

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MarketFlow &mdash; AlphaPy Pro 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=acc74ff5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="alphapy" href="../source/modules.html" />
    <link rel="prev" title="Project Structure" href="project.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AlphaPy Pro
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/command.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/kaggle.html">Kaggle Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/market.html">Market Prediction Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/system.html">Trading System Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">AlphaPy Pro Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project Structure</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MarketFlow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modern-data-sources">Modern Data Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-format-and-structure">Data Format and Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#variable-definition-language-vdl">Variable Definition Language (VDL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-features">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-marketflow">Running MarketFlow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-structure">Output Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#trading-systems-integration">Trading Systems Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-applications">Example Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performance-analytics">Performance Analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/modules.html">alphapy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AlphaPy Pro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MarketFlow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/market_flow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="marketflow">
<h1>MarketFlow<a class="headerlink" href="#marketflow" title="Link to this heading"></a></h1>
<p><strong>MarketFlow</strong> (<code class="docutils literal notranslate"><span class="pre">mflow</span></code>) is AlphaPy Pro’s specialized pipeline for financial market
analysis and algorithmic trading. It transforms raw market data into machine learning
models for market predictions, portfolio optimization, and systematic trading strategies.</p>
<a class="reference internal image-reference" href="../_images/market_pipeline.png"><img alt="MarketFlow Pipeline" class="align-center" src="../_images/market_pipeline.png" style="width: 100%;" />
</a>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>MarketFlow provides a complete workflow for quantitative finance:</p>
<ol class="arabic simple">
<li><p><strong>Data Acquisition</strong> - Fetch market data from multiple sources</p></li>
<li><p><strong>Feature Engineering</strong> - Create technical indicators and market features</p></li>
<li><p><strong>Signal Generation</strong> - Build predictive models for market movements</p></li>
<li><p><strong>Portfolio Construction</strong> - Optimize position sizing and risk management</p></li>
<li><p><strong>Backtesting</strong> - Evaluate strategy performance with realistic assumptions</p></li>
</ol>
</section>
<section id="modern-data-sources">
<h2>Modern Data Sources<a class="headerlink" href="#modern-data-sources" title="Link to this heading"></a></h2>
<p>AlphaPy Pro MarketFlow supports multiple professional-grade data providers:</p>
<p><strong>Primary Data Sources:</strong></p>
<ul class="simple">
<li><p><strong>EODHD (End of Day Historical Data)</strong> - Daily and intraday market data</p></li>
<li><p><strong>Yahoo Finance</strong> - Free daily stock data via yfinance</p></li>
<li><p><strong>Polygon</strong> - Professional real-time and historical market data</p></li>
<li><p><strong>IEX Cloud</strong> - Financial data API with extensive coverage</p></li>
</ul>
<p><strong>Legacy Support:</strong></p>
<ul class="simple">
<li><p><strong>Google Finance</strong> - Deprecated (API discontinued in 2017)</p></li>
<li><p><strong>Quandl</strong> - Limited free tier available</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Google Finance intraday data is no longer available. Modern applications
should use EODHD or Polygon for intraday data requirements.</p>
</div>
</section>
<section id="data-format-and-structure">
<h2>Data Format and Structure<a class="headerlink" href="#data-format-and-structure" title="Link to this heading"></a></h2>
<p>MarketFlow standardizes all market data into a consistent format:</p>
<p><strong>Daily Market Data (OHLCV):</strong></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>Date,Open,High,Low,Close,Volume,Symbol
2024-01-02,185.64,186.89,183.86,185.64,52844800,AAPL
2024-01-03,184.97,185.89,182.73,184.25,58414800,AAPL
</pre></div>
</div>
<p><strong>Intraday Market Data:</strong></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>Datetime,Open,High,Low,Close,Volume,Symbol,bar_number
2024-01-02 09:30:00,185.64,185.89,185.30,185.50,125400,AAPL,1
2024-01-02 09:31:00,185.50,185.75,185.25,185.60,98300,AAPL,2
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>MarketFlow uses a hierarchical configuration system combining multiple YAML files:</p>
<p><strong>market.yml</strong> - Market-specific configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">market</span><span class="p">:</span>
<span class="w">    </span><span class="nt">data_history      </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">252</span><span class="w">              </span><span class="c1"># Trading days of history</span>
<span class="w">    </span><span class="nt">forecast_period   </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">                </span><span class="c1"># Days to forecast</span>
<span class="w">    </span><span class="nt">fractal          </span><span class="p">:</span><span class="w"> </span><span class="s">&#39;1d&#39;</span><span class="w">              </span><span class="c1"># Time frame (1d, 1h, 5m)</span>
<span class="w">    </span><span class="nt">leaders          </span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;open&#39;</span><span class="p p-Indicator">]</span><span class="w">          </span><span class="c1"># Features available at market open</span>
<span class="w">    </span><span class="nt">predict_history  </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">               </span><span class="c1"># Min periods for prediction</span>
<span class="w">    </span><span class="nt">schema           </span><span class="p">:</span><span class="w"> </span><span class="s">&#39;prices&#39;</span><span class="w">          </span><span class="c1"># Data schema identifier</span>
<span class="w">    </span><span class="nt">target_group     </span><span class="p">:</span><span class="w"> </span><span class="s">&#39;tech&#39;</span><span class="w">            </span><span class="c1"># Symbol group to analyze</span>

<span class="nt">groups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tech</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AAPL</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MSFT</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GOOGL</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">META</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TSLA</span>

<span class="w">    </span><span class="nt">crypto</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BTC-USD</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ETH-USD</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ADA-USD</span>

<span class="w">    </span><span class="nt">etf</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPY</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">QQQ</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IWM</span>
</pre></div>
</div>
<p><strong>Data Source Configuration:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">data_sources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eodhd&#39;</span><span class="w">                    </span><span class="c1"># Primary data source</span>
<span class="w">    </span><span class="nt">fallback</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;yahoo&#39;</span><span class="w">                   </span><span class="c1"># Fallback source</span>

<span class="w">    </span><span class="nt">eodhd</span><span class="p">:</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;your_api_key&#39;</span>
<span class="w">        </span><span class="nt">base_url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;https://eodhistoricaldata.com/api/&#39;</span>

<span class="w">    </span><span class="nt">polygon</span><span class="p">:</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;your_polygon_key&#39;</span>
<span class="w">        </span><span class="nt">base_url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;https://api.polygon.io/&#39;</span>
</pre></div>
</div>
</section>
<section id="variable-definition-language-vdl">
<h2>Variable Definition Language (VDL)<a class="headerlink" href="#variable-definition-language-vdl" title="Link to this heading"></a></h2>
<p>MarketFlow includes a powerful Variable Definition Language for creating
technical indicators and custom features:</p>
<p><strong>Basic Technical Indicators:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Moving averages</span>
<span class="w">    </span><span class="nt">sma_20</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mean(close,</span><span class="nv"> </span><span class="s">20)&#39;</span><span class="w">           </span><span class="c1"># Simple moving average</span>
<span class="w">    </span><span class="nt">ema_12</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;ewm(close,</span><span class="nv"> </span><span class="s">12)&#39;</span><span class="w">            </span><span class="c1"># Exponential moving average</span>

<span class="w">    </span><span class="c1"># Momentum indicators</span>
<span class="w">    </span><span class="nt">rsi_14</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;rsi(close,</span><span class="nv"> </span><span class="s">14)&#39;</span><span class="w">            </span><span class="c1"># Relative Strength Index</span>
<span class="w">    </span><span class="nt">macd</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;macd(close,</span><span class="nv"> </span><span class="s">12,</span><span class="nv"> </span><span class="s">26,</span><span class="nv"> </span><span class="s">9)&#39;</span><span class="w">      </span><span class="c1"># MACD</span>

<span class="w">    </span><span class="c1"># Volatility indicators</span>
<span class="w">    </span><span class="nt">bb_upper</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;bollinger_upper(close,</span><span class="nv"> </span><span class="s">20,</span><span class="nv"> </span><span class="s">2)&#39;</span><span class="w">  </span><span class="c1"># Bollinger Bands</span>
<span class="w">    </span><span class="nt">atr_14</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;atr(high,</span><span class="nv"> </span><span class="s">low,</span><span class="nv"> </span><span class="s">close,</span><span class="nv"> </span><span class="s">14)&#39;</span><span class="w">        </span><span class="c1"># Average True Range</span>

<span class="w">    </span><span class="c1"># Volume indicators</span>
<span class="w">    </span><span class="nt">obv</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;on_balance_volume(close,</span><span class="nv"> </span><span class="s">volume)&#39;</span><span class="w">     </span><span class="c1"># On Balance Volume</span>
<span class="w">    </span><span class="nt">vwap</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;volume_weighted_average_price(high,</span><span class="nv"> </span><span class="s">low,</span><span class="nv"> </span><span class="s">close,</span><span class="nv"> </span><span class="s">volume)&#39;</span>
</pre></div>
</div>
<p><strong>Custom Expressions:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">variables</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Price relationships</span>
<span class="w">    </span><span class="nt">above_sma</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;close</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">sma_20&#39;</span><span class="w">         </span><span class="c1"># Boolean: price above SMA</span>
<span class="w">    </span><span class="nt">price_momentum</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;close</span><span class="nv"> </span><span class="s">/</span><span class="nv"> </span><span class="s">sma_50&#39;</span><span class="w">    </span><span class="c1"># Price relative to trend</span>

<span class="w">    </span><span class="c1"># Volatility measures</span>
<span class="w">    </span><span class="nt">daily_return</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pct_change(close,</span><span class="nv"> </span><span class="s">1)&#39;</span>
<span class="w">    </span><span class="nt">volatility</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;std(daily_return,</span><span class="nv"> </span><span class="s">20)&#39;</span>

<span class="w">    </span><span class="c1"># Multi-timeframe</span>
<span class="w">    </span><span class="nt">weekly_high</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;resample(high,</span><span class="nv"> </span><span class="s">&quot;W&quot;,</span><span class="nv"> </span><span class="s">&quot;max&quot;)&#39;</span>
</pre></div>
</div>
<p><strong>Aliases for Convenience:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cma</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;sma_close&#39;</span><span class="w">                    </span><span class="c1"># Closing moving average</span>
<span class="w">    </span><span class="nt">vol</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;volume&#39;</span><span class="w">                       </span><span class="c1"># Volume shorthand</span>
<span class="w">    </span><span class="nt">ret</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pct_change(close,</span><span class="nv"> </span><span class="s">1)&#39;</span><span class="w">         </span><span class="c1"># Daily returns</span>
</pre></div>
</div>
</section>
<section id="advanced-features">
<h2>Advanced Features<a class="headerlink" href="#advanced-features" title="Link to this heading"></a></h2>
<p><strong>Meta-Labeling:</strong></p>
<p>MarketFlow implements the Triple Barrier Method for advanced financial ML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="nt">meta_labeling</span><span class="p">:</span>
<span class="w">        </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">        </span><span class="nt">profit_target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.02</span><span class="w">             </span><span class="c1"># 2% profit target</span>
<span class="w">        </span><span class="nt">stop_loss</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span><span class="w">                 </span><span class="c1"># 1% stop loss</span>
<span class="w">        </span><span class="nt">max_holding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">                  </span><span class="c1"># Max holding period (days)</span>
<span class="w">        </span><span class="nt">volatility_window</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">           </span><span class="c1"># Volatility calculation window</span>
</pre></div>
</div>
<p><strong>Time Series Cross-Validation:</strong></p>
<p>Proper time series validation that respects temporal order:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="nt">time_series</span><span class="p">:</span>
<span class="w">        </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">        </span><span class="nt">cv_method</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;time_series_split&#39;</span><span class="w">   </span><span class="c1"># Time-aware CV</span>
<span class="w">        </span><span class="nt">test_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span><span class="w">                   </span><span class="c1"># Recent 20% for testing</span>
<span class="w">        </span><span class="nt">gap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">                           </span><span class="c1"># Gap between train/test</span>
</pre></div>
</div>
<p><strong>Portfolio Optimization:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">portfolio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">optimization</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mean_variance&#39;</span><span class="w">        </span><span class="c1"># Optimization method</span>
<span class="w">    </span><span class="nt">max_weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span><span class="w">                     </span><span class="c1"># Max position size</span>
<span class="w">    </span><span class="nt">rebalance_freq</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;monthly&#39;</span><span class="w">           </span><span class="c1"># Rebalancing frequency</span>
<span class="w">    </span><span class="nt">transaction_cost</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span><span class="w">             </span><span class="c1"># 10 bps transaction cost</span>
</pre></div>
</div>
</section>
<section id="running-marketflow">
<h2>Running MarketFlow<a class="headerlink" href="#running-marketflow" title="Link to this heading"></a></h2>
<p><strong>Basic Usage:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train models for default group</span>
mflow

<span class="c1"># Train with specific date range</span>
mflow<span class="w"> </span>--tdate<span class="w"> </span><span class="m">2020</span>-01-01<span class="w"> </span>--pdate<span class="w"> </span><span class="m">2023</span>-12-31

<span class="c1"># Generate predictions only</span>
mflow<span class="w"> </span>--predict
</pre></div>
</div>
<p><strong>Configuration Options:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use different data source</span>
mflow<span class="w"> </span>--source<span class="w"> </span>eodhd

<span class="c1"># Extended history</span>
mflow<span class="w"> </span>--history<span class="w"> </span><span class="m">500</span>

<span class="c1"># Different time frame</span>
mflow<span class="w"> </span>--fractal<span class="w"> </span>1h
</pre></div>
</div>
</section>
<section id="output-structure">
<h2>Output Structure<a class="headerlink" href="#output-structure" title="Link to this heading"></a></h2>
<p>MarketFlow generates comprehensive output for analysis:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>runs/run_YYYYMMDD_HHMMSS/
├── config/
│   ├── market.yml
│   └── model.yml
├── data/
│   ├── features/              # Engineered features
│   ├── prices/                # Raw price data
│   └── indicators/            # Technical indicators
├── models/
│   ├── signal_model.pkl       # Trained prediction model
│   └── portfolio_model.pkl    # Portfolio optimization
├── predictions/
│   ├── signals.csv            # Model predictions
│   └── positions.csv          # Portfolio positions
└── analysis/
    ├── backtest_results.html  # Performance report
    ├── factor_analysis.csv    # Factor attribution
    └── risk_metrics.csv       # Risk analytics
</pre></div>
</div>
</section>
<section id="trading-systems-integration">
<h2>Trading Systems Integration<a class="headerlink" href="#trading-systems-integration" title="Link to this heading"></a></h2>
<p>MarketFlow can generate trading signals for various execution platforms:</p>
<p><strong>Signal Generation:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">systems</span><span class="p">:</span>
<span class="w">    </span><span class="nt">long_short</span><span class="p">:</span>
<span class="w">        </span><span class="nt">signal_long</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;prediction</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0.6&#39;</span><span class="w">     </span><span class="c1"># Long threshold</span>
<span class="w">        </span><span class="nt">signal_short</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;prediction</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">0.4&#39;</span><span class="w">    </span><span class="c1"># Short threshold</span>
<span class="w">        </span><span class="nt">max_positions</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">                   </span><span class="c1"># Position limit</span>

<span class="w">    </span><span class="nt">momentum</span><span class="p">:</span>
<span class="w">        </span><span class="nt">signal_long</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;close</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">sma_20</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">rsi_14</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">70&#39;</span>
<span class="w">        </span><span class="nt">signal_exit</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;close</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">sma_20</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">rsi_14</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">80&#39;</span>
</pre></div>
</div>
<p><strong>Risk Management:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">risk</span><span class="p">:</span>
<span class="w">    </span><span class="nt">max_portfolio_vol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.15</span><span class="w">             </span><span class="c1"># 15% max portfolio volatility</span>
<span class="w">    </span><span class="nt">max_individual_weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.05</span><span class="w">         </span><span class="c1"># 5% max individual position</span>
<span class="w">    </span><span class="nt">stop_loss</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.02</span><span class="w">                     </span><span class="c1"># 2% stop loss</span>
<span class="w">    </span><span class="nt">profit_target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.04</span><span class="w">                 </span><span class="c1"># 4% profit target</span>
</pre></div>
</div>
</section>
<section id="example-applications">
<h2>Example Applications<a class="headerlink" href="#example-applications" title="Link to this heading"></a></h2>
<p><strong>1. Momentum Strategy:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;future_return_5d</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0.02&#39;</span><span class="w">       </span><span class="c1"># 2% return in 5 days</span>
<span class="nt">features</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;rsi_14&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;macd_signal&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;volume_ratio_20&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;price_momentum_50&#39;</span>
</pre></div>
</div>
<p><strong>2. Mean Reversion:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;future_return_1d&#39;</span>
<span class="nt">features</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;zscore_close_20&#39;</span><span class="w">                  </span><span class="c1"># Z-score of price</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;rsi_oversold&#39;</span><span class="w">                     </span><span class="c1"># RSI &lt; 30</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;bollinger_position&#39;</span><span class="w">              </span><span class="c1"># Position in Bollinger Bands</span>
</pre></div>
</div>
<p><strong>3. Multi-Asset Strategy:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">groups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">universe</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SPY</span><span class="w">    </span><span class="c1"># S&amp;P 500</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TLT</span><span class="w">    </span><span class="c1"># 20+ Year Treasury</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GLD</span><span class="w">    </span><span class="c1"># Gold</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VIX</span><span class="w">    </span><span class="c1"># Volatility</span>

<span class="nt">features</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;correlation_spy_20&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;relative_strength&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;regime_indicator&#39;</span>
</pre></div>
</div>
</section>
<section id="performance-analytics">
<h2>Performance Analytics<a class="headerlink" href="#performance-analytics" title="Link to this heading"></a></h2>
<p>MarketFlow provides comprehensive performance analysis:</p>
<p><strong>Returns Analysis:</strong>
* Total return and CAGR
* Sharpe ratio and Sortino ratio
* Maximum drawdown
* Win rate and profit factor</p>
<p><strong>Risk Metrics:</strong>
* Value at Risk (VaR)
* Conditional VaR (CVaR)
* Beta and correlation analysis
* Factor exposure analysis</p>
<p><strong>Trading Metrics:</strong>
* Transaction costs
* Turnover and capacity
* Implementation shortfall
* Market impact analysis</p>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Data Quality</strong> - Validate data sources and handle corporate actions</p></li>
<li><p><strong>Feature Engineering</strong> - Focus on regime-aware features</p></li>
<li><p><strong>Walk-Forward Analysis</strong> - Use time-series cross-validation</p></li>
<li><p><strong>Risk Management</strong> - Implement proper position sizing</p></li>
<li><p><strong>Transaction Costs</strong> - Account for realistic trading costs</p></li>
<li><p><strong>Out-of-Sample Testing</strong> - Reserve recent data for final validation</p></li>
</ol>
<p>For detailed examples, see the <code class="docutils literal notranslate"><span class="pre">projects/</span></code> directory which includes:</p>
<ul class="simple">
<li><p>Shannon’s Demon trading strategy</p></li>
<li><p>Time series momentum models</p></li>
<li><p>Triple barrier method implementations</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="project.html" class="btn btn-neutral float-left" title="Project Structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../source/modules.html" class="btn btn-neutral float-right" title="alphapy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, ScottFree Analytics LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
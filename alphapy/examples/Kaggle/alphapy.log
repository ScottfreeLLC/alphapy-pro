[08/07/21 19:23:27] INFO	********************************************************************************
[08/07/21 19:23:27] INFO	AlphaPy Start
[08/07/21 19:23:27] INFO	********************************************************************************
[08/07/21 19:23:27] INFO	Model Configuration
[08/07/21 19:23:27] INFO	No transforms Found
[08/07/21 19:23:27] INFO	MODEL PARAMETERS:
[08/07/21 19:23:27] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:23:27] INFO	calibration       = False
[08/07/21 19:23:27] INFO	cal_type          = sigmoid
[08/07/21 19:23:27] INFO	calibration_plot  = False
[08/07/21 19:23:27] INFO	clustering        = True
[08/07/21 19:23:27] INFO	cluster_inc       = 3
[08/07/21 19:23:27] INFO	cluster_max       = 30
[08/07/21 19:23:27] INFO	cluster_min       = 3
[08/07/21 19:23:27] INFO	confusion_matrix  = True
[08/07/21 19:23:27] INFO	counts            = True
[08/07/21 19:23:27] INFO	cv_folds          = 3
[08/07/21 19:23:27] INFO	directory         = .
[08/07/21 19:23:27] INFO	extension         = csv
[08/07/21 19:23:27] INFO	drop              = ['PassengerId']
[08/07/21 19:23:27] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:23:27] INFO	esr               = 20
[08/07/21 19:23:27] INFO	factors           = ['Embarked']
[08/07/21 19:23:27] INFO	features [X]      = *
[08/07/21 19:23:27] INFO	feature_selection = False
[08/07/21 19:23:27] INFO	fs_percentage     = 50
[08/07/21 19:23:27] INFO	fs_score_func     = <function f_classif at 0x7f88905a58b0>
[08/07/21 19:23:27] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:23:27] INFO	grid_search       = True
[08/07/21 19:23:27] INFO	gs_iters          = 50
[08/07/21 19:23:27] INFO	gs_random         = True
[08/07/21 19:23:27] INFO	gs_sample         = False
[08/07/21 19:23:27] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:23:27] INFO	importances       = True
[08/07/21 19:23:27] INFO	interactions      = False
[08/07/21 19:23:27] INFO	isomap            = False
[08/07/21 19:23:27] INFO	iso_components    = 2
[08/07/21 19:23:27] INFO	iso_neighbors     = 5
[08/07/21 19:23:27] INFO	isample_pct       = 10
[08/07/21 19:23:27] INFO	learning_curve    = True
[08/07/21 19:23:27] INFO	logtransform      = False
[08/07/21 19:23:27] INFO	lv_remove         = True
[08/07/21 19:23:27] INFO	lv_threshold      = 0.100000
[08/07/21 19:23:27] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:23:27] INFO	n_estimators      = 51
[08/07/21 19:23:27] INFO	n_jobs            = -1
[08/07/21 19:23:27] INFO	ngrams_max        = 2
[08/07/21 19:23:27] INFO	numpy             = True
[08/07/21 19:23:27] INFO	pca               = False
[08/07/21 19:23:27] INFO	pca_inc           = 1
[08/07/21 19:23:27] INFO	pca_max           = 10
[08/07/21 19:23:27] INFO	pca_min           = 2
[08/07/21 19:23:27] INFO	pca_whiten        = False
[08/07/21 19:23:27] INFO	poly_degree       = 2
[08/07/21 19:23:27] INFO	pvalue_level      = 0.010000
[08/07/21 19:23:27] INFO	rfe               = True
[08/07/21 19:23:27] INFO	rfe_step          = 3
[08/07/21 19:23:27] INFO	roc_curve         = True
[08/07/21 19:23:27] INFO	rounding          = 2
[08/07/21 19:23:27] INFO	sampling          = False
[08/07/21 19:23:27] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:23:27] INFO	sampling_ratio    = 0.500000
[08/07/21 19:23:27] INFO	scaler_option     = True
[08/07/21 19:23:27] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:23:27] INFO	scipy             = False
[08/07/21 19:23:27] INFO	scorer            = roc_auc
[08/07/21 19:23:27] INFO	seed              = 42
[08/07/21 19:23:27] INFO	sentinel          = -1
[08/07/21 19:23:27] INFO	separator         = ,
[08/07/21 19:23:27] INFO	shuffle           = False
[08/07/21 19:23:27] INFO	split             = 0.400000
[08/07/21 19:23:27] INFO	submission_file   = gender_submission
[08/07/21 19:23:27] INFO	submit_probas     = False
[08/07/21 19:23:27] INFO	target [y]        = Survived
[08/07/21 19:23:27] INFO	target_value      = 1
[08/07/21 19:23:27] INFO	transforms        = None
[08/07/21 19:23:27] INFO	tsne              = False
[08/07/21 19:23:27] INFO	tsne_components   = 2
[08/07/21 19:23:27] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:23:27] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:23:27] INFO	vectorize         = False
[08/07/21 19:23:27] INFO	verbosity         = 0
[08/07/21 19:23:27] INFO	Creating directory ./data
[08/07/21 19:23:27] INFO	Creating directory ./model
[08/07/21 19:23:27] INFO	Creating directory ./output
[08/07/21 19:23:27] INFO	Creating directory ./plots
[08/07/21 19:23:27] INFO	Creating Model
[08/07/21 19:23:27] INFO	Calling Pipeline
[08/07/21 19:23:27] INFO	Training Pipeline
[08/07/21 19:23:27] INFO	Loading Data
[08/07/21 19:23:27] INFO	Loading data from ./input/train.csv
[08/07/21 19:23:27] INFO	Found target Survived in data frame
[08/07/21 19:23:27] INFO	Labels (y) found for Partition.train
[08/07/21 19:23:27] INFO	Loading Data
[08/07/21 19:23:27] INFO	Loading data from ./input/test.csv
[08/07/21 19:23:27] INFO	Target Survived not found in Partition.test
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Original Feature Statistics
[08/07/21 19:23:27] INFO	Number of Training Rows    : 891
[08/07/21 19:23:27] INFO	Number of Training Columns : 11
[08/07/21 19:23:27] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:23:27] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:23:27] INFO	Number of Testing Rows     : 418
[08/07/21 19:23:27] INFO	Number of Testing Columns  : 11
[08/07/21 19:23:27] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:23:27] INFO	Feature Count     : 11
[08/07/21 19:23:27] INFO	Applying transforms
[08/07/21 19:23:27] INFO	No transforms Specified
[08/07/21 19:23:27] INFO	New Feature Count : 11
[08/07/21 19:23:27] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:23:27] INFO	Original Feature Count : 11
[08/07/21 19:23:27] INFO	Reduced Feature Count  : 10
[08/07/21 19:23:27] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:23:27] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:23:27] INFO	Creating Cross-Tabulations
[08/07/21 19:23:27] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:23:27] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:23:27] INFO	Feature Count     : 10
[08/07/21 19:23:27] INFO	Creating Count Features
[08/07/21 19:23:27] INFO	NA Counts
[08/07/21 19:23:27] INFO	Number Counts
[08/07/21 19:23:27] INFO	New Feature Count : 21
[08/07/21 19:23:27] INFO	Creating Base Features
[08/07/21 19:23:27] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:23:27] INFO	Feature 2: Name => Factorization
[08/07/21 19:23:27] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:23:27] INFO	Feature 3: Sex => Factorization
[08/07/21 19:23:27] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:23:27] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:23:27] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:23:27] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:23:27] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:23:27] INFO	Encoding: Encoders.target
[08/07/21 19:23:27] INFO	Fitting training features for Embarked
[08/07/21 19:23:27] INFO	Transforming testing features for Embarked
[08/07/21 19:23:27] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	New Feature Count : 21
[08/07/21 19:23:27] INFO	Scaling Base Features
[08/07/21 19:23:27] INFO	Creating NumPy Features
[08/07/21 19:23:27] INFO	NumPy Feature: sum
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: mean
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: std
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: var
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature Count : 4
[08/07/21 19:23:27] INFO	New Feature Count : 25
[08/07/21 19:23:27] INFO	Creating Clustering Features
[08/07/21 19:23:27] INFO	Cluster Minimum   : 3
[08/07/21 19:23:27] INFO	Cluster Maximum   : 30
[08/07/21 19:23:27] INFO	Cluster Increment : 3
[08/07/21 19:23:27] INFO	k = 3
[08/07/21 19:23:27] INFO	k = 6
[08/07/21 19:23:27] INFO	k = 9
[08/07/21 19:23:27] INFO	k = 12
[08/07/21 19:23:27] INFO	k = 15
[08/07/21 19:23:27] INFO	k = 18
[08/07/21 19:23:27] INFO	k = 21
[08/07/21 19:23:27] INFO	k = 24
[08/07/21 19:23:27] INFO	k = 27
[08/07/21 19:23:27] INFO	k = 30
[08/07/21 19:23:27] INFO	Clustering Feature Count : 10
[08/07/21 19:23:27] INFO	New Feature Count : 35
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Creating Interactions
[08/07/21 19:23:27] INFO	Initial Feature Count  : 35
[08/07/21 19:23:27] INFO	Skipping Interactions
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Removing Low-Variance Features
[08/07/21 19:23:27] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:23:27] INFO	Original Feature Count  : 35
[08/07/21 19:23:27] INFO	Reduced Feature Count   : 35
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Skipping Shuffling
[08/07/21 19:23:27] INFO	Skipping Sampling
[08/07/21 19:23:27] INFO	Getting All Estimators
[08/07/21 19:23:27] INFO	Algorithm Configuration
[08/07/21 19:23:27] INFO	Cannot load xgboost
[08/07/21 19:23:27] INFO	Cannot load lightgbm
[08/07/21 19:23:27] INFO	Cannot load catboost
[08/07/21 19:23:27] INFO	Cannot load keras
[08/07/21 19:23:27] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:23:27] INFO	Selecting Models
[08/07/21 19:23:27] INFO	Algorithm: CATB
[08/07/21 19:23:27] INFO	Algorithm CATB not found
[08/07/21 19:26:47] INFO	********************************************************************************
[08/07/21 19:26:47] INFO	AlphaPy Start
[08/07/21 19:26:47] INFO	********************************************************************************
[08/07/21 19:26:47] INFO	Model Configuration
[08/07/21 19:26:47] INFO	No transforms Found
[08/07/21 19:26:47] INFO	MODEL PARAMETERS:
[08/07/21 19:26:47] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:26:47] INFO	calibration       = False
[08/07/21 19:26:47] INFO	cal_type          = sigmoid
[08/07/21 19:26:47] INFO	calibration_plot  = False
[08/07/21 19:26:47] INFO	clustering        = True
[08/07/21 19:26:47] INFO	cluster_inc       = 3
[08/07/21 19:26:47] INFO	cluster_max       = 30
[08/07/21 19:26:47] INFO	cluster_min       = 3
[08/07/21 19:26:47] INFO	confusion_matrix  = True
[08/07/21 19:26:47] INFO	counts            = True
[08/07/21 19:26:47] INFO	cv_folds          = 3
[08/07/21 19:26:47] INFO	directory         = .
[08/07/21 19:26:47] INFO	extension         = csv
[08/07/21 19:26:47] INFO	drop              = ['PassengerId']
[08/07/21 19:26:47] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:26:47] INFO	esr               = 20
[08/07/21 19:26:47] INFO	factors           = ['Embarked']
[08/07/21 19:26:47] INFO	features [X]      = *
[08/07/21 19:26:47] INFO	feature_selection = False
[08/07/21 19:26:47] INFO	fs_percentage     = 50
[08/07/21 19:26:47] INFO	fs_score_func     = <function f_classif at 0x7f99f9e2e8b0>
[08/07/21 19:26:47] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:26:47] INFO	grid_search       = True
[08/07/21 19:26:47] INFO	gs_iters          = 50
[08/07/21 19:26:47] INFO	gs_random         = True
[08/07/21 19:26:47] INFO	gs_sample         = False
[08/07/21 19:26:47] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:26:47] INFO	importances       = True
[08/07/21 19:26:47] INFO	interactions      = False
[08/07/21 19:26:47] INFO	isomap            = False
[08/07/21 19:26:47] INFO	iso_components    = 2
[08/07/21 19:26:47] INFO	iso_neighbors     = 5
[08/07/21 19:26:47] INFO	isample_pct       = 10
[08/07/21 19:26:47] INFO	learning_curve    = True
[08/07/21 19:26:47] INFO	logtransform      = False
[08/07/21 19:26:47] INFO	lv_remove         = True
[08/07/21 19:26:47] INFO	lv_threshold      = 0.100000
[08/07/21 19:26:47] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:26:47] INFO	n_estimators      = 51
[08/07/21 19:26:47] INFO	n_jobs            = -1
[08/07/21 19:26:47] INFO	ngrams_max        = 2
[08/07/21 19:26:47] INFO	numpy             = True
[08/07/21 19:26:47] INFO	pca               = False
[08/07/21 19:26:47] INFO	pca_inc           = 1
[08/07/21 19:26:47] INFO	pca_max           = 10
[08/07/21 19:26:47] INFO	pca_min           = 2
[08/07/21 19:26:47] INFO	pca_whiten        = False
[08/07/21 19:26:47] INFO	poly_degree       = 2
[08/07/21 19:26:47] INFO	pvalue_level      = 0.010000
[08/07/21 19:26:47] INFO	rfe               = True
[08/07/21 19:26:47] INFO	rfe_step          = 3
[08/07/21 19:26:47] INFO	roc_curve         = True
[08/07/21 19:26:47] INFO	rounding          = 2
[08/07/21 19:26:47] INFO	sampling          = False
[08/07/21 19:26:47] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:26:47] INFO	sampling_ratio    = 0.500000
[08/07/21 19:26:47] INFO	scaler_option     = True
[08/07/21 19:26:47] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:26:47] INFO	scipy             = False
[08/07/21 19:26:47] INFO	scorer            = roc_auc
[08/07/21 19:26:47] INFO	seed              = 42
[08/07/21 19:26:47] INFO	sentinel          = -1
[08/07/21 19:26:47] INFO	separator         = ,
[08/07/21 19:26:47] INFO	shuffle           = False
[08/07/21 19:26:47] INFO	split             = 0.400000
[08/07/21 19:26:47] INFO	submission_file   = gender_submission
[08/07/21 19:26:47] INFO	submit_probas     = False
[08/07/21 19:26:47] INFO	target [y]        = Survived
[08/07/21 19:26:47] INFO	target_value      = 1
[08/07/21 19:26:47] INFO	transforms        = None
[08/07/21 19:26:47] INFO	tsne              = False
[08/07/21 19:26:47] INFO	tsne_components   = 2
[08/07/21 19:26:47] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:26:47] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:26:47] INFO	vectorize         = False
[08/07/21 19:26:47] INFO	verbosity         = 0
[08/07/21 19:26:47] INFO	Creating Model
[08/07/21 19:26:47] INFO	Calling Pipeline
[08/07/21 19:26:47] INFO	Training Pipeline
[08/07/21 19:26:47] INFO	Loading Data
[08/07/21 19:26:47] INFO	Loading data from ./input/train.csv
[08/07/21 19:26:47] INFO	Found target Survived in data frame
[08/07/21 19:26:47] INFO	Labels (y) found for Partition.train
[08/07/21 19:26:47] INFO	Loading Data
[08/07/21 19:26:47] INFO	Loading data from ./input/test.csv
[08/07/21 19:26:47] INFO	Target Survived not found in Partition.test
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Original Feature Statistics
[08/07/21 19:26:47] INFO	Number of Training Rows    : 891
[08/07/21 19:26:47] INFO	Number of Training Columns : 11
[08/07/21 19:26:47] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:26:47] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:26:47] INFO	Number of Testing Rows     : 418
[08/07/21 19:26:47] INFO	Number of Testing Columns  : 11
[08/07/21 19:26:47] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:26:47] INFO	Feature Count     : 11
[08/07/21 19:26:47] INFO	Applying transforms
[08/07/21 19:26:47] INFO	No transforms Specified
[08/07/21 19:26:47] INFO	New Feature Count : 11
[08/07/21 19:26:47] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:26:47] INFO	Original Feature Count : 11
[08/07/21 19:26:47] INFO	Reduced Feature Count  : 10
[08/07/21 19:26:47] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:26:47] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:26:47] INFO	Creating Cross-Tabulations
[08/07/21 19:26:47] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:26:47] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:26:47] INFO	Feature Count     : 10
[08/07/21 19:26:47] INFO	Creating Count Features
[08/07/21 19:26:47] INFO	NA Counts
[08/07/21 19:26:47] INFO	Number Counts
[08/07/21 19:26:47] INFO	New Feature Count : 21
[08/07/21 19:26:47] INFO	Creating Base Features
[08/07/21 19:26:47] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:26:47] INFO	Feature 2: Name => Factorization
[08/07/21 19:26:47] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:26:47] INFO	Feature 3: Sex => Factorization
[08/07/21 19:26:47] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:26:47] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:26:47] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:26:47] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:26:47] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:26:47] INFO	Encoding: Encoders.target
[08/07/21 19:26:47] INFO	Fitting training features for Embarked
[08/07/21 19:26:47] INFO	Transforming testing features for Embarked
[08/07/21 19:26:47] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	New Feature Count : 21
[08/07/21 19:26:47] INFO	Scaling Base Features
[08/07/21 19:26:47] INFO	Creating NumPy Features
[08/07/21 19:26:47] INFO	NumPy Feature: sum
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: mean
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: std
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: var
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature Count : 4
[08/07/21 19:26:47] INFO	New Feature Count : 25
[08/07/21 19:26:47] INFO	Creating Clustering Features
[08/07/21 19:26:47] INFO	Cluster Minimum   : 3
[08/07/21 19:26:47] INFO	Cluster Maximum   : 30
[08/07/21 19:26:47] INFO	Cluster Increment : 3
[08/07/21 19:26:47] INFO	k = 3
[08/07/21 19:26:47] INFO	k = 6
[08/07/21 19:26:47] INFO	k = 9
[08/07/21 19:26:47] INFO	k = 12
[08/07/21 19:26:47] INFO	k = 15
[08/07/21 19:26:47] INFO	k = 18
[08/07/21 19:26:47] INFO	k = 21
[08/07/21 19:26:47] INFO	k = 24
[08/07/21 19:26:47] INFO	k = 27
[08/07/21 19:26:47] INFO	k = 30
[08/07/21 19:26:47] INFO	Clustering Feature Count : 10
[08/07/21 19:26:47] INFO	New Feature Count : 35
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Creating Interactions
[08/07/21 19:26:47] INFO	Initial Feature Count  : 35
[08/07/21 19:26:47] INFO	Skipping Interactions
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Removing Low-Variance Features
[08/07/21 19:26:47] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:26:47] INFO	Original Feature Count  : 35
[08/07/21 19:26:47] INFO	Reduced Feature Count   : 35
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Skipping Shuffling
[08/07/21 19:26:47] INFO	Skipping Sampling
[08/07/21 19:26:47] INFO	Getting All Estimators
[08/07/21 19:26:47] INFO	Algorithm Configuration
[08/07/21 19:26:47] INFO	Cannot load xgboost
[08/07/21 19:26:47] INFO	Cannot load lightgbm
[08/07/21 19:26:47] INFO	Cannot load catboost
[08/07/21 19:26:47] INFO	Cannot load keras
[08/07/21 19:26:47] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:26:47] INFO	Selecting Models
[08/07/21 19:26:47] INFO	Algorithm: CATB
[08/07/21 19:26:47] INFO	Algorithm CATB not found
[08/07/21 19:27:41] INFO	********************************************************************************
[08/07/21 19:27:41] INFO	AlphaPy Start
[08/07/21 19:27:41] INFO	********************************************************************************
[08/07/21 19:27:41] INFO	Model Configuration
[08/07/21 19:27:41] INFO	No transforms Found
[08/07/21 19:27:41] INFO	MODEL PARAMETERS:
[08/07/21 19:27:41] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:27:41] INFO	calibration       = False
[08/07/21 19:27:41] INFO	cal_type          = sigmoid
[08/07/21 19:27:41] INFO	calibration_plot  = False
[08/07/21 19:27:41] INFO	clustering        = True
[08/07/21 19:27:41] INFO	cluster_inc       = 3
[08/07/21 19:27:41] INFO	cluster_max       = 30
[08/07/21 19:27:41] INFO	cluster_min       = 3
[08/07/21 19:27:41] INFO	confusion_matrix  = True
[08/07/21 19:27:41] INFO	counts            = True
[08/07/21 19:27:41] INFO	cv_folds          = 3
[08/07/21 19:27:41] INFO	directory         = .
[08/07/21 19:27:41] INFO	extension         = csv
[08/07/21 19:27:41] INFO	drop              = ['PassengerId']
[08/07/21 19:27:41] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:27:41] INFO	esr               = 20
[08/07/21 19:27:41] INFO	factors           = ['Embarked']
[08/07/21 19:27:41] INFO	features [X]      = *
[08/07/21 19:27:41] INFO	feature_selection = False
[08/07/21 19:27:41] INFO	fs_percentage     = 50
[08/07/21 19:27:41] INFO	fs_score_func     = <function f_classif at 0x7fa9eb53b700>
[08/07/21 19:27:41] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:27:41] INFO	grid_search       = True
[08/07/21 19:27:41] INFO	gs_iters          = 50
[08/07/21 19:27:41] INFO	gs_random         = True
[08/07/21 19:27:41] INFO	gs_sample         = False
[08/07/21 19:27:41] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:27:41] INFO	importances       = True
[08/07/21 19:27:41] INFO	interactions      = False
[08/07/21 19:27:41] INFO	isomap            = False
[08/07/21 19:27:41] INFO	iso_components    = 2
[08/07/21 19:27:41] INFO	iso_neighbors     = 5
[08/07/21 19:27:41] INFO	isample_pct       = 10
[08/07/21 19:27:41] INFO	learning_curve    = True
[08/07/21 19:27:41] INFO	logtransform      = False
[08/07/21 19:27:41] INFO	lv_remove         = True
[08/07/21 19:27:41] INFO	lv_threshold      = 0.100000
[08/07/21 19:27:41] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:27:41] INFO	n_estimators      = 51
[08/07/21 19:27:41] INFO	n_jobs            = -1
[08/07/21 19:27:41] INFO	ngrams_max        = 2
[08/07/21 19:27:41] INFO	numpy             = True
[08/07/21 19:27:41] INFO	pca               = False
[08/07/21 19:27:41] INFO	pca_inc           = 1
[08/07/21 19:27:41] INFO	pca_max           = 10
[08/07/21 19:27:41] INFO	pca_min           = 2
[08/07/21 19:27:41] INFO	pca_whiten        = False
[08/07/21 19:27:41] INFO	poly_degree       = 2
[08/07/21 19:27:41] INFO	pvalue_level      = 0.010000
[08/07/21 19:27:41] INFO	rfe               = True
[08/07/21 19:27:41] INFO	rfe_step          = 3
[08/07/21 19:27:41] INFO	roc_curve         = True
[08/07/21 19:27:41] INFO	rounding          = 2
[08/07/21 19:27:41] INFO	sampling          = False
[08/07/21 19:27:41] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:27:41] INFO	sampling_ratio    = 0.500000
[08/07/21 19:27:41] INFO	scaler_option     = True
[08/07/21 19:27:41] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:27:41] INFO	scipy             = False
[08/07/21 19:27:41] INFO	scorer            = roc_auc
[08/07/21 19:27:41] INFO	seed              = 42
[08/07/21 19:27:41] INFO	sentinel          = -1
[08/07/21 19:27:41] INFO	separator         = ,
[08/07/21 19:27:41] INFO	shuffle           = False
[08/07/21 19:27:41] INFO	split             = 0.400000
[08/07/21 19:27:41] INFO	submission_file   = gender_submission
[08/07/21 19:27:41] INFO	submit_probas     = False
[08/07/21 19:27:41] INFO	target [y]        = Survived
[08/07/21 19:27:41] INFO	target_value      = 1
[08/07/21 19:27:41] INFO	transforms        = None
[08/07/21 19:27:41] INFO	tsne              = False
[08/07/21 19:27:41] INFO	tsne_components   = 2
[08/07/21 19:27:41] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:27:41] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:27:41] INFO	vectorize         = False
[08/07/21 19:27:41] INFO	verbosity         = 0
[08/07/21 19:27:41] INFO	Creating Model
[08/07/21 19:27:41] INFO	Calling Pipeline
[08/07/21 19:27:41] INFO	Training Pipeline
[08/07/21 19:27:41] INFO	Loading Data
[08/07/21 19:27:41] INFO	Loading data from ./input/train.csv
[08/07/21 19:27:41] INFO	Found target Survived in data frame
[08/07/21 19:27:41] INFO	Labels (y) found for Partition.train
[08/07/21 19:27:41] INFO	Loading Data
[08/07/21 19:27:41] INFO	Loading data from ./input/test.csv
[08/07/21 19:27:41] INFO	Target Survived not found in Partition.test
[08/07/21 19:27:41] INFO	Saving New Features in Model
[08/07/21 19:27:41] INFO	Original Feature Statistics
[08/07/21 19:27:41] INFO	Number of Training Rows    : 891
[08/07/21 19:27:41] INFO	Number of Training Columns : 11
[08/07/21 19:27:41] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:27:41] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:27:41] INFO	Number of Testing Rows     : 418
[08/07/21 19:27:41] INFO	Number of Testing Columns  : 11
[08/07/21 19:27:41] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:27:41] INFO	Feature Count     : 11
[08/07/21 19:27:41] INFO	Applying transforms
[08/07/21 19:27:41] INFO	No transforms Specified
[08/07/21 19:27:41] INFO	New Feature Count : 11
[08/07/21 19:27:41] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:27:41] INFO	Original Feature Count : 11
[08/07/21 19:27:41] INFO	Reduced Feature Count  : 10
[08/07/21 19:27:41] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:27:41] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:27:41] INFO	Creating Cross-Tabulations
[08/07/21 19:27:41] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:27:41] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:27:41] INFO	Feature Count     : 10
[08/07/21 19:27:41] INFO	Creating Count Features
[08/07/21 19:27:41] INFO	NA Counts
[08/07/21 19:27:41] INFO	Number Counts
[08/07/21 19:27:41] INFO	New Feature Count : 21
[08/07/21 19:27:41] INFO	Creating Base Features
[08/07/21 19:27:41] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:27:41] INFO	Feature 2: Name => Factorization
[08/07/21 19:27:41] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:27:41] INFO	Feature 3: Sex => Factorization
[08/07/21 19:27:41] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:27:41] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:27:41] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:27:41] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:27:41] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:27:41] INFO	Encoding: Encoders.target
[08/07/21 19:27:41] INFO	Fitting training features for Embarked
[08/07/21 19:27:41] INFO	Transforming testing features for Embarked
[08/07/21 19:27:41] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	New Feature Count : 21
[08/07/21 19:27:41] INFO	Scaling Base Features
[08/07/21 19:27:41] INFO	Creating NumPy Features
[08/07/21 19:27:41] INFO	NumPy Feature: sum
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: mean
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: std
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: var
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature Count : 4
[08/07/21 19:27:41] INFO	New Feature Count : 25
[08/07/21 19:27:41] INFO	Creating Clustering Features
[08/07/21 19:27:41] INFO	Cluster Minimum   : 3
[08/07/21 19:27:41] INFO	Cluster Maximum   : 30
[08/07/21 19:27:41] INFO	Cluster Increment : 3
[08/07/21 19:27:41] INFO	k = 3
[08/07/21 19:27:41] INFO	k = 6
[08/07/21 19:27:41] INFO	k = 9
[08/07/21 19:27:41] INFO	k = 12
[08/07/21 19:27:41] INFO	k = 15
[08/07/21 19:27:41] INFO	k = 18
[08/07/21 19:27:42] INFO	k = 21
[08/07/21 19:27:42] INFO	k = 24
[08/07/21 19:27:42] INFO	k = 27
[08/07/21 19:27:42] INFO	k = 30
[08/07/21 19:27:42] INFO	Clustering Feature Count : 10
[08/07/21 19:27:42] INFO	New Feature Count : 35
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Creating Interactions
[08/07/21 19:27:42] INFO	Initial Feature Count  : 35
[08/07/21 19:27:42] INFO	Skipping Interactions
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Removing Low-Variance Features
[08/07/21 19:27:42] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:27:42] INFO	Original Feature Count  : 35
[08/07/21 19:27:42] INFO	Reduced Feature Count   : 35
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Skipping Shuffling
[08/07/21 19:27:42] INFO	Skipping Sampling
[08/07/21 19:27:42] INFO	Getting All Estimators
[08/07/21 19:27:42] INFO	Algorithm Configuration
[08/07/21 19:27:42] INFO	Cannot load xgboost
[08/07/21 19:27:42] INFO	Cannot load lightgbm
[08/07/21 19:27:42] INFO	Cannot load catboost
[08/07/21 19:27:42] INFO	Cannot load keras
[08/07/21 19:27:42] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:27:42] INFO	Selecting Models
[08/07/21 19:27:42] INFO	Algorithm: CATB
[08/07/21 19:27:42] INFO	Algorithm CATB not found
[08/07/21 19:27:42] INFO	Fitting Initial Model
[08/07/21 19:28:50] INFO	********************************************************************************
[08/07/21 19:28:50] INFO	AlphaPy Start
[08/07/21 19:28:50] INFO	********************************************************************************
[08/07/21 19:28:50] INFO	Model Configuration
[08/07/21 19:28:50] INFO	No transforms Found
[08/07/21 19:28:50] INFO	MODEL PARAMETERS:
[08/07/21 19:28:50] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:28:50] INFO	calibration       = False
[08/07/21 19:28:50] INFO	cal_type          = sigmoid
[08/07/21 19:28:50] INFO	calibration_plot  = False
[08/07/21 19:28:50] INFO	clustering        = True
[08/07/21 19:28:50] INFO	cluster_inc       = 3
[08/07/21 19:28:50] INFO	cluster_max       = 30
[08/07/21 19:28:50] INFO	cluster_min       = 3
[08/07/21 19:28:50] INFO	confusion_matrix  = True
[08/07/21 19:28:50] INFO	counts            = True
[08/07/21 19:28:50] INFO	cv_folds          = 3
[08/07/21 19:28:50] INFO	directory         = .
[08/07/21 19:28:50] INFO	extension         = csv
[08/07/21 19:28:50] INFO	drop              = ['PassengerId']
[08/07/21 19:28:50] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:28:50] INFO	esr               = 20
[08/07/21 19:28:50] INFO	factors           = ['Embarked']
[08/07/21 19:28:50] INFO	features [X]      = *
[08/07/21 19:28:50] INFO	feature_selection = False
[08/07/21 19:28:50] INFO	fs_percentage     = 50
[08/07/21 19:28:50] INFO	fs_score_func     = <function f_classif at 0x7f929349d8b0>
[08/07/21 19:28:50] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:28:50] INFO	grid_search       = True
[08/07/21 19:28:50] INFO	gs_iters          = 50
[08/07/21 19:28:50] INFO	gs_random         = True
[08/07/21 19:28:50] INFO	gs_sample         = False
[08/07/21 19:28:50] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:28:50] INFO	importances       = True
[08/07/21 19:28:50] INFO	interactions      = False
[08/07/21 19:28:50] INFO	isomap            = False
[08/07/21 19:28:50] INFO	iso_components    = 2
[08/07/21 19:28:50] INFO	iso_neighbors     = 5
[08/07/21 19:28:50] INFO	isample_pct       = 10
[08/07/21 19:28:50] INFO	learning_curve    = True
[08/07/21 19:28:50] INFO	logtransform      = False
[08/07/21 19:28:50] INFO	lv_remove         = True
[08/07/21 19:28:50] INFO	lv_threshold      = 0.100000
[08/07/21 19:28:50] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:28:50] INFO	n_estimators      = 51
[08/07/21 19:28:50] INFO	n_jobs            = -1
[08/07/21 19:28:50] INFO	ngrams_max        = 2
[08/07/21 19:28:50] INFO	numpy             = True
[08/07/21 19:28:50] INFO	pca               = False
[08/07/21 19:28:50] INFO	pca_inc           = 1
[08/07/21 19:28:50] INFO	pca_max           = 10
[08/07/21 19:28:50] INFO	pca_min           = 2
[08/07/21 19:28:50] INFO	pca_whiten        = False
[08/07/21 19:28:50] INFO	poly_degree       = 2
[08/07/21 19:28:50] INFO	pvalue_level      = 0.010000
[08/07/21 19:28:50] INFO	rfe               = True
[08/07/21 19:28:50] INFO	rfe_step          = 3
[08/07/21 19:28:50] INFO	roc_curve         = True
[08/07/21 19:28:50] INFO	rounding          = 2
[08/07/21 19:28:50] INFO	sampling          = False
[08/07/21 19:28:50] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:28:50] INFO	sampling_ratio    = 0.500000
[08/07/21 19:28:50] INFO	scaler_option     = True
[08/07/21 19:28:50] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:28:50] INFO	scipy             = False
[08/07/21 19:28:50] INFO	scorer            = roc_auc
[08/07/21 19:28:50] INFO	seed              = 42
[08/07/21 19:28:50] INFO	sentinel          = -1
[08/07/21 19:28:50] INFO	separator         = ,
[08/07/21 19:28:50] INFO	shuffle           = False
[08/07/21 19:28:50] INFO	split             = 0.400000
[08/07/21 19:28:50] INFO	submission_file   = gender_submission
[08/07/21 19:28:50] INFO	submit_probas     = False
[08/07/21 19:28:50] INFO	target [y]        = Survived
[08/07/21 19:28:50] INFO	target_value      = 1
[08/07/21 19:28:50] INFO	transforms        = None
[08/07/21 19:28:50] INFO	tsne              = False
[08/07/21 19:28:50] INFO	tsne_components   = 2
[08/07/21 19:28:50] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:28:50] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:28:50] INFO	vectorize         = False
[08/07/21 19:28:50] INFO	verbosity         = 0
[08/07/21 19:28:50] INFO	Creating Model
[08/07/21 19:28:50] INFO	Calling Pipeline
[08/07/21 19:28:50] INFO	Training Pipeline
[08/07/21 19:28:50] INFO	Loading Data
[08/07/21 19:28:50] INFO	Loading data from ./input/train.csv
[08/07/21 19:28:50] INFO	Found target Survived in data frame
[08/07/21 19:28:50] INFO	Labels (y) found for Partition.train
[08/07/21 19:28:50] INFO	Loading Data
[08/07/21 19:28:50] INFO	Loading data from ./input/test.csv
[08/07/21 19:28:50] INFO	Target Survived not found in Partition.test
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Original Feature Statistics
[08/07/21 19:28:50] INFO	Number of Training Rows    : 891
[08/07/21 19:28:50] INFO	Number of Training Columns : 11
[08/07/21 19:28:50] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:28:50] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:28:50] INFO	Number of Testing Rows     : 418
[08/07/21 19:28:50] INFO	Number of Testing Columns  : 11
[08/07/21 19:28:50] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:28:50] INFO	Feature Count     : 11
[08/07/21 19:28:50] INFO	Applying transforms
[08/07/21 19:28:50] INFO	No transforms Specified
[08/07/21 19:28:50] INFO	New Feature Count : 11
[08/07/21 19:28:50] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:28:50] INFO	Original Feature Count : 11
[08/07/21 19:28:50] INFO	Reduced Feature Count  : 10
[08/07/21 19:28:50] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:28:50] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:28:50] INFO	Creating Cross-Tabulations
[08/07/21 19:28:50] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:28:50] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:28:50] INFO	Feature Count     : 10
[08/07/21 19:28:50] INFO	Creating Count Features
[08/07/21 19:28:50] INFO	NA Counts
[08/07/21 19:28:50] INFO	Number Counts
[08/07/21 19:28:50] INFO	New Feature Count : 21
[08/07/21 19:28:50] INFO	Creating Base Features
[08/07/21 19:28:50] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:28:50] INFO	Feature 2: Name => Factorization
[08/07/21 19:28:50] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:28:50] INFO	Feature 3: Sex => Factorization
[08/07/21 19:28:50] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:28:50] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:28:50] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:28:50] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:28:50] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:28:50] INFO	Encoding: Encoders.target
[08/07/21 19:28:50] INFO	Fitting training features for Embarked
[08/07/21 19:28:50] INFO	Transforming testing features for Embarked
[08/07/21 19:28:50] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	New Feature Count : 21
[08/07/21 19:28:50] INFO	Scaling Base Features
[08/07/21 19:28:50] INFO	Creating NumPy Features
[08/07/21 19:28:50] INFO	NumPy Feature: sum
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: mean
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: std
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: var
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature Count : 4
[08/07/21 19:28:50] INFO	New Feature Count : 25
[08/07/21 19:28:50] INFO	Creating Clustering Features
[08/07/21 19:28:50] INFO	Cluster Minimum   : 3
[08/07/21 19:28:50] INFO	Cluster Maximum   : 30
[08/07/21 19:28:50] INFO	Cluster Increment : 3
[08/07/21 19:28:50] INFO	k = 3
[08/07/21 19:28:50] INFO	k = 6
[08/07/21 19:28:50] INFO	k = 9
[08/07/21 19:28:50] INFO	k = 12
[08/07/21 19:28:50] INFO	k = 15
[08/07/21 19:28:50] INFO	k = 18
[08/07/21 19:28:50] INFO	k = 21
[08/07/21 19:28:50] INFO	k = 24
[08/07/21 19:28:50] INFO	k = 27
[08/07/21 19:28:50] INFO	k = 30
[08/07/21 19:28:50] INFO	Clustering Feature Count : 10
[08/07/21 19:28:50] INFO	New Feature Count : 35
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Creating Interactions
[08/07/21 19:28:50] INFO	Initial Feature Count  : 35
[08/07/21 19:28:50] INFO	Skipping Interactions
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Removing Low-Variance Features
[08/07/21 19:28:50] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:28:50] INFO	Original Feature Count  : 35
[08/07/21 19:28:50] INFO	Reduced Feature Count   : 35
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Skipping Shuffling
[08/07/21 19:28:50] INFO	Skipping Sampling
[08/07/21 19:28:50] INFO	Getting All Estimators
[08/07/21 19:28:50] INFO	Algorithm Configuration
[08/07/21 19:28:50] INFO	Cannot load xgboost
[08/07/21 19:28:50] INFO	Cannot load catboost
[08/07/21 19:28:50] INFO	Cannot load keras
[08/07/21 19:28:50] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:28:50] INFO	Selecting Models
[08/07/21 19:28:50] INFO	Algorithm: CATB
[08/07/21 19:28:50] INFO	Algorithm CATB not found
[08/07/21 19:28:50] INFO	Fitting Initial Model
[08/07/21 19:30:00] INFO	********************************************************************************
[08/07/21 19:30:00] INFO	AlphaPy Start
[08/07/21 19:30:00] INFO	********************************************************************************
[08/07/21 19:30:00] INFO	Model Configuration
[08/07/21 19:30:00] INFO	No transforms Found
[08/07/21 19:30:00] INFO	MODEL PARAMETERS:
[08/07/21 19:30:00] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:30:00] INFO	calibration       = False
[08/07/21 19:30:00] INFO	cal_type          = sigmoid
[08/07/21 19:30:00] INFO	calibration_plot  = False
[08/07/21 19:30:00] INFO	clustering        = True
[08/07/21 19:30:00] INFO	cluster_inc       = 3
[08/07/21 19:30:00] INFO	cluster_max       = 30
[08/07/21 19:30:00] INFO	cluster_min       = 3
[08/07/21 19:30:00] INFO	confusion_matrix  = True
[08/07/21 19:30:00] INFO	counts            = True
[08/07/21 19:30:00] INFO	cv_folds          = 3
[08/07/21 19:30:00] INFO	directory         = .
[08/07/21 19:30:00] INFO	extension         = csv
[08/07/21 19:30:00] INFO	drop              = ['PassengerId']
[08/07/21 19:30:00] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:30:00] INFO	esr               = 20
[08/07/21 19:30:00] INFO	factors           = ['Embarked']
[08/07/21 19:30:00] INFO	features [X]      = *
[08/07/21 19:30:00] INFO	feature_selection = False
[08/07/21 19:30:00] INFO	fs_percentage     = 50
[08/07/21 19:30:00] INFO	fs_score_func     = <function f_classif at 0x7f7f2b51d8b0>
[08/07/21 19:30:00] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:30:00] INFO	grid_search       = True
[08/07/21 19:30:00] INFO	gs_iters          = 50
[08/07/21 19:30:00] INFO	gs_random         = True
[08/07/21 19:30:00] INFO	gs_sample         = False
[08/07/21 19:30:00] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:30:00] INFO	importances       = True
[08/07/21 19:30:00] INFO	interactions      = False
[08/07/21 19:30:00] INFO	isomap            = False
[08/07/21 19:30:00] INFO	iso_components    = 2
[08/07/21 19:30:00] INFO	iso_neighbors     = 5
[08/07/21 19:30:00] INFO	isample_pct       = 10
[08/07/21 19:30:00] INFO	learning_curve    = True
[08/07/21 19:30:00] INFO	logtransform      = False
[08/07/21 19:30:00] INFO	lv_remove         = True
[08/07/21 19:30:00] INFO	lv_threshold      = 0.100000
[08/07/21 19:30:00] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:30:00] INFO	n_estimators      = 51
[08/07/21 19:30:00] INFO	n_jobs            = -1
[08/07/21 19:30:00] INFO	ngrams_max        = 2
[08/07/21 19:30:00] INFO	numpy             = True
[08/07/21 19:30:00] INFO	pca               = False
[08/07/21 19:30:00] INFO	pca_inc           = 1
[08/07/21 19:30:00] INFO	pca_max           = 10
[08/07/21 19:30:00] INFO	pca_min           = 2
[08/07/21 19:30:00] INFO	pca_whiten        = False
[08/07/21 19:30:00] INFO	poly_degree       = 2
[08/07/21 19:30:00] INFO	pvalue_level      = 0.010000
[08/07/21 19:30:00] INFO	rfe               = True
[08/07/21 19:30:00] INFO	rfe_step          = 3
[08/07/21 19:30:00] INFO	roc_curve         = True
[08/07/21 19:30:00] INFO	rounding          = 2
[08/07/21 19:30:00] INFO	sampling          = False
[08/07/21 19:30:00] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:30:00] INFO	sampling_ratio    = 0.500000
[08/07/21 19:30:00] INFO	scaler_option     = True
[08/07/21 19:30:00] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:30:00] INFO	scipy             = False
[08/07/21 19:30:00] INFO	scorer            = roc_auc
[08/07/21 19:30:00] INFO	seed              = 42
[08/07/21 19:30:00] INFO	sentinel          = -1
[08/07/21 19:30:00] INFO	separator         = ,
[08/07/21 19:30:00] INFO	shuffle           = False
[08/07/21 19:30:00] INFO	split             = 0.400000
[08/07/21 19:30:00] INFO	submission_file   = gender_submission
[08/07/21 19:30:00] INFO	submit_probas     = False
[08/07/21 19:30:00] INFO	target [y]        = Survived
[08/07/21 19:30:00] INFO	target_value      = 1
[08/07/21 19:30:00] INFO	transforms        = None
[08/07/21 19:30:00] INFO	tsne              = False
[08/07/21 19:30:00] INFO	tsne_components   = 2
[08/07/21 19:30:00] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:30:00] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:30:00] INFO	vectorize         = False
[08/07/21 19:30:00] INFO	verbosity         = 0
[08/07/21 19:30:00] INFO	Creating Model
[08/07/21 19:30:00] INFO	Calling Pipeline
[08/07/21 19:30:00] INFO	Training Pipeline
[08/07/21 19:30:00] INFO	Loading Data
[08/07/21 19:30:00] INFO	Loading data from ./input/train.csv
[08/07/21 19:30:00] INFO	Found target Survived in data frame
[08/07/21 19:30:00] INFO	Labels (y) found for Partition.train
[08/07/21 19:30:00] INFO	Loading Data
[08/07/21 19:30:00] INFO	Loading data from ./input/test.csv
[08/07/21 19:30:01] INFO	Target Survived not found in Partition.test
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Original Feature Statistics
[08/07/21 19:30:01] INFO	Number of Training Rows    : 891
[08/07/21 19:30:01] INFO	Number of Training Columns : 11
[08/07/21 19:30:01] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:30:01] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:30:01] INFO	Number of Testing Rows     : 418
[08/07/21 19:30:01] INFO	Number of Testing Columns  : 11
[08/07/21 19:30:01] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:30:01] INFO	Feature Count     : 11
[08/07/21 19:30:01] INFO	Applying transforms
[08/07/21 19:30:01] INFO	No transforms Specified
[08/07/21 19:30:01] INFO	New Feature Count : 11
[08/07/21 19:30:01] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:30:01] INFO	Original Feature Count : 11
[08/07/21 19:30:01] INFO	Reduced Feature Count  : 10
[08/07/21 19:30:01] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:30:01] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:30:01] INFO	Creating Cross-Tabulations
[08/07/21 19:30:01] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:30:01] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:30:01] INFO	Feature Count     : 10
[08/07/21 19:30:01] INFO	Creating Count Features
[08/07/21 19:30:01] INFO	NA Counts
[08/07/21 19:30:01] INFO	Number Counts
[08/07/21 19:30:01] INFO	New Feature Count : 21
[08/07/21 19:30:01] INFO	Creating Base Features
[08/07/21 19:30:01] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:30:01] INFO	Feature 2: Name => Factorization
[08/07/21 19:30:01] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:30:01] INFO	Feature 3: Sex => Factorization
[08/07/21 19:30:01] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:30:01] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:30:01] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:30:01] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:30:01] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:30:01] INFO	Encoding: Encoders.target
[08/07/21 19:30:01] INFO	Fitting training features for Embarked
[08/07/21 19:30:01] INFO	Transforming testing features for Embarked
[08/07/21 19:30:01] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	New Feature Count : 21
[08/07/21 19:30:01] INFO	Scaling Base Features
[08/07/21 19:30:01] INFO	Creating NumPy Features
[08/07/21 19:30:01] INFO	NumPy Feature: sum
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: mean
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: std
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: var
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature Count : 4
[08/07/21 19:30:01] INFO	New Feature Count : 25
[08/07/21 19:30:01] INFO	Creating Clustering Features
[08/07/21 19:30:01] INFO	Cluster Minimum   : 3
[08/07/21 19:30:01] INFO	Cluster Maximum   : 30
[08/07/21 19:30:01] INFO	Cluster Increment : 3
[08/07/21 19:30:01] INFO	k = 3
[08/07/21 19:30:01] INFO	k = 6
[08/07/21 19:30:01] INFO	k = 9
[08/07/21 19:30:01] INFO	k = 12
[08/07/21 19:30:01] INFO	k = 15
[08/07/21 19:30:01] INFO	k = 18
[08/07/21 19:30:01] INFO	k = 21
[08/07/21 19:30:01] INFO	k = 24
[08/07/21 19:30:01] INFO	k = 27
[08/07/21 19:30:01] INFO	k = 30
[08/07/21 19:30:01] INFO	Clustering Feature Count : 10
[08/07/21 19:30:01] INFO	New Feature Count : 35
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Creating Interactions
[08/07/21 19:30:01] INFO	Initial Feature Count  : 35
[08/07/21 19:30:01] INFO	Skipping Interactions
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Removing Low-Variance Features
[08/07/21 19:30:01] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:30:01] INFO	Original Feature Count  : 35
[08/07/21 19:30:01] INFO	Reduced Feature Count   : 35
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Skipping Shuffling
[08/07/21 19:30:01] INFO	Skipping Sampling
[08/07/21 19:30:01] INFO	Getting All Estimators
[08/07/21 19:30:01] INFO	Algorithm Configuration
[08/07/21 19:30:01] INFO	Cannot load catboost
[08/07/21 19:30:01] INFO	Cannot load keras
[08/07/21 19:30:01] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:30:01] INFO	Selecting Models
[08/07/21 19:30:01] INFO	Algorithm: CATB
[08/07/21 19:30:01] INFO	Algorithm CATB not found
[08/07/21 19:30:01] INFO	Fitting Initial Model
[08/07/21 19:33:15] INFO	********************************************************************************
[08/07/21 19:33:15] INFO	AlphaPy Start
[08/07/21 19:33:15] INFO	********************************************************************************
[08/07/21 19:33:15] INFO	Model Configuration
[08/07/21 19:33:15] INFO	No transforms Found
[08/07/21 19:33:15] INFO	MODEL PARAMETERS:
[08/07/21 19:33:15] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:33:15] INFO	calibration       = False
[08/07/21 19:33:15] INFO	cal_type          = sigmoid
[08/07/21 19:33:15] INFO	calibration_plot  = False
[08/07/21 19:33:15] INFO	clustering        = True
[08/07/21 19:33:15] INFO	cluster_inc       = 3
[08/07/21 19:33:15] INFO	cluster_max       = 30
[08/07/21 19:33:15] INFO	cluster_min       = 3
[08/07/21 19:33:15] INFO	confusion_matrix  = True
[08/07/21 19:33:15] INFO	counts            = True
[08/07/21 19:33:15] INFO	cv_folds          = 3
[08/07/21 19:33:15] INFO	directory         = .
[08/07/21 19:33:15] INFO	extension         = csv
[08/07/21 19:33:15] INFO	drop              = ['PassengerId']
[08/07/21 19:33:15] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:33:15] INFO	esr               = 20
[08/07/21 19:33:15] INFO	factors           = ['Embarked']
[08/07/21 19:33:15] INFO	features [X]      = *
[08/07/21 19:33:15] INFO	feature_selection = False
[08/07/21 19:33:15] INFO	fs_percentage     = 50
[08/07/21 19:33:15] INFO	fs_score_func     = <function f_classif at 0x7fe572ec58b0>
[08/07/21 19:33:15] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:33:15] INFO	grid_search       = True
[08/07/21 19:33:15] INFO	gs_iters          = 50
[08/07/21 19:33:15] INFO	gs_random         = True
[08/07/21 19:33:15] INFO	gs_sample         = False
[08/07/21 19:33:15] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:33:15] INFO	importances       = True
[08/07/21 19:33:15] INFO	interactions      = False
[08/07/21 19:33:15] INFO	isomap            = False
[08/07/21 19:33:15] INFO	iso_components    = 2
[08/07/21 19:33:15] INFO	iso_neighbors     = 5
[08/07/21 19:33:15] INFO	isample_pct       = 10
[08/07/21 19:33:15] INFO	learning_curve    = True
[08/07/21 19:33:15] INFO	logtransform      = False
[08/07/21 19:33:15] INFO	lv_remove         = True
[08/07/21 19:33:15] INFO	lv_threshold      = 0.100000
[08/07/21 19:33:15] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:33:15] INFO	n_estimators      = 51
[08/07/21 19:33:15] INFO	n_jobs            = -1
[08/07/21 19:33:15] INFO	ngrams_max        = 2
[08/07/21 19:33:15] INFO	numpy             = True
[08/07/21 19:33:15] INFO	pca               = False
[08/07/21 19:33:15] INFO	pca_inc           = 1
[08/07/21 19:33:15] INFO	pca_max           = 10
[08/07/21 19:33:15] INFO	pca_min           = 2
[08/07/21 19:33:15] INFO	pca_whiten        = False
[08/07/21 19:33:15] INFO	poly_degree       = 2
[08/07/21 19:33:15] INFO	pvalue_level      = 0.010000
[08/07/21 19:33:15] INFO	rfe               = True
[08/07/21 19:33:15] INFO	rfe_step          = 3
[08/07/21 19:33:15] INFO	roc_curve         = True
[08/07/21 19:33:15] INFO	rounding          = 2
[08/07/21 19:33:15] INFO	sampling          = False
[08/07/21 19:33:15] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:33:15] INFO	sampling_ratio    = 0.500000
[08/07/21 19:33:15] INFO	scaler_option     = True
[08/07/21 19:33:15] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:33:15] INFO	scipy             = False
[08/07/21 19:33:15] INFO	scorer            = roc_auc
[08/07/21 19:33:15] INFO	seed              = 42
[08/07/21 19:33:15] INFO	sentinel          = -1
[08/07/21 19:33:15] INFO	separator         = ,
[08/07/21 19:33:15] INFO	shuffle           = False
[08/07/21 19:33:15] INFO	split             = 0.400000
[08/07/21 19:33:15] INFO	submission_file   = gender_submission
[08/07/21 19:33:15] INFO	submit_probas     = False
[08/07/21 19:33:15] INFO	target [y]        = Survived
[08/07/21 19:33:15] INFO	target_value      = 1
[08/07/21 19:33:15] INFO	transforms        = None
[08/07/21 19:33:15] INFO	tsne              = False
[08/07/21 19:33:15] INFO	tsne_components   = 2
[08/07/21 19:33:15] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:33:15] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:33:15] INFO	vectorize         = False
[08/07/21 19:33:15] INFO	verbosity         = 0
[08/07/21 19:33:15] INFO	Creating Model
[08/07/21 19:33:15] INFO	Calling Pipeline
[08/07/21 19:33:15] INFO	Training Pipeline
[08/07/21 19:33:15] INFO	Loading Data
[08/07/21 19:33:15] INFO	Loading data from ./input/train.csv
[08/07/21 19:33:15] INFO	Found target Survived in data frame
[08/07/21 19:33:15] INFO	Labels (y) found for Partition.train
[08/07/21 19:33:15] INFO	Loading Data
[08/07/21 19:33:15] INFO	Loading data from ./input/test.csv
[08/07/21 19:33:15] INFO	Target Survived not found in Partition.test
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Original Feature Statistics
[08/07/21 19:33:15] INFO	Number of Training Rows    : 891
[08/07/21 19:33:15] INFO	Number of Training Columns : 11
[08/07/21 19:33:15] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:33:15] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:33:15] INFO	Number of Testing Rows     : 418
[08/07/21 19:33:15] INFO	Number of Testing Columns  : 11
[08/07/21 19:33:15] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:33:15] INFO	Feature Count     : 11
[08/07/21 19:33:15] INFO	Applying transforms
[08/07/21 19:33:15] INFO	No transforms Specified
[08/07/21 19:33:15] INFO	New Feature Count : 11
[08/07/21 19:33:15] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:33:15] INFO	Original Feature Count : 11
[08/07/21 19:33:15] INFO	Reduced Feature Count  : 10
[08/07/21 19:33:15] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:33:15] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:33:15] INFO	Creating Cross-Tabulations
[08/07/21 19:33:15] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:33:15] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:33:15] INFO	Feature Count     : 10
[08/07/21 19:33:15] INFO	Creating Count Features
[08/07/21 19:33:15] INFO	NA Counts
[08/07/21 19:33:15] INFO	Number Counts
[08/07/21 19:33:15] INFO	New Feature Count : 21
[08/07/21 19:33:15] INFO	Creating Base Features
[08/07/21 19:33:15] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:33:15] INFO	Feature 2: Name => Factorization
[08/07/21 19:33:15] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:33:15] INFO	Feature 3: Sex => Factorization
[08/07/21 19:33:15] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:33:15] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:33:15] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:33:15] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:33:15] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:33:15] INFO	Encoding: Encoders.target
[08/07/21 19:33:15] INFO	Fitting training features for Embarked
[08/07/21 19:33:15] INFO	Transforming testing features for Embarked
[08/07/21 19:33:15] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	New Feature Count : 21
[08/07/21 19:33:15] INFO	Scaling Base Features
[08/07/21 19:33:15] INFO	Creating NumPy Features
[08/07/21 19:33:15] INFO	NumPy Feature: sum
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: mean
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: std
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: var
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature Count : 4
[08/07/21 19:33:15] INFO	New Feature Count : 25
[08/07/21 19:33:15] INFO	Creating Clustering Features
[08/07/21 19:33:15] INFO	Cluster Minimum   : 3
[08/07/21 19:33:15] INFO	Cluster Maximum   : 30
[08/07/21 19:33:15] INFO	Cluster Increment : 3
[08/07/21 19:33:15] INFO	k = 3
[08/07/21 19:33:15] INFO	k = 6
[08/07/21 19:33:15] INFO	k = 9
[08/07/21 19:33:15] INFO	k = 12
[08/07/21 19:33:15] INFO	k = 15
[08/07/21 19:33:15] INFO	k = 18
[08/07/21 19:33:15] INFO	k = 21
[08/07/21 19:33:15] INFO	k = 24
[08/07/21 19:33:15] INFO	k = 27
[08/07/21 19:33:15] INFO	k = 30
[08/07/21 19:33:15] INFO	Clustering Feature Count : 10
[08/07/21 19:33:15] INFO	New Feature Count : 35
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Creating Interactions
[08/07/21 19:33:15] INFO	Initial Feature Count  : 35
[08/07/21 19:33:15] INFO	Skipping Interactions
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Removing Low-Variance Features
[08/07/21 19:33:15] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:33:15] INFO	Original Feature Count  : 35
[08/07/21 19:33:15] INFO	Reduced Feature Count   : 35
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Skipping Shuffling
[08/07/21 19:33:15] INFO	Skipping Sampling
[08/07/21 19:33:15] INFO	Getting All Estimators
[08/07/21 19:33:15] INFO	Algorithm Configuration
[08/07/21 19:33:15] INFO	Cannot load catboost
[08/07/21 19:33:15] INFO	Cannot load keras
[08/07/21 19:33:15] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:33:15] INFO	Selecting Models
[08/07/21 19:33:15] INFO	Algorithm: CATB
[08/07/21 19:33:15] INFO	Algorithm CATB not found
[08/07/21 19:33:15] INFO	Fitting Initial Model
[08/07/21 19:44:19] INFO	********************************************************************************
[08/07/21 19:44:19] INFO	AlphaPy Start
[08/07/21 19:44:19] INFO	********************************************************************************
[08/07/21 19:44:19] INFO	Model Configuration
[08/07/21 19:44:19] INFO	No transforms Found
[08/07/21 19:44:19] INFO	MODEL PARAMETERS:
[08/07/21 19:44:19] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:44:19] INFO	calibration       = False
[08/07/21 19:44:19] INFO	cal_type          = sigmoid
[08/07/21 19:44:19] INFO	calibration_plot  = False
[08/07/21 19:44:19] INFO	clustering        = True
[08/07/21 19:44:19] INFO	cluster_inc       = 3
[08/07/21 19:44:19] INFO	cluster_max       = 30
[08/07/21 19:44:19] INFO	cluster_min       = 3
[08/07/21 19:44:19] INFO	confusion_matrix  = True
[08/07/21 19:44:19] INFO	counts            = True
[08/07/21 19:44:19] INFO	cv_folds          = 3
[08/07/21 19:44:19] INFO	directory         = .
[08/07/21 19:44:19] INFO	extension         = csv
[08/07/21 19:44:19] INFO	drop              = ['PassengerId']
[08/07/21 19:44:19] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:44:19] INFO	esr               = 20
[08/07/21 19:44:19] INFO	factors           = ['Embarked']
[08/07/21 19:44:19] INFO	features [X]      = *
[08/07/21 19:44:19] INFO	feature_selection = False
[08/07/21 19:44:19] INFO	fs_percentage     = 50
[08/07/21 19:44:19] INFO	fs_score_func     = <function f_classif at 0x7ffce2d048b0>
[08/07/21 19:44:19] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:44:19] INFO	grid_search       = True
[08/07/21 19:44:19] INFO	gs_iters          = 50
[08/07/21 19:44:19] INFO	gs_random         = True
[08/07/21 19:44:19] INFO	gs_sample         = False
[08/07/21 19:44:19] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:44:19] INFO	importances       = True
[08/07/21 19:44:19] INFO	interactions      = False
[08/07/21 19:44:19] INFO	isomap            = False
[08/07/21 19:44:19] INFO	iso_components    = 2
[08/07/21 19:44:19] INFO	iso_neighbors     = 5
[08/07/21 19:44:19] INFO	isample_pct       = 10
[08/07/21 19:44:19] INFO	learning_curve    = True
[08/07/21 19:44:19] INFO	logtransform      = False
[08/07/21 19:44:19] INFO	lv_remove         = True
[08/07/21 19:44:19] INFO	lv_threshold      = 0.100000
[08/07/21 19:44:19] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:44:19] INFO	n_estimators      = 51
[08/07/21 19:44:19] INFO	n_jobs            = -1
[08/07/21 19:44:19] INFO	ngrams_max        = 2
[08/07/21 19:44:19] INFO	numpy             = True
[08/07/21 19:44:19] INFO	pca               = False
[08/07/21 19:44:19] INFO	pca_inc           = 1
[08/07/21 19:44:19] INFO	pca_max           = 10
[08/07/21 19:44:19] INFO	pca_min           = 2
[08/07/21 19:44:19] INFO	pca_whiten        = False
[08/07/21 19:44:19] INFO	poly_degree       = 2
[08/07/21 19:44:19] INFO	pvalue_level      = 0.010000
[08/07/21 19:44:19] INFO	rfe               = True
[08/07/21 19:44:19] INFO	rfe_step          = 3
[08/07/21 19:44:19] INFO	roc_curve         = True
[08/07/21 19:44:19] INFO	rounding          = 2
[08/07/21 19:44:19] INFO	sampling          = False
[08/07/21 19:44:19] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:44:19] INFO	sampling_ratio    = 0.500000
[08/07/21 19:44:19] INFO	scaler_option     = True
[08/07/21 19:44:19] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:44:19] INFO	scipy             = False
[08/07/21 19:44:19] INFO	scorer            = roc_auc
[08/07/21 19:44:19] INFO	seed              = 42
[08/07/21 19:44:19] INFO	sentinel          = -1
[08/07/21 19:44:19] INFO	separator         = ,
[08/07/21 19:44:19] INFO	shuffle           = False
[08/07/21 19:44:19] INFO	split             = 0.400000
[08/07/21 19:44:19] INFO	submission_file   = gender_submission
[08/07/21 19:44:19] INFO	submit_probas     = False
[08/07/21 19:44:19] INFO	target [y]        = Survived
[08/07/21 19:44:19] INFO	target_value      = 1
[08/07/21 19:44:19] INFO	transforms        = None
[08/07/21 19:44:19] INFO	tsne              = False
[08/07/21 19:44:19] INFO	tsne_components   = 2
[08/07/21 19:44:19] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:44:19] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:44:19] INFO	vectorize         = False
[08/07/21 19:44:19] INFO	verbosity         = 0
[08/07/21 19:44:19] INFO	Creating Model
[08/07/21 19:44:19] INFO	Calling Pipeline
[08/07/21 19:44:19] INFO	Training Pipeline
[08/07/21 19:44:19] INFO	Loading Data
[08/07/21 19:44:19] INFO	Loading data from ./input/train.csv
[08/07/21 19:44:19] INFO	Found target Survived in data frame
[08/07/21 19:44:19] INFO	Labels (y) found for Partition.train
[08/07/21 19:44:19] INFO	Loading Data
[08/07/21 19:44:19] INFO	Loading data from ./input/test.csv
[08/07/21 19:44:19] INFO	Target Survived not found in Partition.test
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Original Feature Statistics
[08/07/21 19:44:19] INFO	Number of Training Rows    : 891
[08/07/21 19:44:19] INFO	Number of Training Columns : 11
[08/07/21 19:44:19] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:44:19] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:44:19] INFO	Number of Testing Rows     : 418
[08/07/21 19:44:19] INFO	Number of Testing Columns  : 11
[08/07/21 19:44:19] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:44:19] INFO	Feature Count     : 11
[08/07/21 19:44:19] INFO	Applying transforms
[08/07/21 19:44:19] INFO	No transforms Specified
[08/07/21 19:44:19] INFO	New Feature Count : 11
[08/07/21 19:44:19] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:44:19] INFO	Original Feature Count : 11
[08/07/21 19:44:19] INFO	Reduced Feature Count  : 10
[08/07/21 19:44:19] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:44:19] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:44:19] INFO	Creating Cross-Tabulations
[08/07/21 19:44:19] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:44:19] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:44:19] INFO	Feature Count     : 10
[08/07/21 19:44:19] INFO	Creating Count Features
[08/07/21 19:44:19] INFO	NA Counts
[08/07/21 19:44:19] INFO	Number Counts
[08/07/21 19:44:19] INFO	New Feature Count : 21
[08/07/21 19:44:19] INFO	Creating Base Features
[08/07/21 19:44:19] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:44:19] INFO	Feature 2: Name => Factorization
[08/07/21 19:44:19] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:44:19] INFO	Feature 3: Sex => Factorization
[08/07/21 19:44:19] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:44:19] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:44:19] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:44:19] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:44:19] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:44:19] INFO	Encoding: Encoders.target
[08/07/21 19:44:19] INFO	Fitting training features for Embarked
[08/07/21 19:44:19] INFO	Transforming testing features for Embarked
[08/07/21 19:44:19] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	New Feature Count : 21
[08/07/21 19:44:19] INFO	Scaling Base Features
[08/07/21 19:44:19] INFO	Creating NumPy Features
[08/07/21 19:44:19] INFO	NumPy Feature: sum
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: mean
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: std
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: var
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature Count : 4
[08/07/21 19:44:19] INFO	New Feature Count : 25
[08/07/21 19:44:19] INFO	Creating Clustering Features
[08/07/21 19:44:19] INFO	Cluster Minimum   : 3
[08/07/21 19:44:19] INFO	Cluster Maximum   : 30
[08/07/21 19:44:19] INFO	Cluster Increment : 3
[08/07/21 19:44:19] INFO	k = 3
[08/07/21 19:44:19] INFO	k = 6
[08/07/21 19:44:19] INFO	k = 9
[08/07/21 19:44:19] INFO	k = 12
[08/07/21 19:44:19] INFO	k = 15
[08/07/21 19:44:19] INFO	k = 18
[08/07/21 19:44:19] INFO	k = 21
[08/07/21 19:44:19] INFO	k = 24
[08/07/21 19:44:19] INFO	k = 27
[08/07/21 19:44:19] INFO	k = 30
[08/07/21 19:44:19] INFO	Clustering Feature Count : 10
[08/07/21 19:44:19] INFO	New Feature Count : 35
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Creating Interactions
[08/07/21 19:44:19] INFO	Initial Feature Count  : 35
[08/07/21 19:44:19] INFO	Skipping Interactions
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Removing Low-Variance Features
[08/07/21 19:44:19] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:44:19] INFO	Original Feature Count  : 35
[08/07/21 19:44:19] INFO	Reduced Feature Count   : 35
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Skipping Shuffling
[08/07/21 19:44:19] INFO	Skipping Sampling
[08/07/21 19:44:19] INFO	Getting All Estimators
[08/07/21 19:44:19] INFO	Algorithm Configuration
[08/07/21 19:44:20] INFO	Cannot load catboost
[08/07/21 19:44:20] INFO	Cannot load keras
[08/07/21 19:44:20] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:44:20] INFO	Selecting Models
[08/07/21 19:44:20] INFO	Algorithm: CATB
[08/07/21 19:44:20] INFO	Algorithm CATB not found
[08/07/21 19:44:20] INFO	Fitting Initial Model
[08/07/21 19:45:30] INFO	********************************************************************************
[08/07/21 19:45:30] INFO	AlphaPy Start
[08/07/21 19:45:30] INFO	********************************************************************************
[08/07/21 19:45:30] INFO	Model Configuration
[08/07/21 19:45:30] INFO	No transforms Found
[08/07/21 19:45:30] INFO	MODEL PARAMETERS:
[08/07/21 19:45:30] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:45:30] INFO	calibration       = False
[08/07/21 19:45:30] INFO	cal_type          = sigmoid
[08/07/21 19:45:30] INFO	calibration_plot  = False
[08/07/21 19:45:30] INFO	clustering        = True
[08/07/21 19:45:30] INFO	cluster_inc       = 3
[08/07/21 19:45:30] INFO	cluster_max       = 30
[08/07/21 19:45:30] INFO	cluster_min       = 3
[08/07/21 19:45:30] INFO	confusion_matrix  = True
[08/07/21 19:45:30] INFO	counts            = True
[08/07/21 19:45:30] INFO	cv_folds          = 3
[08/07/21 19:45:30] INFO	directory         = .
[08/07/21 19:45:30] INFO	extension         = csv
[08/07/21 19:45:30] INFO	drop              = ['PassengerId']
[08/07/21 19:45:30] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:45:30] INFO	esr               = 20
[08/07/21 19:45:30] INFO	factors           = ['Embarked']
[08/07/21 19:45:30] INFO	features [X]      = *
[08/07/21 19:45:30] INFO	feature_selection = False
[08/07/21 19:45:30] INFO	fs_percentage     = 50
[08/07/21 19:45:30] INFO	fs_score_func     = <function f_classif at 0x7ff24b63d8b0>
[08/07/21 19:45:30] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:45:30] INFO	grid_search       = True
[08/07/21 19:45:30] INFO	gs_iters          = 50
[08/07/21 19:45:31] INFO	gs_random         = True
[08/07/21 19:45:31] INFO	gs_sample         = False
[08/07/21 19:45:31] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:45:31] INFO	importances       = True
[08/07/21 19:45:31] INFO	interactions      = False
[08/07/21 19:45:31] INFO	isomap            = False
[08/07/21 19:45:31] INFO	iso_components    = 2
[08/07/21 19:45:31] INFO	iso_neighbors     = 5
[08/07/21 19:45:31] INFO	isample_pct       = 10
[08/07/21 19:45:31] INFO	learning_curve    = True
[08/07/21 19:45:31] INFO	logtransform      = False
[08/07/21 19:45:31] INFO	lv_remove         = True
[08/07/21 19:45:31] INFO	lv_threshold      = 0.100000
[08/07/21 19:45:31] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:45:31] INFO	n_estimators      = 51
[08/07/21 19:45:31] INFO	n_jobs            = -1
[08/07/21 19:45:31] INFO	ngrams_max        = 2
[08/07/21 19:45:31] INFO	numpy             = True
[08/07/21 19:45:31] INFO	pca               = False
[08/07/21 19:45:31] INFO	pca_inc           = 1
[08/07/21 19:45:31] INFO	pca_max           = 10
[08/07/21 19:45:31] INFO	pca_min           = 2
[08/07/21 19:45:31] INFO	pca_whiten        = False
[08/07/21 19:45:31] INFO	poly_degree       = 2
[08/07/21 19:45:31] INFO	pvalue_level      = 0.010000
[08/07/21 19:45:31] INFO	rfe               = True
[08/07/21 19:45:31] INFO	rfe_step          = 3
[08/07/21 19:45:31] INFO	roc_curve         = True
[08/07/21 19:45:31] INFO	rounding          = 2
[08/07/21 19:45:31] INFO	sampling          = False
[08/07/21 19:45:31] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:45:31] INFO	sampling_ratio    = 0.500000
[08/07/21 19:45:31] INFO	scaler_option     = True
[08/07/21 19:45:31] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:45:31] INFO	scipy             = False
[08/07/21 19:45:31] INFO	scorer            = roc_auc
[08/07/21 19:45:31] INFO	seed              = 42
[08/07/21 19:45:31] INFO	sentinel          = -1
[08/07/21 19:45:31] INFO	separator         = ,
[08/07/21 19:45:31] INFO	shuffle           = False
[08/07/21 19:45:31] INFO	split             = 0.400000
[08/07/21 19:45:31] INFO	submission_file   = gender_submission
[08/07/21 19:45:31] INFO	submit_probas     = False
[08/07/21 19:45:31] INFO	target [y]        = Survived
[08/07/21 19:45:31] INFO	target_value      = 1
[08/07/21 19:45:31] INFO	transforms        = None
[08/07/21 19:45:31] INFO	tsne              = False
[08/07/21 19:45:31] INFO	tsne_components   = 2
[08/07/21 19:45:31] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:45:31] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:45:31] INFO	vectorize         = False
[08/07/21 19:45:31] INFO	verbosity         = 0
[08/07/21 19:45:31] INFO	Creating Model
[08/07/21 19:45:31] INFO	Calling Pipeline
[08/07/21 19:45:31] INFO	Training Pipeline
[08/07/21 19:45:31] INFO	Loading Data
[08/07/21 19:45:31] INFO	Loading data from ./input/train.csv
[08/07/21 19:45:31] INFO	Found target Survived in data frame
[08/07/21 19:45:31] INFO	Labels (y) found for Partition.train
[08/07/21 19:45:31] INFO	Loading Data
[08/07/21 19:45:31] INFO	Loading data from ./input/test.csv
[08/07/21 19:45:31] INFO	Target Survived not found in Partition.test
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Original Feature Statistics
[08/07/21 19:45:31] INFO	Number of Training Rows    : 891
[08/07/21 19:45:31] INFO	Number of Training Columns : 11
[08/07/21 19:45:31] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:45:31] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:45:31] INFO	Number of Testing Rows     : 418
[08/07/21 19:45:31] INFO	Number of Testing Columns  : 11
[08/07/21 19:45:31] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:45:31] INFO	Feature Count     : 11
[08/07/21 19:45:31] INFO	Applying transforms
[08/07/21 19:45:31] INFO	No transforms Specified
[08/07/21 19:45:31] INFO	New Feature Count : 11
[08/07/21 19:45:31] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:45:31] INFO	Original Feature Count : 11
[08/07/21 19:45:31] INFO	Reduced Feature Count  : 10
[08/07/21 19:45:31] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:45:31] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:45:31] INFO	Creating Cross-Tabulations
[08/07/21 19:45:31] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:45:31] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:45:31] INFO	Feature Count     : 10
[08/07/21 19:45:31] INFO	Creating Count Features
[08/07/21 19:45:31] INFO	NA Counts
[08/07/21 19:45:31] INFO	Number Counts
[08/07/21 19:45:31] INFO	New Feature Count : 21
[08/07/21 19:45:31] INFO	Creating Base Features
[08/07/21 19:45:31] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:45:31] INFO	Feature 2: Name => Factorization
[08/07/21 19:45:31] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:45:31] INFO	Feature 3: Sex => Factorization
[08/07/21 19:45:31] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:45:31] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:45:31] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:45:31] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:45:31] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:45:31] INFO	Encoding: Encoders.target
[08/07/21 19:45:31] INFO	Fitting training features for Embarked
[08/07/21 19:45:31] INFO	Transforming testing features for Embarked
[08/07/21 19:45:31] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	New Feature Count : 21
[08/07/21 19:45:31] INFO	Scaling Base Features
[08/07/21 19:45:31] INFO	Creating NumPy Features
[08/07/21 19:45:31] INFO	NumPy Feature: sum
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: mean
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: std
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: var
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature Count : 4
[08/07/21 19:45:31] INFO	New Feature Count : 25
[08/07/21 19:45:31] INFO	Creating Clustering Features
[08/07/21 19:45:31] INFO	Cluster Minimum   : 3
[08/07/21 19:45:31] INFO	Cluster Maximum   : 30
[08/07/21 19:45:31] INFO	Cluster Increment : 3
[08/07/21 19:45:31] INFO	k = 3
[08/07/21 19:45:31] INFO	k = 6
[08/07/21 19:45:31] INFO	k = 9
[08/07/21 19:45:31] INFO	k = 12
[08/07/21 19:45:31] INFO	k = 15
[08/07/21 19:45:31] INFO	k = 18
[08/07/21 19:45:31] INFO	k = 21
[08/07/21 19:45:31] INFO	k = 24
[08/07/21 19:45:31] INFO	k = 27
[08/07/21 19:45:31] INFO	k = 30
[08/07/21 19:45:31] INFO	Clustering Feature Count : 10
[08/07/21 19:45:31] INFO	New Feature Count : 35
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Creating Interactions
[08/07/21 19:45:31] INFO	Initial Feature Count  : 35
[08/07/21 19:45:31] INFO	Skipping Interactions
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Removing Low-Variance Features
[08/07/21 19:45:31] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:45:31] INFO	Original Feature Count  : 35
[08/07/21 19:45:31] INFO	Reduced Feature Count   : 35
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Skipping Shuffling
[08/07/21 19:45:31] INFO	Skipping Sampling
[08/07/21 19:45:31] INFO	Getting All Estimators
[08/07/21 19:45:31] INFO	Algorithm Configuration
[08/07/21 19:45:31] INFO	Cannot load catboost
[08/07/21 19:45:31] INFO	Cannot load keras
[08/07/21 19:45:31] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:45:31] INFO	Selecting Models
[08/07/21 19:45:31] INFO	Algorithm: CATB
[08/07/21 19:45:31] INFO	Algorithm CATB not found
[08/07/21 19:45:31] INFO	Fitting Initial Model
[08/07/21 19:46:10] INFO	********************************************************************************
[08/07/21 19:46:10] INFO	AlphaPy Start
[08/07/21 19:46:10] INFO	********************************************************************************
[08/07/21 19:46:10] INFO	Model Configuration
[08/07/21 19:46:10] INFO	No transforms Found
[08/07/21 19:46:10] INFO	MODEL PARAMETERS:
[08/07/21 19:46:10] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:46:10] INFO	calibration       = False
[08/07/21 19:46:10] INFO	cal_type          = sigmoid
[08/07/21 19:46:10] INFO	calibration_plot  = False
[08/07/21 19:46:10] INFO	clustering        = True
[08/07/21 19:46:10] INFO	cluster_inc       = 3
[08/07/21 19:46:10] INFO	cluster_max       = 30
[08/07/21 19:46:10] INFO	cluster_min       = 3
[08/07/21 19:46:10] INFO	confusion_matrix  = True
[08/07/21 19:46:10] INFO	counts            = True
[08/07/21 19:46:10] INFO	cv_folds          = 3
[08/07/21 19:46:10] INFO	directory         = .
[08/07/21 19:46:10] INFO	extension         = csv
[08/07/21 19:46:10] INFO	drop              = ['PassengerId']
[08/07/21 19:46:10] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:46:10] INFO	esr               = 20
[08/07/21 19:46:10] INFO	factors           = ['Embarked']
[08/07/21 19:46:10] INFO	features [X]      = *
[08/07/21 19:46:10] INFO	feature_selection = False
[08/07/21 19:46:10] INFO	fs_percentage     = 50
[08/07/21 19:46:10] INFO	fs_score_func     = <function f_classif at 0x7f92d33448b0>
[08/07/21 19:46:10] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:46:10] INFO	grid_search       = True
[08/07/21 19:46:10] INFO	gs_iters          = 50
[08/07/21 19:46:10] INFO	gs_random         = True
[08/07/21 19:46:10] INFO	gs_sample         = False
[08/07/21 19:46:10] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:46:10] INFO	importances       = True
[08/07/21 19:46:10] INFO	interactions      = False
[08/07/21 19:46:10] INFO	isomap            = False
[08/07/21 19:46:10] INFO	iso_components    = 2
[08/07/21 19:46:10] INFO	iso_neighbors     = 5
[08/07/21 19:46:10] INFO	isample_pct       = 10
[08/07/21 19:46:10] INFO	learning_curve    = True
[08/07/21 19:46:10] INFO	logtransform      = False
[08/07/21 19:46:10] INFO	lv_remove         = True
[08/07/21 19:46:10] INFO	lv_threshold      = 0.100000
[08/07/21 19:46:10] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:46:10] INFO	n_estimators      = 51
[08/07/21 19:46:10] INFO	n_jobs            = -1
[08/07/21 19:46:10] INFO	ngrams_max        = 2
[08/07/21 19:46:10] INFO	numpy             = True
[08/07/21 19:46:10] INFO	pca               = False
[08/07/21 19:46:10] INFO	pca_inc           = 1
[08/07/21 19:46:10] INFO	pca_max           = 10
[08/07/21 19:46:10] INFO	pca_min           = 2
[08/07/21 19:46:10] INFO	pca_whiten        = False
[08/07/21 19:46:10] INFO	poly_degree       = 2
[08/07/21 19:46:10] INFO	pvalue_level      = 0.010000
[08/07/21 19:46:10] INFO	rfe               = True
[08/07/21 19:46:10] INFO	rfe_step          = 3
[08/07/21 19:46:10] INFO	roc_curve         = True
[08/07/21 19:46:10] INFO	rounding          = 2
[08/07/21 19:46:10] INFO	sampling          = False
[08/07/21 19:46:10] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:46:10] INFO	sampling_ratio    = 0.500000
[08/07/21 19:46:10] INFO	scaler_option     = True
[08/07/21 19:46:10] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:46:10] INFO	scipy             = False
[08/07/21 19:46:10] INFO	scorer            = roc_auc
[08/07/21 19:46:10] INFO	seed              = 42
[08/07/21 19:46:10] INFO	sentinel          = -1
[08/07/21 19:46:10] INFO	separator         = ,
[08/07/21 19:46:10] INFO	shuffle           = False
[08/07/21 19:46:10] INFO	split             = 0.400000
[08/07/21 19:46:10] INFO	submission_file   = gender_submission
[08/07/21 19:46:10] INFO	submit_probas     = False
[08/07/21 19:46:10] INFO	target [y]        = Survived
[08/07/21 19:46:10] INFO	target_value      = 1
[08/07/21 19:46:10] INFO	transforms        = None
[08/07/21 19:46:10] INFO	tsne              = False
[08/07/21 19:46:10] INFO	tsne_components   = 2
[08/07/21 19:46:10] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:46:10] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:46:10] INFO	vectorize         = False
[08/07/21 19:46:10] INFO	verbosity         = 0
[08/07/21 19:46:10] INFO	Creating Model
[08/07/21 19:46:10] INFO	Calling Pipeline
[08/07/21 19:46:10] INFO	Training Pipeline
[08/07/21 19:46:10] INFO	Loading Data
[08/07/21 19:46:10] INFO	Loading data from ./input/train.csv
[08/07/21 19:46:10] INFO	Found target Survived in data frame
[08/07/21 19:46:10] INFO	Labels (y) found for Partition.train
[08/07/21 19:46:10] INFO	Loading Data
[08/07/21 19:46:10] INFO	Loading data from ./input/test.csv
[08/07/21 19:46:10] INFO	Target Survived not found in Partition.test
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Original Feature Statistics
[08/07/21 19:46:10] INFO	Number of Training Rows    : 891
[08/07/21 19:46:10] INFO	Number of Training Columns : 11
[08/07/21 19:46:10] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:46:10] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:46:10] INFO	Number of Testing Rows     : 418
[08/07/21 19:46:10] INFO	Number of Testing Columns  : 11
[08/07/21 19:46:10] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:46:10] INFO	Feature Count     : 11
[08/07/21 19:46:10] INFO	Applying transforms
[08/07/21 19:46:10] INFO	No transforms Specified
[08/07/21 19:46:10] INFO	New Feature Count : 11
[08/07/21 19:46:10] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:46:10] INFO	Original Feature Count : 11
[08/07/21 19:46:10] INFO	Reduced Feature Count  : 10
[08/07/21 19:46:10] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:46:10] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:46:10] INFO	Creating Cross-Tabulations
[08/07/21 19:46:10] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:46:10] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:46:10] INFO	Feature Count     : 10
[08/07/21 19:46:10] INFO	Creating Count Features
[08/07/21 19:46:10] INFO	NA Counts
[08/07/21 19:46:10] INFO	Number Counts
[08/07/21 19:46:10] INFO	New Feature Count : 21
[08/07/21 19:46:10] INFO	Creating Base Features
[08/07/21 19:46:10] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:46:10] INFO	Feature 2: Name => Factorization
[08/07/21 19:46:10] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:46:10] INFO	Feature 3: Sex => Factorization
[08/07/21 19:46:10] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:46:10] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:46:10] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:46:10] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:46:10] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:46:10] INFO	Encoding: Encoders.target
[08/07/21 19:46:10] INFO	Fitting training features for Embarked
[08/07/21 19:46:10] INFO	Transforming testing features for Embarked
[08/07/21 19:46:10] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	New Feature Count : 21
[08/07/21 19:46:10] INFO	Scaling Base Features
[08/07/21 19:46:10] INFO	Creating NumPy Features
[08/07/21 19:46:10] INFO	NumPy Feature: sum
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: mean
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: std
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: var
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature Count : 4
[08/07/21 19:46:10] INFO	New Feature Count : 25
[08/07/21 19:46:10] INFO	Creating Clustering Features
[08/07/21 19:46:10] INFO	Cluster Minimum   : 3
[08/07/21 19:46:10] INFO	Cluster Maximum   : 30
[08/07/21 19:46:10] INFO	Cluster Increment : 3
[08/07/21 19:46:10] INFO	k = 3
[08/07/21 19:46:10] INFO	k = 6
[08/07/21 19:46:10] INFO	k = 9
[08/07/21 19:46:10] INFO	k = 12
[08/07/21 19:46:10] INFO	k = 15
[08/07/21 19:46:10] INFO	k = 18
[08/07/21 19:46:10] INFO	k = 21
[08/07/21 19:46:10] INFO	k = 24
[08/07/21 19:46:10] INFO	k = 27
[08/07/21 19:46:10] INFO	k = 30
[08/07/21 19:46:10] INFO	Clustering Feature Count : 10
[08/07/21 19:46:10] INFO	New Feature Count : 35
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Creating Interactions
[08/07/21 19:46:10] INFO	Initial Feature Count  : 35
[08/07/21 19:46:10] INFO	Skipping Interactions
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Removing Low-Variance Features
[08/07/21 19:46:10] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:46:10] INFO	Original Feature Count  : 35
[08/07/21 19:46:10] INFO	Reduced Feature Count   : 35
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Skipping Shuffling
[08/07/21 19:46:10] INFO	Skipping Sampling
[08/07/21 19:46:10] INFO	Getting All Estimators
[08/07/21 19:46:10] INFO	Algorithm Configuration
[08/07/21 19:46:10] INFO	Cannot load catboost
[08/07/21 19:46:10] INFO	Cannot load keras
[08/07/21 19:46:10] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:46:10] INFO	Selecting Models
[08/07/21 19:46:10] INFO	Algorithm: CATB
[08/07/21 19:46:10] INFO	Algorithm CATB not found
[08/07/21 19:46:10] INFO	Fitting Initial Model
[08/07/21 20:00:04] INFO	********************************************************************************
[08/07/21 20:00:04] INFO	AlphaPy Start
[08/07/21 20:00:04] INFO	********************************************************************************
[08/07/21 20:00:04] INFO	Model Configuration
[08/07/21 20:00:04] INFO	No transforms Found
[08/07/21 20:00:04] INFO	MODEL PARAMETERS:
[08/07/21 20:00:04] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 20:00:04] INFO	calibration       = False
[08/07/21 20:00:04] INFO	cal_type          = sigmoid
[08/07/21 20:00:04] INFO	calibration_plot  = False
[08/07/21 20:00:04] INFO	clustering        = True
[08/07/21 20:00:04] INFO	cluster_inc       = 3
[08/07/21 20:00:04] INFO	cluster_max       = 30
[08/07/21 20:00:04] INFO	cluster_min       = 3
[08/07/21 20:00:04] INFO	confusion_matrix  = True
[08/07/21 20:00:04] INFO	counts            = True
[08/07/21 20:00:04] INFO	cv_folds          = 3
[08/07/21 20:00:04] INFO	directory         = .
[08/07/21 20:00:04] INFO	extension         = csv
[08/07/21 20:00:04] INFO	drop              = ['PassengerId']
[08/07/21 20:00:04] INFO	encoder           = <Encoders.target: 14>
[08/07/21 20:00:04] INFO	esr               = 20
[08/07/21 20:00:04] INFO	factors           = ['Embarked']
[08/07/21 20:00:04] INFO	features [X]      = *
[08/07/21 20:00:04] INFO	feature_selection = False
[08/07/21 20:00:04] INFO	fs_percentage     = 50
[08/07/21 20:00:04] INFO	fs_score_func     = <function f_classif at 0x7f892abd58b0>
[08/07/21 20:00:04] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 20:00:04] INFO	grid_search       = True
[08/07/21 20:00:04] INFO	gs_iters          = 50
[08/07/21 20:00:04] INFO	gs_random         = True
[08/07/21 20:00:04] INFO	gs_sample         = False
[08/07/21 20:00:04] INFO	gs_sample_pct     = 0.200000
[08/07/21 20:00:04] INFO	importances       = True
[08/07/21 20:00:04] INFO	interactions      = False
[08/07/21 20:00:04] INFO	isomap            = False
[08/07/21 20:00:04] INFO	iso_components    = 2
[08/07/21 20:00:04] INFO	iso_neighbors     = 5
[08/07/21 20:00:04] INFO	isample_pct       = 10
[08/07/21 20:00:04] INFO	learning_curve    = True
[08/07/21 20:00:04] INFO	logtransform      = False
[08/07/21 20:00:04] INFO	lv_remove         = True
[08/07/21 20:00:04] INFO	lv_threshold      = 0.100000
[08/07/21 20:00:04] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 20:00:04] INFO	n_estimators      = 51
[08/07/21 20:00:04] INFO	n_jobs            = -1
[08/07/21 20:00:04] INFO	ngrams_max        = 2
[08/07/21 20:00:04] INFO	numpy             = True
[08/07/21 20:00:04] INFO	pca               = False
[08/07/21 20:00:04] INFO	pca_inc           = 1
[08/07/21 20:00:04] INFO	pca_max           = 10
[08/07/21 20:00:04] INFO	pca_min           = 2
[08/07/21 20:00:04] INFO	pca_whiten        = False
[08/07/21 20:00:04] INFO	poly_degree       = 2
[08/07/21 20:00:04] INFO	pvalue_level      = 0.010000
[08/07/21 20:00:04] INFO	rfe               = True
[08/07/21 20:00:04] INFO	rfe_step          = 3
[08/07/21 20:00:04] INFO	roc_curve         = True
[08/07/21 20:00:04] INFO	rounding          = 2
[08/07/21 20:00:04] INFO	sampling          = False
[08/07/21 20:00:04] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 20:00:04] INFO	sampling_ratio    = 0.500000
[08/07/21 20:00:04] INFO	scaler_option     = True
[08/07/21 20:00:04] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 20:00:04] INFO	scipy             = False
[08/07/21 20:00:04] INFO	scorer            = roc_auc
[08/07/21 20:00:04] INFO	seed              = 42
[08/07/21 20:00:04] INFO	sentinel          = -1
[08/07/21 20:00:04] INFO	separator         = ,
[08/07/21 20:00:04] INFO	shuffle           = False
[08/07/21 20:00:04] INFO	split             = 0.400000
[08/07/21 20:00:04] INFO	submission_file   = gender_submission
[08/07/21 20:00:04] INFO	submit_probas     = False
[08/07/21 20:00:04] INFO	target [y]        = Survived
[08/07/21 20:00:04] INFO	target_value      = 1
[08/07/21 20:00:04] INFO	transforms        = None
[08/07/21 20:00:04] INFO	tsne              = False
[08/07/21 20:00:04] INFO	tsne_components   = 2
[08/07/21 20:00:04] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 20:00:04] INFO	tsne_perplexity   = 30.000000
[08/07/21 20:00:04] INFO	vectorize         = False
[08/07/21 20:00:04] INFO	verbosity         = 0
[08/07/21 20:00:04] INFO	Creating Model
[08/07/21 20:00:04] INFO	Calling Pipeline
[08/07/21 20:00:04] INFO	Training Pipeline
[08/07/21 20:00:04] INFO	Loading Data
[08/07/21 20:00:04] INFO	Loading data from ./input/train.csv
[08/07/21 20:00:04] INFO	Found target Survived in data frame
[08/07/21 20:00:04] INFO	Labels (y) found for Partition.train
[08/07/21 20:00:04] INFO	Loading Data
[08/07/21 20:00:04] INFO	Loading data from ./input/test.csv
[08/07/21 20:00:04] INFO	Target Survived not found in Partition.test
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Original Feature Statistics
[08/07/21 20:00:04] INFO	Number of Training Rows    : 891
[08/07/21 20:00:04] INFO	Number of Training Columns : 11
[08/07/21 20:00:04] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 20:00:04] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 20:00:04] INFO	Number of Testing Rows     : 418
[08/07/21 20:00:04] INFO	Number of Testing Columns  : 11
[08/07/21 20:00:04] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:00:04] INFO	Feature Count     : 11
[08/07/21 20:00:04] INFO	Applying transforms
[08/07/21 20:00:04] INFO	No transforms Specified
[08/07/21 20:00:04] INFO	New Feature Count : 11
[08/07/21 20:00:04] INFO	Dropping Features: ['PassengerId']
[08/07/21 20:00:04] INFO	Original Feature Count : 11
[08/07/21 20:00:04] INFO	Reduced Feature Count  : 10
[08/07/21 20:00:04] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 20:00:04] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 20:00:04] INFO	Creating Cross-Tabulations
[08/07/21 20:00:04] INFO	Creating crosstabs for feature Embarked
[08/07/21 20:00:04] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:00:04] INFO	Feature Count     : 10
[08/07/21 20:00:04] INFO	Creating Count Features
[08/07/21 20:00:04] INFO	NA Counts
[08/07/21 20:00:04] INFO	Number Counts
[08/07/21 20:00:04] INFO	New Feature Count : 21
[08/07/21 20:00:04] INFO	Creating Base Features
[08/07/21 20:00:04] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 20:00:04] INFO	Feature 2: Name => Factorization
[08/07/21 20:00:04] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 20:00:04] INFO	Feature 3: Sex => Factorization
[08/07/21 20:00:04] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 20:00:04] INFO	Feature 7: Ticket => Factorization
[08/07/21 20:00:04] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 20:00:04] INFO	Feature 9: Cabin => Factorization
[08/07/21 20:00:04] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 20:00:04] INFO	Encoding: Encoders.target
[08/07/21 20:00:04] INFO	Fitting training features for Embarked
[08/07/21 20:00:04] INFO	Transforming testing features for Embarked
[08/07/21 20:00:04] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	New Feature Count : 21
[08/07/21 20:00:04] INFO	Scaling Base Features
[08/07/21 20:00:04] INFO	Creating NumPy Features
[08/07/21 20:00:04] INFO	NumPy Feature: sum
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: mean
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: std
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: var
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature Count : 4
[08/07/21 20:00:04] INFO	New Feature Count : 25
[08/07/21 20:00:04] INFO	Creating Clustering Features
[08/07/21 20:00:04] INFO	Cluster Minimum   : 3
[08/07/21 20:00:04] INFO	Cluster Maximum   : 30
[08/07/21 20:00:04] INFO	Cluster Increment : 3
[08/07/21 20:00:04] INFO	k = 3
[08/07/21 20:00:04] INFO	k = 6
[08/07/21 20:00:04] INFO	k = 9
[08/07/21 20:00:04] INFO	k = 12
[08/07/21 20:00:04] INFO	k = 15
[08/07/21 20:00:04] INFO	k = 18
[08/07/21 20:00:04] INFO	k = 21
[08/07/21 20:00:04] INFO	k = 24
[08/07/21 20:00:04] INFO	k = 27
[08/07/21 20:00:04] INFO	k = 30
[08/07/21 20:00:04] INFO	Clustering Feature Count : 10
[08/07/21 20:00:04] INFO	New Feature Count : 35
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Creating Interactions
[08/07/21 20:00:04] INFO	Initial Feature Count  : 35
[08/07/21 20:00:04] INFO	Skipping Interactions
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Removing Low-Variance Features
[08/07/21 20:00:04] INFO	Low-Variance Threshold  : 0.10
[08/07/21 20:00:04] INFO	Original Feature Count  : 35
[08/07/21 20:00:04] INFO	Reduced Feature Count   : 35
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Skipping Shuffling
[08/07/21 20:00:04] INFO	Skipping Sampling
[08/07/21 20:00:04] INFO	Getting All Estimators
[08/07/21 20:00:04] INFO	Algorithm Configuration
[08/07/21 20:00:06] INFO	Cannot load keras
[08/07/21 20:00:06] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:00:06] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:00:06] INFO	Selecting Models
[08/07/21 20:00:06] INFO	Algorithm: CATB
[08/07/21 20:00:06] INFO	Fitting Initial Model
[08/07/21 20:05:14] INFO	********************************************************************************
[08/07/21 20:05:14] INFO	AlphaPy Start
[08/07/21 20:05:14] INFO	********************************************************************************
[08/07/21 20:05:14] INFO	Model Configuration
[08/07/21 20:05:14] INFO	No transforms Found
[08/07/21 20:05:14] INFO	MODEL PARAMETERS:
[08/07/21 20:05:14] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 20:05:14] INFO	calibration       = False
[08/07/21 20:05:14] INFO	cal_type          = sigmoid
[08/07/21 20:05:14] INFO	calibration_plot  = False
[08/07/21 20:05:14] INFO	clustering        = True
[08/07/21 20:05:14] INFO	cluster_inc       = 3
[08/07/21 20:05:14] INFO	cluster_max       = 30
[08/07/21 20:05:14] INFO	cluster_min       = 3
[08/07/21 20:05:14] INFO	confusion_matrix  = True
[08/07/21 20:05:14] INFO	counts            = True
[08/07/21 20:05:14] INFO	cv_folds          = 3
[08/07/21 20:05:14] INFO	directory         = .
[08/07/21 20:05:14] INFO	extension         = csv
[08/07/21 20:05:14] INFO	drop              = ['PassengerId']
[08/07/21 20:05:14] INFO	encoder           = <Encoders.target: 14>
[08/07/21 20:05:14] INFO	esr               = 20
[08/07/21 20:05:14] INFO	factors           = ['Embarked']
[08/07/21 20:05:14] INFO	features [X]      = *
[08/07/21 20:05:14] INFO	feature_selection = False
[08/07/21 20:05:14] INFO	fs_percentage     = 50
[08/07/21 20:05:14] INFO	fs_score_func     = <function f_classif at 0x7f8bc8225820>
[08/07/21 20:05:14] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 20:05:14] INFO	grid_search       = True
[08/07/21 20:05:14] INFO	gs_iters          = 50
[08/07/21 20:05:14] INFO	gs_random         = True
[08/07/21 20:05:14] INFO	gs_sample         = False
[08/07/21 20:05:14] INFO	gs_sample_pct     = 0.200000
[08/07/21 20:05:14] INFO	importances       = True
[08/07/21 20:05:14] INFO	interactions      = False
[08/07/21 20:05:14] INFO	isomap            = False
[08/07/21 20:05:14] INFO	iso_components    = 2
[08/07/21 20:05:14] INFO	iso_neighbors     = 5
[08/07/21 20:05:14] INFO	isample_pct       = 10
[08/07/21 20:05:14] INFO	learning_curve    = True
[08/07/21 20:05:14] INFO	logtransform      = False
[08/07/21 20:05:14] INFO	lv_remove         = True
[08/07/21 20:05:14] INFO	lv_threshold      = 0.100000
[08/07/21 20:05:14] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 20:05:14] INFO	n_estimators      = 51
[08/07/21 20:05:14] INFO	n_jobs            = -1
[08/07/21 20:05:14] INFO	ngrams_max        = 2
[08/07/21 20:05:14] INFO	numpy             = True
[08/07/21 20:05:14] INFO	pca               = False
[08/07/21 20:05:14] INFO	pca_inc           = 1
[08/07/21 20:05:14] INFO	pca_max           = 10
[08/07/21 20:05:14] INFO	pca_min           = 2
[08/07/21 20:05:14] INFO	pca_whiten        = False
[08/07/21 20:05:14] INFO	poly_degree       = 2
[08/07/21 20:05:14] INFO	pvalue_level      = 0.010000
[08/07/21 20:05:14] INFO	rfe               = True
[08/07/21 20:05:14] INFO	rfe_step          = 3
[08/07/21 20:05:14] INFO	roc_curve         = True
[08/07/21 20:05:14] INFO	rounding          = 2
[08/07/21 20:05:14] INFO	sampling          = False
[08/07/21 20:05:14] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 20:05:14] INFO	sampling_ratio    = 0.500000
[08/07/21 20:05:14] INFO	scaler_option     = True
[08/07/21 20:05:14] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 20:05:14] INFO	scipy             = False
[08/07/21 20:05:14] INFO	scorer            = roc_auc
[08/07/21 20:05:14] INFO	seed              = 42
[08/07/21 20:05:14] INFO	sentinel          = -1
[08/07/21 20:05:14] INFO	separator         = ,
[08/07/21 20:05:14] INFO	shuffle           = False
[08/07/21 20:05:14] INFO	split             = 0.400000
[08/07/21 20:05:14] INFO	submission_file   = gender_submission
[08/07/21 20:05:14] INFO	submit_probas     = False
[08/07/21 20:05:14] INFO	target [y]        = Survived
[08/07/21 20:05:14] INFO	target_value      = 1
[08/07/21 20:05:14] INFO	transforms        = None
[08/07/21 20:05:14] INFO	tsne              = False
[08/07/21 20:05:14] INFO	tsne_components   = 2
[08/07/21 20:05:14] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 20:05:14] INFO	tsne_perplexity   = 30.000000
[08/07/21 20:05:14] INFO	vectorize         = False
[08/07/21 20:05:14] INFO	verbosity         = 0
[08/07/21 20:05:14] INFO	Creating Model
[08/07/21 20:05:14] INFO	Calling Pipeline
[08/07/21 20:05:14] INFO	Training Pipeline
[08/07/21 20:05:14] INFO	Loading Data
[08/07/21 20:05:14] INFO	Loading data from ./input/train.csv
[08/07/21 20:05:14] INFO	Found target Survived in data frame
[08/07/21 20:05:14] INFO	Labels (y) found for Partition.train
[08/07/21 20:05:14] INFO	Loading Data
[08/07/21 20:05:14] INFO	Loading data from ./input/test.csv
[08/07/21 20:05:14] INFO	Target Survived not found in Partition.test
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Original Feature Statistics
[08/07/21 20:05:14] INFO	Number of Training Rows    : 891
[08/07/21 20:05:14] INFO	Number of Training Columns : 11
[08/07/21 20:05:14] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 20:05:14] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 20:05:14] INFO	Number of Testing Rows     : 418
[08/07/21 20:05:14] INFO	Number of Testing Columns  : 11
[08/07/21 20:05:14] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:05:14] INFO	Feature Count     : 11
[08/07/21 20:05:14] INFO	Applying transforms
[08/07/21 20:05:14] INFO	No transforms Specified
[08/07/21 20:05:14] INFO	New Feature Count : 11
[08/07/21 20:05:14] INFO	Dropping Features: ['PassengerId']
[08/07/21 20:05:14] INFO	Original Feature Count : 11
[08/07/21 20:05:14] INFO	Reduced Feature Count  : 10
[08/07/21 20:05:14] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 20:05:14] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 20:05:14] INFO	Creating Cross-Tabulations
[08/07/21 20:05:14] INFO	Creating crosstabs for feature Embarked
[08/07/21 20:05:14] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:05:14] INFO	Feature Count     : 10
[08/07/21 20:05:14] INFO	Creating Count Features
[08/07/21 20:05:14] INFO	NA Counts
[08/07/21 20:05:14] INFO	Number Counts
[08/07/21 20:05:14] INFO	New Feature Count : 21
[08/07/21 20:05:14] INFO	Creating Base Features
[08/07/21 20:05:14] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 20:05:14] INFO	Feature 2: Name => Factorization
[08/07/21 20:05:14] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 20:05:14] INFO	Feature 3: Sex => Factorization
[08/07/21 20:05:14] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 20:05:14] INFO	Feature 7: Ticket => Factorization
[08/07/21 20:05:14] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 20:05:14] INFO	Feature 9: Cabin => Factorization
[08/07/21 20:05:14] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 20:05:14] INFO	Encoding: Encoders.target
[08/07/21 20:05:14] INFO	Fitting training features for Embarked
[08/07/21 20:05:14] INFO	Transforming testing features for Embarked
[08/07/21 20:05:14] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	New Feature Count : 21
[08/07/21 20:05:14] INFO	Scaling Base Features
[08/07/21 20:05:14] INFO	Creating NumPy Features
[08/07/21 20:05:14] INFO	NumPy Feature: sum
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: mean
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: std
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: var
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature Count : 4
[08/07/21 20:05:14] INFO	New Feature Count : 25
[08/07/21 20:05:14] INFO	Creating Clustering Features
[08/07/21 20:05:14] INFO	Cluster Minimum   : 3
[08/07/21 20:05:14] INFO	Cluster Maximum   : 30
[08/07/21 20:05:14] INFO	Cluster Increment : 3
[08/07/21 20:05:14] INFO	k = 3
[08/07/21 20:05:14] INFO	k = 6
[08/07/21 20:05:14] INFO	k = 9
[08/07/21 20:05:14] INFO	k = 12
[08/07/21 20:05:14] INFO	k = 15
[08/07/21 20:05:14] INFO	k = 18
[08/07/21 20:05:14] INFO	k = 21
[08/07/21 20:05:14] INFO	k = 24
[08/07/21 20:05:14] INFO	k = 27
[08/07/21 20:05:14] INFO	k = 30
[08/07/21 20:05:14] INFO	Clustering Feature Count : 10
[08/07/21 20:05:14] INFO	New Feature Count : 35
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Creating Interactions
[08/07/21 20:05:14] INFO	Initial Feature Count  : 35
[08/07/21 20:05:14] INFO	Skipping Interactions
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Removing Low-Variance Features
[08/07/21 20:05:14] INFO	Low-Variance Threshold  : 0.10
[08/07/21 20:05:14] INFO	Original Feature Count  : 35
[08/07/21 20:05:14] INFO	Reduced Feature Count   : 35
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Skipping Shuffling
[08/07/21 20:05:14] INFO	Skipping Sampling
[08/07/21 20:05:14] INFO	Getting All Estimators
[08/07/21 20:05:14] INFO	Algorithm Configuration
[08/07/21 20:05:14] INFO	Cannot load keras
[08/07/21 20:05:14] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:05:14] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:05:14] INFO	Selecting Models
[08/07/21 20:05:14] INFO	Algorithm: CATB
[08/07/21 20:05:14] INFO	Fitting Initial Model
[08/07/21 20:05:15] INFO	Cross-Validation
[08/07/21 20:05:16] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/07/21 20:05:16] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:19] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[08/07/21 20:05:19] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/07/21 20:05:19] INFO	No grid is defined for grid search
[08/07/21 20:05:19] INFO	Final Model Predictions for CATB
[08/07/21 20:05:19] INFO	Skipping Calibration
[08/07/21 20:05:19] INFO	Making Predictions
[08/07/21 20:05:19] INFO	Predictions Complete
[08/07/21 20:05:19] INFO	Algorithm: LGB
[08/07/21 20:05:19] INFO	Fitting Initial Model
[08/07/21 20:05:19] INFO	Cross-Validation
[08/07/21 20:05:19] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/07/21 20:05:19] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:21] INFO	RFECV took 1.91 seconds for step 3 and 3 folds
[08/07/21 20:05:21] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/07/21 20:05:21] INFO	No grid is defined for grid search
[08/07/21 20:05:21] INFO	Final Model Predictions for LGB
[08/07/21 20:05:21] INFO	Skipping Calibration
[08/07/21 20:05:21] INFO	Making Predictions
[08/07/21 20:05:21] INFO	Predictions Complete
[08/07/21 20:05:21] INFO	Algorithm: XGB
[08/07/21 20:05:21] INFO	Fitting Initial Model
[08/07/21 20:05:21] INFO	Cross-Validation
[08/07/21 20:05:22] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/07/21 20:05:22] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:24] INFO	RFECV took 2.43 seconds for step 3 and 3 folds
[08/07/21 20:05:24] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/07/21 20:05:24] INFO	Randomized Grid Search
[08/07/21 20:06:17] INFO	Grid Search took 52.84 seconds for 50 candidate parameter settings.
[08/07/21 20:06:17] INFO	Model with rank: 1
[08/07/21 20:06:17] INFO	Mean validation score: 0.872 (std: 0.020)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[08/07/21 20:06:17] INFO	Model with rank: 2
[08/07/21 20:06:17] INFO	Mean validation score: 0.872 (std: 0.025)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[08/07/21 20:06:17] INFO	Model with rank: 3
[08/07/21 20:06:17] INFO	Mean validation score: 0.871 (std: 0.020)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[08/07/21 20:06:17] INFO	Algorithm: XGB, Best Score: 0.8724, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[08/07/21 20:06:17] INFO	Final Model Predictions for XGB
[08/07/21 20:06:17] INFO	Skipping Calibration
[08/07/21 20:06:17] INFO	Making Predictions
[08/07/21 20:06:17] INFO	Predictions Complete
[08/07/21 20:06:17] INFO	Blending Models
[08/07/21 20:06:17] INFO	Blending Start: 2021-08-07 20:06:17.602307
[08/07/21 20:06:17] INFO	Blending Complete: 0:00:00.013576
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Metrics for: Partition.train
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: CATB
[08/07/21 20:06:17] INFO	accuracy: 0.8585858585858586
[08/07/21 20:06:17] INFO	average_precision: 0.9113351686222868
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.8378391333525069
[08/07/21 20:06:17] INFO	brier_score_loss: 0.10043404518351136
[08/07/21 20:06:17] INFO	cohen_kappa: 0.6932572665125658
[08/07/21 20:06:17] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/07/21 20:06:17] INFO	f1: 0.8025078369905956
[08/07/21 20:06:17] INFO	neg_log_loss: 0.3371948718196211
[08/07/21 20:06:17] INFO	precision: 0.8648648648648649
[08/07/21 20:06:17] INFO	recall: 0.7485380116959064
[08/07/21 20:06:17] INFO	roc_auc: 0.9297979313797549
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: LGB
[08/07/21 20:06:17] INFO	accuracy: 0.9730639730639731
[08/07/21 20:06:17] INFO	average_precision: 0.9961113207491221
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.9687709711437062
[08/07/21 20:06:17] INFO	brier_score_loss: 0.032809498448974184
[08/07/21 20:06:17] INFO	cohen_kappa: 0.9427387092109702
[08/07/21 20:06:17] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/07/21 20:06:17] INFO	f1: 0.9643916913946586
[08/07/21 20:06:17] INFO	neg_log_loss: 0.1458307566281259
[08/07/21 20:06:17] INFO	precision: 0.9789156626506024
[08/07/21 20:06:17] INFO	recall: 0.9502923976608187
[08/07/21 20:06:17] INFO	roc_auc: 0.9974861257576241
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: XGB
[08/07/21 20:06:17] INFO	accuracy: 0.9304152637485971
[08/07/21 20:06:17] INFO	average_precision: 0.9716306882839921
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.9181765890135174
[08/07/21 20:06:17] INFO	brier_score_loss: 0.07412143940154169
[08/07/21 20:06:17] INFO	cohen_kappa: 0.8504167275917531
[08/07/21 20:06:17] INFO	confusion_matrix: [[533  16]
 [ 46 296]]
[08/07/21 20:06:17] INFO	f1: 0.9051987767584098
[08/07/21 20:06:17] INFO	neg_log_loss: 0.2874399062275351
[08/07/21 20:06:17] INFO	precision: 0.9487179487179487
[08/07/21 20:06:17] INFO	recall: 0.8654970760233918
[08/07/21 20:06:17] INFO	roc_auc: 0.9800967202462746
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Metrics for: Partition.test
[08/07/21 20:06:17] INFO	No labels for generating Partition.test metrics
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Selecting Best Model
[08/07/21 20:06:17] INFO	Scoring for: Partition.train
[08/07/21 20:06:17] INFO	Best Model Selection Start: 2021-08-07 20:06:17.637484
[08/07/21 20:06:17] INFO	Scoring CATB Model
[08/07/21 20:06:17] INFO	Scoring LGB Model
[08/07/21 20:06:17] INFO	Scoring XGB Model
[08/07/21 20:06:17] INFO	Scoring BLEND Model
[08/07/21 20:06:17] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[08/07/21 20:06:17] INFO	Best Model Selection Complete: 0:00:00.000218
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Generating Plots for partition: train
[08/07/21 20:06:17] INFO	Generating Calibration Plot
[08/07/21 20:06:17] INFO	Calibration for Algorithm: CATB
[08/07/21 20:06:17] INFO	Calibration for Algorithm: LGB
[08/07/21 20:06:17] INFO	Calibration for Algorithm: XGB
[08/07/21 20:06:17] INFO	Writing plot to ./plots/calibration_train.png
[08/07/21 20:06:17] INFO	Generating Confusion Matrices
[08/07/21 20:06:17] INFO	Confusion Matrix for Algorithm: CATB
[08/07/21 20:06:17] INFO	Confusion Matrix:
[08/07/21 20:06:17] INFO	[[509  40]
 [ 86 256]]
[08/07/21 20:06:17] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/07/21 20:06:17] INFO	Confusion Matrix for Algorithm: LGB
[08/07/21 20:06:17] INFO	Confusion Matrix:
[08/07/21 20:06:17] INFO	[[542   7]
 [ 17 325]]
[08/07/21 20:06:17] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/07/21 20:06:18] INFO	Confusion Matrix for Algorithm: XGB
[08/07/21 20:06:18] INFO	Confusion Matrix:
[08/07/21 20:06:18] INFO	[[533  16]
 [ 46 296]]
[08/07/21 20:06:18] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/07/21 20:06:18] INFO	Generating ROC Curves
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: CATB
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: LGB
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: XGB
[08/07/21 20:06:18] INFO	Writing plot to ./plots/roc_curve_train.png
[08/07/21 20:06:18] INFO	Generating Learning Curves
[08/07/21 20:06:18] INFO	Algorithm Configuration
[08/07/21 20:06:18] INFO	Cannot load keras
[08/07/21 20:06:18] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:06:18] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:06:18] INFO	Learning Curve for Algorithm: CATB
[08/07/21 20:06:18] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/07/21 20:06:18] INFO	Learning Curve for Algorithm: LGB
[08/07/21 20:06:20] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/07/21 20:06:20] INFO	Learning Curve for Algorithm: XGB
[08/07/21 20:06:21] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/07/21 20:06:21] INFO	Generating Feature Importance Plots
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: CATB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Sex_factor (45.178104)
[08/07/21 20:06:21] INFO	2. Pclass (13.721171)
[08/07/21 20:06:21] INFO	3. Age (6.651788)
[08/07/21 20:06:21] INFO	4. Fare (4.529770)
[08/07/21 20:06:21] INFO	5. var (3.586590)
[08/07/21 20:06:21] INFO	6. std (3.492385)
[08/07/21 20:06:21] INFO	7. Ticket_factor (3.315046)
[08/07/21 20:06:21] INFO	8. cluster_30 (2.831587)
[08/07/21 20:06:21] INFO	9. mean (2.733389)
[08/07/21 20:06:21] INFO	10. Name_factor (2.586310)
[08/07/21 20:06:21] INFO	11. Cabin_factor (2.101764)
[08/07/21 20:06:21] INFO	12. Embarked (2.086410)
[08/07/21 20:06:21] INFO	13. SibSp (2.085405)
[08/07/21 20:06:21] INFO	14. cluster_12 (1.876782)
[08/07/21 20:06:21] INFO	15. cluster_24 (1.263144)
[08/07/21 20:06:21] INFO	16. count_2 (1.004409)
[08/07/21 20:06:21] INFO	17. sum (0.955946)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: LGB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Fare (256.000000)
[08/07/21 20:06:21] INFO	2. sum (241.000000)
[08/07/21 20:06:21] INFO	3. Age (232.000000)
[08/07/21 20:06:21] INFO	4. std (201.000000)
[08/07/21 20:06:21] INFO	5. Ticket_factor (199.000000)
[08/07/21 20:06:21] INFO	6. Name_factor (175.000000)
[08/07/21 20:06:21] INFO	7. cluster_30 (53.000000)
[08/07/21 20:06:21] INFO	8. cluster_27 (46.000000)
[08/07/21 20:06:21] INFO	9. Sex_factor (43.000000)
[08/07/21 20:06:21] INFO	10. Pclass (43.000000)
[08/07/21 20:06:21] INFO	11. Cabin_factor (41.000000)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: XGB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Sex_factor (0.424644)
[08/07/21 20:06:21] INFO	2. Pclass (0.127452)
[08/07/21 20:06:21] INFO	3. Cabin_factor (0.081307)
[08/07/21 20:06:21] INFO	4. Age (0.051007)
[08/07/21 20:06:21] INFO	5. SibSp (0.049620)
[08/07/21 20:06:21] INFO	6. count_1 (0.046373)
[08/07/21 20:06:21] INFO	7. Embarked (0.046225)
[08/07/21 20:06:21] INFO	8. std (0.036262)
[08/07/21 20:06:21] INFO	9. cluster_30 (0.036076)
[08/07/21 20:06:21] INFO	10. Fare (0.032410)
[08/07/21 20:06:21] INFO	11. cluster_24 (0.021187)
[08/07/21 20:06:21] INFO	12. Name_factor (0.019312)
[08/07/21 20:06:21] INFO	13. sum (0.017784)
[08/07/21 20:06:21] INFO	14. cluster_15 (0.010340)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/07/21 20:06:21] INFO	================================================================================
[08/07/21 20:06:21] INFO	Saving Model Predictor
[08/07/21 20:06:21] INFO	Writing model predictor to ./model/model_20210807.pkl
[08/07/21 20:06:21] INFO	Saving Feature Map
[08/07/21 20:06:21] INFO	Writing feature map to ./model/feature_map_20210807.pkl
[08/07/21 20:06:21] INFO	Loading data from ./input/test_20210807.csv
[08/07/21 20:06:21] INFO	Saving Predictions
[08/07/21 20:06:21] INFO	Writing data frame to ./output/predictions_20210807.csv
[08/07/21 20:06:21] INFO	Saving Probabilities
[08/07/21 20:06:21] INFO	Writing data frame to ./output/probabilities_20210807.csv
[08/07/21 20:06:21] INFO	Saving Ranked Predictions
[08/07/21 20:06:21] INFO	Writing data frame to ./output/rankings_20210807.csv
[08/07/21 20:06:21] INFO	Saving Submission to ./output/submission_20210807.csv
[08/07/21 20:06:21] INFO	********************************************************************************
[08/07/21 20:06:21] INFO	AlphaPy End
[08/07/21 20:06:21] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	AlphaPy Start
[08/22/21 09:18:26] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	Model Configuration
[08/22/21 09:18:26] INFO	No transforms Found
[08/22/21 09:18:26] INFO	MODEL PARAMETERS:
[08/22/21 09:18:26] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/22/21 09:18:26] INFO	calibration       = False
[08/22/21 09:18:26] INFO	cal_type          = sigmoid
[08/22/21 09:18:26] INFO	calibration_plot  = False
[08/22/21 09:18:26] INFO	clustering        = True
[08/22/21 09:18:26] INFO	cluster_inc       = 3
[08/22/21 09:18:26] INFO	cluster_max       = 30
[08/22/21 09:18:26] INFO	cluster_min       = 3
[08/22/21 09:18:26] INFO	confusion_matrix  = True
[08/22/21 09:18:26] INFO	counts            = True
[08/22/21 09:18:26] INFO	cv_folds          = 3
[08/22/21 09:18:26] INFO	directory         = .
[08/22/21 09:18:26] INFO	extension         = csv
[08/22/21 09:18:26] INFO	drop              = ['PassengerId']
[08/22/21 09:18:26] INFO	encoder           = <Encoders.target: 14>
[08/22/21 09:18:26] INFO	esr               = 20
[08/22/21 09:18:26] INFO	factors           = ['Embarked']
[08/22/21 09:18:26] INFO	features [X]      = *
[08/22/21 09:18:26] INFO	feature_selection = False
[08/22/21 09:18:26] INFO	fs_percentage     = 50
[08/22/21 09:18:26] INFO	fs_score_func     = <function f_classif at 0x7fe6cae17b80>
[08/22/21 09:18:26] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/22/21 09:18:26] INFO	grid_search       = True
[08/22/21 09:18:26] INFO	gs_iters          = 50
[08/22/21 09:18:26] INFO	gs_random         = True
[08/22/21 09:18:26] INFO	gs_sample         = False
[08/22/21 09:18:26] INFO	gs_sample_pct     = 0.200000
[08/22/21 09:18:26] INFO	importances       = True
[08/22/21 09:18:26] INFO	interactions      = False
[08/22/21 09:18:26] INFO	isomap            = False
[08/22/21 09:18:26] INFO	iso_components    = 2
[08/22/21 09:18:26] INFO	iso_neighbors     = 5
[08/22/21 09:18:26] INFO	isample_pct       = 10
[08/22/21 09:18:26] INFO	learning_curve    = True
[08/22/21 09:18:26] INFO	logtransform      = False
[08/22/21 09:18:26] INFO	lv_remove         = True
[08/22/21 09:18:26] INFO	lv_threshold      = 0.100000
[08/22/21 09:18:26] INFO	model_type        = <ModelType.classification: 1>
[08/22/21 09:18:26] INFO	n_estimators      = 51
[08/22/21 09:18:26] INFO	n_jobs            = -1
[08/22/21 09:18:26] INFO	ngrams_max        = 2
[08/22/21 09:18:26] INFO	numpy             = True
[08/22/21 09:18:26] INFO	pca               = False
[08/22/21 09:18:26] INFO	pca_inc           = 1
[08/22/21 09:18:26] INFO	pca_max           = 10
[08/22/21 09:18:26] INFO	pca_min           = 2
[08/22/21 09:18:26] INFO	pca_whiten        = False
[08/22/21 09:18:26] INFO	poly_degree       = 2
[08/22/21 09:18:26] INFO	pvalue_level      = 0.010000
[08/22/21 09:18:26] INFO	rfe               = True
[08/22/21 09:18:26] INFO	rfe_step          = 3
[08/22/21 09:18:26] INFO	roc_curve         = True
[08/22/21 09:18:26] INFO	rounding          = 2
[08/22/21 09:18:26] INFO	sampling          = False
[08/22/21 09:18:26] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/22/21 09:18:26] INFO	sampling_ratio    = 0.500000
[08/22/21 09:18:26] INFO	scaler_option     = True
[08/22/21 09:18:26] INFO	scaler_type       = <Scalers.standard: 2>
[08/22/21 09:18:26] INFO	scipy             = False
[08/22/21 09:18:26] INFO	scorer            = roc_auc
[08/22/21 09:18:26] INFO	seed              = 42
[08/22/21 09:18:26] INFO	sentinel          = -1
[08/22/21 09:18:26] INFO	separator         = ,
[08/22/21 09:18:26] INFO	shuffle           = False
[08/22/21 09:18:26] INFO	split             = 0.400000
[08/22/21 09:18:26] INFO	submission_file   = gender_submission
[08/22/21 09:18:26] INFO	submit_probas     = False
[08/22/21 09:18:26] INFO	target [y]        = Survived
[08/22/21 09:18:26] INFO	target_value      = 1
[08/22/21 09:18:26] INFO	transforms        = None
[08/22/21 09:18:26] INFO	tsne              = False
[08/22/21 09:18:26] INFO	tsne_components   = 2
[08/22/21 09:18:26] INFO	tsne_learn_rate   = 1000.000000
[08/22/21 09:18:26] INFO	tsne_perplexity   = 30.000000
[08/22/21 09:18:26] INFO	vectorize         = False
[08/22/21 09:18:26] INFO	verbosity         = 0
[08/22/21 09:18:26] INFO	Creating Model
[08/22/21 09:18:26] INFO	Calling Pipeline
[08/22/21 09:18:26] INFO	Training Pipeline
[08/22/21 09:18:26] INFO	Loading Data
[08/22/21 09:18:26] INFO	Loading data from ./input/train.csv
[08/22/21 09:18:26] INFO	Found target Survived in data frame
[08/22/21 09:18:26] INFO	Labels (y) found for Partition.train
[08/22/21 09:18:26] INFO	Loading Data
[08/22/21 09:18:26] INFO	Loading data from ./input/test.csv
[08/22/21 09:18:26] INFO	Target Survived not found in Partition.test
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Original Feature Statistics
[08/22/21 09:18:26] INFO	Number of Training Rows    : 891
[08/22/21 09:18:26] INFO	Number of Training Columns : 11
[08/22/21 09:18:26] INFO	Unique Training Values for Survived : [0 1]
[08/22/21 09:18:26] INFO	Unique Training Counts for Survived : [549 342]
[08/22/21 09:18:26] INFO	Number of Testing Rows     : 418
[08/22/21 09:18:26] INFO	Number of Testing Columns  : 11
[08/22/21 09:18:26] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 09:18:26] INFO	Feature Count     : 11
[08/22/21 09:18:26] INFO	Applying transforms
[08/22/21 09:18:26] INFO	No transforms Specified
[08/22/21 09:18:26] INFO	New Feature Count : 11
[08/22/21 09:18:26] INFO	Dropping Features: ['PassengerId']
[08/22/21 09:18:26] INFO	Original Feature Count : 11
[08/22/21 09:18:26] INFO	Reduced Feature Count  : 10
[08/22/21 09:18:26] INFO	Writing data frame to ./input/train_20210822.csv
[08/22/21 09:18:26] INFO	Writing data frame to ./input/test_20210822.csv
[08/22/21 09:18:26] INFO	Creating Cross-Tabulations
[08/22/21 09:18:26] INFO	Creating crosstabs for feature Embarked
[08/22/21 09:18:26] INFO	NumExpr defaulting to 8 threads.
[08/22/21 09:18:26] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 09:18:26] INFO	Feature Count     : 10
[08/22/21 09:18:26] INFO	Creating Count Features
[08/22/21 09:18:26] INFO	NA Counts
[08/22/21 09:18:26] INFO	Number Counts
[08/22/21 09:18:26] INFO	New Feature Count : 21
[08/22/21 09:18:26] INFO	Creating Base Features
[08/22/21 09:18:26] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/22/21 09:18:26] INFO	Feature 2: Name => Factorization
[08/22/21 09:18:26] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/22/21 09:18:26] INFO	Feature 3: Sex => Factorization
[08/22/21 09:18:26] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/22/21 09:18:26] INFO	Feature 7: Ticket => Factorization
[08/22/21 09:18:26] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/22/21 09:18:26] INFO	Feature 9: Cabin => Factorization
[08/22/21 09:18:26] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/22/21 09:18:26] INFO	Encoding: Encoders.target
[08/22/21 09:18:26] INFO	Fitting training features for Embarked
[08/22/21 09:18:26] INFO	Transforming testing features for Embarked
[08/22/21 09:18:26] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	New Feature Count : 21
[08/22/21 09:18:26] INFO	Scaling Base Features
[08/22/21 09:18:26] INFO	Creating NumPy Features
[08/22/21 09:18:26] INFO	NumPy Feature: sum
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: mean
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: std
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: var
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature Count : 4
[08/22/21 09:18:26] INFO	New Feature Count : 25
[08/22/21 09:18:26] INFO	Creating Clustering Features
[08/22/21 09:18:26] INFO	Cluster Minimum   : 3
[08/22/21 09:18:26] INFO	Cluster Maximum   : 30
[08/22/21 09:18:26] INFO	Cluster Increment : 3
[08/22/21 09:18:26] INFO	k = 3
[08/22/21 09:18:26] INFO	k = 6
[08/22/21 09:18:26] INFO	k = 9
[08/22/21 09:18:26] INFO	k = 12
[08/22/21 09:18:26] INFO	k = 15
[08/22/21 09:18:26] INFO	k = 18
[08/22/21 09:18:26] INFO	k = 21
[08/22/21 09:18:26] INFO	k = 24
[08/22/21 09:18:26] INFO	k = 27
[08/22/21 09:18:26] INFO	k = 30
[08/22/21 09:18:26] INFO	Clustering Feature Count : 10
[08/22/21 09:18:26] INFO	New Feature Count : 35
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Creating Interactions
[08/22/21 09:18:26] INFO	Initial Feature Count  : 35
[08/22/21 09:18:26] INFO	Skipping Interactions
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Removing Low-Variance Features
[08/22/21 09:18:26] INFO	Low-Variance Threshold  : 0.10
[08/22/21 09:18:26] INFO	Original Feature Count  : 35
[08/22/21 09:18:26] INFO	Reduced Feature Count   : 35
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Skipping Shuffling
[08/22/21 09:18:26] INFO	Skipping Sampling
[08/22/21 09:18:26] INFO	Getting All Estimators
[08/22/21 09:18:26] INFO	Algorithm Configuration
[08/22/21 09:18:27] INFO	Cannot load keras
[08/22/21 09:18:27] INFO	Algorithm KERASC not found (check package installation)
[08/22/21 09:18:27] INFO	Algorithm KERASR not found (check package installation)
[08/22/21 09:18:27] INFO	Selecting Models
[08/22/21 09:18:27] INFO	Algorithm: CATB
[08/22/21 09:18:27] INFO	Fitting Initial Model
[08/22/21 09:18:27] INFO	Cross-Validation
[08/22/21 09:18:28] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/22/21 09:18:28] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:31] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[08/22/21 09:18:31] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/22/21 09:18:31] INFO	No grid is defined for grid search
[08/22/21 09:18:31] INFO	Final Model Predictions for CATB
[08/22/21 09:18:31] INFO	Skipping Calibration
[08/22/21 09:18:31] INFO	Making Predictions
[08/22/21 09:18:31] INFO	Predictions Complete
[08/22/21 09:18:31] INFO	Algorithm: LGB
[08/22/21 09:18:31] INFO	Fitting Initial Model
[08/22/21 09:18:31] INFO	Cross-Validation
[08/22/21 09:18:31] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/22/21 09:18:31] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:33] INFO	RFECV took 1.94 seconds for step 3 and 3 folds
[08/22/21 09:18:33] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/22/21 09:18:33] INFO	No grid is defined for grid search
[08/22/21 09:18:33] INFO	Final Model Predictions for LGB
[08/22/21 09:18:33] INFO	Skipping Calibration
[08/22/21 09:18:33] INFO	Making Predictions
[08/22/21 09:18:33] INFO	Predictions Complete
[08/22/21 09:18:33] INFO	Algorithm: XGB
[08/22/21 09:18:33] INFO	Fitting Initial Model
[08/22/21 09:18:33] INFO	Cross-Validation
[08/22/21 09:18:33] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/22/21 09:18:33] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:36] INFO	RFECV took 2.50 seconds for step 3 and 3 folds
[08/22/21 09:18:36] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/22/21 09:18:36] INFO	Randomized Grid Search
[08/22/21 09:19:31] INFO	Grid Search took 55.16 seconds for 50 candidate parameter settings.
[08/22/21 09:19:31] INFO	Model with rank: 1
[08/22/21 09:19:31] INFO	Mean validation score: 0.871 (std: 0.021)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[08/22/21 09:19:31] INFO	Model with rank: 2
[08/22/21 09:19:31] INFO	Mean validation score: 0.871 (std: 0.027)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[08/22/21 09:19:31] INFO	Model with rank: 3
[08/22/21 09:19:31] INFO	Mean validation score: 0.870 (std: 0.021)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[08/22/21 09:19:31] INFO	Algorithm: XGB, Best Score: 0.8714, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[08/22/21 09:19:31] INFO	Final Model Predictions for XGB
[08/22/21 09:19:31] INFO	Skipping Calibration
[08/22/21 09:19:31] INFO	Making Predictions
[08/22/21 09:19:31] INFO	Predictions Complete
[08/22/21 09:19:31] INFO	Blending Models
[08/22/21 09:19:31] INFO	Blending Start: 2021-08-22 09:19:31.231842
[08/22/21 09:19:31] INFO	Blending Complete: 0:00:00.018845
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Metrics for: Partition.train
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: CATB
[08/22/21 09:19:31] INFO	accuracy: 0.8585858585858586
[08/22/21 09:19:31] INFO	average_precision: 0.9113351686222868
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.8378391333525069
[08/22/21 09:19:31] INFO	brier_score_loss: 0.10043404518351136
[08/22/21 09:19:31] INFO	cohen_kappa: 0.6932572665125658
[08/22/21 09:19:31] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/22/21 09:19:31] INFO	f1: 0.8025078369905956
[08/22/21 09:19:31] INFO	neg_log_loss: 0.3371948718196211
[08/22/21 09:19:31] INFO	precision: 0.8648648648648649
[08/22/21 09:19:31] INFO	recall: 0.7485380116959064
[08/22/21 09:19:31] INFO	roc_auc: 0.9297979313797549
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: LGB
[08/22/21 09:19:31] INFO	accuracy: 0.9730639730639731
[08/22/21 09:19:31] INFO	average_precision: 0.9961113207491221
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.9687709711437062
[08/22/21 09:19:31] INFO	brier_score_loss: 0.032809498448974184
[08/22/21 09:19:31] INFO	cohen_kappa: 0.9427387092109702
[08/22/21 09:19:31] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/22/21 09:19:31] INFO	f1: 0.9643916913946586
[08/22/21 09:19:31] INFO	neg_log_loss: 0.1458307566281259
[08/22/21 09:19:31] INFO	precision: 0.9789156626506024
[08/22/21 09:19:31] INFO	recall: 0.9502923976608187
[08/22/21 09:19:31] INFO	roc_auc: 0.9974861257576241
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: XGB
[08/22/21 09:19:31] INFO	accuracy: 0.8664421997755332
[08/22/21 09:19:31] INFO	average_precision: 0.917654266961909
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.8447656025309175
[08/22/21 09:19:31] INFO	brier_score_loss: 0.13383595098411258
[08/22/21 09:19:31] INFO	cohen_kappa: 0.709476954945624
[08/22/21 09:19:31] INFO	confusion_matrix: [[515  34]
 [ 85 257]]
[08/22/21 09:19:31] INFO	f1: 0.812006319115324
[08/22/21 09:19:31] INFO	neg_log_loss: 0.4457342040993683
[08/22/21 09:19:31] INFO	precision: 0.8831615120274914
[08/22/21 09:19:31] INFO	recall: 0.7514619883040936
[08/22/21 09:19:31] INFO	roc_auc: 0.9314410038453754
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Metrics for: Partition.test
[08/22/21 09:19:31] INFO	No labels for generating Partition.test metrics
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Selecting Best Model
[08/22/21 09:19:31] INFO	Scoring for: Partition.train
[08/22/21 09:19:31] INFO	Best Model Selection Start: 2021-08-22 09:19:31.273454
[08/22/21 09:19:31] INFO	Scoring CATB Model
[08/22/21 09:19:31] INFO	Scoring LGB Model
[08/22/21 09:19:31] INFO	Scoring XGB Model
[08/22/21 09:19:31] INFO	Scoring BLEND Model
[08/22/21 09:19:31] INFO	Best Model is BLEND with a roc_auc score of 0.9981
[08/22/21 09:19:31] INFO	Best Model Selection Complete: 0:00:00.000244
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Generating Plots for partition: train
[08/22/21 09:19:31] INFO	Generating Calibration Plot
[08/22/21 09:19:31] INFO	Calibration for Algorithm: CATB
[08/22/21 09:19:31] INFO	Calibration for Algorithm: LGB
[08/22/21 09:19:31] INFO	Calibration for Algorithm: XGB
[08/22/21 09:19:31] INFO	Writing plot to ./plots/calibration_train.png
[08/22/21 09:19:31] INFO	Generating Confusion Matrices
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: CATB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[509  40]
 [ 86 256]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: LGB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[542   7]
 [ 17 325]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: XGB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[515  34]
 [ 85 257]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/22/21 09:19:31] INFO	Generating ROC Curves
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: CATB
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: LGB
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: XGB
[08/22/21 09:19:31] INFO	Writing plot to ./plots/roc_curve_train.png
[08/22/21 09:19:31] INFO	Generating Learning Curves
[08/22/21 09:19:31] INFO	Algorithm Configuration
[08/22/21 09:19:31] INFO	Cannot load keras
[08/22/21 09:19:31] INFO	Algorithm KERASC not found (check package installation)
[08/22/21 09:19:31] INFO	Algorithm KERASR not found (check package installation)
[08/22/21 09:19:31] INFO	Learning Curve for Algorithm: CATB
[08/22/21 09:19:32] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/22/21 09:19:32] INFO	Learning Curve for Algorithm: LGB
[08/22/21 09:19:34] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/22/21 09:19:34] INFO	Learning Curve for Algorithm: XGB
[08/22/21 09:19:35] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/22/21 09:19:35] INFO	Generating Feature Importance Plots
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: CATB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Sex_factor (45.178104)
[08/22/21 09:19:35] INFO	2. Pclass (13.721171)
[08/22/21 09:19:35] INFO	3. Age (6.651788)
[08/22/21 09:19:35] INFO	4. Fare (4.529770)
[08/22/21 09:19:35] INFO	5. var (3.586590)
[08/22/21 09:19:35] INFO	6. std (3.492385)
[08/22/21 09:19:35] INFO	7. Ticket_factor (3.315046)
[08/22/21 09:19:35] INFO	8. cluster_30 (2.831587)
[08/22/21 09:19:35] INFO	9. mean (2.733389)
[08/22/21 09:19:35] INFO	10. Name_factor (2.586310)
[08/22/21 09:19:35] INFO	11. Cabin_factor (2.101764)
[08/22/21 09:19:35] INFO	12. Embarked (2.086410)
[08/22/21 09:19:35] INFO	13. SibSp (2.085405)
[08/22/21 09:19:35] INFO	14. cluster_12 (1.876782)
[08/22/21 09:19:35] INFO	15. cluster_24 (1.263144)
[08/22/21 09:19:35] INFO	16. count_2 (1.004409)
[08/22/21 09:19:35] INFO	17. sum (0.955946)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: LGB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Fare (256.000000)
[08/22/21 09:19:35] INFO	2. sum (241.000000)
[08/22/21 09:19:35] INFO	3. Age (232.000000)
[08/22/21 09:19:35] INFO	4. std (201.000000)
[08/22/21 09:19:35] INFO	5. Ticket_factor (199.000000)
[08/22/21 09:19:35] INFO	6. Name_factor (175.000000)
[08/22/21 09:19:35] INFO	7. cluster_30 (53.000000)
[08/22/21 09:19:35] INFO	8. cluster_27 (46.000000)
[08/22/21 09:19:35] INFO	9. Sex_factor (43.000000)
[08/22/21 09:19:35] INFO	10. Pclass (43.000000)
[08/22/21 09:19:35] INFO	11. Cabin_factor (41.000000)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: XGB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Sex_factor (0.424644)
[08/22/21 09:19:35] INFO	2. Pclass (0.127452)
[08/22/21 09:19:35] INFO	3. Cabin_factor (0.081307)
[08/22/21 09:19:35] INFO	4. Age (0.051007)
[08/22/21 09:19:35] INFO	5. SibSp (0.049620)
[08/22/21 09:19:35] INFO	6. count_1 (0.046373)
[08/22/21 09:19:35] INFO	7. Embarked (0.046225)
[08/22/21 09:19:35] INFO	8. std (0.036262)
[08/22/21 09:19:35] INFO	9. cluster_30 (0.036076)
[08/22/21 09:19:35] INFO	10. Fare (0.032410)
[08/22/21 09:19:35] INFO	11. cluster_24 (0.021187)
[08/22/21 09:19:35] INFO	12. Name_factor (0.019312)
[08/22/21 09:19:35] INFO	13. sum (0.017784)
[08/22/21 09:19:35] INFO	14. cluster_15 (0.010340)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/22/21 09:19:35] INFO	================================================================================
[08/22/21 09:19:35] INFO	Saving Model Predictor
[08/22/21 09:19:35] INFO	Writing model predictor to ./model/model_20210822.pkl
[08/22/21 09:19:35] INFO	Saving Feature Map
[08/22/21 09:19:35] INFO	Writing feature map to ./model/feature_map_20210822.pkl
[08/22/21 09:19:35] INFO	Loading data from ./input/test_20210822.csv
[08/22/21 09:19:35] INFO	Saving Predictions
[08/22/21 09:19:35] INFO	Writing data frame to ./output/predictions_20210822.csv
[08/22/21 09:19:35] INFO	Saving Probabilities
[08/22/21 09:19:35] INFO	Writing data frame to ./output/probabilities_20210822.csv
[08/22/21 09:19:35] INFO	Saving Ranked Predictions
[08/22/21 09:19:35] INFO	Writing data frame to ./output/rankings_20210822.csv
[08/22/21 09:19:35] INFO	Saving Submission to ./output/submission_20210822.csv
[08/22/21 09:19:35] INFO	********************************************************************************
[08/22/21 09:19:35] INFO	AlphaPy End
[08/22/21 09:19:35] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	AlphaPy Start
[08/22/21 15:39:22] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	Model Configuration
[08/22/21 15:39:22] INFO	No transforms Found
[08/22/21 15:39:22] INFO	MODEL PARAMETERS:
[08/22/21 15:39:22] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/22/21 15:39:22] INFO	calibration       = False
[08/22/21 15:39:22] INFO	cal_type          = sigmoid
[08/22/21 15:39:22] INFO	calibration_plot  = False
[08/22/21 15:39:22] INFO	clustering        = True
[08/22/21 15:39:22] INFO	cluster_inc       = 3
[08/22/21 15:39:22] INFO	cluster_max       = 30
[08/22/21 15:39:22] INFO	cluster_min       = 3
[08/22/21 15:39:22] INFO	confusion_matrix  = True
[08/22/21 15:39:22] INFO	counts            = True
[08/22/21 15:39:22] INFO	cv_folds          = 3
[08/22/21 15:39:22] INFO	directory         = .
[08/22/21 15:39:22] INFO	extension         = csv
[08/22/21 15:39:22] INFO	drop              = ['PassengerId']
[08/22/21 15:39:22] INFO	encoder           = <Encoders.target: 14>
[08/22/21 15:39:22] INFO	esr               = 20
[08/22/21 15:39:22] INFO	factors           = ['Embarked']
[08/22/21 15:39:22] INFO	features [X]      = *
[08/22/21 15:39:22] INFO	feature_selection = False
[08/22/21 15:39:22] INFO	fs_percentage     = 50
[08/22/21 15:39:22] INFO	fs_score_func     = <function f_classif at 0x7fba62cb5b80>
[08/22/21 15:39:22] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/22/21 15:39:22] INFO	grid_search       = True
[08/22/21 15:39:22] INFO	gs_iters          = 50
[08/22/21 15:39:22] INFO	gs_random         = True
[08/22/21 15:39:22] INFO	gs_sample         = False
[08/22/21 15:39:22] INFO	gs_sample_pct     = 0.200000
[08/22/21 15:39:22] INFO	importances       = True
[08/22/21 15:39:22] INFO	interactions      = False
[08/22/21 15:39:22] INFO	isomap            = False
[08/22/21 15:39:22] INFO	iso_components    = 2
[08/22/21 15:39:22] INFO	iso_neighbors     = 5
[08/22/21 15:39:22] INFO	isample_pct       = 10
[08/22/21 15:39:22] INFO	learning_curve    = True
[08/22/21 15:39:22] INFO	logtransform      = False
[08/22/21 15:39:22] INFO	lv_remove         = True
[08/22/21 15:39:22] INFO	lv_threshold      = 0.100000
[08/22/21 15:39:22] INFO	model_type        = <ModelType.classification: 1>
[08/22/21 15:39:22] INFO	n_estimators      = 51
[08/22/21 15:39:22] INFO	n_jobs            = -1
[08/22/21 15:39:22] INFO	ngrams_max        = 2
[08/22/21 15:39:22] INFO	numpy             = True
[08/22/21 15:39:22] INFO	pca               = False
[08/22/21 15:39:22] INFO	pca_inc           = 1
[08/22/21 15:39:22] INFO	pca_max           = 10
[08/22/21 15:39:22] INFO	pca_min           = 2
[08/22/21 15:39:22] INFO	pca_whiten        = False
[08/22/21 15:39:22] INFO	poly_degree       = 2
[08/22/21 15:39:22] INFO	pvalue_level      = 0.010000
[08/22/21 15:39:22] INFO	rfe               = True
[08/22/21 15:39:22] INFO	rfe_step          = 3
[08/22/21 15:39:22] INFO	roc_curve         = True
[08/22/21 15:39:22] INFO	rounding          = 2
[08/22/21 15:39:22] INFO	sampling          = False
[08/22/21 15:39:22] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/22/21 15:39:22] INFO	sampling_ratio    = 0.500000
[08/22/21 15:39:22] INFO	scaler_option     = True
[08/22/21 15:39:22] INFO	scaler_type       = <Scalers.standard: 2>
[08/22/21 15:39:22] INFO	scipy             = False
[08/22/21 15:39:22] INFO	scorer            = roc_auc
[08/22/21 15:39:22] INFO	seed              = 42
[08/22/21 15:39:22] INFO	sentinel          = -1
[08/22/21 15:39:22] INFO	separator         = ,
[08/22/21 15:39:22] INFO	shuffle           = False
[08/22/21 15:39:22] INFO	split             = 0.400000
[08/22/21 15:39:22] INFO	submission_file   = gender_submission
[08/22/21 15:39:22] INFO	submit_probas     = False
[08/22/21 15:39:22] INFO	target [y]        = Survived
[08/22/21 15:39:22] INFO	target_value      = 1
[08/22/21 15:39:22] INFO	transforms        = None
[08/22/21 15:39:22] INFO	tsne              = False
[08/22/21 15:39:22] INFO	tsne_components   = 2
[08/22/21 15:39:22] INFO	tsne_learn_rate   = 1000.000000
[08/22/21 15:39:22] INFO	tsne_perplexity   = 30.000000
[08/22/21 15:39:22] INFO	vectorize         = False
[08/22/21 15:39:22] INFO	verbosity         = 0
[08/22/21 15:39:22] INFO	Creating Model
[08/22/21 15:39:22] INFO	Calling Pipeline
[08/22/21 15:39:22] INFO	Training Pipeline
[08/22/21 15:39:22] INFO	Loading Data
[08/22/21 15:39:22] INFO	Loading data from ./input/train.csv
[08/22/21 15:39:22] INFO	Found target Survived in data frame
[08/22/21 15:39:22] INFO	Labels (y) found for Partition.train
[08/22/21 15:39:22] INFO	Loading Data
[08/22/21 15:39:22] INFO	Loading data from ./input/test.csv
[08/22/21 15:39:22] INFO	Target Survived not found in Partition.test
[08/22/21 15:39:22] INFO	Saving New Features in Model
[08/22/21 15:39:22] INFO	Original Feature Statistics
[08/22/21 15:39:22] INFO	Number of Training Rows    : 891
[08/22/21 15:39:22] INFO	Number of Training Columns : 11
[08/22/21 15:39:22] INFO	Unique Training Values for Survived : [0 1]
[08/22/21 15:39:22] INFO	Unique Training Counts for Survived : [549 342]
[08/22/21 15:39:22] INFO	Number of Testing Rows     : 418
[08/22/21 15:39:22] INFO	Number of Testing Columns  : 11
[08/22/21 15:39:22] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 15:39:22] INFO	Feature Count     : 11
[08/22/21 15:39:22] INFO	Applying transforms
[08/22/21 15:39:22] INFO	No transforms Specified
[08/22/21 15:39:22] INFO	New Feature Count : 11
[08/22/21 15:39:22] INFO	Dropping Features: ['PassengerId']
[08/22/21 15:39:22] INFO	Original Feature Count : 11
[08/22/21 15:39:22] INFO	Reduced Feature Count  : 10
[08/22/21 15:39:22] INFO	Writing data frame to ./input/train_20210822.csv
[08/22/21 15:39:22] INFO	Writing data frame to ./input/test_20210822.csv
[08/22/21 15:39:22] INFO	Creating Cross-Tabulations
[08/22/21 15:39:22] INFO	Creating crosstabs for feature Embarked
[08/22/21 15:39:22] INFO	NumExpr defaulting to 8 threads.
[08/22/21 15:39:22] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 15:39:22] INFO	Feature Count     : 10
[08/22/21 15:39:22] INFO	Creating Count Features
[08/22/21 15:39:22] INFO	NA Counts
[08/22/21 15:39:22] INFO	Number Counts
[08/22/21 15:39:22] INFO	New Feature Count : 21
[08/22/21 15:39:22] INFO	Creating Base Features
[08/22/21 15:39:22] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/22/21 15:39:22] INFO	Feature 2: Name => Factorization
[08/22/21 15:39:22] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/22/21 15:39:22] INFO	Feature 3: Sex => Factorization
[08/22/21 15:39:22] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/22/21 15:39:22] INFO	Feature 7: Ticket => Factorization
[08/22/21 15:39:22] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/22/21 15:39:22] INFO	Feature 9: Cabin => Factorization
[08/22/21 15:39:22] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/22/21 15:39:22] INFO	Encoding: Encoders.target
[08/22/21 15:39:22] INFO	Fitting training features for Embarked
[08/22/21 15:39:22] INFO	Transforming testing features for Embarked
[08/22/21 15:39:22] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	New Feature Count : 21
[08/22/21 15:39:22] INFO	Scaling Base Features
[08/22/21 15:39:22] INFO	Creating NumPy Features
[08/22/21 15:39:22] INFO	NumPy Feature: sum
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: mean
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: std
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: var
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature Count : 4
[08/22/21 15:39:22] INFO	New Feature Count : 25
[08/22/21 15:39:22] INFO	Creating Clustering Features
[08/22/21 15:39:22] INFO	Cluster Minimum   : 3
[08/22/21 15:39:22] INFO	Cluster Maximum   : 30
[08/22/21 15:39:22] INFO	Cluster Increment : 3
[08/22/21 15:39:22] INFO	k = 3
[08/22/21 15:39:22] INFO	k = 6
[08/22/21 15:39:22] INFO	k = 9
[08/22/21 15:39:22] INFO	k = 12
[08/22/21 15:39:22] INFO	k = 15
[08/22/21 15:39:22] INFO	k = 18
[08/22/21 15:39:22] INFO	k = 21
[08/22/21 15:39:23] INFO	k = 24
[08/22/21 15:39:23] INFO	k = 27
[08/22/21 15:39:23] INFO	k = 30
[08/22/21 15:39:23] INFO	Clustering Feature Count : 10
[08/22/21 15:39:23] INFO	New Feature Count : 35
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Creating Interactions
[08/22/21 15:39:23] INFO	Initial Feature Count  : 35
[08/22/21 15:39:23] INFO	Skipping Interactions
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Removing Low-Variance Features
[08/22/21 15:39:23] INFO	Low-Variance Threshold  : 0.10
[08/22/21 15:39:23] INFO	Original Feature Count  : 35
[08/22/21 15:39:23] INFO	Reduced Feature Count   : 35
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Skipping Shuffling
[08/22/21 15:39:23] INFO	Skipping Sampling
[08/22/21 15:39:23] INFO	Getting All Estimators
[08/22/21 15:39:23] INFO	Algorithm Configuration
[08/22/21 15:39:23] INFO	Selecting Models
[08/22/21 15:39:23] INFO	Algorithm: CATB
[08/22/21 15:39:23] INFO	Fitting Initial Model
[08/22/21 15:39:24] INFO	Cross-Validation
[08/22/21 15:39:25] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/22/21 15:39:25] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:27] INFO	RFECV took 2.28 seconds for step 3 and 3 folds
[08/22/21 15:39:27] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/22/21 15:39:27] INFO	No grid is defined for grid search
[08/22/21 15:39:27] INFO	Final Model Predictions for CATB
[08/22/21 15:39:27] INFO	Skipping Calibration
[08/22/21 15:39:27] INFO	Making Predictions
[08/22/21 15:39:27] INFO	Predictions Complete
[08/22/21 15:39:27] INFO	Algorithm: LGB
[08/22/21 15:39:27] INFO	Fitting Initial Model
[08/22/21 15:39:28] INFO	Cross-Validation
[08/22/21 15:39:29] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/22/21 15:39:29] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:37] INFO	RFECV took 7.56 seconds for step 3 and 3 folds
[08/22/21 15:39:37] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/22/21 15:39:37] INFO	No grid is defined for grid search
[08/22/21 15:39:37] INFO	Final Model Predictions for LGB
[08/22/21 15:39:37] INFO	Skipping Calibration
[08/22/21 15:39:37] INFO	Making Predictions
[08/22/21 15:39:37] INFO	Predictions Complete
[08/22/21 15:39:37] INFO	Algorithm: XGB
[08/22/21 15:39:37] INFO	Fitting Initial Model
[08/22/21 15:39:37] INFO	Cross-Validation
[08/22/21 15:39:38] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/22/21 15:39:38] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:46] INFO	RFECV took 8.05 seconds for step 3 and 3 folds
[08/22/21 15:39:46] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/22/21 15:39:46] INFO	Randomized Grid Search
[08/22/21 15:41:54] INFO	Grid Search took 127.89 seconds for 50 candidate parameter settings.
[08/22/21 15:41:54] INFO	Model with rank: 1
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.026)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[08/22/21 15:41:54] INFO	Model with rank: 2
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.027)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[08/22/21 15:41:54] INFO	Model with rank: 3
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.021)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[08/22/21 15:41:54] INFO	Algorithm: XGB, Best Score: 0.8701, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[08/22/21 15:41:54] INFO	Final Model Predictions for XGB
[08/22/21 15:41:54] INFO	Skipping Calibration
[08/22/21 15:41:54] INFO	Making Predictions
[08/22/21 15:41:54] INFO	Predictions Complete
[08/22/21 15:41:54] INFO	Blending Models
[08/22/21 15:41:54] INFO	Blending Start: 2021-08-22 15:41:54.223590
[08/22/21 15:41:54] INFO	Blending Complete: 0:00:00.020620
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Metrics for: Partition.train
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: CATB
[08/22/21 15:41:54] INFO	accuracy: 0.8585858585858586
[08/22/21 15:41:54] INFO	average_precision: 0.9113351686222868
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.8378391333525069
[08/22/21 15:41:54] INFO	brier_score_loss: 0.10043404518351136
[08/22/21 15:41:54] INFO	cohen_kappa: 0.6932572665125658
[08/22/21 15:41:54] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/22/21 15:41:54] INFO	f1: 0.8025078369905956
[08/22/21 15:41:54] INFO	neg_log_loss: 0.3371948718196211
[08/22/21 15:41:54] INFO	precision: 0.8648648648648649
[08/22/21 15:41:54] INFO	recall: 0.7485380116959064
[08/22/21 15:41:54] INFO	roc_auc: 0.9297979313797549
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: LGB
[08/22/21 15:41:54] INFO	accuracy: 0.9730639730639731
[08/22/21 15:41:54] INFO	average_precision: 0.9961113207491221
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.9687709711437062
[08/22/21 15:41:54] INFO	brier_score_loss: 0.032809498448974184
[08/22/21 15:41:54] INFO	cohen_kappa: 0.9427387092109702
[08/22/21 15:41:54] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/22/21 15:41:54] INFO	f1: 0.9643916913946586
[08/22/21 15:41:54] INFO	neg_log_loss: 0.1458307566281259
[08/22/21 15:41:54] INFO	precision: 0.9789156626506024
[08/22/21 15:41:54] INFO	recall: 0.9502923976608187
[08/22/21 15:41:54] INFO	roc_auc: 0.9974861257576241
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: XGB
[08/22/21 15:41:54] INFO	accuracy: 0.9225589225589226
[08/22/21 15:41:54] INFO	average_precision: 0.9576532313408883
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.9090451538682772
[08/22/21 15:41:54] INFO	brier_score_loss: 0.16912337672198585
[08/22/21 15:41:54] INFO	cohen_kappa: 0.8332478945441231
[08/22/21 15:41:54] INFO	confusion_matrix: [[531  18]
 [ 51 291]]
[08/22/21 15:41:54] INFO	f1: 0.8940092165898617
[08/22/21 15:41:54] INFO	neg_log_loss: 0.5283242148314796
[08/22/21 15:41:54] INFO	precision: 0.941747572815534
[08/22/21 15:41:54] INFO	recall: 0.8508771929824561
[08/22/21 15:41:54] INFO	roc_auc: 0.9640068598941189
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Metrics for: Partition.test
[08/22/21 15:41:54] INFO	No labels for generating Partition.test metrics
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Selecting Best Model
[08/22/21 15:41:54] INFO	Scoring for: Partition.train
[08/22/21 15:41:54] INFO	Best Model Selection Start: 2021-08-22 15:41:54.269223
[08/22/21 15:41:54] INFO	Scoring CATB Model
[08/22/21 15:41:54] INFO	Scoring LGB Model
[08/22/21 15:41:54] INFO	Scoring XGB Model
[08/22/21 15:41:54] INFO	Scoring BLEND Model
[08/22/21 15:41:54] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[08/22/21 15:41:54] INFO	Best Model Selection Complete: 0:00:00.000207
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Generating Plots for partition: train
[08/22/21 15:41:54] INFO	Generating Calibration Plot
[08/22/21 15:41:54] INFO	Calibration for Algorithm: CATB
[08/22/21 15:41:54] INFO	Calibration for Algorithm: LGB
[08/22/21 15:41:54] INFO	Calibration for Algorithm: XGB
[08/22/21 15:41:54] INFO	Writing plot to ./plots/calibration_train.png
[08/22/21 15:41:54] INFO	Generating Confusion Matrices
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: CATB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[509  40]
 [ 86 256]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: LGB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[542   7]
 [ 17 325]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: XGB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[531  18]
 [ 51 291]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/22/21 15:41:54] INFO	Generating ROC Curves
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: CATB
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: LGB
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: XGB
[08/22/21 15:41:54] INFO	Writing plot to ./plots/roc_curve_train.png
[08/22/21 15:41:54] INFO	Generating Learning Curves
[08/22/21 15:41:54] INFO	Algorithm Configuration
[08/22/21 15:41:54] INFO	Learning Curve for Algorithm: CATB
[08/22/21 15:41:55] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/22/21 15:41:55] INFO	Learning Curve for Algorithm: LGB
[08/22/21 15:41:57] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/22/21 15:41:57] INFO	Learning Curve for Algorithm: XGB
[08/22/21 15:41:58] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/22/21 15:41:58] INFO	Generating Feature Importance Plots
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: CATB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Sex_factor (45.178104)
[08/22/21 15:41:58] INFO	2. Pclass (13.721171)
[08/22/21 15:41:58] INFO	3. Age (6.651788)
[08/22/21 15:41:58] INFO	4. Fare (4.529770)
[08/22/21 15:41:58] INFO	5. var (3.586590)
[08/22/21 15:41:58] INFO	6. std (3.492385)
[08/22/21 15:41:58] INFO	7. Ticket_factor (3.315046)
[08/22/21 15:41:58] INFO	8. cluster_30 (2.831587)
[08/22/21 15:41:58] INFO	9. mean (2.733389)
[08/22/21 15:41:58] INFO	10. Name_factor (2.586310)
[08/22/21 15:41:58] INFO	11. Cabin_factor (2.101764)
[08/22/21 15:41:58] INFO	12. Embarked (2.086410)
[08/22/21 15:41:58] INFO	13. SibSp (2.085405)
[08/22/21 15:41:58] INFO	14. cluster_12 (1.876782)
[08/22/21 15:41:58] INFO	15. cluster_24 (1.263144)
[08/22/21 15:41:58] INFO	16. count_2 (1.004409)
[08/22/21 15:41:58] INFO	17. sum (0.955946)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: LGB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Fare (256.000000)
[08/22/21 15:41:58] INFO	2. sum (241.000000)
[08/22/21 15:41:58] INFO	3. Age (232.000000)
[08/22/21 15:41:58] INFO	4. std (201.000000)
[08/22/21 15:41:58] INFO	5. Ticket_factor (199.000000)
[08/22/21 15:41:58] INFO	6. Name_factor (175.000000)
[08/22/21 15:41:58] INFO	7. cluster_30 (53.000000)
[08/22/21 15:41:58] INFO	8. cluster_27 (46.000000)
[08/22/21 15:41:58] INFO	9. Sex_factor (43.000000)
[08/22/21 15:41:58] INFO	10. Pclass (43.000000)
[08/22/21 15:41:58] INFO	11. Cabin_factor (41.000000)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: XGB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Sex_factor (0.424644)
[08/22/21 15:41:58] INFO	2. Pclass (0.127452)
[08/22/21 15:41:58] INFO	3. Cabin_factor (0.081307)
[08/22/21 15:41:58] INFO	4. Age (0.051007)
[08/22/21 15:41:58] INFO	5. SibSp (0.049620)
[08/22/21 15:41:58] INFO	6. count_1 (0.046373)
[08/22/21 15:41:58] INFO	7. Embarked (0.046225)
[08/22/21 15:41:58] INFO	8. std (0.036262)
[08/22/21 15:41:58] INFO	9. cluster_30 (0.036076)
[08/22/21 15:41:58] INFO	10. Fare (0.032410)
[08/22/21 15:41:58] INFO	11. cluster_24 (0.021187)
[08/22/21 15:41:58] INFO	12. Name_factor (0.019312)
[08/22/21 15:41:58] INFO	13. sum (0.017784)
[08/22/21 15:41:58] INFO	14. cluster_15 (0.010340)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/22/21 15:41:58] INFO	================================================================================
[08/22/21 15:41:58] INFO	Saving Model Predictor
[08/22/21 15:41:58] INFO	Writing model predictor to ./model/model_20210822.pkl
[08/22/21 15:41:58] INFO	Saving Feature Map
[08/22/21 15:41:58] INFO	Writing feature map to ./model/feature_map_20210822.pkl
[08/22/21 15:41:58] INFO	Loading data from ./input/test_20210822.csv
[08/22/21 15:41:58] INFO	Saving Predictions
[08/22/21 15:41:58] INFO	Writing data frame to ./output/predictions_20210822.csv
[08/22/21 15:41:58] INFO	Saving Probabilities
[08/22/21 15:41:58] INFO	Writing data frame to ./output/probabilities_20210822.csv
[08/22/21 15:41:58] INFO	Saving Ranked Predictions
[08/22/21 15:41:58] INFO	Writing data frame to ./output/rankings_20210822.csv
[08/22/21 15:41:58] INFO	Saving Submission to ./output/submission_20210822.csv
[08/22/21 15:41:58] INFO	********************************************************************************
[08/22/21 15:41:58] INFO	AlphaPy End
[08/22/21 15:41:58] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	AlphaPy Start
[09/04/21 13:16:30] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	Model Configuration
[09/04/21 13:16:30] INFO	No transforms Found
[09/04/21 13:16:30] INFO	MODEL PARAMETERS:
[09/04/21 13:16:30] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/04/21 13:16:30] INFO	calibration       = False
[09/04/21 13:16:30] INFO	cal_type          = sigmoid
[09/04/21 13:16:30] INFO	calibration_plot  = False
[09/04/21 13:16:30] INFO	clustering        = True
[09/04/21 13:16:30] INFO	cluster_inc       = 3
[09/04/21 13:16:30] INFO	cluster_max       = 30
[09/04/21 13:16:30] INFO	cluster_min       = 3
[09/04/21 13:16:30] INFO	confusion_matrix  = True
[09/04/21 13:16:30] INFO	counts            = True
[09/04/21 13:16:30] INFO	cv_folds          = 3
[09/04/21 13:16:30] INFO	directory         = .
[09/04/21 13:16:30] INFO	extension         = csv
[09/04/21 13:16:30] INFO	drop              = ['PassengerId']
[09/04/21 13:16:30] INFO	encoder           = <Encoders.target: 14>
[09/04/21 13:16:30] INFO	esr               = 20
[09/04/21 13:16:30] INFO	factors           = ['Embarked']
[09/04/21 13:16:30] INFO	features [X]      = *
[09/04/21 13:16:30] INFO	feature_selection = False
[09/04/21 13:16:30] INFO	fs_percentage     = 50
[09/04/21 13:16:30] INFO	fs_score_func     = <function f_classif at 0x7ffb5b10cd30>
[09/04/21 13:16:30] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/04/21 13:16:30] INFO	grid_search       = True
[09/04/21 13:16:30] INFO	gs_iters          = 50
[09/04/21 13:16:30] INFO	gs_random         = True
[09/04/21 13:16:30] INFO	gs_sample         = False
[09/04/21 13:16:30] INFO	gs_sample_pct     = 0.200000
[09/04/21 13:16:30] INFO	importances       = True
[09/04/21 13:16:30] INFO	interactions      = False
[09/04/21 13:16:30] INFO	isomap            = False
[09/04/21 13:16:30] INFO	iso_components    = 2
[09/04/21 13:16:30] INFO	iso_neighbors     = 5
[09/04/21 13:16:30] INFO	isample_pct       = 10
[09/04/21 13:16:30] INFO	learning_curve    = True
[09/04/21 13:16:30] INFO	logtransform      = False
[09/04/21 13:16:30] INFO	lv_remove         = True
[09/04/21 13:16:30] INFO	lv_threshold      = 0.100000
[09/04/21 13:16:30] INFO	model_type        = <ModelType.classification: 1>
[09/04/21 13:16:30] INFO	n_estimators      = 51
[09/04/21 13:16:30] INFO	n_jobs            = -1
[09/04/21 13:16:30] INFO	ngrams_max        = 2
[09/04/21 13:16:30] INFO	numpy             = True
[09/04/21 13:16:30] INFO	pca               = False
[09/04/21 13:16:30] INFO	pca_inc           = 1
[09/04/21 13:16:30] INFO	pca_max           = 10
[09/04/21 13:16:30] INFO	pca_min           = 2
[09/04/21 13:16:30] INFO	pca_whiten        = False
[09/04/21 13:16:30] INFO	poly_degree       = 2
[09/04/21 13:16:30] INFO	pvalue_level      = 0.010000
[09/04/21 13:16:30] INFO	rfe               = True
[09/04/21 13:16:30] INFO	rfe_step          = 3
[09/04/21 13:16:30] INFO	roc_curve         = True
[09/04/21 13:16:30] INFO	rounding          = 2
[09/04/21 13:16:30] INFO	sampling          = False
[09/04/21 13:16:30] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/04/21 13:16:30] INFO	sampling_ratio    = 0.500000
[09/04/21 13:16:30] INFO	scaler_option     = True
[09/04/21 13:16:30] INFO	scaler_type       = <Scalers.standard: 2>
[09/04/21 13:16:30] INFO	scipy             = False
[09/04/21 13:16:30] INFO	scorer            = roc_auc
[09/04/21 13:16:30] INFO	seed              = 42
[09/04/21 13:16:30] INFO	sentinel          = -1
[09/04/21 13:16:30] INFO	separator         = ,
[09/04/21 13:16:30] INFO	shuffle           = False
[09/04/21 13:16:30] INFO	split             = 0.400000
[09/04/21 13:16:30] INFO	submission_file   = gender_submission
[09/04/21 13:16:30] INFO	submit_probas     = False
[09/04/21 13:16:30] INFO	target [y]        = Survived
[09/04/21 13:16:30] INFO	target_value      = 1
[09/04/21 13:16:30] INFO	transforms        = None
[09/04/21 13:16:30] INFO	tsne              = False
[09/04/21 13:16:30] INFO	tsne_components   = 2
[09/04/21 13:16:30] INFO	tsne_learn_rate   = 1000.000000
[09/04/21 13:16:30] INFO	tsne_perplexity   = 30.000000
[09/04/21 13:16:30] INFO	vectorize         = False
[09/04/21 13:16:30] INFO	verbosity         = 0
[09/04/21 13:16:30] INFO	Creating Model
[09/04/21 13:16:30] INFO	Calling Pipeline
[09/04/21 13:16:30] INFO	Training Pipeline
[09/04/21 13:16:30] INFO	Loading Data
[09/04/21 13:16:30] INFO	Loading data from ./input/train.csv
[09/04/21 13:16:30] INFO	Found target Survived in data frame
[09/04/21 13:16:30] INFO	Labels (y) found for Partition.train
[09/04/21 13:16:30] INFO	Loading Data
[09/04/21 13:16:30] INFO	Loading data from ./input/test.csv
[09/04/21 13:16:30] INFO	Target Survived not found in Partition.test
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Original Feature Statistics
[09/04/21 13:16:30] INFO	Number of Training Rows    : 891
[09/04/21 13:16:30] INFO	Number of Training Columns : 11
[09/04/21 13:16:30] INFO	Unique Training Values for Survived : [0 1]
[09/04/21 13:16:30] INFO	Unique Training Counts for Survived : [549 342]
[09/04/21 13:16:30] INFO	Number of Testing Rows     : 418
[09/04/21 13:16:30] INFO	Number of Testing Columns  : 11
[09/04/21 13:16:30] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/04/21 13:16:30] INFO	Feature Count     : 11
[09/04/21 13:16:30] INFO	Applying transforms
[09/04/21 13:16:30] INFO	No transforms Specified
[09/04/21 13:16:30] INFO	New Feature Count : 11
[09/04/21 13:16:30] INFO	Dropping Features: ['PassengerId']
[09/04/21 13:16:30] INFO	Original Feature Count : 11
[09/04/21 13:16:30] INFO	Reduced Feature Count  : 10
[09/04/21 13:16:30] INFO	Writing data frame to ./input/train_20210904.csv
[09/04/21 13:16:30] INFO	Writing data frame to ./input/test_20210904.csv
[09/04/21 13:16:30] INFO	Creating Cross-Tabulations
[09/04/21 13:16:30] INFO	Creating crosstabs for feature Embarked
[09/04/21 13:16:30] INFO	NumExpr defaulting to 8 threads.
[09/04/21 13:16:30] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/04/21 13:16:30] INFO	Feature Count     : 10
[09/04/21 13:16:30] INFO	Creating Count Features
[09/04/21 13:16:30] INFO	NA Counts
[09/04/21 13:16:30] INFO	Number Counts
[09/04/21 13:16:30] INFO	New Feature Count : 21
[09/04/21 13:16:30] INFO	Creating Base Features
[09/04/21 13:16:30] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/04/21 13:16:30] INFO	Feature 2: Name => Factorization
[09/04/21 13:16:30] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/04/21 13:16:30] INFO	Feature 3: Sex => Factorization
[09/04/21 13:16:30] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/04/21 13:16:30] INFO	Feature 7: Ticket => Factorization
[09/04/21 13:16:30] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/04/21 13:16:30] INFO	Feature 9: Cabin => Factorization
[09/04/21 13:16:30] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/04/21 13:16:30] INFO	Encoding: Encoders.target
[09/04/21 13:16:30] INFO	Fitting training features for Embarked
[09/04/21 13:16:30] INFO	Transforming testing features for Embarked
[09/04/21 13:16:30] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	New Feature Count : 21
[09/04/21 13:16:30] INFO	Scaling Base Features
[09/04/21 13:16:30] INFO	Creating NumPy Features
[09/04/21 13:16:30] INFO	NumPy Feature: sum
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: mean
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: std
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: var
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature Count : 4
[09/04/21 13:16:30] INFO	New Feature Count : 25
[09/04/21 13:16:30] INFO	Creating Clustering Features
[09/04/21 13:16:30] INFO	Cluster Minimum   : 3
[09/04/21 13:16:30] INFO	Cluster Maximum   : 30
[09/04/21 13:16:30] INFO	Cluster Increment : 3
[09/04/21 13:16:30] INFO	k = 3
[09/04/21 13:16:30] INFO	k = 6
[09/04/21 13:16:30] INFO	k = 9
[09/04/21 13:16:30] INFO	k = 12
[09/04/21 13:16:30] INFO	k = 15
[09/04/21 13:16:30] INFO	k = 18
[09/04/21 13:16:30] INFO	k = 21
[09/04/21 13:16:30] INFO	k = 24
[09/04/21 13:16:30] INFO	k = 27
[09/04/21 13:16:30] INFO	k = 30
[09/04/21 13:16:30] INFO	Clustering Feature Count : 10
[09/04/21 13:16:30] INFO	New Feature Count : 35
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Creating Interactions
[09/04/21 13:16:30] INFO	Initial Feature Count  : 35
[09/04/21 13:16:30] INFO	Skipping Interactions
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Removing Low-Variance Features
[09/04/21 13:16:30] INFO	Low-Variance Threshold  : 0.10
[09/04/21 13:16:30] INFO	Original Feature Count  : 35
[09/04/21 13:16:30] INFO	Reduced Feature Count   : 35
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Skipping Shuffling
[09/04/21 13:16:30] INFO	Skipping Sampling
[09/04/21 13:16:30] INFO	Getting All Estimators
[09/04/21 13:16:30] INFO	Algorithm Configuration
[09/04/21 13:16:31] INFO	Selecting Models
[09/04/21 13:16:31] INFO	Algorithm: CATB
[09/04/21 13:16:31] INFO	Fitting Initial Model
[09/04/21 13:16:31] INFO	Cross-Validation
[09/04/21 13:16:33] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/04/21 13:16:33] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:35] INFO	RFECV took 2.48 seconds for step 3 and 3 folds
[09/04/21 13:16:35] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/04/21 13:16:35] INFO	No grid is defined for grid search
[09/04/21 13:16:35] INFO	Final Model Predictions for CATB
[09/04/21 13:16:35] INFO	Skipping Calibration
[09/04/21 13:16:35] INFO	Making Predictions
[09/04/21 13:16:35] INFO	Predictions Complete
[09/04/21 13:16:35] INFO	Algorithm: LGB
[09/04/21 13:16:35] INFO	Fitting Initial Model
[09/04/21 13:16:35] INFO	Cross-Validation
[09/04/21 13:16:36] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/04/21 13:16:36] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:39] INFO	RFECV took 2.99 seconds for step 3 and 3 folds
[09/04/21 13:16:39] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/04/21 13:16:39] INFO	No grid is defined for grid search
[09/04/21 13:16:39] INFO	Final Model Predictions for LGB
[09/04/21 13:16:39] INFO	Skipping Calibration
[09/04/21 13:16:39] INFO	Making Predictions
[09/04/21 13:16:39] INFO	Predictions Complete
[09/04/21 13:16:39] INFO	Algorithm: XGB
[09/04/21 13:16:39] INFO	Fitting Initial Model
[09/04/21 13:16:39] INFO	Cross-Validation
[09/04/21 13:16:39] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/04/21 13:16:39] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:42] INFO	RFECV took 2.92 seconds for step 3 and 3 folds
[09/04/21 13:16:42] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/04/21 13:16:42] INFO	Randomized Grid Search
[09/04/21 13:17:46] INFO	Grid Search took 64.01 seconds for 50 candidate parameter settings.
[09/04/21 13:17:46] INFO	Model with rank: 1
[09/04/21 13:17:46] INFO	Mean validation score: 0.873 (std: 0.023)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[09/04/21 13:17:46] INFO	Model with rank: 2
[09/04/21 13:17:46] INFO	Mean validation score: 0.871 (std: 0.013)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[09/04/21 13:17:46] INFO	Model with rank: 3
[09/04/21 13:17:46] INFO	Mean validation score: 0.870 (std: 0.020)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[09/04/21 13:17:46] INFO	Algorithm: XGB, Best Score: 0.8729, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[09/04/21 13:17:46] INFO	Final Model Predictions for XGB
[09/04/21 13:17:46] INFO	Skipping Calibration
[09/04/21 13:17:46] INFO	Making Predictions
[09/04/21 13:17:46] INFO	Predictions Complete
[09/04/21 13:17:46] INFO	Blending Models
[09/04/21 13:17:46] INFO	Blending Start: 2021-09-04 13:17:46.381270
[09/04/21 13:17:46] INFO	Blending Complete: 0:00:00.015735
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Metrics for: Partition.train
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: CATB
[09/04/21 13:17:46] INFO	accuracy: 0.8585858585858586
[09/04/21 13:17:46] INFO	average_precision: 0.9113351686222868
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.8378391333525069
[09/04/21 13:17:46] INFO	brier_score_loss: 0.10043404518351136
[09/04/21 13:17:46] INFO	cohen_kappa: 0.6932572665125658
[09/04/21 13:17:46] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/04/21 13:17:46] INFO	f1: 0.8025078369905956
[09/04/21 13:17:46] INFO	neg_log_loss: 0.3371948718196211
[09/04/21 13:17:46] INFO	precision: 0.8648648648648649
[09/04/21 13:17:46] INFO	recall: 0.7485380116959064
[09/04/21 13:17:46] INFO	roc_auc: 0.9297979313797549
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: LGB
[09/04/21 13:17:46] INFO	accuracy: 0.9730639730639731
[09/04/21 13:17:46] INFO	average_precision: 0.9961113207491221
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.9687709711437062
[09/04/21 13:17:46] INFO	brier_score_loss: 0.032809498448974184
[09/04/21 13:17:46] INFO	cohen_kappa: 0.9427387092109702
[09/04/21 13:17:46] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/04/21 13:17:46] INFO	f1: 0.9643916913946586
[09/04/21 13:17:46] INFO	neg_log_loss: 0.1458307566281259
[09/04/21 13:17:46] INFO	precision: 0.9789156626506024
[09/04/21 13:17:46] INFO	recall: 0.9502923976608187
[09/04/21 13:17:46] INFO	roc_auc: 0.9974861257576241
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: XGB
[09/04/21 13:17:46] INFO	accuracy: 0.9057239057239057
[09/04/21 13:17:46] INFO	average_precision: 0.9470768333074432
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.8882178122902886
[09/04/21 13:17:46] INFO	brier_score_loss: 0.1749366357341051
[09/04/21 13:17:46] INFO	cohen_kappa: 0.7957359009628611
[09/04/21 13:17:46] INFO	confusion_matrix: [[529  20]
 [ 64 278]]
[09/04/21 13:17:46] INFO	f1: 0.8687500000000001
[09/04/21 13:17:46] INFO	neg_log_loss: 0.5403209037317839
[09/04/21 13:17:46] INFO	precision: 0.9328859060402684
[09/04/21 13:17:46] INFO	recall: 0.8128654970760234
[09/04/21 13:17:46] INFO	roc_auc: 0.9570138156563236
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Metrics for: Partition.test
[09/04/21 13:17:46] INFO	No labels for generating Partition.test metrics
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Selecting Best Model
[09/04/21 13:17:46] INFO	Scoring for: Partition.train
[09/04/21 13:17:46] INFO	Best Model Selection Start: 2021-09-04 13:17:46.419438
[09/04/21 13:17:46] INFO	Scoring CATB Model
[09/04/21 13:17:46] INFO	Scoring LGB Model
[09/04/21 13:17:46] INFO	Scoring XGB Model
[09/04/21 13:17:46] INFO	Scoring BLEND Model
[09/04/21 13:17:46] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/04/21 13:17:46] INFO	Best Model Selection Complete: 0:00:00.000198
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Generating Plots for partition: train
[09/04/21 13:17:46] INFO	Generating Calibration Plot
[09/04/21 13:17:46] INFO	Calibration for Algorithm: CATB
[09/04/21 13:17:46] INFO	Calibration for Algorithm: LGB
[09/04/21 13:17:46] INFO	Calibration for Algorithm: XGB
[09/04/21 13:17:46] INFO	Writing plot to ./plots/calibration_train.png
[09/04/21 13:17:46] INFO	Generating Confusion Matrices
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: CATB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[509  40]
 [ 86 256]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: LGB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[542   7]
 [ 17 325]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: XGB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[529  20]
 [ 64 278]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/04/21 13:17:46] INFO	Generating ROC Curves
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: CATB
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: LGB
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: XGB
[09/04/21 13:17:46] INFO	Writing plot to ./plots/roc_curve_train.png
[09/04/21 13:17:46] INFO	Generating Learning Curves
[09/04/21 13:17:46] INFO	Algorithm Configuration
[09/04/21 13:17:47] INFO	Learning Curve for Algorithm: CATB
[09/04/21 13:17:47] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/04/21 13:17:47] INFO	Learning Curve for Algorithm: LGB
[09/04/21 13:17:49] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/04/21 13:17:49] INFO	Learning Curve for Algorithm: XGB
[09/04/21 13:17:50] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/04/21 13:17:50] INFO	Generating Feature Importance Plots
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: CATB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Sex_factor (45.178104)
[09/04/21 13:17:50] INFO	2. Pclass (13.721171)
[09/04/21 13:17:50] INFO	3. Age (6.651788)
[09/04/21 13:17:50] INFO	4. Fare (4.529770)
[09/04/21 13:17:50] INFO	5. var (3.586590)
[09/04/21 13:17:50] INFO	6. std (3.492385)
[09/04/21 13:17:50] INFO	7. Ticket_factor (3.315046)
[09/04/21 13:17:50] INFO	8. cluster_30 (2.831587)
[09/04/21 13:17:50] INFO	9. mean (2.733389)
[09/04/21 13:17:50] INFO	10. Name_factor (2.586310)
[09/04/21 13:17:50] INFO	11. Cabin_factor (2.101764)
[09/04/21 13:17:50] INFO	12. Embarked (2.086410)
[09/04/21 13:17:50] INFO	13. SibSp (2.085405)
[09/04/21 13:17:50] INFO	14. cluster_12 (1.876782)
[09/04/21 13:17:50] INFO	15. cluster_24 (1.263144)
[09/04/21 13:17:50] INFO	16. count_2 (1.004409)
[09/04/21 13:17:50] INFO	17. sum (0.955946)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: LGB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Fare (256.000000)
[09/04/21 13:17:50] INFO	2. sum (241.000000)
[09/04/21 13:17:50] INFO	3. Age (232.000000)
[09/04/21 13:17:50] INFO	4. std (201.000000)
[09/04/21 13:17:50] INFO	5. Ticket_factor (199.000000)
[09/04/21 13:17:50] INFO	6. Name_factor (175.000000)
[09/04/21 13:17:50] INFO	7. cluster_30 (53.000000)
[09/04/21 13:17:50] INFO	8. cluster_27 (46.000000)
[09/04/21 13:17:50] INFO	9. Sex_factor (43.000000)
[09/04/21 13:17:50] INFO	10. Pclass (43.000000)
[09/04/21 13:17:50] INFO	11. Cabin_factor (41.000000)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: XGB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Sex_factor (0.424644)
[09/04/21 13:17:50] INFO	2. Pclass (0.127452)
[09/04/21 13:17:50] INFO	3. Cabin_factor (0.081307)
[09/04/21 13:17:50] INFO	4. Age (0.051007)
[09/04/21 13:17:50] INFO	5. SibSp (0.049620)
[09/04/21 13:17:50] INFO	6. count_1 (0.046373)
[09/04/21 13:17:50] INFO	7. Embarked (0.046225)
[09/04/21 13:17:50] INFO	8. std (0.036262)
[09/04/21 13:17:50] INFO	9. cluster_30 (0.036076)
[09/04/21 13:17:50] INFO	10. Fare (0.032410)
[09/04/21 13:17:50] INFO	11. cluster_24 (0.021187)
[09/04/21 13:17:50] INFO	12. Name_factor (0.019312)
[09/04/21 13:17:50] INFO	13. sum (0.017784)
[09/04/21 13:17:50] INFO	14. cluster_15 (0.010340)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/04/21 13:17:50] INFO	================================================================================
[09/04/21 13:17:50] INFO	Saving Model Predictor
[09/04/21 13:17:50] INFO	Writing model predictor to ./model/model_20210904.pkl
[09/04/21 13:17:50] INFO	Saving Feature Map
[09/04/21 13:17:50] INFO	Writing feature map to ./model/feature_map_20210904.pkl
[09/04/21 13:17:50] INFO	Loading data from ./input/test_20210904.csv
[09/04/21 13:17:50] INFO	Saving Predictions
[09/04/21 13:17:50] INFO	Writing data frame to ./output/predictions_20210904.csv
[09/04/21 13:17:50] INFO	Saving Probabilities
[09/04/21 13:17:50] INFO	Writing data frame to ./output/probabilities_20210904.csv
[09/04/21 13:17:50] INFO	Saving Ranked Predictions
[09/04/21 13:17:50] INFO	Writing data frame to ./output/rankings_20210904.csv
[09/04/21 13:17:50] INFO	Saving Submission to ./output/submission_20210904.csv
[09/04/21 13:17:50] INFO	********************************************************************************
[09/04/21 13:17:50] INFO	AlphaPy End
[09/04/21 13:17:50] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	AlphaPy Start
[09/16/21 09:12:25] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	Model Configuration
[09/16/21 09:14:31] INFO	********************************************************************************
[09/16/21 09:14:31] INFO	AlphaPy Start
[09/16/21 09:14:31] INFO	********************************************************************************
[09/16/21 09:14:31] INFO	Model Configuration
[09/16/21 09:14:31] INFO	No transforms Found
[09/16/21 09:14:31] INFO	MODEL PARAMETERS:
[09/16/21 09:14:31] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/16/21 09:14:31] INFO	calibration       = False
[09/16/21 09:14:31] INFO	cal_type          = sigmoid
[09/16/21 09:14:31] INFO	calibration_plot  = False
[09/16/21 09:14:31] INFO	clustering        = True
[09/16/21 09:14:31] INFO	cluster_inc       = 3
[09/16/21 09:14:31] INFO	cluster_max       = 30
[09/16/21 09:14:31] INFO	cluster_min       = 3
[09/16/21 09:14:31] INFO	confusion_matrix  = True
[09/16/21 09:14:31] INFO	counts            = True
[09/16/21 09:14:31] INFO	cv_folds          = 3
[09/16/21 09:14:31] INFO	directory         = .
[09/16/21 09:14:31] INFO	extension         = csv
[09/16/21 09:14:31] INFO	drop              = ['PassengerId']
[09/16/21 09:14:31] INFO	encoder           = <Encoders.target: 14>
[09/16/21 09:14:31] INFO	esr               = 20
[09/16/21 09:14:31] INFO	factors           = ['Embarked']
[09/16/21 09:14:31] INFO	features [X]      = *
[09/16/21 09:14:31] INFO	feature_selection = False
[09/16/21 09:14:31] INFO	fs_percentage     = 50
[09/16/21 09:14:31] INFO	fs_score_func     = <function f_classif at 0x7fa8c2d9a8b0>
[09/16/21 09:14:31] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/16/21 09:14:31] INFO	grid_search       = True
[09/16/21 09:14:31] INFO	gs_iters          = 50
[09/16/21 09:14:31] INFO	gs_random         = True
[09/16/21 09:14:31] INFO	gs_sample         = False
[09/16/21 09:14:31] INFO	gs_sample_pct     = 0.200000
[09/16/21 09:14:31] INFO	importances       = True
[09/16/21 09:14:31] INFO	interactions      = False
[09/16/21 09:14:31] INFO	isomap            = False
[09/16/21 09:14:31] INFO	iso_components    = 2
[09/16/21 09:14:31] INFO	iso_neighbors     = 5
[09/16/21 09:14:31] INFO	isample_pct       = 10
[09/16/21 09:14:31] INFO	leaders           = []
[09/16/21 09:14:31] INFO	learning_curve    = True
[09/16/21 09:14:31] INFO	logtransform      = False
[09/16/21 09:14:31] INFO	lv_remove         = True
[09/16/21 09:14:31] INFO	lv_threshold      = 0.100000
[09/16/21 09:14:31] INFO	model_type        = <ModelType.classification: 1>
[09/16/21 09:14:31] INFO	n_estimators      = 51
[09/16/21 09:14:31] INFO	n_jobs            = -1
[09/16/21 09:14:31] INFO	ngrams_max        = 2
[09/16/21 09:14:31] INFO	numpy             = True
[09/16/21 09:14:31] INFO	pca               = False
[09/16/21 09:14:31] INFO	pca_inc           = 1
[09/16/21 09:14:31] INFO	pca_max           = 10
[09/16/21 09:14:31] INFO	pca_min           = 2
[09/16/21 09:14:31] INFO	pca_whiten        = False
[09/16/21 09:14:31] INFO	poly_degree       = 2
[09/16/21 09:14:31] INFO	pvalue_level      = 0.010000
[09/16/21 09:14:31] INFO	rfe               = True
[09/16/21 09:14:31] INFO	rfe_step          = 3
[09/16/21 09:14:31] INFO	roc_curve         = True
[09/16/21 09:14:31] INFO	rounding          = 2
[09/16/21 09:14:31] INFO	sampling          = False
[09/16/21 09:14:31] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/16/21 09:14:31] INFO	sampling_ratio    = 0.500000
[09/16/21 09:14:31] INFO	scaler_option     = True
[09/16/21 09:14:31] INFO	scaler_type       = <Scalers.standard: 2>
[09/16/21 09:14:31] INFO	scipy             = False
[09/16/21 09:14:31] INFO	scorer            = roc_auc
[09/16/21 09:14:31] INFO	seed              = 42
[09/16/21 09:14:31] INFO	sentinel          = -1
[09/16/21 09:14:31] INFO	separator         = ,
[09/16/21 09:14:31] INFO	shuffle           = False
[09/16/21 09:14:31] INFO	split             = 0.400000
[09/16/21 09:14:31] INFO	submission_file   = gender_submission
[09/16/21 09:14:31] INFO	submit_probas     = False
[09/16/21 09:14:31] INFO	target [y]        = Survived
[09/16/21 09:14:31] INFO	target_value      = 1
[09/16/21 09:14:31] INFO	transforms        = None
[09/16/21 09:14:31] INFO	tsne              = False
[09/16/21 09:14:31] INFO	tsne_components   = 2
[09/16/21 09:14:31] INFO	tsne_learn_rate   = 1000.000000
[09/16/21 09:14:31] INFO	tsne_perplexity   = 30.000000
[09/16/21 09:14:31] INFO	vectorize         = False
[09/16/21 09:14:31] INFO	verbosity         = 0
[09/16/21 09:14:31] INFO	Creating Model
[09/16/21 09:14:31] INFO	Calling Pipeline
[09/16/21 09:14:31] INFO	Training Pipeline
[09/16/21 09:14:31] INFO	Loading Data
[09/16/21 09:14:31] INFO	Loading data from ./input/train.csv
[09/16/21 09:14:31] INFO	Found target Survived in data frame
[09/16/21 09:14:31] INFO	Labels (y) found for Partition.train
[09/16/21 09:14:31] INFO	Loading Data
[09/16/21 09:14:31] INFO	Loading data from ./input/test.csv
[09/16/21 09:14:31] INFO	Target Survived not found in Partition.test
[09/16/21 09:14:31] INFO	Saving New Features in Model
[09/16/21 09:14:31] INFO	Original Feature Statistics
[09/16/21 09:14:31] INFO	Number of Training Rows    : 891
[09/16/21 09:14:31] INFO	Number of Training Columns : 11
[09/16/21 09:14:31] INFO	Unique Training Values for Survived : [0 1]
[09/16/21 09:14:31] INFO	Unique Training Counts for Survived : [549 342]
[09/16/21 09:14:31] INFO	Number of Testing Rows     : 418
[09/16/21 09:14:31] INFO	Number of Testing Columns  : 11
[09/16/21 09:14:31] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:14:31] INFO	Feature Count     : 11
[09/16/21 09:14:31] INFO	Applying transforms
[09/16/21 09:14:31] INFO	No transforms Specified
[09/16/21 09:14:31] INFO	New Feature Count : 11
[09/16/21 09:14:31] INFO	Dropping Features: ['PassengerId']
[09/16/21 09:14:31] INFO	Original Feature Count : 11
[09/16/21 09:14:31] INFO	Reduced Feature Count  : 10
[09/16/21 09:14:31] INFO	Writing data frame to ./input/train_20210916.csv
[09/16/21 09:14:31] INFO	Writing data frame to ./input/test_20210916.csv
[09/16/21 09:14:31] INFO	Creating Cross-Tabulations
[09/16/21 09:14:31] INFO	Creating crosstabs for feature Embarked
[09/16/21 09:14:31] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:14:31] INFO	Feature Count     : 10
[09/16/21 09:14:31] INFO	Creating Count Features
[09/16/21 09:14:31] INFO	NA Counts
[09/16/21 09:14:31] INFO	Number Counts
[09/16/21 09:14:31] INFO	New Feature Count : 21
[09/16/21 09:14:31] INFO	Creating Base Features
[09/16/21 09:14:31] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/16/21 09:14:31] INFO	Feature 2: Name => Factorization
[09/16/21 09:14:31] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/16/21 09:14:31] INFO	Feature 3: Sex => Factorization
[09/16/21 09:14:31] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/16/21 09:14:31] INFO	Feature 7: Ticket => Factorization
[09/16/21 09:14:31] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/16/21 09:14:31] INFO	Feature 9: Cabin => Factorization
[09/16/21 09:14:31] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/16/21 09:14:31] INFO	Encoding: Encoders.target
[09/16/21 09:14:31] INFO	Fitting training features for Embarked
[09/16/21 09:14:31] INFO	Transforming testing features for Embarked
[09/16/21 09:14:31] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	New Feature Count : 21
[09/16/21 09:14:31] INFO	Scaling Base Features
[09/16/21 09:14:31] INFO	Creating NumPy Features
[09/16/21 09:14:31] INFO	NumPy Feature: sum
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: mean
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: std
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: var
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature Count : 4
[09/16/21 09:14:31] INFO	New Feature Count : 25
[09/16/21 09:14:31] INFO	Creating Clustering Features
[09/16/21 09:14:31] INFO	Cluster Minimum   : 3
[09/16/21 09:14:31] INFO	Cluster Maximum   : 30
[09/16/21 09:14:31] INFO	Cluster Increment : 3
[09/16/21 09:14:31] INFO	k = 3
[09/16/21 09:14:32] INFO	k = 6
[09/16/21 09:14:32] INFO	k = 9
[09/16/21 09:14:32] INFO	k = 12
[09/16/21 09:14:32] INFO	k = 15
[09/16/21 09:14:32] INFO	k = 18
[09/16/21 09:14:32] INFO	k = 21
[09/16/21 09:14:32] INFO	k = 24
[09/16/21 09:14:32] INFO	k = 27
[09/16/21 09:14:32] INFO	k = 30
[09/16/21 09:14:32] INFO	Clustering Feature Count : 10
[09/16/21 09:14:32] INFO	New Feature Count : 35
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Creating Interactions
[09/16/21 09:14:32] INFO	Initial Feature Count  : 35
[09/16/21 09:14:32] INFO	Skipping Interactions
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Removing Low-Variance Features
[09/16/21 09:14:32] INFO	Low-Variance Threshold  : 0.10
[09/16/21 09:14:32] INFO	Original Feature Count  : 35
[09/16/21 09:14:32] INFO	Reduced Feature Count   : 35
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Skipping Shuffling
[09/16/21 09:14:32] INFO	Skipping Sampling
[09/16/21 09:14:32] INFO	Getting All Estimators
[09/16/21 09:14:32] INFO	Algorithm Configuration
[09/16/21 09:14:33] INFO	Selecting Models
[09/16/21 09:14:33] INFO	Algorithm: CATB
[09/16/21 09:14:33] INFO	Fitting Initial Model
[09/16/21 09:14:33] INFO	Cross-Validation
[09/16/21 09:14:34] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/16/21 09:14:34] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:37] INFO	RFECV took 2.51 seconds for step 3 and 3 folds
[09/16/21 09:14:37] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/16/21 09:14:37] INFO	No grid is defined for grid search
[09/16/21 09:14:37] INFO	Final Model Predictions for CATB
[09/16/21 09:14:37] INFO	Skipping Calibration
[09/16/21 09:14:37] INFO	Making Predictions
[09/16/21 09:14:37] INFO	Predictions Complete
[09/16/21 09:14:37] INFO	Algorithm: LGB
[09/16/21 09:14:37] INFO	Fitting Initial Model
[09/16/21 09:14:37] INFO	Cross-Validation
[09/16/21 09:14:38] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/16/21 09:14:38] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:40] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[09/16/21 09:14:40] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/16/21 09:14:40] INFO	No grid is defined for grid search
[09/16/21 09:14:40] INFO	Final Model Predictions for LGB
[09/16/21 09:14:40] INFO	Skipping Calibration
[09/16/21 09:14:40] INFO	Making Predictions
[09/16/21 09:14:40] INFO	Predictions Complete
[09/16/21 09:14:40] INFO	Algorithm: XGB
[09/16/21 09:14:40] INFO	Fitting Initial Model
[09/16/21 09:14:40] INFO	Cross-Validation
[09/16/21 09:14:41] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/16/21 09:14:41] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:44] INFO	RFECV took 2.95 seconds for step 3 and 3 folds
[09/16/21 09:14:44] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/16/21 09:14:44] INFO	Randomized Grid Search
[09/16/21 09:16:11] INFO	Grid Search took 87.56 seconds for 50 candidate parameter settings.
[09/16/21 09:16:11] INFO	Model with rank: 1
[09/16/21 09:16:11] INFO	Mean validation score: 0.872 (std: 0.021)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Model with rank: 2
[09/16/21 09:16:11] INFO	Mean validation score: 0.870 (std: 0.024)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[09/16/21 09:16:11] INFO	Model with rank: 3
[09/16/21 09:16:11] INFO	Mean validation score: 0.869 (std: 0.021)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Algorithm: XGB, Best Score: 0.8718, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Final Model Predictions for XGB
[09/16/21 09:16:11] INFO	Skipping Calibration
[09/16/21 09:16:11] INFO	Making Predictions
[09/16/21 09:16:11] INFO	Predictions Complete
[09/16/21 09:16:11] INFO	Blending Models
[09/16/21 09:16:11] INFO	Blending Start: 2021-09-16 09:16:11.760483
[09/16/21 09:16:11] INFO	Blending Complete: 0:00:00.015313
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Metrics for: Partition.train
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: CATB
[09/16/21 09:16:11] INFO	accuracy: 0.8585858585858586
[09/16/21 09:16:11] INFO	average_precision: 0.9113351686222868
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.8378391333525069
[09/16/21 09:16:11] INFO	brier_score_loss: 0.10043404518351136
[09/16/21 09:16:11] INFO	cohen_kappa: 0.6932572665125658
[09/16/21 09:16:11] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/16/21 09:16:11] INFO	f1: 0.8025078369905956
[09/16/21 09:16:11] INFO	neg_log_loss: 0.3371948718196211
[09/16/21 09:16:11] INFO	precision: 0.8648648648648649
[09/16/21 09:16:11] INFO	recall: 0.7485380116959064
[09/16/21 09:16:11] INFO	roc_auc: 0.9297979313797549
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: LGB
[09/16/21 09:16:11] INFO	accuracy: 0.9730639730639731
[09/16/21 09:16:11] INFO	average_precision: 0.9961113207491221
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.9687709711437062
[09/16/21 09:16:11] INFO	brier_score_loss: 0.032809498448974184
[09/16/21 09:16:11] INFO	cohen_kappa: 0.9427387092109702
[09/16/21 09:16:11] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/16/21 09:16:11] INFO	f1: 0.9643916913946586
[09/16/21 09:16:11] INFO	neg_log_loss: 0.1458307566281259
[09/16/21 09:16:11] INFO	precision: 0.9789156626506024
[09/16/21 09:16:11] INFO	recall: 0.9502923976608187
[09/16/21 09:16:11] INFO	roc_auc: 0.9974861257576241
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: XGB
[09/16/21 09:16:11] INFO	accuracy: 0.9236812570145904
[09/16/21 09:16:11] INFO	average_precision: 0.9698555146807429
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.9088534176972486
[09/16/21 09:16:11] INFO	brier_score_loss: 0.0753543675763611
[09/16/21 09:16:11] INFO	cohen_kappa: 0.8352019583843329
[09/16/21 09:16:11] INFO	confusion_matrix: [[534  15]
 [ 53 289]]
[09/16/21 09:16:11] INFO	f1: 0.8947368421052633
[09/16/21 09:16:11] INFO	neg_log_loss: 0.2905843097352821
[09/16/21 09:16:11] INFO	precision: 0.9506578947368421
[09/16/21 09:16:11] INFO	recall: 0.8450292397660819
[09/16/21 09:16:11] INFO	roc_auc: 0.9783018566452562
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Metrics for: Partition.test
[09/16/21 09:16:11] INFO	No labels for generating Partition.test metrics
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Selecting Best Model
[09/16/21 09:16:11] INFO	Scoring for: Partition.train
[09/16/21 09:16:11] INFO	Best Model Selection Start: 2021-09-16 09:16:11.799109
[09/16/21 09:16:11] INFO	Scoring CATB Model
[09/16/21 09:16:11] INFO	Scoring LGB Model
[09/16/21 09:16:11] INFO	Scoring XGB Model
[09/16/21 09:16:11] INFO	Scoring BLEND Model
[09/16/21 09:16:11] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[09/16/21 09:16:11] INFO	Best Model Selection Complete: 0:00:00.000213
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Generating Plots for partition: train
[09/16/21 09:16:11] INFO	Generating Calibration Plot
[09/16/21 09:16:11] INFO	Calibration for Algorithm: CATB
[09/16/21 09:16:11] INFO	Calibration for Algorithm: LGB
[09/16/21 09:16:11] INFO	Calibration for Algorithm: XGB
[09/16/21 09:16:11] INFO	Writing plot to ./plots/calibration_train.png
[09/16/21 09:16:11] INFO	Generating Confusion Matrices
[09/16/21 09:16:11] INFO	Confusion Matrix for Algorithm: CATB
[09/16/21 09:16:11] INFO	Confusion Matrix:
[09/16/21 09:16:11] INFO	[[509  40]
 [ 86 256]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/16/21 09:16:12] INFO	Confusion Matrix for Algorithm: LGB
[09/16/21 09:16:12] INFO	Confusion Matrix:
[09/16/21 09:16:12] INFO	[[542   7]
 [ 17 325]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/16/21 09:16:12] INFO	Confusion Matrix for Algorithm: XGB
[09/16/21 09:16:12] INFO	Confusion Matrix:
[09/16/21 09:16:12] INFO	[[534  15]
 [ 53 289]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/16/21 09:16:12] INFO	Generating ROC Curves
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: CATB
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: LGB
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: XGB
[09/16/21 09:16:12] INFO	Writing plot to ./plots/roc_curve_train.png
[09/16/21 09:16:12] INFO	Generating Learning Curves
[09/16/21 09:16:12] INFO	Algorithm Configuration
[09/16/21 09:16:12] INFO	Learning Curve for Algorithm: CATB
[09/16/21 09:16:12] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/16/21 09:16:13] INFO	Learning Curve for Algorithm: LGB
[09/16/21 09:16:14] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/16/21 09:16:14] INFO	Learning Curve for Algorithm: XGB
[09/16/21 09:16:15] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/16/21 09:16:15] INFO	Generating Feature Importance Plots
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: CATB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Sex_factor (45.178104)
[09/16/21 09:16:15] INFO	2. Pclass (13.721171)
[09/16/21 09:16:15] INFO	3. Age (6.651788)
[09/16/21 09:16:15] INFO	4. Fare (4.529770)
[09/16/21 09:16:15] INFO	5. var (3.586590)
[09/16/21 09:16:15] INFO	6. std (3.492385)
[09/16/21 09:16:15] INFO	7. Ticket_factor (3.315046)
[09/16/21 09:16:15] INFO	8. cluster_30 (2.831587)
[09/16/21 09:16:15] INFO	9. mean (2.733389)
[09/16/21 09:16:15] INFO	10. Name_factor (2.586310)
[09/16/21 09:16:15] INFO	11. Cabin_factor (2.101764)
[09/16/21 09:16:15] INFO	12. Embarked (2.086410)
[09/16/21 09:16:15] INFO	13. SibSp (2.085405)
[09/16/21 09:16:15] INFO	14. cluster_12 (1.876782)
[09/16/21 09:16:15] INFO	15. cluster_24 (1.263144)
[09/16/21 09:16:15] INFO	16. count_2 (1.004409)
[09/16/21 09:16:15] INFO	17. sum (0.955946)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: LGB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Fare (256.000000)
[09/16/21 09:16:15] INFO	2. sum (241.000000)
[09/16/21 09:16:15] INFO	3. Age (232.000000)
[09/16/21 09:16:15] INFO	4. std (201.000000)
[09/16/21 09:16:15] INFO	5. Ticket_factor (199.000000)
[09/16/21 09:16:15] INFO	6. Name_factor (175.000000)
[09/16/21 09:16:15] INFO	7. cluster_30 (53.000000)
[09/16/21 09:16:15] INFO	8. cluster_27 (46.000000)
[09/16/21 09:16:15] INFO	9. Sex_factor (43.000000)
[09/16/21 09:16:15] INFO	10. Pclass (43.000000)
[09/16/21 09:16:15] INFO	11. Cabin_factor (41.000000)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: XGB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Sex_factor (0.424644)
[09/16/21 09:16:15] INFO	2. Pclass (0.127452)
[09/16/21 09:16:15] INFO	3. Cabin_factor (0.081307)
[09/16/21 09:16:15] INFO	4. Age (0.051007)
[09/16/21 09:16:15] INFO	5. SibSp (0.049620)
[09/16/21 09:16:15] INFO	6. count_1 (0.046373)
[09/16/21 09:16:15] INFO	7. Embarked (0.046225)
[09/16/21 09:16:15] INFO	8. std (0.036262)
[09/16/21 09:16:15] INFO	9. cluster_30 (0.036076)
[09/16/21 09:16:15] INFO	10. Fare (0.032410)
[09/16/21 09:16:15] INFO	11. cluster_24 (0.021187)
[09/16/21 09:16:15] INFO	12. Name_factor (0.019312)
[09/16/21 09:16:15] INFO	13. sum (0.017784)
[09/16/21 09:16:15] INFO	14. cluster_15 (0.010340)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/16/21 09:16:16] INFO	================================================================================
[09/16/21 09:16:16] INFO	Saving Model Predictor
[09/16/21 09:16:16] INFO	Writing model predictor to ./model/model_20210916.pkl
[09/16/21 09:16:16] INFO	Saving Feature Map
[09/16/21 09:16:16] INFO	Writing feature map to ./model/feature_map_20210916.pkl
[09/16/21 09:16:16] INFO	Loading data from ./input/test_20210916.csv
[09/16/21 09:16:16] INFO	Saving Predictions
[09/16/21 09:16:16] INFO	Writing data frame to ./output/predictions_20210916.csv
[09/16/21 09:16:16] INFO	Saving Probabilities
[09/16/21 09:16:16] INFO	Writing data frame to ./output/probabilities_20210916.csv
[09/16/21 09:16:16] INFO	Saving Ranked Predictions
[09/16/21 09:16:16] INFO	Writing data frame to ./output/rankings_20210916.csv
[09/16/21 09:16:16] INFO	Saving Submission to ./output/submission_20210916.csv
[09/16/21 09:16:16] INFO	********************************************************************************
[09/16/21 09:16:16] INFO	AlphaPy End
[09/16/21 09:16:16] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	AlphaPy Start
[09/16/21 09:16:49] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	Model Configuration
[09/16/21 09:16:49] INFO	No transforms Found
[09/16/21 09:16:49] INFO	MODEL PARAMETERS:
[09/16/21 09:16:49] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/16/21 09:16:49] INFO	calibration       = False
[09/16/21 09:16:49] INFO	cal_type          = sigmoid
[09/16/21 09:16:49] INFO	calibration_plot  = False
[09/16/21 09:16:49] INFO	clustering        = True
[09/16/21 09:16:49] INFO	cluster_inc       = 3
[09/16/21 09:16:49] INFO	cluster_max       = 30
[09/16/21 09:16:49] INFO	cluster_min       = 3
[09/16/21 09:16:49] INFO	confusion_matrix  = True
[09/16/21 09:16:49] INFO	counts            = True
[09/16/21 09:16:49] INFO	cv_folds          = 3
[09/16/21 09:16:49] INFO	directory         = .
[09/16/21 09:16:49] INFO	extension         = csv
[09/16/21 09:16:49] INFO	drop              = ['PassengerId']
[09/16/21 09:16:49] INFO	encoder           = <Encoders.target: 14>
[09/16/21 09:16:49] INFO	esr               = 20
[09/16/21 09:16:49] INFO	factors           = ['Embarked']
[09/16/21 09:16:49] INFO	features [X]      = *
[09/16/21 09:16:49] INFO	feature_selection = False
[09/16/21 09:16:49] INFO	fs_percentage     = 50
[09/16/21 09:16:49] INFO	fs_score_func     = <function f_classif at 0x7fe57ac8c9d0>
[09/16/21 09:16:49] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/16/21 09:16:49] INFO	grid_search       = True
[09/16/21 09:16:49] INFO	gs_iters          = 50
[09/16/21 09:16:49] INFO	gs_random         = True
[09/16/21 09:16:49] INFO	gs_sample         = False
[09/16/21 09:16:49] INFO	gs_sample_pct     = 0.200000
[09/16/21 09:16:49] INFO	importances       = True
[09/16/21 09:16:49] INFO	interactions      = False
[09/16/21 09:16:49] INFO	isomap            = False
[09/16/21 09:16:49] INFO	iso_components    = 2
[09/16/21 09:16:49] INFO	iso_neighbors     = 5
[09/16/21 09:16:49] INFO	isample_pct       = 10
[09/16/21 09:16:49] INFO	leaders           = []
[09/16/21 09:16:49] INFO	learning_curve    = True
[09/16/21 09:16:49] INFO	logtransform      = False
[09/16/21 09:16:49] INFO	lv_remove         = True
[09/16/21 09:16:49] INFO	lv_threshold      = 0.100000
[09/16/21 09:16:49] INFO	model_type        = <ModelType.classification: 1>
[09/16/21 09:16:49] INFO	n_estimators      = 51
[09/16/21 09:16:49] INFO	n_jobs            = -1
[09/16/21 09:16:49] INFO	ngrams_max        = 2
[09/16/21 09:16:49] INFO	numpy             = True
[09/16/21 09:16:49] INFO	pca               = False
[09/16/21 09:16:49] INFO	pca_inc           = 1
[09/16/21 09:16:49] INFO	pca_max           = 10
[09/16/21 09:16:49] INFO	pca_min           = 2
[09/16/21 09:16:49] INFO	pca_whiten        = False
[09/16/21 09:16:49] INFO	poly_degree       = 2
[09/16/21 09:16:49] INFO	pvalue_level      = 0.010000
[09/16/21 09:16:49] INFO	rfe               = True
[09/16/21 09:16:49] INFO	rfe_step          = 3
[09/16/21 09:16:49] INFO	roc_curve         = True
[09/16/21 09:16:49] INFO	rounding          = 2
[09/16/21 09:16:49] INFO	sampling          = False
[09/16/21 09:16:49] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/16/21 09:16:49] INFO	sampling_ratio    = 0.500000
[09/16/21 09:16:49] INFO	scaler_option     = True
[09/16/21 09:16:49] INFO	scaler_type       = <Scalers.standard: 2>
[09/16/21 09:16:49] INFO	scipy             = False
[09/16/21 09:16:49] INFO	scorer            = roc_auc
[09/16/21 09:16:49] INFO	seed              = 42
[09/16/21 09:16:49] INFO	sentinel          = -1
[09/16/21 09:16:49] INFO	separator         = ,
[09/16/21 09:16:49] INFO	shuffle           = False
[09/16/21 09:16:49] INFO	split             = 0.400000
[09/16/21 09:16:49] INFO	submission_file   = gender_submission
[09/16/21 09:16:49] INFO	submit_probas     = False
[09/16/21 09:16:49] INFO	target [y]        = Survived
[09/16/21 09:16:49] INFO	target_value      = 1
[09/16/21 09:16:49] INFO	transforms        = None
[09/16/21 09:16:49] INFO	tsne              = False
[09/16/21 09:16:49] INFO	tsne_components   = 2
[09/16/21 09:16:49] INFO	tsne_learn_rate   = 1000.000000
[09/16/21 09:16:49] INFO	tsne_perplexity   = 30.000000
[09/16/21 09:16:49] INFO	vectorize         = False
[09/16/21 09:16:49] INFO	verbosity         = 0
[09/16/21 09:16:49] INFO	Creating Model
[09/16/21 09:16:49] INFO	Calling Pipeline
[09/16/21 09:16:49] INFO	Training Pipeline
[09/16/21 09:16:49] INFO	Loading Data
[09/16/21 09:16:49] INFO	Loading data from ./input/train.csv
[09/16/21 09:16:49] INFO	Found target Survived in data frame
[09/16/21 09:16:49] INFO	Labels (y) found for Partition.train
[09/16/21 09:16:49] INFO	Loading Data
[09/16/21 09:16:49] INFO	Loading data from ./input/test.csv
[09/16/21 09:16:49] INFO	Target Survived not found in Partition.test
[09/16/21 09:16:49] INFO	Saving New Features in Model
[09/16/21 09:16:49] INFO	Original Feature Statistics
[09/16/21 09:16:49] INFO	Number of Training Rows    : 891
[09/16/21 09:16:49] INFO	Number of Training Columns : 11
[09/16/21 09:16:49] INFO	Unique Training Values for Survived : [0 1]
[09/16/21 09:16:49] INFO	Unique Training Counts for Survived : [549 342]
[09/16/21 09:16:49] INFO	Number of Testing Rows     : 418
[09/16/21 09:16:49] INFO	Number of Testing Columns  : 11
[09/16/21 09:16:49] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:16:49] INFO	Feature Count     : 11
[09/16/21 09:16:49] INFO	Applying transforms
[09/16/21 09:16:49] INFO	No transforms Specified
[09/16/21 09:16:49] INFO	New Feature Count : 11
[09/16/21 09:16:49] INFO	Dropping Features: ['PassengerId']
[09/16/21 09:16:49] INFO	Original Feature Count : 11
[09/16/21 09:16:49] INFO	Reduced Feature Count  : 10
[09/16/21 09:16:49] INFO	Writing data frame to ./input/train_20210916.csv
[09/16/21 09:16:49] INFO	Writing data frame to ./input/test_20210916.csv
[09/16/21 09:16:49] INFO	Creating Cross-Tabulations
[09/16/21 09:16:49] INFO	Creating crosstabs for feature Embarked
[09/16/21 09:16:49] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:16:49] INFO	Feature Count     : 10
[09/16/21 09:16:49] INFO	Creating Count Features
[09/16/21 09:16:49] INFO	NA Counts
[09/16/21 09:16:49] INFO	Number Counts
[09/16/21 09:16:49] INFO	New Feature Count : 21
[09/16/21 09:16:49] INFO	Creating Base Features
[09/16/21 09:16:49] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/16/21 09:16:49] INFO	Feature 2: Name => Factorization
[09/16/21 09:16:49] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/16/21 09:16:49] INFO	Feature 3: Sex => Factorization
[09/16/21 09:16:49] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/16/21 09:16:49] INFO	Feature 7: Ticket => Factorization
[09/16/21 09:16:49] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/16/21 09:16:49] INFO	Feature 9: Cabin => Factorization
[09/16/21 09:16:49] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/16/21 09:16:49] INFO	Encoding: Encoders.target
[09/16/21 09:16:49] INFO	Fitting training features for Embarked
[09/16/21 09:16:49] INFO	Transforming testing features for Embarked
[09/16/21 09:16:49] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	New Feature Count : 21
[09/16/21 09:16:49] INFO	Scaling Base Features
[09/16/21 09:16:49] INFO	Creating NumPy Features
[09/16/21 09:16:49] INFO	NumPy Feature: sum
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: mean
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: std
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: var
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature Count : 4
[09/16/21 09:16:49] INFO	New Feature Count : 25
[09/16/21 09:16:49] INFO	Creating Clustering Features
[09/16/21 09:16:49] INFO	Cluster Minimum   : 3
[09/16/21 09:16:49] INFO	Cluster Maximum   : 30
[09/16/21 09:16:49] INFO	Cluster Increment : 3
[09/16/21 09:16:49] INFO	k = 3
[09/16/21 09:16:50] INFO	k = 6
[09/16/21 09:16:50] INFO	k = 9
[09/16/21 09:16:50] INFO	k = 12
[09/16/21 09:16:50] INFO	k = 15
[09/16/21 09:16:50] INFO	k = 18
[09/16/21 09:16:50] INFO	k = 21
[09/16/21 09:16:50] INFO	k = 24
[09/16/21 09:16:50] INFO	k = 27
[09/16/21 09:16:50] INFO	k = 30
[09/16/21 09:16:50] INFO	Clustering Feature Count : 10
[09/16/21 09:16:50] INFO	New Feature Count : 35
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Creating Interactions
[09/16/21 09:16:50] INFO	Initial Feature Count  : 35
[09/16/21 09:16:50] INFO	Skipping Interactions
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Removing Low-Variance Features
[09/16/21 09:16:50] INFO	Low-Variance Threshold  : 0.10
[09/16/21 09:16:50] INFO	Original Feature Count  : 35
[09/16/21 09:16:50] INFO	Reduced Feature Count   : 35
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Skipping Shuffling
[09/16/21 09:16:50] INFO	Skipping Sampling
[09/16/21 09:16:50] INFO	Getting All Estimators
[09/16/21 09:16:50] INFO	Algorithm Configuration
[09/16/21 09:16:50] INFO	Selecting Models
[09/16/21 09:16:50] INFO	Algorithm: CATB
[09/16/21 09:16:50] INFO	Fitting Initial Model
[09/16/21 09:16:50] INFO	Cross-Validation
[09/16/21 09:16:52] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/16/21 09:16:52] INFO	Recursive Feature Elimination with CV
[09/16/21 09:16:54] INFO	RFECV took 2.58 seconds for step 3 and 3 folds
[09/16/21 09:16:54] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/16/21 09:16:54] INFO	No grid is defined for grid search
[09/16/21 09:16:54] INFO	Final Model Predictions for CATB
[09/16/21 09:16:54] INFO	Skipping Calibration
[09/16/21 09:16:54] INFO	Making Predictions
[09/16/21 09:16:54] INFO	Predictions Complete
[09/16/21 09:16:54] INFO	Algorithm: LGB
[09/16/21 09:16:54] INFO	Fitting Initial Model
[09/16/21 09:16:54] INFO	Cross-Validation
[09/16/21 09:16:55] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/16/21 09:16:55] INFO	Recursive Feature Elimination with CV
[09/16/21 09:16:58] INFO	RFECV took 2.29 seconds for step 3 and 3 folds
[09/16/21 09:16:58] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/16/21 09:16:58] INFO	No grid is defined for grid search
[09/16/21 09:16:58] INFO	Final Model Predictions for LGB
[09/16/21 09:16:58] INFO	Skipping Calibration
[09/16/21 09:16:58] INFO	Making Predictions
[09/16/21 09:16:58] INFO	Predictions Complete
[09/16/21 09:16:58] INFO	Algorithm: XGB
[09/16/21 09:16:58] INFO	Fitting Initial Model
[09/16/21 09:16:58] INFO	Cross-Validation
[09/16/21 09:16:58] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/16/21 09:16:58] INFO	Recursive Feature Elimination with CV
[09/16/21 09:17:01] INFO	RFECV took 2.80 seconds for step 3 and 3 folds
[09/16/21 09:17:01] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/16/21 09:17:01] INFO	Randomized Grid Search
[09/16/21 09:18:18] INFO	Grid Search took 76.63 seconds for 50 candidate parameter settings.
[09/16/21 09:18:18] INFO	Model with rank: 1
[09/16/21 09:18:18] INFO	Mean validation score: 0.872 (std: 0.027)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[09/16/21 09:18:18] INFO	Model with rank: 2
[09/16/21 09:18:18] INFO	Mean validation score: 0.871 (std: 0.023)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:18:18] INFO	Model with rank: 3
[09/16/21 09:18:18] INFO	Mean validation score: 0.871 (std: 0.020)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[09/16/21 09:18:18] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[09/16/21 09:18:18] INFO	Final Model Predictions for XGB
[09/16/21 09:18:18] INFO	Skipping Calibration
[09/16/21 09:18:18] INFO	Making Predictions
[09/16/21 09:18:18] INFO	Predictions Complete
[09/16/21 09:18:18] INFO	Blending Models
[09/16/21 09:18:18] INFO	Blending Start: 2021-09-16 09:18:18.010436
[09/16/21 09:18:18] INFO	Blending Complete: 0:00:00.006903
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Metrics for: Partition.train
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: CATB
[09/16/21 09:18:18] INFO	accuracy: 0.8585858585858586
[09/16/21 09:18:18] INFO	average_precision: 0.9113351686222868
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.8378391333525069
[09/16/21 09:18:18] INFO	brier_score_loss: 0.10043404518351136
[09/16/21 09:18:18] INFO	cohen_kappa: 0.6932572665125658
[09/16/21 09:18:18] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/16/21 09:18:18] INFO	f1: 0.8025078369905956
[09/16/21 09:18:18] INFO	neg_log_loss: 0.3371948718196211
[09/16/21 09:18:18] INFO	precision: 0.8648648648648649
[09/16/21 09:18:18] INFO	recall: 0.7485380116959064
[09/16/21 09:18:18] INFO	roc_auc: 0.9297979313797549
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: LGB
[09/16/21 09:18:18] INFO	accuracy: 0.9730639730639731
[09/16/21 09:18:18] INFO	average_precision: 0.9961113207491221
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.9687709711437062
[09/16/21 09:18:18] INFO	brier_score_loss: 0.032809498448974184
[09/16/21 09:18:18] INFO	cohen_kappa: 0.9427387092109702
[09/16/21 09:18:18] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/16/21 09:18:18] INFO	f1: 0.9643916913946586
[09/16/21 09:18:18] INFO	neg_log_loss: 0.1458307566281259
[09/16/21 09:18:18] INFO	precision: 0.9789156626506024
[09/16/21 09:18:18] INFO	recall: 0.9502923976608187
[09/16/21 09:18:18] INFO	roc_auc: 0.9974861257576241
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: XGB
[09/16/21 09:18:18] INFO	accuracy: 0.9438832772166106
[09/16/21 09:18:18] INFO	average_precision: 0.9803814890043973
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.9335154826958105
[09/16/21 09:18:18] INFO	brier_score_loss: 0.06571987701478049
[09/16/21 09:18:18] INFO	cohen_kappa: 0.8796381850897242
[09/16/21 09:18:18] INFO	confusion_matrix: [[537  12]
 [ 38 304]]
[09/16/21 09:18:18] INFO	f1: 0.9240121580547112
[09/16/21 09:18:18] INFO	neg_log_loss: 0.2629800713532233
[09/16/21 09:18:18] INFO	precision: 0.9620253164556962
[09/16/21 09:18:18] INFO	recall: 0.8888888888888888
[09/16/21 09:18:18] INFO	roc_auc: 0.9853002268878024
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Metrics for: Partition.test
[09/16/21 09:18:18] INFO	No labels for generating Partition.test metrics
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Selecting Best Model
[09/16/21 09:18:18] INFO	Scoring for: Partition.train
[09/16/21 09:18:18] INFO	Best Model Selection Start: 2021-09-16 09:18:18.038152
[09/16/21 09:18:18] INFO	Scoring CATB Model
[09/16/21 09:18:18] INFO	Scoring LGB Model
[09/16/21 09:18:18] INFO	Scoring XGB Model
[09/16/21 09:18:18] INFO	Scoring BLEND Model
[09/16/21 09:18:18] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/16/21 09:18:18] INFO	Best Model Selection Complete: 0:00:00.000200
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Generating Plots for partition: train
[09/16/21 09:18:18] INFO	Generating Calibration Plot
[09/16/21 09:18:18] INFO	Calibration for Algorithm: CATB
[09/16/21 09:18:18] INFO	Calibration for Algorithm: LGB
[09/16/21 09:18:18] INFO	Calibration for Algorithm: XGB
[09/16/21 09:18:18] INFO	Writing plot to ./plots/calibration_train.png
[09/16/21 09:18:18] INFO	Generating Confusion Matrices
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: CATB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[509  40]
 [ 86 256]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: LGB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[542   7]
 [ 17 325]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: XGB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[537  12]
 [ 38 304]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/16/21 09:18:18] INFO	Generating ROC Curves
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: CATB
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: LGB
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: XGB
[09/16/21 09:18:18] INFO	Writing plot to ./plots/roc_curve_train.png
[09/16/21 09:18:18] INFO	Generating Learning Curves
[09/16/21 09:18:18] INFO	Algorithm Configuration
[09/16/21 09:18:18] INFO	Learning Curve for Algorithm: CATB
[09/16/21 09:18:19] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/16/21 09:18:19] INFO	Learning Curve for Algorithm: LGB
[09/16/21 09:18:20] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/16/21 09:18:20] INFO	Learning Curve for Algorithm: XGB
[09/16/21 09:18:21] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/16/21 09:18:21] INFO	Generating Feature Importance Plots
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: CATB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Sex_factor (45.178104)
[09/16/21 09:18:21] INFO	2. Pclass (13.721171)
[09/16/21 09:18:21] INFO	3. Age (6.651788)
[09/16/21 09:18:21] INFO	4. Fare (4.529770)
[09/16/21 09:18:21] INFO	5. var (3.586590)
[09/16/21 09:18:21] INFO	6. std (3.492385)
[09/16/21 09:18:21] INFO	7. Ticket_factor (3.315046)
[09/16/21 09:18:21] INFO	8. cluster_30 (2.831587)
[09/16/21 09:18:21] INFO	9. mean (2.733389)
[09/16/21 09:18:21] INFO	10. Name_factor (2.586310)
[09/16/21 09:18:21] INFO	11. Cabin_factor (2.101764)
[09/16/21 09:18:21] INFO	12. Embarked (2.086410)
[09/16/21 09:18:21] INFO	13. SibSp (2.085405)
[09/16/21 09:18:21] INFO	14. cluster_12 (1.876782)
[09/16/21 09:18:21] INFO	15. cluster_24 (1.263144)
[09/16/21 09:18:21] INFO	16. count_2 (1.004409)
[09/16/21 09:18:21] INFO	17. sum (0.955946)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: LGB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Fare (256.000000)
[09/16/21 09:18:21] INFO	2. sum (241.000000)
[09/16/21 09:18:21] INFO	3. Age (232.000000)
[09/16/21 09:18:21] INFO	4. std (201.000000)
[09/16/21 09:18:21] INFO	5. Ticket_factor (199.000000)
[09/16/21 09:18:21] INFO	6. Name_factor (175.000000)
[09/16/21 09:18:21] INFO	7. cluster_30 (53.000000)
[09/16/21 09:18:21] INFO	8. cluster_27 (46.000000)
[09/16/21 09:18:21] INFO	9. Sex_factor (43.000000)
[09/16/21 09:18:21] INFO	10. Pclass (43.000000)
[09/16/21 09:18:21] INFO	11. Cabin_factor (41.000000)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: XGB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Sex_factor (0.424644)
[09/16/21 09:18:21] INFO	2. Pclass (0.127452)
[09/16/21 09:18:21] INFO	3. Cabin_factor (0.081307)
[09/16/21 09:18:21] INFO	4. Age (0.051007)
[09/16/21 09:18:21] INFO	5. SibSp (0.049620)
[09/16/21 09:18:21] INFO	6. count_1 (0.046373)
[09/16/21 09:18:21] INFO	7. Embarked (0.046225)
[09/16/21 09:18:21] INFO	8. std (0.036262)
[09/16/21 09:18:21] INFO	9. cluster_30 (0.036076)
[09/16/21 09:18:21] INFO	10. Fare (0.032410)
[09/16/21 09:18:21] INFO	11. cluster_24 (0.021187)
[09/16/21 09:18:21] INFO	12. Name_factor (0.019312)
[09/16/21 09:18:21] INFO	13. sum (0.017784)
[09/16/21 09:18:21] INFO	14. cluster_15 (0.010340)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/16/21 09:18:22] INFO	================================================================================
[09/16/21 09:18:22] INFO	Saving Model Predictor
[09/16/21 09:18:22] INFO	Writing model predictor to ./model/model_20210916.pkl
[09/16/21 09:18:22] INFO	Saving Feature Map
[09/16/21 09:18:22] INFO	Writing feature map to ./model/feature_map_20210916.pkl
[09/16/21 09:18:22] INFO	Loading data from ./input/test_20210916.csv
[09/16/21 09:18:22] INFO	Saving Predictions
[09/16/21 09:18:22] INFO	Writing data frame to ./output/predictions_20210916.csv
[09/16/21 09:18:22] INFO	Saving Probabilities
[09/16/21 09:18:22] INFO	Writing data frame to ./output/probabilities_20210916.csv
[09/16/21 09:18:22] INFO	Saving Ranked Predictions
[09/16/21 09:18:22] INFO	Writing data frame to ./output/rankings_20210916.csv
[09/16/21 09:18:22] INFO	Saving Submission to ./output/submission_20210916.csv
[09/16/21 09:18:22] INFO	********************************************************************************
[09/16/21 09:18:22] INFO	AlphaPy End
[09/16/21 09:18:22] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	AlphaPy Start
[09/26/21 14:16:25] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	Model Configuration
[09/26/21 14:16:25] INFO	No transforms Found
[09/26/21 14:16:25] INFO	MODEL PARAMETERS:
[09/26/21 14:16:25] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/26/21 14:16:25] INFO	calibration       = False
[09/26/21 14:16:25] INFO	cal_type          = sigmoid
[09/26/21 14:16:25] INFO	calibration_plot  = False
[09/26/21 14:16:25] INFO	clustering        = True
[09/26/21 14:16:25] INFO	cluster_inc       = 3
[09/26/21 14:16:25] INFO	cluster_max       = 30
[09/26/21 14:16:25] INFO	cluster_min       = 3
[09/26/21 14:16:25] INFO	confusion_matrix  = True
[09/26/21 14:16:25] INFO	counts            = True
[09/26/21 14:16:25] INFO	cv_folds          = 3
[09/26/21 14:16:25] INFO	directory         = .
[09/26/21 14:16:25] INFO	extension         = csv
[09/26/21 14:16:25] INFO	drop              = ['PassengerId']
[09/26/21 14:16:25] INFO	encoder           = <Encoders.target: 14>
[09/26/21 14:16:25] INFO	esr               = 20
[09/26/21 14:16:25] INFO	factors           = ['Embarked']
[09/26/21 14:16:25] INFO	features [X]      = *
[09/26/21 14:16:25] INFO	feature_selection = False
[09/26/21 14:16:25] INFO	fs_percentage     = 50
[09/26/21 14:16:25] INFO	fs_score_func     = <function f_classif at 0x7fb733133d30>
[09/26/21 14:16:25] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/26/21 14:16:25] INFO	grid_search       = True
[09/26/21 14:16:25] INFO	gs_iters          = 50
[09/26/21 14:16:25] INFO	gs_random         = True
[09/26/21 14:16:25] INFO	gs_sample         = False
[09/26/21 14:16:25] INFO	gs_sample_pct     = 0.200000
[09/26/21 14:16:25] INFO	importances       = True
[09/26/21 14:16:25] INFO	interactions      = False
[09/26/21 14:16:25] INFO	isomap            = False
[09/26/21 14:16:25] INFO	iso_components    = 2
[09/26/21 14:16:25] INFO	iso_neighbors     = 5
[09/26/21 14:16:25] INFO	isample_pct       = 10
[09/26/21 14:16:25] INFO	leaders           = []
[09/26/21 14:16:25] INFO	learning_curve    = True
[09/26/21 14:16:25] INFO	logtransform      = False
[09/26/21 14:16:25] INFO	lv_remove         = True
[09/26/21 14:16:25] INFO	lv_threshold      = 0.100000
[09/26/21 14:16:25] INFO	model_type        = <ModelType.classification: 1>
[09/26/21 14:16:25] INFO	n_estimators      = 51
[09/26/21 14:16:25] INFO	n_jobs            = -1
[09/26/21 14:16:25] INFO	ngrams_max        = 2
[09/26/21 14:16:25] INFO	numpy             = True
[09/26/21 14:16:25] INFO	pca               = False
[09/26/21 14:16:25] INFO	pca_inc           = 1
[09/26/21 14:16:25] INFO	pca_max           = 10
[09/26/21 14:16:25] INFO	pca_min           = 2
[09/26/21 14:16:25] INFO	pca_whiten        = False
[09/26/21 14:16:25] INFO	poly_degree       = 2
[09/26/21 14:16:25] INFO	pvalue_level      = 0.010000
[09/26/21 14:16:25] INFO	rfe               = True
[09/26/21 14:16:25] INFO	rfe_step          = 3
[09/26/21 14:16:25] INFO	roc_curve         = True
[09/26/21 14:16:25] INFO	rounding          = 2
[09/26/21 14:16:25] INFO	sampling          = False
[09/26/21 14:16:25] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/26/21 14:16:25] INFO	sampling_ratio    = 0.500000
[09/26/21 14:16:25] INFO	scaler_option     = True
[09/26/21 14:16:25] INFO	scaler_type       = <Scalers.standard: 2>
[09/26/21 14:16:25] INFO	scipy             = False
[09/26/21 14:16:25] INFO	scorer            = roc_auc
[09/26/21 14:16:25] INFO	seed              = 42
[09/26/21 14:16:25] INFO	sentinel          = -1
[09/26/21 14:16:25] INFO	separator         = ,
[09/26/21 14:16:25] INFO	shuffle           = False
[09/26/21 14:16:25] INFO	split             = 0.400000
[09/26/21 14:16:25] INFO	submission_file   = gender_submission
[09/26/21 14:16:25] INFO	submit_probas     = False
[09/26/21 14:16:25] INFO	target [y]        = Survived
[09/26/21 14:16:25] INFO	target_value      = 1
[09/26/21 14:16:25] INFO	transforms        = None
[09/26/21 14:16:25] INFO	tsne              = False
[09/26/21 14:16:25] INFO	tsne_components   = 2
[09/26/21 14:16:25] INFO	tsne_learn_rate   = 1000.000000
[09/26/21 14:16:25] INFO	tsne_perplexity   = 30.000000
[09/26/21 14:16:25] INFO	vectorize         = False
[09/26/21 14:16:25] INFO	verbosity         = 0
[09/26/21 14:16:25] INFO	Creating Model
[09/26/21 14:16:25] INFO	Calling Pipeline
[09/26/21 14:16:25] INFO	Training Pipeline
[09/26/21 14:16:25] INFO	Loading Data
[09/26/21 14:16:25] INFO	Loading data from ./input/train.csv
[09/26/21 14:16:25] INFO	Found target Survived in data frame
[09/26/21 14:16:25] INFO	Labels (y) found for Partition.train
[09/26/21 14:16:25] INFO	Loading Data
[09/26/21 14:16:25] INFO	Loading data from ./input/test.csv
[09/26/21 14:16:25] INFO	Target Survived not found in Partition.test
[09/26/21 14:16:25] INFO	Saving New Features in Model
[09/26/21 14:16:25] INFO	Original Feature Statistics
[09/26/21 14:16:25] INFO	Number of Training Rows    : 891
[09/26/21 14:16:25] INFO	Number of Training Columns : 11
[09/26/21 14:16:25] INFO	Unique Training Values for Survived : [0 1]
[09/26/21 14:16:25] INFO	Unique Training Counts for Survived : [549 342]
[09/26/21 14:16:25] INFO	Number of Testing Rows     : 418
[09/26/21 14:16:25] INFO	Number of Testing Columns  : 11
[09/26/21 14:16:25] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/26/21 14:16:25] INFO	Feature Count     : 11
[09/26/21 14:16:25] INFO	Applying transforms
[09/26/21 14:16:25] INFO	No transforms Specified
[09/26/21 14:16:25] INFO	New Feature Count : 11
[09/26/21 14:16:25] INFO	Dropping Features: ['PassengerId']
[09/26/21 14:16:25] INFO	Original Feature Count : 11
[09/26/21 14:16:25] INFO	Reduced Feature Count  : 10
[09/26/21 14:16:25] INFO	Writing data frame to ./input/train_20210926.csv
[09/26/21 14:16:25] INFO	Writing data frame to ./input/test_20210926.csv
[09/26/21 14:16:25] INFO	Creating Cross-Tabulations
[09/26/21 14:16:25] INFO	Creating crosstabs for feature Embarked
[09/26/21 14:16:25] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/26/21 14:16:25] INFO	Feature Count     : 10
[09/26/21 14:16:25] INFO	Creating Count Features
[09/26/21 14:16:25] INFO	NA Counts
[09/26/21 14:16:25] INFO	Number Counts
[09/26/21 14:16:25] INFO	New Feature Count : 21
[09/26/21 14:16:25] INFO	Creating Base Features
[09/26/21 14:16:25] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/26/21 14:16:25] INFO	Feature 2: Name => Factorization
[09/26/21 14:16:25] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/26/21 14:16:25] INFO	Feature 3: Sex => Factorization
[09/26/21 14:16:25] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/26/21 14:16:25] INFO	Feature 7: Ticket => Factorization
[09/26/21 14:16:25] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/26/21 14:16:25] INFO	Feature 9: Cabin => Factorization
[09/26/21 14:16:25] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/26/21 14:16:25] INFO	Encoding: Encoders.target
[09/26/21 14:16:25] INFO	Fitting training features for Embarked
[09/26/21 14:16:25] INFO	Transforming testing features for Embarked
[09/26/21 14:16:25] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	New Feature Count : 21
[09/26/21 14:16:25] INFO	Scaling Base Features
[09/26/21 14:16:25] INFO	Creating NumPy Features
[09/26/21 14:16:25] INFO	NumPy Feature: sum
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: mean
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: std
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: var
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature Count : 4
[09/26/21 14:16:25] INFO	New Feature Count : 25
[09/26/21 14:16:25] INFO	Creating Clustering Features
[09/26/21 14:16:25] INFO	Cluster Minimum   : 3
[09/26/21 14:16:25] INFO	Cluster Maximum   : 30
[09/26/21 14:16:25] INFO	Cluster Increment : 3
[09/26/21 14:16:25] INFO	k = 3
[09/26/21 14:16:26] INFO	k = 6
[09/26/21 14:16:26] INFO	k = 9
[09/26/21 14:16:26] INFO	k = 12
[09/26/21 14:16:26] INFO	k = 15
[09/26/21 14:16:26] INFO	k = 18
[09/26/21 14:16:26] INFO	k = 21
[09/26/21 14:16:26] INFO	k = 24
[09/26/21 14:16:26] INFO	k = 27
[09/26/21 14:16:26] INFO	k = 30
[09/26/21 14:16:26] INFO	Clustering Feature Count : 10
[09/26/21 14:16:26] INFO	New Feature Count : 35
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Creating Interactions
[09/26/21 14:16:26] INFO	Initial Feature Count  : 35
[09/26/21 14:16:26] INFO	Skipping Interactions
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Removing Low-Variance Features
[09/26/21 14:16:26] INFO	Low-Variance Threshold  : 0.10
[09/26/21 14:16:26] INFO	Original Feature Count  : 35
[09/26/21 14:16:26] INFO	Reduced Feature Count   : 35
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Skipping Shuffling
[09/26/21 14:16:26] INFO	Skipping Sampling
[09/26/21 14:16:26] INFO	Getting All Estimators
[09/26/21 14:16:26] INFO	Algorithm Configuration
[09/26/21 14:16:27] INFO	Selecting Models
[09/26/21 14:16:27] INFO	Algorithm: CATB
[09/26/21 14:16:27] INFO	Fitting Initial Model
[09/26/21 14:16:27] INFO	Cross-Validation
[09/26/21 14:16:28] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/26/21 14:16:28] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:31] INFO	RFECV took 2.48 seconds for step 3 and 3 folds
[09/26/21 14:16:31] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/26/21 14:16:31] INFO	No grid is defined for grid search
[09/26/21 14:16:31] INFO	Final Model Predictions for CATB
[09/26/21 14:16:31] INFO	Skipping Calibration
[09/26/21 14:16:31] INFO	Making Predictions
[09/26/21 14:16:31] INFO	Predictions Complete
[09/26/21 14:16:31] INFO	Algorithm: LGB
[09/26/21 14:16:31] INFO	Fitting Initial Model
[09/26/21 14:16:31] INFO	Cross-Validation
[09/26/21 14:16:32] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/26/21 14:16:32] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:34] INFO	RFECV took 2.21 seconds for step 3 and 3 folds
[09/26/21 14:16:34] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/26/21 14:16:34] INFO	No grid is defined for grid search
[09/26/21 14:16:34] INFO	Final Model Predictions for LGB
[09/26/21 14:16:34] INFO	Skipping Calibration
[09/26/21 14:16:34] INFO	Making Predictions
[09/26/21 14:16:34] INFO	Predictions Complete
[09/26/21 14:16:34] INFO	Algorithm: XGB
[09/26/21 14:16:34] INFO	Fitting Initial Model
[09/26/21 14:16:34] INFO	Cross-Validation
[09/26/21 14:16:35] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/26/21 14:16:35] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:38] INFO	RFECV took 2.91 seconds for step 3 and 3 folds
[09/26/21 14:16:38] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/26/21 14:16:38] INFO	Randomized Grid Search
[09/26/21 14:17:47] INFO	Grid Search took 69.67 seconds for 50 candidate parameter settings.
[09/26/21 14:17:47] INFO	Model with rank: 1
[09/26/21 14:17:47] INFO	Mean validation score: 0.872 (std: 0.019)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[09/26/21 14:17:47] INFO	Model with rank: 2
[09/26/21 14:17:47] INFO	Mean validation score: 0.869 (std: 0.021)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[09/26/21 14:17:47] INFO	Model with rank: 3
[09/26/21 14:17:47] INFO	Mean validation score: 0.869 (std: 0.024)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[09/26/21 14:17:47] INFO	Algorithm: XGB, Best Score: 0.8718, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[09/26/21 14:17:47] INFO	Final Model Predictions for XGB
[09/26/21 14:17:47] INFO	Skipping Calibration
[09/26/21 14:17:47] INFO	Making Predictions
[09/26/21 14:17:47] INFO	Predictions Complete
[09/26/21 14:17:47] INFO	Blending Models
[09/26/21 14:17:47] INFO	Blending Start: 2021-09-26 14:17:47.752878
[09/26/21 14:17:47] INFO	Blending Complete: 0:00:00.011710
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Metrics for: Partition.train
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: CATB
[09/26/21 14:17:47] INFO	accuracy: 0.8585858585858586
[09/26/21 14:17:47] INFO	average_precision: 0.9113351686222868
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.8378391333525069
[09/26/21 14:17:47] INFO	brier_score_loss: 0.10043404518351136
[09/26/21 14:17:47] INFO	cohen_kappa: 0.6932572665125658
[09/26/21 14:17:47] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/26/21 14:17:47] INFO	f1: 0.8025078369905956
[09/26/21 14:17:47] INFO	neg_log_loss: 0.3371948718196211
[09/26/21 14:17:47] INFO	precision: 0.8648648648648649
[09/26/21 14:17:47] INFO	recall: 0.7485380116959064
[09/26/21 14:17:47] INFO	roc_auc: 0.9297979313797549
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: LGB
[09/26/21 14:17:47] INFO	accuracy: 0.9730639730639731
[09/26/21 14:17:47] INFO	average_precision: 0.9961113207491221
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.9687709711437062
[09/26/21 14:17:47] INFO	brier_score_loss: 0.032809498448974184
[09/26/21 14:17:47] INFO	cohen_kappa: 0.9427387092109702
[09/26/21 14:17:47] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/26/21 14:17:47] INFO	f1: 0.9643916913946586
[09/26/21 14:17:47] INFO	neg_log_loss: 0.1458307566281259
[09/26/21 14:17:47] INFO	precision: 0.9789156626506024
[09/26/21 14:17:47] INFO	recall: 0.9502923976608187
[09/26/21 14:17:47] INFO	roc_auc: 0.9974861257576241
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: XGB
[09/26/21 14:17:47] INFO	accuracy: 0.9034792368125701
[09/26/21 14:17:47] INFO	average_precision: 0.9420220304254212
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.8852938356821014
[09/26/21 14:17:47] INFO	brier_score_loss: 0.09082637971296194
[09/26/21 14:17:47] INFO	cohen_kappa: 0.7906359120641322
[09/26/21 14:17:47] INFO	confusion_matrix: [[529  20]
 [ 66 276]]
[09/26/21 14:17:47] INFO	f1: 0.865203761755486
[09/26/21 14:17:47] INFO	neg_log_loss: 0.3250040239189343
[09/26/21 14:17:47] INFO	precision: 0.9324324324324325
[09/26/21 14:17:47] INFO	recall: 0.8070175438596491
[09/26/21 14:17:47] INFO	roc_auc: 0.9562149149437041
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Metrics for: Partition.test
[09/26/21 14:17:47] INFO	No labels for generating Partition.test metrics
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Selecting Best Model
[09/26/21 14:17:47] INFO	Scoring for: Partition.train
[09/26/21 14:17:47] INFO	Best Model Selection Start: 2021-09-26 14:17:47.786239
[09/26/21 14:17:47] INFO	Scoring CATB Model
[09/26/21 14:17:47] INFO	Scoring LGB Model
[09/26/21 14:17:47] INFO	Scoring XGB Model
[09/26/21 14:17:47] INFO	Scoring BLEND Model
[09/26/21 14:17:47] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/26/21 14:17:47] INFO	Best Model Selection Complete: 0:00:00.000189
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Generating Plots for partition: train
[09/26/21 14:17:47] INFO	Generating Calibration Plot
[09/26/21 14:17:47] INFO	Calibration for Algorithm: CATB
[09/26/21 14:17:47] INFO	Calibration for Algorithm: LGB
[09/26/21 14:17:47] INFO	Calibration for Algorithm: XGB
[09/26/21 14:17:47] INFO	Writing plot to ./plots/calibration_train.png
[09/26/21 14:17:47] INFO	Generating Confusion Matrices
[09/26/21 14:17:47] INFO	Confusion Matrix for Algorithm: CATB
[09/26/21 14:17:47] INFO	Confusion Matrix:
[09/26/21 14:17:47] INFO	[[509  40]
 [ 86 256]]
[09/26/21 14:17:47] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/26/21 14:17:48] INFO	Confusion Matrix for Algorithm: LGB
[09/26/21 14:17:48] INFO	Confusion Matrix:
[09/26/21 14:17:48] INFO	[[542   7]
 [ 17 325]]
[09/26/21 14:17:48] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/26/21 14:17:48] INFO	Confusion Matrix for Algorithm: XGB
[09/26/21 14:17:48] INFO	Confusion Matrix:
[09/26/21 14:17:48] INFO	[[529  20]
 [ 66 276]]
[09/26/21 14:17:48] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/26/21 14:17:48] INFO	Generating ROC Curves
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: CATB
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: LGB
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: XGB
[09/26/21 14:17:48] INFO	Writing plot to ./plots/roc_curve_train.png
[09/26/21 14:17:48] INFO	Generating Learning Curves
[09/26/21 14:17:48] INFO	Algorithm Configuration
[09/26/21 14:17:48] INFO	Learning Curve for Algorithm: CATB
[09/26/21 14:17:48] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/26/21 14:17:48] INFO	Learning Curve for Algorithm: LGB
[09/26/21 14:17:50] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/26/21 14:17:50] INFO	Learning Curve for Algorithm: XGB
[09/26/21 14:17:51] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/26/21 14:17:51] INFO	Generating Feature Importance Plots
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: CATB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Sex_factor (45.178104)
[09/26/21 14:17:51] INFO	2. Pclass (13.721171)
[09/26/21 14:17:51] INFO	3. Age (6.651788)
[09/26/21 14:17:51] INFO	4. Fare (4.529770)
[09/26/21 14:17:51] INFO	5. var (3.586590)
[09/26/21 14:17:51] INFO	6. std (3.492385)
[09/26/21 14:17:51] INFO	7. Ticket_factor (3.315046)
[09/26/21 14:17:51] INFO	8. cluster_30 (2.831587)
[09/26/21 14:17:51] INFO	9. mean (2.733389)
[09/26/21 14:17:51] INFO	10. Name_factor (2.586310)
[09/26/21 14:17:51] INFO	11. Cabin_factor (2.101764)
[09/26/21 14:17:51] INFO	12. Embarked (2.086410)
[09/26/21 14:17:51] INFO	13. SibSp (2.085405)
[09/26/21 14:17:51] INFO	14. cluster_12 (1.876782)
[09/26/21 14:17:51] INFO	15. cluster_24 (1.263144)
[09/26/21 14:17:51] INFO	16. count_2 (1.004409)
[09/26/21 14:17:51] INFO	17. sum (0.955946)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: LGB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Fare (256.000000)
[09/26/21 14:17:51] INFO	2. sum (241.000000)
[09/26/21 14:17:51] INFO	3. Age (232.000000)
[09/26/21 14:17:51] INFO	4. std (201.000000)
[09/26/21 14:17:51] INFO	5. Ticket_factor (199.000000)
[09/26/21 14:17:51] INFO	6. Name_factor (175.000000)
[09/26/21 14:17:51] INFO	7. cluster_30 (53.000000)
[09/26/21 14:17:51] INFO	8. cluster_27 (46.000000)
[09/26/21 14:17:51] INFO	9. Sex_factor (43.000000)
[09/26/21 14:17:51] INFO	10. Pclass (43.000000)
[09/26/21 14:17:51] INFO	11. Cabin_factor (41.000000)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: XGB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Sex_factor (0.424644)
[09/26/21 14:17:51] INFO	2. Pclass (0.127452)
[09/26/21 14:17:51] INFO	3. Cabin_factor (0.081307)
[09/26/21 14:17:51] INFO	4. Age (0.051007)
[09/26/21 14:17:51] INFO	5. SibSp (0.049620)
[09/26/21 14:17:51] INFO	6. count_1 (0.046373)
[09/26/21 14:17:51] INFO	7. Embarked (0.046225)
[09/26/21 14:17:51] INFO	8. std (0.036262)
[09/26/21 14:17:51] INFO	9. cluster_30 (0.036076)
[09/26/21 14:17:51] INFO	10. Fare (0.032410)
[09/26/21 14:17:51] INFO	11. cluster_24 (0.021187)
[09/26/21 14:17:51] INFO	12. Name_factor (0.019312)
[09/26/21 14:17:51] INFO	13. sum (0.017784)
[09/26/21 14:17:51] INFO	14. cluster_15 (0.010340)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/26/21 14:17:51] INFO	================================================================================
[09/26/21 14:17:51] INFO	Saving Model Predictor
[09/26/21 14:17:51] INFO	Writing model predictor to ./model/model_20210926.pkl
[09/26/21 14:17:51] INFO	Saving Feature Map
[09/26/21 14:17:51] INFO	Writing feature map to ./model/feature_map_20210926.pkl
[09/26/21 14:17:51] INFO	Loading data from ./input/test_20210926.csv
[09/26/21 14:17:51] INFO	Saving Predictions
[09/26/21 14:17:51] INFO	Writing data frame to ./output/predictions_20210926.csv
[09/26/21 14:17:51] INFO	Saving Probabilities
[09/26/21 14:17:51] INFO	Writing data frame to ./output/probabilities_20210926.csv
[09/26/21 14:17:51] INFO	Saving Ranked Predictions
[09/26/21 14:17:51] INFO	Writing data frame to ./output/rankings_20210926.csv
[09/26/21 14:17:51] INFO	Saving Submission to ./output/submission_20210926.csv
[09/26/21 14:17:51] INFO	********************************************************************************
[09/26/21 14:17:51] INFO	AlphaPy End
[09/26/21 14:17:51] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	AlphaPy Start
[10/05/21 17:04:56] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	Model Configuration
[10/05/21 17:04:56] INFO	No transforms Found
[10/05/21 17:04:56] INFO	MODEL PARAMETERS:
[10/05/21 17:04:56] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/05/21 17:04:56] INFO	calibration       = False
[10/05/21 17:04:56] INFO	cal_type          = sigmoid
[10/05/21 17:04:56] INFO	calibration_plot  = False
[10/05/21 17:04:56] INFO	clustering        = True
[10/05/21 17:04:56] INFO	cluster_inc       = 3
[10/05/21 17:04:56] INFO	cluster_max       = 30
[10/05/21 17:04:56] INFO	cluster_min       = 3
[10/05/21 17:04:56] INFO	confusion_matrix  = True
[10/05/21 17:04:56] INFO	counts            = True
[10/05/21 17:04:56] INFO	cv_folds          = 3
[10/05/21 17:04:56] INFO	directory         = .
[10/05/21 17:04:56] INFO	extension         = csv
[10/05/21 17:04:56] INFO	drop              = ['PassengerId']
[10/05/21 17:04:56] INFO	encoder           = <Encoders.target: 14>
[10/05/21 17:04:56] INFO	esr               = 20
[10/05/21 17:04:56] INFO	factors           = ['Embarked']
[10/05/21 17:04:56] INFO	features [X]      = *
[10/05/21 17:04:56] INFO	feature_selection = False
[10/05/21 17:04:56] INFO	fs_percentage     = 50
[10/05/21 17:04:56] INFO	fs_score_func     = <function f_classif at 0x7f96c0915f70>
[10/05/21 17:04:56] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/05/21 17:04:56] INFO	grid_search       = True
[10/05/21 17:04:56] INFO	gs_iters          = 50
[10/05/21 17:04:56] INFO	gs_random         = True
[10/05/21 17:04:56] INFO	gs_sample         = False
[10/05/21 17:04:56] INFO	gs_sample_pct     = 0.200000
[10/05/21 17:04:56] INFO	importances       = True
[10/05/21 17:04:56] INFO	interactions      = False
[10/05/21 17:04:56] INFO	isomap            = False
[10/05/21 17:04:56] INFO	iso_components    = 2
[10/05/21 17:04:56] INFO	iso_neighbors     = 5
[10/05/21 17:04:56] INFO	isample_pct       = 10
[10/05/21 17:04:56] INFO	leaders           = []
[10/05/21 17:04:56] INFO	learning_curve    = True
[10/05/21 17:04:56] INFO	logtransform      = False
[10/05/21 17:04:56] INFO	lv_remove         = True
[10/05/21 17:04:56] INFO	lv_threshold      = 0.100000
[10/05/21 17:04:56] INFO	model_type        = <ModelType.classification: 1>
[10/05/21 17:04:56] INFO	n_estimators      = 51
[10/05/21 17:04:56] INFO	n_jobs            = -1
[10/05/21 17:04:56] INFO	ngrams_max        = 2
[10/05/21 17:04:56] INFO	numpy             = True
[10/05/21 17:04:56] INFO	pca               = False
[10/05/21 17:04:56] INFO	pca_inc           = 1
[10/05/21 17:04:56] INFO	pca_max           = 10
[10/05/21 17:04:56] INFO	pca_min           = 2
[10/05/21 17:04:56] INFO	pca_whiten        = False
[10/05/21 17:04:56] INFO	poly_degree       = 2
[10/05/21 17:04:56] INFO	pvalue_level      = 0.010000
[10/05/21 17:04:56] INFO	rfe               = True
[10/05/21 17:04:56] INFO	rfe_step          = 3
[10/05/21 17:04:56] INFO	roc_curve         = True
[10/05/21 17:04:56] INFO	rounding          = 2
[10/05/21 17:04:56] INFO	sampling          = False
[10/05/21 17:04:56] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/05/21 17:04:56] INFO	sampling_ratio    = 0.500000
[10/05/21 17:04:56] INFO	scaler_option     = True
[10/05/21 17:04:56] INFO	scaler_type       = <Scalers.standard: 2>
[10/05/21 17:04:56] INFO	scipy             = False
[10/05/21 17:04:56] INFO	scorer            = roc_auc
[10/05/21 17:04:56] INFO	seed              = 42
[10/05/21 17:04:56] INFO	sentinel          = -1
[10/05/21 17:04:56] INFO	separator         = ,
[10/05/21 17:04:56] INFO	shuffle           = False
[10/05/21 17:04:56] INFO	split             = 0.400000
[10/05/21 17:04:56] INFO	submission_file   = gender_submission
[10/05/21 17:04:56] INFO	submit_probas     = False
[10/05/21 17:04:56] INFO	target [y]        = Survived
[10/05/21 17:04:56] INFO	target_value      = 1
[10/05/21 17:04:56] INFO	transforms        = None
[10/05/21 17:04:56] INFO	tsne              = False
[10/05/21 17:04:56] INFO	tsne_components   = 2
[10/05/21 17:04:56] INFO	tsne_learn_rate   = 1000.000000
[10/05/21 17:04:56] INFO	tsne_perplexity   = 30.000000
[10/05/21 17:04:56] INFO	vectorize         = False
[10/05/21 17:04:56] INFO	verbosity         = 0
[10/05/21 17:04:56] INFO	Creating Model
[10/05/21 17:04:56] INFO	Calling Pipeline
[10/05/21 17:04:56] INFO	Training Pipeline
[10/05/21 17:04:56] INFO	Loading Data
[10/05/21 17:04:56] INFO	Loading data from ./input/train.csv
[10/05/21 17:04:56] INFO	Found target Survived in data frame
[10/05/21 17:04:56] INFO	Labels (y) found for Partition.train
[10/05/21 17:04:56] INFO	Loading Data
[10/05/21 17:04:56] INFO	Loading data from ./input/test.csv
[10/05/21 17:04:56] INFO	Target Survived not found in Partition.test
[10/05/21 17:04:56] INFO	Saving New Features in Model
[10/05/21 17:04:56] INFO	Original Feature Statistics
[10/05/21 17:04:56] INFO	Number of Training Rows    : 891
[10/05/21 17:04:56] INFO	Number of Training Columns : 11
[10/05/21 17:04:56] INFO	Unique Training Values for Survived : [0 1]
[10/05/21 17:04:56] INFO	Unique Training Counts for Survived : [549 342]
[10/05/21 17:04:56] INFO	Number of Testing Rows     : 418
[10/05/21 17:04:56] INFO	Number of Testing Columns  : 11
[10/05/21 17:04:56] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:04:56] INFO	Feature Count     : 11
[10/05/21 17:04:56] INFO	Applying transforms
[10/05/21 17:04:56] INFO	No transforms Specified
[10/05/21 17:04:56] INFO	New Feature Count : 11
[10/05/21 17:04:56] INFO	Dropping Features: ['PassengerId']
[10/05/21 17:04:56] INFO	Original Feature Count : 11
[10/05/21 17:04:56] INFO	Reduced Feature Count  : 10
[10/05/21 17:04:56] INFO	Writing data frame to ./input/train_20211005.csv
[10/05/21 17:04:56] INFO	Writing data frame to ./input/test_20211005.csv
[10/05/21 17:04:56] INFO	Creating Cross-Tabulations
[10/05/21 17:04:56] INFO	Creating crosstabs for feature Embarked
[10/05/21 17:04:56] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:04:56] INFO	Feature Count     : 10
[10/05/21 17:04:56] INFO	Creating Count Features
[10/05/21 17:04:56] INFO	NA Counts
[10/05/21 17:04:56] INFO	Number Counts
[10/05/21 17:04:56] INFO	New Feature Count : 21
[10/05/21 17:04:56] INFO	Creating Base Features
[10/05/21 17:04:56] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/05/21 17:04:56] INFO	Feature 2: Name => Factorization
[10/05/21 17:04:56] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/05/21 17:04:56] INFO	Feature 3: Sex => Factorization
[10/05/21 17:04:56] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/05/21 17:04:56] INFO	Feature 7: Ticket => Factorization
[10/05/21 17:04:56] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/05/21 17:04:56] INFO	Feature 9: Cabin => Factorization
[10/05/21 17:04:56] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/05/21 17:04:56] INFO	Encoding: Encoders.target
[10/05/21 17:04:56] INFO	Fitting training features for Embarked
[10/05/21 17:04:56] INFO	Transforming testing features for Embarked
[10/05/21 17:04:56] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	New Feature Count : 21
[10/05/21 17:04:56] INFO	Scaling Base Features
[10/05/21 17:04:56] INFO	Creating NumPy Features
[10/05/21 17:04:56] INFO	NumPy Feature: sum
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: mean
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: std
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: var
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature Count : 4
[10/05/21 17:04:56] INFO	New Feature Count : 25
[10/05/21 17:04:56] INFO	Creating Clustering Features
[10/05/21 17:04:56] INFO	Cluster Minimum   : 3
[10/05/21 17:04:56] INFO	Cluster Maximum   : 30
[10/05/21 17:04:56] INFO	Cluster Increment : 3
[10/05/21 17:04:56] INFO	k = 3
[10/05/21 17:04:57] INFO	k = 6
[10/05/21 17:04:57] INFO	k = 9
[10/05/21 17:04:57] INFO	k = 12
[10/05/21 17:04:57] INFO	k = 15
[10/05/21 17:04:57] INFO	k = 18
[10/05/21 17:04:57] INFO	k = 21
[10/05/21 17:04:57] INFO	k = 24
[10/05/21 17:04:57] INFO	k = 27
[10/05/21 17:04:57] INFO	k = 30
[10/05/21 17:04:57] INFO	Clustering Feature Count : 10
[10/05/21 17:04:57] INFO	New Feature Count : 35
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Creating Interactions
[10/05/21 17:04:57] INFO	Initial Feature Count  : 35
[10/05/21 17:04:57] INFO	Skipping Interactions
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Removing Low-Variance Features
[10/05/21 17:04:57] INFO	Low-Variance Threshold  : 0.10
[10/05/21 17:04:57] INFO	Original Feature Count  : 35
[10/05/21 17:04:57] INFO	Reduced Feature Count   : 35
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Skipping Shuffling
[10/05/21 17:04:57] INFO	Skipping Sampling
[10/05/21 17:04:57] INFO	Getting All Estimators
[10/05/21 17:04:57] INFO	Algorithm Configuration
[10/05/21 17:04:59] INFO	Selecting Models
[10/05/21 17:04:59] INFO	Algorithm: CATB
[10/05/21 17:04:59] INFO	Fitting Initial Model
[10/05/21 17:04:59] INFO	Cross-Validation
[10/05/21 17:05:01] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/05/21 17:05:01] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:03] INFO	RFECV took 2.47 seconds for step 3 and 3 folds
[10/05/21 17:05:03] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/05/21 17:05:03] INFO	No grid is defined for grid search
[10/05/21 17:05:03] INFO	Final Model Predictions for CATB
[10/05/21 17:05:03] INFO	Skipping Calibration
[10/05/21 17:05:03] INFO	Making Predictions
[10/05/21 17:05:03] INFO	Predictions Complete
[10/05/21 17:05:03] INFO	Algorithm: LGB
[10/05/21 17:05:03] INFO	Fitting Initial Model
[10/05/21 17:05:03] INFO	Cross-Validation
[10/05/21 17:05:04] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/05/21 17:05:04] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:07] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[10/05/21 17:05:07] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/05/21 17:05:07] INFO	No grid is defined for grid search
[10/05/21 17:05:07] INFO	Final Model Predictions for LGB
[10/05/21 17:05:07] INFO	Skipping Calibration
[10/05/21 17:05:07] INFO	Making Predictions
[10/05/21 17:05:07] INFO	Predictions Complete
[10/05/21 17:05:07] INFO	Algorithm: XGB
[10/05/21 17:05:07] INFO	Fitting Initial Model
[10/05/21 17:05:07] INFO	Cross-Validation
[10/05/21 17:05:07] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/05/21 17:05:07] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:10] INFO	RFECV took 2.87 seconds for step 3 and 3 folds
[10/05/21 17:05:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/05/21 17:05:10] INFO	Randomized Grid Search
[10/05/21 17:05:57] INFO	********************************************************************************
[10/05/21 17:05:57] INFO	AlphaPy Start
[10/05/21 17:05:57] INFO	********************************************************************************
[10/05/21 17:05:57] INFO	Model Configuration
[10/05/21 17:05:57] INFO	No transforms Found
[10/05/21 17:05:57] INFO	MODEL PARAMETERS:
[10/05/21 17:05:57] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/05/21 17:05:57] INFO	calibration       = False
[10/05/21 17:05:57] INFO	cal_type          = sigmoid
[10/05/21 17:05:57] INFO	calibration_plot  = False
[10/05/21 17:05:57] INFO	clustering        = True
[10/05/21 17:05:57] INFO	cluster_inc       = 3
[10/05/21 17:05:57] INFO	cluster_max       = 30
[10/05/21 17:05:57] INFO	cluster_min       = 3
[10/05/21 17:05:57] INFO	confusion_matrix  = True
[10/05/21 17:05:57] INFO	counts            = True
[10/05/21 17:05:57] INFO	cv_folds          = 3
[10/05/21 17:05:57] INFO	directory         = .
[10/05/21 17:05:57] INFO	extension         = csv
[10/05/21 17:05:57] INFO	drop              = ['PassengerId']
[10/05/21 17:05:57] INFO	encoder           = <Encoders.target: 14>
[10/05/21 17:05:57] INFO	esr               = 20
[10/05/21 17:05:57] INFO	factors           = ['Embarked']
[10/05/21 17:05:57] INFO	features [X]      = *
[10/05/21 17:05:57] INFO	feature_selection = False
[10/05/21 17:05:57] INFO	fs_percentage     = 50
[10/05/21 17:05:57] INFO	fs_score_func     = <function f_classif at 0x7f916b19df70>
[10/05/21 17:05:57] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/05/21 17:05:57] INFO	grid_search       = True
[10/05/21 17:05:57] INFO	gs_iters          = 50
[10/05/21 17:05:57] INFO	gs_random         = True
[10/05/21 17:05:57] INFO	gs_sample         = False
[10/05/21 17:05:57] INFO	gs_sample_pct     = 0.200000
[10/05/21 17:05:57] INFO	importances       = True
[10/05/21 17:05:57] INFO	interactions      = False
[10/05/21 17:05:57] INFO	isomap            = False
[10/05/21 17:05:57] INFO	iso_components    = 2
[10/05/21 17:05:57] INFO	iso_neighbors     = 5
[10/05/21 17:05:57] INFO	isample_pct       = 10
[10/05/21 17:05:57] INFO	leaders           = []
[10/05/21 17:05:57] INFO	learning_curve    = True
[10/05/21 17:05:57] INFO	logtransform      = False
[10/05/21 17:05:57] INFO	lv_remove         = True
[10/05/21 17:05:57] INFO	lv_threshold      = 0.100000
[10/05/21 17:05:57] INFO	model_type        = <ModelType.classification: 1>
[10/05/21 17:05:57] INFO	n_estimators      = 51
[10/05/21 17:05:57] INFO	n_jobs            = -1
[10/05/21 17:05:57] INFO	ngrams_max        = 2
[10/05/21 17:05:57] INFO	numpy             = True
[10/05/21 17:05:57] INFO	pca               = False
[10/05/21 17:05:57] INFO	pca_inc           = 1
[10/05/21 17:05:57] INFO	pca_max           = 10
[10/05/21 17:05:57] INFO	pca_min           = 2
[10/05/21 17:05:57] INFO	pca_whiten        = False
[10/05/21 17:05:57] INFO	poly_degree       = 2
[10/05/21 17:05:57] INFO	pvalue_level      = 0.010000
[10/05/21 17:05:57] INFO	rfe               = True
[10/05/21 17:05:57] INFO	rfe_step          = 3
[10/05/21 17:05:57] INFO	roc_curve         = True
[10/05/21 17:05:57] INFO	rounding          = 2
[10/05/21 17:05:57] INFO	sampling          = False
[10/05/21 17:05:57] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/05/21 17:05:57] INFO	sampling_ratio    = 0.500000
[10/05/21 17:05:57] INFO	scaler_option     = True
[10/05/21 17:05:57] INFO	scaler_type       = <Scalers.standard: 2>
[10/05/21 17:05:57] INFO	scipy             = False
[10/05/21 17:05:57] INFO	scorer            = roc_auc
[10/05/21 17:05:57] INFO	seed              = 42
[10/05/21 17:05:57] INFO	sentinel          = -1
[10/05/21 17:05:57] INFO	separator         = ,
[10/05/21 17:05:57] INFO	shuffle           = False
[10/05/21 17:05:57] INFO	split             = 0.400000
[10/05/21 17:05:57] INFO	submission_file   = gender_submission
[10/05/21 17:05:57] INFO	submit_probas     = False
[10/05/21 17:05:57] INFO	target [y]        = Survived
[10/05/21 17:05:57] INFO	target_value      = 1
[10/05/21 17:05:57] INFO	transforms        = None
[10/05/21 17:05:57] INFO	tsne              = False
[10/05/21 17:05:57] INFO	tsne_components   = 2
[10/05/21 17:05:57] INFO	tsne_learn_rate   = 1000.000000
[10/05/21 17:05:57] INFO	tsne_perplexity   = 30.000000
[10/05/21 17:05:57] INFO	vectorize         = False
[10/05/21 17:05:57] INFO	verbosity         = 0
[10/05/21 17:05:57] INFO	Creating Model
[10/05/21 17:05:57] INFO	Calling Pipeline
[10/05/21 17:05:57] INFO	Training Pipeline
[10/05/21 17:05:57] INFO	Loading Data
[10/05/21 17:05:57] INFO	Loading data from ./input/train.csv
[10/05/21 17:05:57] INFO	Found target Survived in data frame
[10/05/21 17:05:57] INFO	Labels (y) found for Partition.train
[10/05/21 17:05:57] INFO	Loading Data
[10/05/21 17:05:57] INFO	Loading data from ./input/test.csv
[10/05/21 17:05:57] INFO	Target Survived not found in Partition.test
[10/05/21 17:05:57] INFO	Saving New Features in Model
[10/05/21 17:05:57] INFO	Original Feature Statistics
[10/05/21 17:05:57] INFO	Number of Training Rows    : 891
[10/05/21 17:05:57] INFO	Number of Training Columns : 11
[10/05/21 17:05:57] INFO	Unique Training Values for Survived : [0 1]
[10/05/21 17:05:57] INFO	Unique Training Counts for Survived : [549 342]
[10/05/21 17:05:57] INFO	Number of Testing Rows     : 418
[10/05/21 17:05:57] INFO	Number of Testing Columns  : 11
[10/05/21 17:05:57] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:05:57] INFO	Feature Count     : 11
[10/05/21 17:05:57] INFO	Applying transforms
[10/05/21 17:05:57] INFO	No transforms Specified
[10/05/21 17:05:57] INFO	New Feature Count : 11
[10/05/21 17:05:57] INFO	Dropping Features: ['PassengerId']
[10/05/21 17:05:57] INFO	Original Feature Count : 11
[10/05/21 17:05:57] INFO	Reduced Feature Count  : 10
[10/05/21 17:05:57] INFO	Writing data frame to ./input/train_20211005.csv
[10/05/21 17:05:57] INFO	Writing data frame to ./input/test_20211005.csv
[10/05/21 17:05:57] INFO	Creating Cross-Tabulations
[10/05/21 17:05:57] INFO	Creating crosstabs for feature Embarked
[10/05/21 17:05:57] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:05:57] INFO	Feature Count     : 10
[10/05/21 17:05:57] INFO	Creating Count Features
[10/05/21 17:05:57] INFO	NA Counts
[10/05/21 17:05:57] INFO	Number Counts
[10/05/21 17:05:57] INFO	New Feature Count : 21
[10/05/21 17:05:57] INFO	Creating Base Features
[10/05/21 17:05:57] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/05/21 17:05:57] INFO	Feature 2: Name => Factorization
[10/05/21 17:05:57] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/05/21 17:05:57] INFO	Feature 3: Sex => Factorization
[10/05/21 17:05:57] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/05/21 17:05:57] INFO	Feature 7: Ticket => Factorization
[10/05/21 17:05:57] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/05/21 17:05:57] INFO	Feature 9: Cabin => Factorization
[10/05/21 17:05:57] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/05/21 17:05:57] INFO	Encoding: Encoders.target
[10/05/21 17:05:57] INFO	Fitting training features for Embarked
[10/05/21 17:05:57] INFO	Transforming testing features for Embarked
[10/05/21 17:05:57] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	New Feature Count : 21
[10/05/21 17:05:57] INFO	Scaling Base Features
[10/05/21 17:05:57] INFO	Creating NumPy Features
[10/05/21 17:05:57] INFO	NumPy Feature: sum
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: mean
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: std
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: var
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature Count : 4
[10/05/21 17:05:57] INFO	New Feature Count : 25
[10/05/21 17:05:57] INFO	Creating Clustering Features
[10/05/21 17:05:57] INFO	Cluster Minimum   : 3
[10/05/21 17:05:57] INFO	Cluster Maximum   : 30
[10/05/21 17:05:57] INFO	Cluster Increment : 3
[10/05/21 17:05:57] INFO	k = 3
[10/05/21 17:05:57] INFO	k = 6
[10/05/21 17:05:57] INFO	k = 9
[10/05/21 17:05:57] INFO	k = 12
[10/05/21 17:05:57] INFO	k = 15
[10/05/21 17:05:58] INFO	k = 18
[10/05/21 17:05:58] INFO	k = 21
[10/05/21 17:05:58] INFO	k = 24
[10/05/21 17:05:58] INFO	k = 27
[10/05/21 17:05:58] INFO	k = 30
[10/05/21 17:05:58] INFO	Clustering Feature Count : 10
[10/05/21 17:05:58] INFO	New Feature Count : 35
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Creating Interactions
[10/05/21 17:05:58] INFO	Initial Feature Count  : 35
[10/05/21 17:05:58] INFO	Skipping Interactions
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Removing Low-Variance Features
[10/05/21 17:05:58] INFO	Low-Variance Threshold  : 0.10
[10/05/21 17:05:58] INFO	Original Feature Count  : 35
[10/05/21 17:05:58] INFO	Reduced Feature Count   : 35
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Skipping Shuffling
[10/05/21 17:05:58] INFO	Skipping Sampling
[10/05/21 17:05:58] INFO	Getting All Estimators
[10/05/21 17:05:58] INFO	Algorithm Configuration
[10/05/21 17:05:58] INFO	Selecting Models
[10/05/21 17:05:58] INFO	Algorithm: CATB
[10/05/21 17:05:58] INFO	Fitting Initial Model
[10/05/21 17:05:58] INFO	Cross-Validation
[10/05/21 17:06:00] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/05/21 17:06:00] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:02] INFO	RFECV took 2.52 seconds for step 3 and 3 folds
[10/05/21 17:06:02] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/05/21 17:06:02] INFO	No grid is defined for grid search
[10/05/21 17:06:02] INFO	Final Model Predictions for CATB
[10/05/21 17:06:02] INFO	Skipping Calibration
[10/05/21 17:06:02] INFO	Making Predictions
[10/05/21 17:06:02] INFO	Predictions Complete
[10/05/21 17:06:02] INFO	Algorithm: LGB
[10/05/21 17:06:02] INFO	Fitting Initial Model
[10/05/21 17:06:02] INFO	Cross-Validation
[10/05/21 17:06:03] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/05/21 17:06:03] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:06] INFO	RFECV took 2.55 seconds for step 3 and 3 folds
[10/05/21 17:06:06] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/05/21 17:06:06] INFO	No grid is defined for grid search
[10/05/21 17:06:06] INFO	Final Model Predictions for LGB
[10/05/21 17:06:06] INFO	Skipping Calibration
[10/05/21 17:06:06] INFO	Making Predictions
[10/05/21 17:06:06] INFO	Predictions Complete
[10/05/21 17:06:06] INFO	Algorithm: XGB
[10/05/21 17:06:06] INFO	Fitting Initial Model
[10/05/21 17:06:06] INFO	Cross-Validation
[10/05/21 17:06:06] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/05/21 17:06:06] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:10] INFO	RFECV took 3.94 seconds for step 3 and 3 folds
[10/05/21 17:06:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/05/21 17:06:10] INFO	Randomized Grid Search
[10/05/21 17:07:18] INFO	Grid Search took 68.00 seconds for 50 candidate parameter settings.
[10/05/21 17:07:18] INFO	Model with rank: 1
[10/05/21 17:07:18] INFO	Mean validation score: 0.872 (std: 0.026)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Model with rank: 2
[10/05/21 17:07:18] INFO	Mean validation score: 0.870 (std: 0.022)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[10/05/21 17:07:18] INFO	Model with rank: 3
[10/05/21 17:07:18] INFO	Mean validation score: 0.870 (std: 0.027)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Final Model Predictions for XGB
[10/05/21 17:07:18] INFO	Skipping Calibration
[10/05/21 17:07:18] INFO	Making Predictions
[10/05/21 17:07:18] INFO	Predictions Complete
[10/05/21 17:07:18] INFO	Blending Models
[10/05/21 17:07:18] INFO	Blending Start: 2021-10-05 17:07:18.746050
[10/05/21 17:07:18] INFO	Blending Complete: 0:00:00.017902
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Metrics for: Partition.train
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: CATB
[10/05/21 17:07:18] INFO	accuracy: 0.8585858585858586
[10/05/21 17:07:18] INFO	average_precision: 0.9113351686222868
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.8378391333525069
[10/05/21 17:07:18] INFO	brier_score_loss: 0.10043404518351136
[10/05/21 17:07:18] INFO	cohen_kappa: 0.6932572665125658
[10/05/21 17:07:18] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/05/21 17:07:18] INFO	f1: 0.8025078369905956
[10/05/21 17:07:18] INFO	neg_log_loss: 0.3371948718196211
[10/05/21 17:07:18] INFO	precision: 0.8648648648648649
[10/05/21 17:07:18] INFO	recall: 0.7485380116959064
[10/05/21 17:07:18] INFO	roc_auc: 0.9297979313797549
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: LGB
[10/05/21 17:07:18] INFO	accuracy: 0.9730639730639731
[10/05/21 17:07:18] INFO	average_precision: 0.9961113207491221
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.9687709711437062
[10/05/21 17:07:18] INFO	brier_score_loss: 0.032809498448974184
[10/05/21 17:07:18] INFO	cohen_kappa: 0.9427387092109702
[10/05/21 17:07:18] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/05/21 17:07:18] INFO	f1: 0.9643916913946586
[10/05/21 17:07:18] INFO	neg_log_loss: 0.1458307566281259
[10/05/21 17:07:18] INFO	precision: 0.9789156626506024
[10/05/21 17:07:18] INFO	recall: 0.9502923976608187
[10/05/21 17:07:18] INFO	roc_auc: 0.9974861257576241
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: XGB
[10/05/21 17:07:18] INFO	accuracy: 0.9124579124579124
[10/05/21 17:07:18] INFO	average_precision: 0.9499339046242075
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.8958872591314351
[10/05/21 17:07:18] INFO	brier_score_loss: 0.17677758259057422
[10/05/21 17:07:18] INFO	cohen_kappa: 0.8105402620344473
[10/05/21 17:07:18] INFO	confusion_matrix: [[531  18]
 [ 60 282]]
[10/05/21 17:07:18] INFO	f1: 0.8785046728971964
[10/05/21 17:07:18] INFO	neg_log_loss: 0.5441860756288073
[10/05/21 17:07:18] INFO	precision: 0.94
[10/05/21 17:07:18] INFO	recall: 0.8245614035087719
[10/05/21 17:07:18] INFO	roc_auc: 0.959865891200375
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Metrics for: Partition.test
[10/05/21 17:07:18] INFO	No labels for generating Partition.test metrics
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Selecting Best Model
[10/05/21 17:07:18] INFO	Scoring for: Partition.train
[10/05/21 17:07:18] INFO	Best Model Selection Start: 2021-10-05 17:07:18.793035
[10/05/21 17:07:18] INFO	Scoring CATB Model
[10/05/21 17:07:18] INFO	Scoring LGB Model
[10/05/21 17:07:18] INFO	Scoring XGB Model
[10/05/21 17:07:18] INFO	Scoring BLEND Model
[10/05/21 17:07:18] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/05/21 17:07:18] INFO	Best Model Selection Complete: 0:00:00.000281
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Generating Plots for partition: train
[10/05/21 17:07:18] INFO	Generating Calibration Plot
[10/05/21 17:07:18] INFO	Calibration for Algorithm: CATB
[10/05/21 17:07:18] INFO	Calibration for Algorithm: LGB
[10/05/21 17:07:18] INFO	Calibration for Algorithm: XGB
[10/05/21 17:07:18] INFO	Writing plot to ./plots/calibration_train.png
[10/05/21 17:07:18] INFO	Generating Confusion Matrices
[10/05/21 17:07:18] INFO	Confusion Matrix for Algorithm: CATB
[10/05/21 17:07:18] INFO	Confusion Matrix:
[10/05/21 17:07:18] INFO	[[509  40]
 [ 86 256]]
[10/05/21 17:07:18] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/05/21 17:07:19] INFO	Confusion Matrix for Algorithm: LGB
[10/05/21 17:07:19] INFO	Confusion Matrix:
[10/05/21 17:07:19] INFO	[[542   7]
 [ 17 325]]
[10/05/21 17:07:19] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/05/21 17:07:19] INFO	Confusion Matrix for Algorithm: XGB
[10/05/21 17:07:19] INFO	Confusion Matrix:
[10/05/21 17:07:19] INFO	[[531  18]
 [ 60 282]]
[10/05/21 17:07:19] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/05/21 17:07:19] INFO	Generating ROC Curves
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: CATB
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: LGB
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: XGB
[10/05/21 17:07:19] INFO	Writing plot to ./plots/roc_curve_train.png
[10/05/21 17:07:19] INFO	Generating Learning Curves
[10/05/21 17:07:19] INFO	Algorithm Configuration
[10/05/21 17:07:19] INFO	Learning Curve for Algorithm: CATB
[10/05/21 17:07:19] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/05/21 17:07:19] INFO	Learning Curve for Algorithm: LGB
[10/05/21 17:07:22] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/05/21 17:07:22] INFO	Learning Curve for Algorithm: XGB
[10/05/21 17:07:22] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/05/21 17:07:23] INFO	Generating Feature Importance Plots
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: CATB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Sex_factor (45.178104)
[10/05/21 17:07:23] INFO	2. Pclass (13.721171)
[10/05/21 17:07:23] INFO	3. Age (6.651788)
[10/05/21 17:07:23] INFO	4. Fare (4.529770)
[10/05/21 17:07:23] INFO	5. var (3.586590)
[10/05/21 17:07:23] INFO	6. std (3.492385)
[10/05/21 17:07:23] INFO	7. Ticket_factor (3.315046)
[10/05/21 17:07:23] INFO	8. cluster_30 (2.831587)
[10/05/21 17:07:23] INFO	9. mean (2.733389)
[10/05/21 17:07:23] INFO	10. Name_factor (2.586310)
[10/05/21 17:07:23] INFO	11. Cabin_factor (2.101764)
[10/05/21 17:07:23] INFO	12. Embarked (2.086410)
[10/05/21 17:07:23] INFO	13. SibSp (2.085405)
[10/05/21 17:07:23] INFO	14. cluster_12 (1.876782)
[10/05/21 17:07:23] INFO	15. cluster_24 (1.263144)
[10/05/21 17:07:23] INFO	16. count_2 (1.004409)
[10/05/21 17:07:23] INFO	17. sum (0.955946)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: LGB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Fare (256.000000)
[10/05/21 17:07:23] INFO	2. sum (241.000000)
[10/05/21 17:07:23] INFO	3. Age (232.000000)
[10/05/21 17:07:23] INFO	4. std (201.000000)
[10/05/21 17:07:23] INFO	5. Ticket_factor (199.000000)
[10/05/21 17:07:23] INFO	6. Name_factor (175.000000)
[10/05/21 17:07:23] INFO	7. cluster_30 (53.000000)
[10/05/21 17:07:23] INFO	8. cluster_27 (46.000000)
[10/05/21 17:07:23] INFO	9. Sex_factor (43.000000)
[10/05/21 17:07:23] INFO	10. Pclass (43.000000)
[10/05/21 17:07:23] INFO	11. Cabin_factor (41.000000)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: XGB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Sex_factor (0.424644)
[10/05/21 17:07:23] INFO	2. Pclass (0.127452)
[10/05/21 17:07:23] INFO	3. Cabin_factor (0.081307)
[10/05/21 17:07:23] INFO	4. Age (0.051007)
[10/05/21 17:07:23] INFO	5. SibSp (0.049620)
[10/05/21 17:07:23] INFO	6. count_1 (0.046373)
[10/05/21 17:07:23] INFO	7. Embarked (0.046225)
[10/05/21 17:07:23] INFO	8. std (0.036262)
[10/05/21 17:07:23] INFO	9. cluster_30 (0.036076)
[10/05/21 17:07:23] INFO	10. Fare (0.032410)
[10/05/21 17:07:23] INFO	11. cluster_24 (0.021187)
[10/05/21 17:07:23] INFO	12. Name_factor (0.019312)
[10/05/21 17:07:23] INFO	13. sum (0.017784)
[10/05/21 17:07:23] INFO	14. cluster_15 (0.010340)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/05/21 17:07:23] INFO	================================================================================
[10/05/21 17:07:23] INFO	Saving Model Predictor
[10/05/21 17:07:23] INFO	Writing model predictor to ./model/model_20211005.pkl
[10/05/21 17:07:23] INFO	Saving Feature Map
[10/05/21 17:07:23] INFO	Writing feature map to ./model/feature_map_20211005.pkl
[10/05/21 17:07:23] INFO	Loading data from ./input/test_20211005.csv
[10/05/21 17:07:23] INFO	Saving Predictions
[10/05/21 17:07:23] INFO	Writing data frame to ./output/predictions_20211005.csv
[10/05/21 17:07:23] INFO	Saving Probabilities
[10/05/21 17:07:23] INFO	Writing data frame to ./output/probabilities_20211005.csv
[10/05/21 17:07:23] INFO	Saving Ranked Predictions
[10/05/21 17:07:23] INFO	Writing data frame to ./output/rankings_20211005.csv
[10/05/21 17:07:23] INFO	Saving Submission to ./output/submission_20211005.csv
[10/05/21 17:07:23] INFO	********************************************************************************
[10/05/21 17:07:23] INFO	AlphaPy End
[10/05/21 17:07:23] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	AlphaPy Start
[10/19/21 23:14:29] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	Model Configuration
[10/19/21 23:14:29] INFO	No transforms Found
[10/19/21 23:14:29] INFO	MODEL PARAMETERS:
[10/19/21 23:14:29] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/19/21 23:14:29] INFO	calibration       = False
[10/19/21 23:14:29] INFO	cal_type          = sigmoid
[10/19/21 23:14:29] INFO	calibration_plot  = False
[10/19/21 23:14:29] INFO	clustering        = True
[10/19/21 23:14:29] INFO	cluster_inc       = 3
[10/19/21 23:14:29] INFO	cluster_max       = 30
[10/19/21 23:14:29] INFO	cluster_min       = 3
[10/19/21 23:14:29] INFO	confusion_matrix  = True
[10/19/21 23:14:29] INFO	counts            = True
[10/19/21 23:14:29] INFO	cv_folds          = 3
[10/19/21 23:14:29] INFO	directory         = .
[10/19/21 23:14:29] INFO	extension         = csv
[10/19/21 23:14:29] INFO	drop              = ['PassengerId']
[10/19/21 23:14:29] INFO	encoder           = <Encoders.target: 14>
[10/19/21 23:14:29] INFO	esr               = 20
[10/19/21 23:14:29] INFO	factors           = ['Embarked']
[10/19/21 23:14:29] INFO	features [X]      = *
[10/19/21 23:14:29] INFO	feature_selection = False
[10/19/21 23:14:29] INFO	fs_percentage     = 50
[10/19/21 23:14:29] INFO	fs_score_func     = <function f_classif at 0x7fa102be4f70>
[10/19/21 23:14:29] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/19/21 23:14:29] INFO	grid_search       = True
[10/19/21 23:14:29] INFO	gs_iters          = 50
[10/19/21 23:14:29] INFO	gs_random         = True
[10/19/21 23:14:29] INFO	gs_sample         = False
[10/19/21 23:14:29] INFO	gs_sample_pct     = 0.200000
[10/19/21 23:14:29] INFO	importances       = True
[10/19/21 23:14:29] INFO	interactions      = False
[10/19/21 23:14:29] INFO	isomap            = False
[10/19/21 23:14:29] INFO	iso_components    = 2
[10/19/21 23:14:29] INFO	iso_neighbors     = 5
[10/19/21 23:14:29] INFO	isample_pct       = 10
[10/19/21 23:14:29] INFO	leaders           = []
[10/19/21 23:14:29] INFO	learning_curve    = True
[10/19/21 23:14:29] INFO	logtransform      = False
[10/19/21 23:14:29] INFO	lv_remove         = True
[10/19/21 23:14:29] INFO	lv_threshold      = 0.100000
[10/19/21 23:14:29] INFO	model_type        = <ModelType.classification: 1>
[10/19/21 23:14:29] INFO	n_estimators      = 51
[10/19/21 23:14:29] INFO	n_jobs            = -1
[10/19/21 23:14:29] INFO	ngrams_max        = 2
[10/19/21 23:14:29] INFO	numpy             = True
[10/19/21 23:14:29] INFO	pca               = False
[10/19/21 23:14:29] INFO	pca_inc           = 1
[10/19/21 23:14:29] INFO	pca_max           = 10
[10/19/21 23:14:29] INFO	pca_min           = 2
[10/19/21 23:14:29] INFO	pca_whiten        = False
[10/19/21 23:14:29] INFO	poly_degree       = 2
[10/19/21 23:14:29] INFO	pvalue_level      = 0.010000
[10/19/21 23:14:29] INFO	rfe               = True
[10/19/21 23:14:29] INFO	rfe_step          = 3
[10/19/21 23:14:29] INFO	roc_curve         = True
[10/19/21 23:14:29] INFO	rounding          = 2
[10/19/21 23:14:29] INFO	sampling          = False
[10/19/21 23:14:29] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/19/21 23:14:29] INFO	sampling_ratio    = 0.500000
[10/19/21 23:14:29] INFO	scaler_option     = True
[10/19/21 23:14:29] INFO	scaler_type       = <Scalers.standard: 2>
[10/19/21 23:14:29] INFO	scipy             = False
[10/19/21 23:14:29] INFO	scorer            = roc_auc
[10/19/21 23:14:29] INFO	seed              = 42
[10/19/21 23:14:29] INFO	sentinel          = -1
[10/19/21 23:14:29] INFO	separator         = ,
[10/19/21 23:14:29] INFO	shuffle           = False
[10/19/21 23:14:29] INFO	split             = 0.400000
[10/19/21 23:14:29] INFO	submission_file   = gender_submission
[10/19/21 23:14:29] INFO	submit_probas     = False
[10/19/21 23:14:29] INFO	target [y]        = Survived
[10/19/21 23:14:29] INFO	target_value      = 1
[10/19/21 23:14:29] INFO	transforms        = None
[10/19/21 23:14:29] INFO	tsne              = False
[10/19/21 23:14:29] INFO	tsne_components   = 2
[10/19/21 23:14:29] INFO	tsne_learn_rate   = 1000.000000
[10/19/21 23:14:29] INFO	tsne_perplexity   = 30.000000
[10/19/21 23:14:29] INFO	vectorize         = False
[10/19/21 23:14:29] INFO	verbosity         = 0
[10/19/21 23:14:29] INFO	Creating Model
[10/19/21 23:14:29] INFO	Calling Pipeline
[10/19/21 23:14:29] INFO	Training Pipeline
[10/19/21 23:14:29] INFO	Loading Data
[10/19/21 23:14:29] INFO	Loading data from ./input/train.csv
[10/19/21 23:14:29] INFO	Found target Survived in data frame
[10/19/21 23:14:29] INFO	Labels (y) found for Partition.train
[10/19/21 23:14:29] INFO	Loading Data
[10/19/21 23:14:29] INFO	Loading data from ./input/test.csv
[10/19/21 23:14:29] INFO	Target Survived not found in Partition.test
[10/19/21 23:14:29] INFO	Saving New Features in Model
[10/19/21 23:14:29] INFO	Original Feature Statistics
[10/19/21 23:14:29] INFO	Number of Training Rows    : 891
[10/19/21 23:14:29] INFO	Number of Training Columns : 11
[10/19/21 23:14:29] INFO	Unique Training Values for Survived : [0 1]
[10/19/21 23:14:29] INFO	Unique Training Counts for Survived : [549 342]
[10/19/21 23:14:29] INFO	Number of Testing Rows     : 418
[10/19/21 23:14:29] INFO	Number of Testing Columns  : 11
[10/19/21 23:14:29] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/19/21 23:14:29] INFO	Feature Count     : 11
[10/19/21 23:14:29] INFO	Applying transforms
[10/19/21 23:14:29] INFO	No transforms Specified
[10/19/21 23:14:29] INFO	New Feature Count : 11
[10/19/21 23:14:29] INFO	Dropping Features: ['PassengerId']
[10/19/21 23:14:29] INFO	Original Feature Count : 11
[10/19/21 23:14:29] INFO	Reduced Feature Count  : 10
[10/19/21 23:14:29] INFO	Writing data frame to ./input/train_20211019.csv
[10/19/21 23:14:29] INFO	Writing data frame to ./input/test_20211019.csv
[10/19/21 23:14:29] INFO	Creating Cross-Tabulations
[10/19/21 23:14:29] INFO	Creating crosstabs for feature Embarked
[10/19/21 23:14:29] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/19/21 23:14:29] INFO	Feature Count     : 10
[10/19/21 23:14:29] INFO	Creating Count Features
[10/19/21 23:14:29] INFO	NA Counts
[10/19/21 23:14:29] INFO	Number Counts
[10/19/21 23:14:29] INFO	New Feature Count : 21
[10/19/21 23:14:29] INFO	Creating Base Features
[10/19/21 23:14:29] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/19/21 23:14:29] INFO	Feature 2: Name => Factorization
[10/19/21 23:14:29] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/19/21 23:14:29] INFO	Feature 3: Sex => Factorization
[10/19/21 23:14:29] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/19/21 23:14:29] INFO	Feature 7: Ticket => Factorization
[10/19/21 23:14:29] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/19/21 23:14:29] INFO	Feature 9: Cabin => Factorization
[10/19/21 23:14:29] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/19/21 23:14:29] INFO	Encoding: Encoders.target
[10/19/21 23:14:29] INFO	Fitting training features for Embarked
[10/19/21 23:14:29] INFO	Transforming testing features for Embarked
[10/19/21 23:14:29] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	New Feature Count : 21
[10/19/21 23:14:29] INFO	Scaling Base Features
[10/19/21 23:14:29] INFO	Creating NumPy Features
[10/19/21 23:14:29] INFO	NumPy Feature: sum
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: mean
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: std
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: var
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature Count : 4
[10/19/21 23:14:29] INFO	New Feature Count : 25
[10/19/21 23:14:29] INFO	Creating Clustering Features
[10/19/21 23:14:29] INFO	Cluster Minimum   : 3
[10/19/21 23:14:29] INFO	Cluster Maximum   : 30
[10/19/21 23:14:29] INFO	Cluster Increment : 3
[10/19/21 23:14:29] INFO	k = 3
[10/19/21 23:14:30] INFO	k = 6
[10/19/21 23:14:30] INFO	k = 9
[10/19/21 23:14:30] INFO	k = 12
[10/19/21 23:14:30] INFO	k = 15
[10/19/21 23:14:30] INFO	k = 18
[10/19/21 23:14:30] INFO	k = 21
[10/19/21 23:14:30] INFO	k = 24
[10/19/21 23:14:30] INFO	k = 27
[10/19/21 23:14:30] INFO	k = 30
[10/19/21 23:14:30] INFO	Clustering Feature Count : 10
[10/19/21 23:14:30] INFO	New Feature Count : 35
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Creating Interactions
[10/19/21 23:14:30] INFO	Initial Feature Count  : 35
[10/19/21 23:14:30] INFO	Skipping Interactions
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Removing Low-Variance Features
[10/19/21 23:14:30] INFO	Low-Variance Threshold  : 0.10
[10/19/21 23:14:30] INFO	Original Feature Count  : 35
[10/19/21 23:14:30] INFO	Reduced Feature Count   : 35
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Skipping Shuffling
[10/19/21 23:14:30] INFO	Skipping Sampling
[10/19/21 23:14:30] INFO	Getting All Estimators
[10/19/21 23:14:30] INFO	Algorithm Configuration
[10/19/21 23:14:30] INFO	Selecting Models
[10/19/21 23:14:30] INFO	Algorithm: CATB
[10/19/21 23:14:30] INFO	Fitting Initial Model
[10/19/21 23:14:31] INFO	Cross-Validation
[10/19/21 23:14:32] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/19/21 23:14:32] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:35] INFO	RFECV took 2.51 seconds for step 3 and 3 folds
[10/19/21 23:14:35] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/19/21 23:14:35] INFO	No grid is defined for grid search
[10/19/21 23:14:35] INFO	Final Model Predictions for CATB
[10/19/21 23:14:35] INFO	Skipping Calibration
[10/19/21 23:14:35] INFO	Making Predictions
[10/19/21 23:14:35] INFO	Predictions Complete
[10/19/21 23:14:35] INFO	Algorithm: LGB
[10/19/21 23:14:35] INFO	Fitting Initial Model
[10/19/21 23:14:35] INFO	Cross-Validation
[10/19/21 23:14:36] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/19/21 23:14:36] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:38] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[10/19/21 23:14:38] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/19/21 23:14:38] INFO	No grid is defined for grid search
[10/19/21 23:14:38] INFO	Final Model Predictions for LGB
[10/19/21 23:14:38] INFO	Skipping Calibration
[10/19/21 23:14:38] INFO	Making Predictions
[10/19/21 23:14:38] INFO	Predictions Complete
[10/19/21 23:14:38] INFO	Algorithm: XGB
[10/19/21 23:14:38] INFO	Fitting Initial Model
[10/19/21 23:14:38] INFO	Cross-Validation
[10/19/21 23:14:38] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/19/21 23:14:38] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:42] INFO	RFECV took 3.16 seconds for step 3 and 3 folds
[10/19/21 23:14:42] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/19/21 23:14:42] INFO	Randomized Grid Search
[10/19/21 23:16:02] INFO	Grid Search took 80.51 seconds for 50 candidate parameter settings.
[10/19/21 23:16:02] INFO	Model with rank: 1
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.020)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Model with rank: 2
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.022)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[10/19/21 23:16:02] INFO	Model with rank: 3
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.021)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Algorithm: XGB, Best Score: 0.8724, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Final Model Predictions for XGB
[10/19/21 23:16:02] INFO	Skipping Calibration
[10/19/21 23:16:02] INFO	Making Predictions
[10/19/21 23:16:02] INFO	Predictions Complete
[10/19/21 23:16:02] INFO	Blending Models
[10/19/21 23:16:02] INFO	Blending Start: 2021-10-19 23:16:02.629081
[10/19/21 23:16:02] INFO	Blending Complete: 0:00:00.014905
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Metrics for: Partition.train
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: CATB
[10/19/21 23:16:02] INFO	accuracy: 0.8585858585858586
[10/19/21 23:16:02] INFO	average_precision: 0.9113351686222868
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.8378391333525069
[10/19/21 23:16:02] INFO	brier_score_loss: 0.10043404518351136
[10/19/21 23:16:02] INFO	cohen_kappa: 0.6932572665125658
[10/19/21 23:16:02] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/19/21 23:16:02] INFO	f1: 0.8025078369905956
[10/19/21 23:16:02] INFO	neg_log_loss: 0.3371948718196211
[10/19/21 23:16:02] INFO	precision: 0.8648648648648649
[10/19/21 23:16:02] INFO	recall: 0.7485380116959064
[10/19/21 23:16:02] INFO	roc_auc: 0.9297979313797549
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: LGB
[10/19/21 23:16:02] INFO	accuracy: 0.9730639730639731
[10/19/21 23:16:02] INFO	average_precision: 0.9961113207491221
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.9687709711437062
[10/19/21 23:16:02] INFO	brier_score_loss: 0.032809498448974184
[10/19/21 23:16:02] INFO	cohen_kappa: 0.9427387092109702
[10/19/21 23:16:02] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/19/21 23:16:02] INFO	f1: 0.9643916913946586
[10/19/21 23:16:02] INFO	neg_log_loss: 0.1458307566281259
[10/19/21 23:16:02] INFO	precision: 0.9789156626506024
[10/19/21 23:16:02] INFO	recall: 0.9502923976608187
[10/19/21 23:16:02] INFO	roc_auc: 0.9974861257576241
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: XGB
[10/19/21 23:16:02] INFO	accuracy: 0.9304152637485971
[10/19/21 23:16:02] INFO	average_precision: 0.9716306882839921
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.9181765890135174
[10/19/21 23:16:02] INFO	brier_score_loss: 0.07412143940154169
[10/19/21 23:16:02] INFO	cohen_kappa: 0.8504167275917531
[10/19/21 23:16:02] INFO	confusion_matrix: [[533  16]
 [ 46 296]]
[10/19/21 23:16:02] INFO	f1: 0.9051987767584098
[10/19/21 23:16:02] INFO	neg_log_loss: 0.2874399062275351
[10/19/21 23:16:02] INFO	precision: 0.9487179487179487
[10/19/21 23:16:02] INFO	recall: 0.8654970760233918
[10/19/21 23:16:02] INFO	roc_auc: 0.9800967202462746
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Metrics for: Partition.test
[10/19/21 23:16:02] INFO	No labels for generating Partition.test metrics
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Selecting Best Model
[10/19/21 23:16:02] INFO	Scoring for: Partition.train
[10/19/21 23:16:02] INFO	Best Model Selection Start: 2021-10-19 23:16:02.667204
[10/19/21 23:16:02] INFO	Scoring CATB Model
[10/19/21 23:16:02] INFO	Scoring LGB Model
[10/19/21 23:16:02] INFO	Scoring XGB Model
[10/19/21 23:16:02] INFO	Scoring BLEND Model
[10/19/21 23:16:02] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[10/19/21 23:16:02] INFO	Best Model Selection Complete: 0:00:00.000221
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Generating Plots for partition: train
[10/19/21 23:16:02] INFO	Generating Calibration Plot
[10/19/21 23:16:02] INFO	Calibration for Algorithm: CATB
[10/19/21 23:16:02] INFO	Calibration for Algorithm: LGB
[10/19/21 23:16:02] INFO	Calibration for Algorithm: XGB
[10/19/21 23:16:02] INFO	Writing plot to ./plots/calibration_train.png
[10/19/21 23:16:02] INFO	Generating Confusion Matrices
[10/19/21 23:16:02] INFO	Confusion Matrix for Algorithm: CATB
[10/19/21 23:16:02] INFO	Confusion Matrix:
[10/19/21 23:16:02] INFO	[[509  40]
 [ 86 256]]
[10/19/21 23:16:02] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/19/21 23:16:02] INFO	Confusion Matrix for Algorithm: LGB
[10/19/21 23:16:02] INFO	Confusion Matrix:
[10/19/21 23:16:02] INFO	[[542   7]
 [ 17 325]]
[10/19/21 23:16:02] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/19/21 23:16:03] INFO	Confusion Matrix for Algorithm: XGB
[10/19/21 23:16:03] INFO	Confusion Matrix:
[10/19/21 23:16:03] INFO	[[533  16]
 [ 46 296]]
[10/19/21 23:16:03] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/19/21 23:16:03] INFO	Generating ROC Curves
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: CATB
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: LGB
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: XGB
[10/19/21 23:16:03] INFO	Writing plot to ./plots/roc_curve_train.png
[10/19/21 23:16:03] INFO	Generating Learning Curves
[10/19/21 23:16:03] INFO	Algorithm Configuration
[10/19/21 23:16:03] INFO	Learning Curve for Algorithm: CATB
[10/19/21 23:16:03] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/19/21 23:16:03] INFO	Learning Curve for Algorithm: LGB
[10/19/21 23:16:05] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/19/21 23:16:05] INFO	Learning Curve for Algorithm: XGB
[10/19/21 23:16:06] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/19/21 23:16:06] INFO	Generating Feature Importance Plots
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: CATB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Sex_factor (45.178104)
[10/19/21 23:16:06] INFO	2. Pclass (13.721171)
[10/19/21 23:16:06] INFO	3. Age (6.651788)
[10/19/21 23:16:06] INFO	4. Fare (4.529770)
[10/19/21 23:16:06] INFO	5. var (3.586590)
[10/19/21 23:16:06] INFO	6. std (3.492385)
[10/19/21 23:16:06] INFO	7. Ticket_factor (3.315046)
[10/19/21 23:16:06] INFO	8. cluster_30 (2.831587)
[10/19/21 23:16:06] INFO	9. mean (2.733389)
[10/19/21 23:16:06] INFO	10. Name_factor (2.586310)
[10/19/21 23:16:06] INFO	11. Cabin_factor (2.101764)
[10/19/21 23:16:06] INFO	12. Embarked (2.086410)
[10/19/21 23:16:06] INFO	13. SibSp (2.085405)
[10/19/21 23:16:06] INFO	14. cluster_12 (1.876782)
[10/19/21 23:16:06] INFO	15. cluster_24 (1.263144)
[10/19/21 23:16:06] INFO	16. count_2 (1.004409)
[10/19/21 23:16:06] INFO	17. sum (0.955946)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: LGB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Fare (256.000000)
[10/19/21 23:16:06] INFO	2. sum (241.000000)
[10/19/21 23:16:06] INFO	3. Age (232.000000)
[10/19/21 23:16:06] INFO	4. std (201.000000)
[10/19/21 23:16:06] INFO	5. Ticket_factor (199.000000)
[10/19/21 23:16:06] INFO	6. Name_factor (175.000000)
[10/19/21 23:16:06] INFO	7. cluster_30 (53.000000)
[10/19/21 23:16:06] INFO	8. cluster_27 (46.000000)
[10/19/21 23:16:06] INFO	9. Sex_factor (43.000000)
[10/19/21 23:16:06] INFO	10. Pclass (43.000000)
[10/19/21 23:16:06] INFO	11. Cabin_factor (41.000000)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: XGB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Sex_factor (0.424644)
[10/19/21 23:16:06] INFO	2. Pclass (0.127452)
[10/19/21 23:16:06] INFO	3. Cabin_factor (0.081307)
[10/19/21 23:16:06] INFO	4. Age (0.051007)
[10/19/21 23:16:06] INFO	5. SibSp (0.049620)
[10/19/21 23:16:06] INFO	6. count_1 (0.046373)
[10/19/21 23:16:06] INFO	7. Embarked (0.046225)
[10/19/21 23:16:06] INFO	8. std (0.036262)
[10/19/21 23:16:06] INFO	9. cluster_30 (0.036076)
[10/19/21 23:16:06] INFO	10. Fare (0.032410)
[10/19/21 23:16:06] INFO	11. cluster_24 (0.021187)
[10/19/21 23:16:06] INFO	12. Name_factor (0.019312)
[10/19/21 23:16:06] INFO	13. sum (0.017784)
[10/19/21 23:16:06] INFO	14. cluster_15 (0.010340)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/19/21 23:16:06] INFO	================================================================================
[10/19/21 23:16:06] INFO	Saving Model Predictor
[10/19/21 23:16:06] INFO	Writing model predictor to ./model/model_20211019.pkl
[10/19/21 23:16:06] INFO	Saving Feature Map
[10/19/21 23:16:06] INFO	Writing feature map to ./model/feature_map_20211019.pkl
[10/19/21 23:16:06] INFO	Loading data from ./input/test_20211019.csv
[10/19/21 23:16:07] INFO	Saving Predictions
[10/19/21 23:16:07] INFO	Writing data frame to ./output/predictions_20211019.csv
[10/19/21 23:16:07] INFO	Saving Probabilities
[10/19/21 23:16:07] INFO	Writing data frame to ./output/probabilities_20211019.csv
[10/19/21 23:16:07] INFO	Saving Ranked Predictions
[10/19/21 23:16:07] INFO	Writing data frame to ./output/rankings_20211019.csv
[10/19/21 23:16:07] INFO	Saving Submission to ./output/submission_20211019.csv
[10/19/21 23:16:07] INFO	********************************************************************************
[10/19/21 23:16:07] INFO	AlphaPy End
[10/19/21 23:16:07] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	AlphaPy Start
[10/22/21 08:41:15] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	Model Configuration
[10/22/21 08:41:15] INFO	No transforms Found
[10/22/21 08:41:15] INFO	MODEL PARAMETERS:
[10/22/21 08:41:15] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/22/21 08:41:15] INFO	calibration       = False
[10/22/21 08:41:15] INFO	cal_type          = sigmoid
[10/22/21 08:41:15] INFO	calibration_plot  = False
[10/22/21 08:41:15] INFO	clustering        = True
[10/22/21 08:41:15] INFO	cluster_inc       = 3
[10/22/21 08:41:15] INFO	cluster_max       = 30
[10/22/21 08:41:15] INFO	cluster_min       = 3
[10/22/21 08:41:15] INFO	confusion_matrix  = True
[10/22/21 08:41:15] INFO	counts            = True
[10/22/21 08:41:15] INFO	cv_folds          = 3
[10/22/21 08:41:15] INFO	directory         = .
[10/22/21 08:41:15] INFO	extension         = csv
[10/22/21 08:41:15] INFO	drop              = ['PassengerId']
[10/22/21 08:41:15] INFO	encoder           = <Encoders.target: 14>
[10/22/21 08:41:15] INFO	esr               = 20
[10/22/21 08:41:15] INFO	factors           = ['Embarked']
[10/22/21 08:41:15] INFO	features [X]      = *
[10/22/21 08:41:15] INFO	feature_selection = False
[10/22/21 08:41:15] INFO	fs_percentage     = 50
[10/22/21 08:41:15] INFO	fs_score_func     = <function f_classif at 0x7f8f52c715e0>
[10/22/21 08:41:15] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/22/21 08:41:15] INFO	grid_search       = True
[10/22/21 08:41:15] INFO	gs_iters          = 50
[10/22/21 08:41:15] INFO	gs_random         = True
[10/22/21 08:41:15] INFO	gs_sample         = False
[10/22/21 08:41:15] INFO	gs_sample_pct     = 0.200000
[10/22/21 08:41:15] INFO	importances       = True
[10/22/21 08:41:15] INFO	interactions      = False
[10/22/21 08:41:15] INFO	isomap            = False
[10/22/21 08:41:15] INFO	iso_components    = 2
[10/22/21 08:41:15] INFO	iso_neighbors     = 5
[10/22/21 08:41:15] INFO	isample_pct       = 10
[10/22/21 08:41:15] INFO	leaders           = []
[10/22/21 08:41:15] INFO	learning_curve    = True
[10/22/21 08:41:15] INFO	logtransform      = False
[10/22/21 08:41:15] INFO	lv_remove         = True
[10/22/21 08:41:15] INFO	lv_threshold      = 0.100000
[10/22/21 08:41:15] INFO	model_type        = <ModelType.classification: 1>
[10/22/21 08:41:15] INFO	n_estimators      = 51
[10/22/21 08:41:15] INFO	n_jobs            = -1
[10/22/21 08:41:15] INFO	ngrams_max        = 2
[10/22/21 08:41:15] INFO	numpy             = True
[10/22/21 08:41:15] INFO	pca               = False
[10/22/21 08:41:15] INFO	pca_inc           = 1
[10/22/21 08:41:15] INFO	pca_max           = 10
[10/22/21 08:41:15] INFO	pca_min           = 2
[10/22/21 08:41:15] INFO	pca_whiten        = False
[10/22/21 08:41:15] INFO	poly_degree       = 2
[10/22/21 08:41:15] INFO	pvalue_level      = 0.010000
[10/22/21 08:41:15] INFO	rfe               = True
[10/22/21 08:41:15] INFO	rfe_step          = 3
[10/22/21 08:41:15] INFO	roc_curve         = True
[10/22/21 08:41:15] INFO	rounding          = 2
[10/22/21 08:41:15] INFO	sampling          = False
[10/22/21 08:41:15] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/22/21 08:41:15] INFO	sampling_ratio    = 0.500000
[10/22/21 08:41:15] INFO	scaler_option     = True
[10/22/21 08:41:15] INFO	scaler_type       = <Scalers.standard: 2>
[10/22/21 08:41:15] INFO	scipy             = False
[10/22/21 08:41:15] INFO	scorer            = roc_auc
[10/22/21 08:41:15] INFO	seed              = 42
[10/22/21 08:41:15] INFO	sentinel          = -1
[10/22/21 08:41:15] INFO	separator         = ,
[10/22/21 08:41:15] INFO	shuffle           = False
[10/22/21 08:41:15] INFO	split             = 0.400000
[10/22/21 08:41:15] INFO	submission_file   = gender_submission
[10/22/21 08:41:15] INFO	submit_probas     = False
[10/22/21 08:41:15] INFO	target [y]        = Survived
[10/22/21 08:41:15] INFO	target_value      = 1
[10/22/21 08:41:15] INFO	transforms        = None
[10/22/21 08:41:15] INFO	tsne              = False
[10/22/21 08:41:15] INFO	tsne_components   = 2
[10/22/21 08:41:15] INFO	tsne_learn_rate   = 1000.000000
[10/22/21 08:41:15] INFO	tsne_perplexity   = 30.000000
[10/22/21 08:41:15] INFO	vectorize         = False
[10/22/21 08:41:15] INFO	verbosity         = 0
[10/22/21 08:41:15] INFO	Creating Model
[10/22/21 08:41:15] INFO	Calling Pipeline
[10/22/21 08:41:15] INFO	Training Pipeline
[10/22/21 08:41:15] INFO	Loading Data
[10/22/21 08:41:15] INFO	Loading data from ./input/train.csv
[10/22/21 08:41:15] INFO	Found target Survived in data frame
[10/22/21 08:41:15] INFO	Labels (y) found for Partition.train
[10/22/21 08:41:15] INFO	Loading Data
[10/22/21 08:41:15] INFO	Loading data from ./input/test.csv
[10/22/21 08:41:15] INFO	Target Survived not found in Partition.test
[10/22/21 08:41:15] INFO	Saving New Features in Model
[10/22/21 08:41:15] INFO	Original Feature Statistics
[10/22/21 08:41:15] INFO	Number of Training Rows    : 891
[10/22/21 08:41:15] INFO	Number of Training Columns : 11
[10/22/21 08:41:15] INFO	Unique Training Values for Survived : [0 1]
[10/22/21 08:41:15] INFO	Unique Training Counts for Survived : [549 342]
[10/22/21 08:41:15] INFO	Number of Testing Rows     : 418
[10/22/21 08:41:15] INFO	Number of Testing Columns  : 11
[10/22/21 08:41:15] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 08:41:15] INFO	Feature Count     : 11
[10/22/21 08:41:15] INFO	Applying transforms
[10/22/21 08:41:15] INFO	No transforms Specified
[10/22/21 08:41:15] INFO	New Feature Count : 11
[10/22/21 08:41:15] INFO	Dropping Features: ['PassengerId']
[10/22/21 08:41:15] INFO	Original Feature Count : 11
[10/22/21 08:41:15] INFO	Reduced Feature Count  : 10
[10/22/21 08:41:15] INFO	Writing data frame to ./input/train_20211022.csv
[10/22/21 08:41:15] INFO	Writing data frame to ./input/test_20211022.csv
[10/22/21 08:41:15] INFO	Creating Cross-Tabulations
[10/22/21 08:41:15] INFO	Creating crosstabs for feature Embarked
[10/22/21 08:41:15] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 08:41:15] INFO	Feature Count     : 10
[10/22/21 08:41:15] INFO	Creating Count Features
[10/22/21 08:41:15] INFO	NA Counts
[10/22/21 08:41:15] INFO	Number Counts
[10/22/21 08:41:15] INFO	New Feature Count : 21
[10/22/21 08:41:15] INFO	Creating Base Features
[10/22/21 08:41:15] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/22/21 08:41:15] INFO	Feature 2: Name => Factorization
[10/22/21 08:41:15] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/22/21 08:41:15] INFO	Feature 3: Sex => Factorization
[10/22/21 08:41:15] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/22/21 08:41:15] INFO	Feature 7: Ticket => Factorization
[10/22/21 08:41:15] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/22/21 08:41:15] INFO	Feature 9: Cabin => Factorization
[10/22/21 08:41:15] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/22/21 08:41:15] INFO	Encoding: Encoders.target
[10/22/21 08:41:15] INFO	Fitting training features for Embarked
[10/22/21 08:41:15] INFO	Transforming testing features for Embarked
[10/22/21 08:41:15] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	New Feature Count : 21
[10/22/21 08:41:15] INFO	Scaling Base Features
[10/22/21 08:41:15] INFO	Creating NumPy Features
[10/22/21 08:41:15] INFO	NumPy Feature: sum
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: mean
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: std
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: var
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature Count : 4
[10/22/21 08:41:15] INFO	New Feature Count : 25
[10/22/21 08:41:15] INFO	Creating Clustering Features
[10/22/21 08:41:15] INFO	Cluster Minimum   : 3
[10/22/21 08:41:15] INFO	Cluster Maximum   : 30
[10/22/21 08:41:15] INFO	Cluster Increment : 3
[10/22/21 08:41:15] INFO	k = 3
[10/22/21 08:41:15] INFO	k = 6
[10/22/21 08:41:15] INFO	k = 9
[10/22/21 08:41:15] INFO	k = 12
[10/22/21 08:41:16] INFO	k = 15
[10/22/21 08:41:16] INFO	k = 18
[10/22/21 08:41:16] INFO	k = 21
[10/22/21 08:41:16] INFO	k = 24
[10/22/21 08:41:16] INFO	k = 27
[10/22/21 08:41:16] INFO	k = 30
[10/22/21 08:41:16] INFO	Clustering Feature Count : 10
[10/22/21 08:41:16] INFO	New Feature Count : 35
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Creating Interactions
[10/22/21 08:41:16] INFO	Initial Feature Count  : 35
[10/22/21 08:41:16] INFO	Skipping Interactions
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Removing Low-Variance Features
[10/22/21 08:41:16] INFO	Low-Variance Threshold  : 0.10
[10/22/21 08:41:16] INFO	Original Feature Count  : 35
[10/22/21 08:41:16] INFO	Reduced Feature Count   : 35
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Skipping Shuffling
[10/22/21 08:41:16] INFO	Skipping Sampling
[10/22/21 08:41:16] INFO	Getting All Estimators
[10/22/21 08:41:16] INFO	Algorithm Configuration
[10/22/21 08:41:16] INFO	Selecting Models
[10/22/21 08:41:16] INFO	Algorithm: CATB
[10/22/21 08:41:16] INFO	Fitting Initial Model
[10/22/21 08:41:17] INFO	Cross-Validation
[10/22/21 08:41:18] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/22/21 08:41:18] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:21] INFO	RFECV took 2.66 seconds for step 3 and 3 folds
[10/22/21 08:41:21] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/22/21 08:41:21] INFO	No grid is defined for grid search
[10/22/21 08:41:21] INFO	Final Model Predictions for CATB
[10/22/21 08:41:21] INFO	Skipping Calibration
[10/22/21 08:41:21] INFO	Making Predictions
[10/22/21 08:41:21] INFO	Predictions Complete
[10/22/21 08:41:21] INFO	Algorithm: LGB
[10/22/21 08:41:21] INFO	Fitting Initial Model
[10/22/21 08:41:21] INFO	Cross-Validation
[10/22/21 08:41:22] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/22/21 08:41:22] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:24] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[10/22/21 08:41:24] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/22/21 08:41:24] INFO	No grid is defined for grid search
[10/22/21 08:41:24] INFO	Final Model Predictions for LGB
[10/22/21 08:41:24] INFO	Skipping Calibration
[10/22/21 08:41:24] INFO	Making Predictions
[10/22/21 08:41:24] INFO	Predictions Complete
[10/22/21 08:41:24] INFO	Algorithm: XGB
[10/22/21 08:41:24] INFO	Fitting Initial Model
[10/22/21 08:41:25] INFO	Cross-Validation
[10/22/21 08:41:25] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/22/21 08:41:25] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:28] INFO	RFECV took 2.79 seconds for step 3 and 3 folds
[10/22/21 08:41:28] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/22/21 08:41:28] INFO	Randomized Grid Search
[10/22/21 08:42:48] INFO	Grid Search took 80.46 seconds for 50 candidate parameter settings.
[10/22/21 08:42:48] INFO	Model with rank: 1
[10/22/21 08:42:48] INFO	Mean validation score: 0.872 (std: 0.021)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[10/22/21 08:42:48] INFO	Model with rank: 2
[10/22/21 08:42:48] INFO	Mean validation score: 0.870 (std: 0.020)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[10/22/21 08:42:48] INFO	Model with rank: 3
[10/22/21 08:42:48] INFO	Mean validation score: 0.869 (std: 0.021)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 08:42:48] INFO	Algorithm: XGB, Best Score: 0.8723, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[10/22/21 08:42:48] INFO	Final Model Predictions for XGB
[10/22/21 08:42:48] INFO	Skipping Calibration
[10/22/21 08:42:48] INFO	Making Predictions
[10/22/21 08:42:48] INFO	Predictions Complete
[10/22/21 08:42:48] INFO	Blending Models
[10/22/21 08:42:48] INFO	Blending Start: 2021-10-22 08:42:48.601150
[10/22/21 08:42:48] INFO	Blending Complete: 0:00:00.013806
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Metrics for: Partition.train
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: CATB
[10/22/21 08:42:48] INFO	accuracy: 0.8585858585858586
[10/22/21 08:42:48] INFO	average_precision: 0.9113351686222868
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.8378391333525069
[10/22/21 08:42:48] INFO	brier_score_loss: 0.10043404518351136
[10/22/21 08:42:48] INFO	cohen_kappa: 0.6932572665125658
[10/22/21 08:42:48] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/22/21 08:42:48] INFO	f1: 0.8025078369905956
[10/22/21 08:42:48] INFO	neg_log_loss: 0.3371948718196211
[10/22/21 08:42:48] INFO	precision: 0.8648648648648649
[10/22/21 08:42:48] INFO	recall: 0.7485380116959064
[10/22/21 08:42:48] INFO	roc_auc: 0.9297979313797549
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: LGB
[10/22/21 08:42:48] INFO	accuracy: 0.9730639730639731
[10/22/21 08:42:48] INFO	average_precision: 0.9961113207491221
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.9687709711437062
[10/22/21 08:42:48] INFO	brier_score_loss: 0.032809498448974184
[10/22/21 08:42:48] INFO	cohen_kappa: 0.9427387092109702
[10/22/21 08:42:48] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/22/21 08:42:48] INFO	f1: 0.9643916913946586
[10/22/21 08:42:48] INFO	neg_log_loss: 0.1458307566281259
[10/22/21 08:42:48] INFO	precision: 0.9789156626506024
[10/22/21 08:42:48] INFO	recall: 0.9502923976608187
[10/22/21 08:42:48] INFO	roc_auc: 0.9974861257576241
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: XGB
[10/22/21 08:42:48] INFO	accuracy: 0.9438832772166106
[10/22/21 08:42:48] INFO	average_precision: 0.9799994752632971
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.9346179656792254
[10/22/21 08:42:48] INFO	brier_score_loss: 0.05492226465405633
[10/22/21 08:42:48] INFO	cohen_kappa: 0.8799068368188655
[10/22/21 08:42:48] INFO	confusion_matrix: [[535  14]
 [ 36 306]]
[10/22/21 08:42:48] INFO	f1: 0.9244712990936558
[10/22/21 08:42:48] INFO	neg_log_loss: 0.21545422471449296
[10/22/21 08:42:48] INFO	precision: 0.95625
[10/22/21 08:42:48] INFO	recall: 0.8947368421052632
[10/22/21 08:42:48] INFO	roc_auc: 0.9858008713343772
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Metrics for: Partition.test
[10/22/21 08:42:48] INFO	No labels for generating Partition.test metrics
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Selecting Best Model
[10/22/21 08:42:48] INFO	Scoring for: Partition.train
[10/22/21 08:42:48] INFO	Best Model Selection Start: 2021-10-22 08:42:48.637402
[10/22/21 08:42:48] INFO	Scoring CATB Model
[10/22/21 08:42:48] INFO	Scoring LGB Model
[10/22/21 08:42:48] INFO	Scoring XGB Model
[10/22/21 08:42:48] INFO	Scoring BLEND Model
[10/22/21 08:42:48] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/22/21 08:42:48] INFO	Best Model Selection Complete: 0:00:00.000262
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Generating Plots for partition: train
[10/22/21 08:42:48] INFO	Generating Calibration Plot
[10/22/21 08:42:48] INFO	Calibration for Algorithm: CATB
[10/22/21 08:42:48] INFO	Calibration for Algorithm: LGB
[10/22/21 08:42:48] INFO	Calibration for Algorithm: XGB
[10/22/21 08:42:48] INFO	Writing plot to ./plots/calibration_train.png
[10/22/21 08:42:48] INFO	Generating Confusion Matrices
[10/22/21 08:42:48] INFO	Confusion Matrix for Algorithm: CATB
[10/22/21 08:42:48] INFO	Confusion Matrix:
[10/22/21 08:42:48] INFO	[[509  40]
 [ 86 256]]
[10/22/21 08:42:48] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/22/21 08:42:48] INFO	Confusion Matrix for Algorithm: LGB
[10/22/21 08:42:48] INFO	Confusion Matrix:
[10/22/21 08:42:48] INFO	[[542   7]
 [ 17 325]]
[10/22/21 08:42:48] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/22/21 08:42:49] INFO	Confusion Matrix for Algorithm: XGB
[10/22/21 08:42:49] INFO	Confusion Matrix:
[10/22/21 08:42:49] INFO	[[535  14]
 [ 36 306]]
[10/22/21 08:42:49] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/22/21 08:42:49] INFO	Generating ROC Curves
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: CATB
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: LGB
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: XGB
[10/22/21 08:42:49] INFO	Writing plot to ./plots/roc_curve_train.png
[10/22/21 08:42:49] INFO	Generating Learning Curves
[10/22/21 08:42:49] INFO	Algorithm Configuration
[10/22/21 08:42:49] INFO	Learning Curve for Algorithm: CATB
[10/22/21 08:42:49] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/22/21 08:42:49] INFO	Learning Curve for Algorithm: LGB
[10/22/21 08:42:51] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/22/21 08:42:51] INFO	Learning Curve for Algorithm: XGB
[10/22/21 08:42:52] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/22/21 08:42:52] INFO	Generating Feature Importance Plots
[10/22/21 08:42:52] INFO	Feature Importances for Algorithm: CATB
[10/22/21 08:42:52] INFO	Feature Ranking:
[10/22/21 08:42:52] INFO	1. Sex_factor (45.178104)
[10/22/21 08:42:52] INFO	2. Pclass (13.721171)
[10/22/21 08:42:52] INFO	3. Age (6.651788)
[10/22/21 08:42:52] INFO	4. Fare (4.529770)
[10/22/21 08:42:52] INFO	5. var (3.586590)
[10/22/21 08:42:52] INFO	6. std (3.492385)
[10/22/21 08:42:52] INFO	7. Ticket_factor (3.315046)
[10/22/21 08:42:52] INFO	8. cluster_30 (2.831587)
[10/22/21 08:42:52] INFO	9. mean (2.733389)
[10/22/21 08:42:52] INFO	10. Name_factor (2.586310)
[10/22/21 08:42:52] INFO	11. Cabin_factor (2.101764)
[10/22/21 08:42:52] INFO	12. Embarked (2.086410)
[10/22/21 08:42:52] INFO	13. SibSp (2.085405)
[10/22/21 08:42:52] INFO	14. cluster_12 (1.876782)
[10/22/21 08:42:52] INFO	15. cluster_24 (1.263144)
[10/22/21 08:42:52] INFO	16. count_2 (1.004409)
[10/22/21 08:42:52] INFO	17. sum (0.955946)
[10/22/21 08:42:52] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/22/21 08:42:52] INFO	Feature Importances for Algorithm: LGB
[10/22/21 08:42:52] INFO	Feature Ranking:
[10/22/21 08:42:52] INFO	1. Fare (256.000000)
[10/22/21 08:42:52] INFO	2. sum (241.000000)
[10/22/21 08:42:52] INFO	3. Age (232.000000)
[10/22/21 08:42:52] INFO	4. std (201.000000)
[10/22/21 08:42:52] INFO	5. Ticket_factor (199.000000)
[10/22/21 08:42:52] INFO	6. Name_factor (175.000000)
[10/22/21 08:42:52] INFO	7. cluster_30 (53.000000)
[10/22/21 08:42:52] INFO	8. cluster_27 (46.000000)
[10/22/21 08:42:52] INFO	9. Sex_factor (43.000000)
[10/22/21 08:42:52] INFO	10. Pclass (43.000000)
[10/22/21 08:42:52] INFO	11. Cabin_factor (41.000000)
[10/22/21 08:42:52] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/22/21 08:42:53] INFO	Feature Importances for Algorithm: XGB
[10/22/21 08:42:53] INFO	Feature Ranking:
[10/22/21 08:42:53] INFO	1. Sex_factor (0.424644)
[10/22/21 08:42:53] INFO	2. Pclass (0.127452)
[10/22/21 08:42:53] INFO	3. Cabin_factor (0.081307)
[10/22/21 08:42:53] INFO	4. Age (0.051007)
[10/22/21 08:42:53] INFO	5. SibSp (0.049620)
[10/22/21 08:42:53] INFO	6. count_1 (0.046373)
[10/22/21 08:42:53] INFO	7. Embarked (0.046225)
[10/22/21 08:42:53] INFO	8. std (0.036262)
[10/22/21 08:42:53] INFO	9. cluster_30 (0.036076)
[10/22/21 08:42:53] INFO	10. Fare (0.032410)
[10/22/21 08:42:53] INFO	11. cluster_24 (0.021187)
[10/22/21 08:42:53] INFO	12. Name_factor (0.019312)
[10/22/21 08:42:53] INFO	13. sum (0.017784)
[10/22/21 08:42:53] INFO	14. cluster_15 (0.010340)
[10/22/21 08:42:53] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/22/21 08:42:53] INFO	================================================================================
[10/22/21 08:42:53] INFO	Saving Model Predictor
[10/22/21 08:42:53] INFO	Writing model predictor to ./model/model_20211022.pkl
[10/22/21 08:42:53] INFO	Saving Feature Map
[10/22/21 08:42:53] INFO	Writing feature map to ./model/feature_map_20211022.pkl
[10/22/21 08:42:53] INFO	Loading data from ./input/test_20211022.csv
[10/22/21 08:42:53] INFO	Saving Predictions
[10/22/21 08:42:53] INFO	Writing data frame to ./output/predictions_20211022.csv
[10/22/21 08:42:53] INFO	Saving Probabilities
[10/22/21 08:42:53] INFO	Writing data frame to ./output/probabilities_20211022.csv
[10/22/21 08:42:53] INFO	Saving Ranked Predictions
[10/22/21 08:42:53] INFO	Writing data frame to ./output/rankings_20211022.csv
[10/22/21 08:42:53] INFO	Saving Submission to ./output/submission_20211022.csv
[10/22/21 08:42:53] INFO	********************************************************************************
[10/22/21 08:42:53] INFO	AlphaPy End
[10/22/21 08:42:53] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	AlphaPy Start
[10/22/21 09:20:57] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	Model Configuration
[10/22/21 09:20:57] INFO	No transforms Found
[10/22/21 09:20:57] INFO	MODEL PARAMETERS:
[10/22/21 09:20:57] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/22/21 09:20:57] INFO	calibration       = False
[10/22/21 09:20:57] INFO	cal_type          = sigmoid
[10/22/21 09:20:57] INFO	calibration_plot  = False
[10/22/21 09:20:57] INFO	clustering        = True
[10/22/21 09:20:57] INFO	cluster_inc       = 3
[10/22/21 09:20:57] INFO	cluster_max       = 30
[10/22/21 09:20:57] INFO	cluster_min       = 3
[10/22/21 09:20:57] INFO	confusion_matrix  = True
[10/22/21 09:20:57] INFO	counts            = True
[10/22/21 09:20:57] INFO	cv_folds          = 3
[10/22/21 09:20:57] INFO	directory         = .
[10/22/21 09:20:57] INFO	extension         = csv
[10/22/21 09:20:57] INFO	drop              = ['PassengerId']
[10/22/21 09:20:57] INFO	encoder           = <Encoders.target: 14>
[10/22/21 09:20:57] INFO	esr               = 20
[10/22/21 09:20:57] INFO	factors           = ['Embarked']
[10/22/21 09:20:57] INFO	features [X]      = *
[10/22/21 09:20:57] INFO	feature_selection = False
[10/22/21 09:20:57] INFO	fs_percentage     = 50
[10/22/21 09:20:57] INFO	fs_score_func     = <function f_classif at 0x7fddd034a5e0>
[10/22/21 09:20:57] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/22/21 09:20:57] INFO	grid_search       = True
[10/22/21 09:20:57] INFO	gs_iters          = 50
[10/22/21 09:20:57] INFO	gs_random         = True
[10/22/21 09:20:57] INFO	gs_sample         = False
[10/22/21 09:20:57] INFO	gs_sample_pct     = 0.200000
[10/22/21 09:20:57] INFO	importances       = True
[10/22/21 09:20:57] INFO	interactions      = False
[10/22/21 09:20:57] INFO	isomap            = False
[10/22/21 09:20:57] INFO	iso_components    = 2
[10/22/21 09:20:57] INFO	iso_neighbors     = 5
[10/22/21 09:20:57] INFO	isample_pct       = 10
[10/22/21 09:20:57] INFO	leaders           = []
[10/22/21 09:20:57] INFO	learning_curve    = True
[10/22/21 09:20:57] INFO	logtransform      = False
[10/22/21 09:20:57] INFO	lv_remove         = True
[10/22/21 09:20:57] INFO	lv_threshold      = 0.100000
[10/22/21 09:20:57] INFO	model_type        = <ModelType.classification: 1>
[10/22/21 09:20:57] INFO	n_estimators      = 51
[10/22/21 09:20:57] INFO	n_jobs            = -1
[10/22/21 09:20:57] INFO	ngrams_max        = 2
[10/22/21 09:20:57] INFO	numpy             = True
[10/22/21 09:20:57] INFO	pca               = False
[10/22/21 09:20:57] INFO	pca_inc           = 1
[10/22/21 09:20:57] INFO	pca_max           = 10
[10/22/21 09:20:57] INFO	pca_min           = 2
[10/22/21 09:20:57] INFO	pca_whiten        = False
[10/22/21 09:20:57] INFO	poly_degree       = 2
[10/22/21 09:20:57] INFO	pvalue_level      = 0.010000
[10/22/21 09:20:57] INFO	rfe               = True
[10/22/21 09:20:57] INFO	rfe_step          = 3
[10/22/21 09:20:57] INFO	roc_curve         = True
[10/22/21 09:20:57] INFO	rounding          = 2
[10/22/21 09:20:57] INFO	sampling          = False
[10/22/21 09:20:57] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/22/21 09:20:57] INFO	sampling_ratio    = 0.500000
[10/22/21 09:20:57] INFO	scaler_option     = True
[10/22/21 09:20:57] INFO	scaler_type       = <Scalers.standard: 2>
[10/22/21 09:20:57] INFO	scipy             = False
[10/22/21 09:20:57] INFO	scorer            = roc_auc
[10/22/21 09:20:57] INFO	seed              = 42
[10/22/21 09:20:57] INFO	sentinel          = -1
[10/22/21 09:20:57] INFO	separator         = ,
[10/22/21 09:20:57] INFO	shuffle           = False
[10/22/21 09:20:57] INFO	split             = 0.400000
[10/22/21 09:20:57] INFO	submission_file   = gender_submission
[10/22/21 09:20:57] INFO	submit_probas     = False
[10/22/21 09:20:57] INFO	target [y]        = Survived
[10/22/21 09:20:57] INFO	target_value      = 1
[10/22/21 09:20:57] INFO	transforms        = None
[10/22/21 09:20:57] INFO	tsne              = False
[10/22/21 09:20:57] INFO	tsne_components   = 2
[10/22/21 09:20:57] INFO	tsne_learn_rate   = 1000.000000
[10/22/21 09:20:57] INFO	tsne_perplexity   = 30.000000
[10/22/21 09:20:57] INFO	vectorize         = False
[10/22/21 09:20:57] INFO	verbosity         = 0
[10/22/21 09:20:57] INFO	Creating Model
[10/22/21 09:20:57] INFO	Calling Pipeline
[10/22/21 09:20:57] INFO	Training Pipeline
[10/22/21 09:20:57] INFO	Loading Data
[10/22/21 09:20:57] INFO	Loading data from ./input/train.csv
[10/22/21 09:20:57] INFO	Found target Survived in data frame
[10/22/21 09:20:57] INFO	Labels (y) found for Partition.train
[10/22/21 09:20:57] INFO	Loading Data
[10/22/21 09:20:57] INFO	Loading data from ./input/test.csv
[10/22/21 09:20:57] INFO	Target Survived not found in Partition.test
[10/22/21 09:20:57] INFO	Saving New Features in Model
[10/22/21 09:20:57] INFO	Original Feature Statistics
[10/22/21 09:20:57] INFO	Number of Training Rows    : 891
[10/22/21 09:20:57] INFO	Number of Training Columns : 11
[10/22/21 09:20:57] INFO	Unique Training Values for Survived : [0 1]
[10/22/21 09:20:57] INFO	Unique Training Counts for Survived : [549 342]
[10/22/21 09:20:57] INFO	Number of Testing Rows     : 418
[10/22/21 09:20:57] INFO	Number of Testing Columns  : 11
[10/22/21 09:20:57] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 09:20:57] INFO	Feature Count     : 11
[10/22/21 09:20:57] INFO	Applying transforms
[10/22/21 09:20:57] INFO	No transforms Specified
[10/22/21 09:20:57] INFO	New Feature Count : 11
[10/22/21 09:20:57] INFO	Dropping Features: ['PassengerId']
[10/22/21 09:20:57] INFO	Original Feature Count : 11
[10/22/21 09:20:57] INFO	Reduced Feature Count  : 10
[10/22/21 09:20:57] INFO	Writing data frame to ./input/train_20211022.csv
[10/22/21 09:20:57] INFO	Writing data frame to ./input/test_20211022.csv
[10/22/21 09:20:57] INFO	Creating Cross-Tabulations
[10/22/21 09:20:57] INFO	Creating crosstabs for feature Embarked
[10/22/21 09:20:57] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 09:20:57] INFO	Feature Count     : 10
[10/22/21 09:20:57] INFO	Creating Count Features
[10/22/21 09:20:57] INFO	NA Counts
[10/22/21 09:20:57] INFO	Number Counts
[10/22/21 09:20:57] INFO	New Feature Count : 21
[10/22/21 09:20:57] INFO	Creating Base Features
[10/22/21 09:20:57] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/22/21 09:20:57] INFO	Feature 2: Name => Factorization
[10/22/21 09:20:57] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/22/21 09:20:57] INFO	Feature 3: Sex => Factorization
[10/22/21 09:20:57] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/22/21 09:20:57] INFO	Feature 7: Ticket => Factorization
[10/22/21 09:20:57] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/22/21 09:20:57] INFO	Feature 9: Cabin => Factorization
[10/22/21 09:20:57] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/22/21 09:20:57] INFO	Encoding: Encoders.target
[10/22/21 09:20:57] INFO	Fitting training features for Embarked
[10/22/21 09:20:57] INFO	Transforming testing features for Embarked
[10/22/21 09:20:57] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	New Feature Count : 21
[10/22/21 09:20:57] INFO	Scaling Base Features
[10/22/21 09:20:57] INFO	Creating NumPy Features
[10/22/21 09:20:57] INFO	NumPy Feature: sum
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: mean
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: std
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: var
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature Count : 4
[10/22/21 09:20:57] INFO	New Feature Count : 25
[10/22/21 09:20:57] INFO	Creating Clustering Features
[10/22/21 09:20:57] INFO	Cluster Minimum   : 3
[10/22/21 09:20:57] INFO	Cluster Maximum   : 30
[10/22/21 09:20:57] INFO	Cluster Increment : 3
[10/22/21 09:20:57] INFO	k = 3
[10/22/21 09:20:58] INFO	k = 6
[10/22/21 09:20:58] INFO	k = 9
[10/22/21 09:20:58] INFO	k = 12
[10/22/21 09:20:58] INFO	k = 15
[10/22/21 09:20:58] INFO	k = 18
[10/22/21 09:20:58] INFO	k = 21
[10/22/21 09:20:58] INFO	k = 24
[10/22/21 09:20:58] INFO	k = 27
[10/22/21 09:20:58] INFO	k = 30
[10/22/21 09:20:58] INFO	Clustering Feature Count : 10
[10/22/21 09:20:58] INFO	New Feature Count : 35
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Creating Interactions
[10/22/21 09:20:58] INFO	Initial Feature Count  : 35
[10/22/21 09:20:58] INFO	Skipping Interactions
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Removing Low-Variance Features
[10/22/21 09:20:58] INFO	Low-Variance Threshold  : 0.10
[10/22/21 09:20:58] INFO	Original Feature Count  : 35
[10/22/21 09:20:58] INFO	Reduced Feature Count   : 35
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Skipping Shuffling
[10/22/21 09:20:58] INFO	Skipping Sampling
[10/22/21 09:20:58] INFO	Getting All Estimators
[10/22/21 09:20:58] INFO	Algorithm Configuration
[10/22/21 09:20:59] INFO	Selecting Models
[10/22/21 09:20:59] INFO	Algorithm: CATB
[10/22/21 09:20:59] INFO	Fitting Initial Model
[10/22/21 09:20:59] INFO	Cross-Validation
[10/22/21 09:21:01] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/22/21 09:21:01] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:03] INFO	RFECV took 2.86 seconds for step 3 and 3 folds
[10/22/21 09:21:03] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/22/21 09:21:03] INFO	No grid is defined for grid search
[10/22/21 09:21:03] INFO	Final Model Predictions for CATB
[10/22/21 09:21:03] INFO	Skipping Calibration
[10/22/21 09:21:03] INFO	Making Predictions
[10/22/21 09:21:03] INFO	Predictions Complete
[10/22/21 09:21:03] INFO	Algorithm: LGB
[10/22/21 09:21:03] INFO	Fitting Initial Model
[10/22/21 09:21:04] INFO	Cross-Validation
[10/22/21 09:21:05] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/22/21 09:21:05] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:07] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[10/22/21 09:21:07] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/22/21 09:21:07] INFO	No grid is defined for grid search
[10/22/21 09:21:07] INFO	Final Model Predictions for LGB
[10/22/21 09:21:07] INFO	Skipping Calibration
[10/22/21 09:21:07] INFO	Making Predictions
[10/22/21 09:21:07] INFO	Predictions Complete
[10/22/21 09:21:07] INFO	Algorithm: XGB
[10/22/21 09:21:07] INFO	Fitting Initial Model
[10/22/21 09:21:07] INFO	Cross-Validation
[10/22/21 09:21:08] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/22/21 09:21:08] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:10] INFO	RFECV took 2.70 seconds for step 3 and 3 folds
[10/22/21 09:21:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/22/21 09:21:10] INFO	Randomized Grid Search
[10/22/21 09:22:38] INFO	Grid Search took 87.43 seconds for 50 candidate parameter settings.
[10/22/21 09:22:38] INFO	Model with rank: 1
[10/22/21 09:22:38] INFO	Mean validation score: 0.871 (std: 0.023)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/22/21 09:22:38] INFO	Model with rank: 2
[10/22/21 09:22:38] INFO	Mean validation score: 0.868 (std: 0.018)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 09:22:38] INFO	Model with rank: 3
[10/22/21 09:22:38] INFO	Mean validation score: 0.868 (std: 0.020)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 09:22:38] INFO	Algorithm: XGB, Best Score: 0.8707, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/22/21 09:22:38] INFO	Final Model Predictions for XGB
[10/22/21 09:22:38] INFO	Skipping Calibration
[10/22/21 09:22:38] INFO	Making Predictions
[10/22/21 09:22:38] INFO	Predictions Complete
[10/22/21 09:22:38] INFO	Blending Models
[10/22/21 09:22:38] INFO	Blending Start: 2021-10-22 09:22:38.257465
[10/22/21 09:22:38] INFO	Blending Complete: 0:00:00.011166
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Metrics for: Partition.train
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: CATB
[10/22/21 09:22:38] INFO	accuracy: 0.8585858585858586
[10/22/21 09:22:38] INFO	average_precision: 0.9113351686222868
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.8378391333525069
[10/22/21 09:22:38] INFO	brier_score_loss: 0.10043404518351136
[10/22/21 09:22:38] INFO	cohen_kappa: 0.6932572665125658
[10/22/21 09:22:38] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/22/21 09:22:38] INFO	f1: 0.8025078369905956
[10/22/21 09:22:38] INFO	neg_log_loss: 0.3371948718196211
[10/22/21 09:22:38] INFO	precision: 0.8648648648648649
[10/22/21 09:22:38] INFO	recall: 0.7485380116959064
[10/22/21 09:22:38] INFO	roc_auc: 0.9297979313797549
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: LGB
[10/22/21 09:22:38] INFO	accuracy: 0.9730639730639731
[10/22/21 09:22:38] INFO	average_precision: 0.9961113207491221
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.9687709711437062
[10/22/21 09:22:38] INFO	brier_score_loss: 0.032809498448974184
[10/22/21 09:22:38] INFO	cohen_kappa: 0.9427387092109702
[10/22/21 09:22:38] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/22/21 09:22:38] INFO	f1: 0.9643916913946586
[10/22/21 09:22:38] INFO	neg_log_loss: 0.1458307566281259
[10/22/21 09:22:38] INFO	precision: 0.9789156626506024
[10/22/21 09:22:38] INFO	recall: 0.9502923976608187
[10/22/21 09:22:38] INFO	roc_auc: 0.9974861257576241
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: XGB
[10/22/21 09:22:38] INFO	accuracy: 0.9292929292929293
[10/22/21 09:22:38] INFO	average_precision: 0.9729467120088303
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.915612117726009
[10/22/21 09:22:38] INFO	brier_score_loss: 0.07965308322437895
[10/22/21 09:22:38] INFO	cohen_kappa: 0.8475769202570933
[10/22/21 09:22:38] INFO	confusion_matrix: [[535  14]
 [ 49 293]]
[10/22/21 09:22:38] INFO	f1: 0.9029275808936826
[10/22/21 09:22:38] INFO	neg_log_loss: 0.305648740301563
[10/22/21 09:22:38] INFO	precision: 0.9543973941368078
[10/22/21 09:22:38] INFO	recall: 0.8567251461988304
[10/22/21 09:22:38] INFO	roc_auc: 0.9796173798187028
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Metrics for: Partition.test
[10/22/21 09:22:38] INFO	No labels for generating Partition.test metrics
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Selecting Best Model
[10/22/21 09:22:38] INFO	Scoring for: Partition.train
[10/22/21 09:22:38] INFO	Best Model Selection Start: 2021-10-22 09:22:38.289742
[10/22/21 09:22:38] INFO	Scoring CATB Model
[10/22/21 09:22:38] INFO	Scoring LGB Model
[10/22/21 09:22:38] INFO	Scoring XGB Model
[10/22/21 09:22:38] INFO	Scoring BLEND Model
[10/22/21 09:22:38] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[10/22/21 09:22:38] INFO	Best Model Selection Complete: 0:00:00.000198
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Generating Plots for partition: train
[10/22/21 09:22:38] INFO	Generating Calibration Plot
[10/22/21 09:22:38] INFO	Calibration for Algorithm: CATB
[10/22/21 09:22:38] INFO	Calibration for Algorithm: LGB
[10/22/21 09:22:38] INFO	Calibration for Algorithm: XGB
[10/22/21 09:22:38] INFO	Writing plot to ./plots/calibration_train.png
[10/22/21 09:22:38] INFO	Generating Confusion Matrices
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: CATB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[509  40]
 [ 86 256]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: LGB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[542   7]
 [ 17 325]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: XGB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[535  14]
 [ 49 293]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/22/21 09:22:38] INFO	Generating ROC Curves
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: CATB
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: LGB
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: XGB
[10/22/21 09:22:38] INFO	Writing plot to ./plots/roc_curve_train.png
[10/22/21 09:22:38] INFO	Generating Learning Curves
[10/22/21 09:22:38] INFO	Algorithm Configuration
[10/22/21 09:22:38] INFO	Learning Curve for Algorithm: CATB
[10/22/21 09:22:39] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/22/21 09:22:39] INFO	Learning Curve for Algorithm: LGB
[10/22/21 09:22:41] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/22/21 09:22:41] INFO	Learning Curve for Algorithm: XGB
[10/22/21 09:22:42] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/22/21 09:22:42] INFO	Generating Feature Importance Plots
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: CATB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Sex_factor (45.178104)
[10/22/21 09:22:42] INFO	2. Pclass (13.721171)
[10/22/21 09:22:42] INFO	3. Age (6.651788)
[10/22/21 09:22:42] INFO	4. Fare (4.529770)
[10/22/21 09:22:42] INFO	5. var (3.586590)
[10/22/21 09:22:42] INFO	6. std (3.492385)
[10/22/21 09:22:42] INFO	7. Ticket_factor (3.315046)
[10/22/21 09:22:42] INFO	8. cluster_30 (2.831587)
[10/22/21 09:22:42] INFO	9. mean (2.733389)
[10/22/21 09:22:42] INFO	10. Name_factor (2.586310)
[10/22/21 09:22:42] INFO	11. Cabin_factor (2.101764)
[10/22/21 09:22:42] INFO	12. Embarked (2.086410)
[10/22/21 09:22:42] INFO	13. SibSp (2.085405)
[10/22/21 09:22:42] INFO	14. cluster_12 (1.876782)
[10/22/21 09:22:42] INFO	15. cluster_24 (1.263144)
[10/22/21 09:22:42] INFO	16. count_2 (1.004409)
[10/22/21 09:22:42] INFO	17. sum (0.955946)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: LGB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Fare (256.000000)
[10/22/21 09:22:42] INFO	2. sum (241.000000)
[10/22/21 09:22:42] INFO	3. Age (232.000000)
[10/22/21 09:22:42] INFO	4. std (201.000000)
[10/22/21 09:22:42] INFO	5. Ticket_factor (199.000000)
[10/22/21 09:22:42] INFO	6. Name_factor (175.000000)
[10/22/21 09:22:42] INFO	7. cluster_30 (53.000000)
[10/22/21 09:22:42] INFO	8. cluster_27 (46.000000)
[10/22/21 09:22:42] INFO	9. Sex_factor (43.000000)
[10/22/21 09:22:42] INFO	10. Pclass (43.000000)
[10/22/21 09:22:42] INFO	11. Cabin_factor (41.000000)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: XGB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Sex_factor (0.424644)
[10/22/21 09:22:42] INFO	2. Pclass (0.127452)
[10/22/21 09:22:42] INFO	3. Cabin_factor (0.081307)
[10/22/21 09:22:42] INFO	4. Age (0.051007)
[10/22/21 09:22:42] INFO	5. SibSp (0.049620)
[10/22/21 09:22:42] INFO	6. count_1 (0.046373)
[10/22/21 09:22:42] INFO	7. Embarked (0.046225)
[10/22/21 09:22:42] INFO	8. std (0.036262)
[10/22/21 09:22:42] INFO	9. cluster_30 (0.036076)
[10/22/21 09:22:42] INFO	10. Fare (0.032410)
[10/22/21 09:22:42] INFO	11. cluster_24 (0.021187)
[10/22/21 09:22:42] INFO	12. Name_factor (0.019312)
[10/22/21 09:22:42] INFO	13. sum (0.017784)
[10/22/21 09:22:42] INFO	14. cluster_15 (0.010340)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/22/21 09:22:42] INFO	================================================================================
[10/22/21 09:22:42] INFO	Saving Model Predictor
[10/22/21 09:22:42] INFO	Writing model predictor to ./model/model_20211022.pkl
[10/22/21 09:22:42] INFO	Saving Feature Map
[10/22/21 09:22:42] INFO	Writing feature map to ./model/feature_map_20211022.pkl
[10/22/21 09:22:42] INFO	Loading data from ./input/test_20211022.csv
[10/22/21 09:22:42] INFO	Saving Predictions
[10/22/21 09:22:42] INFO	Writing data frame to ./output/predictions_20211022.csv
[10/22/21 09:22:42] INFO	Saving Probabilities
[10/22/21 09:22:42] INFO	Writing data frame to ./output/probabilities_20211022.csv
[10/22/21 09:22:42] INFO	Saving Ranked Predictions
[10/22/21 09:22:42] INFO	Writing data frame to ./output/rankings_20211022.csv
[10/22/21 09:22:42] INFO	Saving Submission to ./output/submission_20211022.csv
[10/22/21 09:22:42] INFO	********************************************************************************
[10/22/21 09:22:42] INFO	AlphaPy End
[10/22/21 09:22:42] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	AlphaPy Start
[10/30/21 00:07:14] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	Model Configuration
[10/30/21 00:07:14] INFO	No transforms Found
[10/30/21 00:07:14] INFO	MODEL PARAMETERS:
[10/30/21 00:07:14] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/30/21 00:07:14] INFO	calibration       = False
[10/30/21 00:07:14] INFO	cal_type          = sigmoid
[10/30/21 00:07:14] INFO	calibration_plot  = False
[10/30/21 00:07:14] INFO	clustering        = True
[10/30/21 00:07:14] INFO	cluster_inc       = 3
[10/30/21 00:07:14] INFO	cluster_max       = 30
[10/30/21 00:07:14] INFO	cluster_min       = 3
[10/30/21 00:07:14] INFO	confusion_matrix  = True
[10/30/21 00:07:14] INFO	counts            = True
[10/30/21 00:07:14] INFO	cv_folds          = 3
[10/30/21 00:07:14] INFO	directory         = .
[10/30/21 00:07:14] INFO	extension         = csv
[10/30/21 00:07:14] INFO	drop              = ['PassengerId']
[10/30/21 00:07:14] INFO	encoder           = <Encoders.target: 14>
[10/30/21 00:07:14] INFO	esr               = 20
[10/30/21 00:07:14] INFO	factors           = ['Embarked']
[10/30/21 00:07:14] INFO	features [X]      = *
[10/30/21 00:07:14] INFO	feature_selection = False
[10/30/21 00:07:14] INFO	fs_percentage     = 50
[10/30/21 00:07:14] INFO	fs_score_func     = <function f_classif at 0x7fc8d8a19820>
[10/30/21 00:07:14] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/30/21 00:07:14] INFO	grid_search       = True
[10/30/21 00:07:14] INFO	gs_iters          = 50
[10/30/21 00:07:14] INFO	gs_random         = True
[10/30/21 00:07:14] INFO	gs_sample         = False
[10/30/21 00:07:14] INFO	gs_sample_pct     = 0.200000
[10/30/21 00:07:14] INFO	importances       = True
[10/30/21 00:07:14] INFO	interactions      = False
[10/30/21 00:07:14] INFO	isomap            = False
[10/30/21 00:07:14] INFO	iso_components    = 2
[10/30/21 00:07:14] INFO	iso_neighbors     = 5
[10/30/21 00:07:14] INFO	isample_pct       = 10
[10/30/21 00:07:14] INFO	leaders           = []
[10/30/21 00:07:14] INFO	learning_curve    = True
[10/30/21 00:07:14] INFO	logtransform      = False
[10/30/21 00:07:14] INFO	lv_remove         = True
[10/30/21 00:07:14] INFO	lv_threshold      = 0.100000
[10/30/21 00:07:14] INFO	model_type        = <ModelType.classification: 1>
[10/30/21 00:07:14] INFO	n_estimators      = 51
[10/30/21 00:07:14] INFO	n_jobs            = -1
[10/30/21 00:07:14] INFO	ngrams_max        = 2
[10/30/21 00:07:14] INFO	numpy             = True
[10/30/21 00:07:14] INFO	pca               = False
[10/30/21 00:07:14] INFO	pca_inc           = 1
[10/30/21 00:07:14] INFO	pca_max           = 10
[10/30/21 00:07:14] INFO	pca_min           = 2
[10/30/21 00:07:14] INFO	pca_whiten        = False
[10/30/21 00:07:14] INFO	poly_degree       = 2
[10/30/21 00:07:14] INFO	pvalue_level      = 0.010000
[10/30/21 00:07:14] INFO	rfe               = True
[10/30/21 00:07:14] INFO	rfe_step          = 3
[10/30/21 00:07:14] INFO	roc_curve         = True
[10/30/21 00:07:14] INFO	rounding          = 2
[10/30/21 00:07:14] INFO	sampling          = False
[10/30/21 00:07:14] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/30/21 00:07:14] INFO	sampling_ratio    = 0.500000
[10/30/21 00:07:14] INFO	scaler_option     = True
[10/30/21 00:07:14] INFO	scaler_type       = <Scalers.standard: 2>
[10/30/21 00:07:14] INFO	scipy             = False
[10/30/21 00:07:14] INFO	scorer            = roc_auc
[10/30/21 00:07:14] INFO	seed              = 42
[10/30/21 00:07:14] INFO	sentinel          = -1
[10/30/21 00:07:14] INFO	separator         = ,
[10/30/21 00:07:14] INFO	shuffle           = False
[10/30/21 00:07:14] INFO	split             = 0.400000
[10/30/21 00:07:14] INFO	submission_file   = gender_submission
[10/30/21 00:07:14] INFO	submit_probas     = False
[10/30/21 00:07:14] INFO	target [y]        = Survived
[10/30/21 00:07:14] INFO	target_value      = 1
[10/30/21 00:07:14] INFO	transforms        = None
[10/30/21 00:07:14] INFO	tsne              = False
[10/30/21 00:07:14] INFO	tsne_components   = 2
[10/30/21 00:07:14] INFO	tsne_learn_rate   = 1000.000000
[10/30/21 00:07:14] INFO	tsne_perplexity   = 30.000000
[10/30/21 00:07:14] INFO	vectorize         = False
[10/30/21 00:07:14] INFO	verbosity         = 0
[10/30/21 00:07:14] INFO	Creating Model
[10/30/21 00:07:14] INFO	Calling Pipeline
[10/30/21 00:07:14] INFO	Training Pipeline
[10/30/21 00:07:14] INFO	Loading Data
[10/30/21 00:07:14] INFO	Loading data from ./input/train.csv
[10/30/21 00:07:14] INFO	Found target Survived in data frame
[10/30/21 00:07:14] INFO	Labels (y) found for Partition.train
[10/30/21 00:07:14] INFO	Loading Data
[10/30/21 00:07:14] INFO	Loading data from ./input/test.csv
[10/30/21 00:07:14] INFO	Target Survived not found in Partition.test
[10/30/21 00:07:14] INFO	Saving New Features in Model
[10/30/21 00:07:14] INFO	Original Feature Statistics
[10/30/21 00:07:14] INFO	Number of Training Rows    : 891
[10/30/21 00:07:14] INFO	Number of Training Columns : 11
[10/30/21 00:07:14] INFO	Unique Training Values for Survived : [0 1]
[10/30/21 00:07:14] INFO	Unique Training Counts for Survived : [549 342]
[10/30/21 00:07:14] INFO	Number of Testing Rows     : 418
[10/30/21 00:07:14] INFO	Number of Testing Columns  : 11
[10/30/21 00:07:14] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/30/21 00:07:14] INFO	Feature Count     : 11
[10/30/21 00:07:14] INFO	Applying transforms
[10/30/21 00:07:14] INFO	No transforms Specified
[10/30/21 00:07:14] INFO	New Feature Count : 11
[10/30/21 00:07:14] INFO	Dropping Features: ['PassengerId']
[10/30/21 00:07:14] INFO	Original Feature Count : 11
[10/30/21 00:07:14] INFO	Reduced Feature Count  : 10
[10/30/21 00:07:14] INFO	Writing data frame to ./input/train_20211030.csv
[10/30/21 00:07:14] INFO	Writing data frame to ./input/test_20211030.csv
[10/30/21 00:07:14] INFO	Creating Cross-Tabulations
[10/30/21 00:07:14] INFO	Creating crosstabs for feature Embarked
[10/30/21 00:07:14] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/30/21 00:07:14] INFO	Feature Count     : 10
[10/30/21 00:07:14] INFO	Creating Count Features
[10/30/21 00:07:14] INFO	NA Counts
[10/30/21 00:07:14] INFO	Number Counts
[10/30/21 00:07:14] INFO	New Feature Count : 21
[10/30/21 00:07:14] INFO	Creating Base Features
[10/30/21 00:07:14] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/30/21 00:07:14] INFO	Feature 2: Name => Factorization
[10/30/21 00:07:14] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/30/21 00:07:14] INFO	Feature 3: Sex => Factorization
[10/30/21 00:07:14] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/30/21 00:07:14] INFO	Feature 7: Ticket => Factorization
[10/30/21 00:07:14] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/30/21 00:07:14] INFO	Feature 9: Cabin => Factorization
[10/30/21 00:07:14] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/30/21 00:07:14] INFO	Encoding: Encoders.target
[10/30/21 00:07:14] INFO	Fitting training features for Embarked
[10/30/21 00:07:14] INFO	Transforming testing features for Embarked
[10/30/21 00:07:14] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	New Feature Count : 21
[10/30/21 00:07:14] INFO	Scaling Base Features
[10/30/21 00:07:14] INFO	Creating NumPy Features
[10/30/21 00:07:14] INFO	NumPy Feature: sum
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: mean
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: std
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: var
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature Count : 4
[10/30/21 00:07:14] INFO	New Feature Count : 25
[10/30/21 00:07:14] INFO	Creating Clustering Features
[10/30/21 00:07:14] INFO	Cluster Minimum   : 3
[10/30/21 00:07:14] INFO	Cluster Maximum   : 30
[10/30/21 00:07:14] INFO	Cluster Increment : 3
[10/30/21 00:07:14] INFO	k = 3
[10/30/21 00:07:15] INFO	k = 6
[10/30/21 00:07:15] INFO	k = 9
[10/30/21 00:07:15] INFO	k = 12
[10/30/21 00:07:15] INFO	k = 15
[10/30/21 00:07:15] INFO	k = 18
[10/30/21 00:07:15] INFO	k = 21
[10/30/21 00:07:15] INFO	k = 24
[10/30/21 00:07:15] INFO	k = 27
[10/30/21 00:07:15] INFO	k = 30
[10/30/21 00:07:15] INFO	Clustering Feature Count : 10
[10/30/21 00:07:15] INFO	New Feature Count : 35
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Creating Interactions
[10/30/21 00:07:15] INFO	Initial Feature Count  : 35
[10/30/21 00:07:15] INFO	Skipping Interactions
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Removing Low-Variance Features
[10/30/21 00:07:15] INFO	Low-Variance Threshold  : 0.10
[10/30/21 00:07:15] INFO	Original Feature Count  : 35
[10/30/21 00:07:15] INFO	Reduced Feature Count   : 35
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Skipping Shuffling
[10/30/21 00:07:15] INFO	Skipping Sampling
[10/30/21 00:07:15] INFO	Getting All Estimators
[10/30/21 00:07:15] INFO	Algorithm Configuration
[10/30/21 00:07:15] INFO	Selecting Models
[10/30/21 00:07:15] INFO	Algorithm: CATB
[10/30/21 00:07:15] INFO	Fitting Initial Model
[10/30/21 00:07:16] INFO	Cross-Validation
[10/30/21 00:07:17] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/30/21 00:07:17] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:20] INFO	RFECV took 2.58 seconds for step 3 and 3 folds
[10/30/21 00:07:20] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/30/21 00:07:20] INFO	No grid is defined for grid search
[10/30/21 00:07:20] INFO	Final Model Predictions for CATB
[10/30/21 00:07:20] INFO	Skipping Calibration
[10/30/21 00:07:20] INFO	Making Predictions
[10/30/21 00:07:20] INFO	Predictions Complete
[10/30/21 00:07:20] INFO	Algorithm: LGB
[10/30/21 00:07:20] INFO	Fitting Initial Model
[10/30/21 00:07:20] INFO	Cross-Validation
[10/30/21 00:07:21] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/30/21 00:07:21] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:23] INFO	RFECV took 2.30 seconds for step 3 and 3 folds
[10/30/21 00:07:23] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/30/21 00:07:23] INFO	No grid is defined for grid search
[10/30/21 00:07:23] INFO	Final Model Predictions for LGB
[10/30/21 00:07:23] INFO	Skipping Calibration
[10/30/21 00:07:23] INFO	Making Predictions
[10/30/21 00:07:23] INFO	Predictions Complete
[10/30/21 00:07:23] INFO	Algorithm: XGB
[10/30/21 00:07:23] INFO	Fitting Initial Model
[10/30/21 00:07:23] INFO	Cross-Validation
[10/30/21 00:07:24] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/30/21 00:07:24] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:27] INFO	RFECV took 2.61 seconds for step 3 and 3 folds
[10/30/21 00:07:27] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/30/21 00:07:27] INFO	Randomized Grid Search
[10/30/21 00:08:34] INFO	Grid Search took 67.66 seconds for 50 candidate parameter settings.
[10/30/21 00:08:34] INFO	Model with rank: 1
[10/30/21 00:08:34] INFO	Mean validation score: 0.872 (std: 0.024)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Model with rank: 2
[10/30/21 00:08:34] INFO	Mean validation score: 0.871 (std: 0.021)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/30/21 00:08:34] INFO	Model with rank: 3
[10/30/21 00:08:34] INFO	Mean validation score: 0.870 (std: 0.023)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Final Model Predictions for XGB
[10/30/21 00:08:34] INFO	Skipping Calibration
[10/30/21 00:08:34] INFO	Making Predictions
[10/30/21 00:08:34] INFO	Predictions Complete
[10/30/21 00:08:34] INFO	Blending Models
[10/30/21 00:08:34] INFO	Blending Start: 2021-10-30 00:08:34.970798
[10/30/21 00:08:34] INFO	Blending Complete: 0:00:00.019175
[10/30/21 00:08:34] INFO	================================================================================
[10/30/21 00:08:34] INFO	Metrics for: Partition.train
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: CATB
[10/30/21 00:08:35] INFO	accuracy: 0.8585858585858586
[10/30/21 00:08:35] INFO	average_precision: 0.9113351686222868
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.8378391333525069
[10/30/21 00:08:35] INFO	brier_score_loss: 0.10043404518351136
[10/30/21 00:08:35] INFO	cohen_kappa: 0.6932572665125658
[10/30/21 00:08:35] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/30/21 00:08:35] INFO	f1: 0.8025078369905956
[10/30/21 00:08:35] INFO	neg_log_loss: 0.3371948718196211
[10/30/21 00:08:35] INFO	precision: 0.8648648648648649
[10/30/21 00:08:35] INFO	recall: 0.7485380116959064
[10/30/21 00:08:35] INFO	roc_auc: 0.9297979313797549
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: LGB
[10/30/21 00:08:35] INFO	accuracy: 0.9730639730639731
[10/30/21 00:08:35] INFO	average_precision: 0.9961113207491221
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.9687709711437062
[10/30/21 00:08:35] INFO	brier_score_loss: 0.032809498448974184
[10/30/21 00:08:35] INFO	cohen_kappa: 0.9427387092109702
[10/30/21 00:08:35] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/30/21 00:08:35] INFO	f1: 0.9643916913946586
[10/30/21 00:08:35] INFO	neg_log_loss: 0.1458307566281259
[10/30/21 00:08:35] INFO	precision: 0.9789156626506024
[10/30/21 00:08:35] INFO	recall: 0.9502923976608187
[10/30/21 00:08:35] INFO	roc_auc: 0.9974861257576241
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: XGB
[10/30/21 00:08:35] INFO	accuracy: 0.8911335578002245
[10/30/21 00:08:35] INFO	average_precision: 0.9341195593208514
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.8714169303039019
[10/30/21 00:08:35] INFO	brier_score_loss: 0.17819410720682557
[10/30/21 00:08:35] INFO	cohen_kappa: 0.7634554277409661
[10/30/21 00:08:35] INFO	confusion_matrix: [[525  24]
 [ 73 269]]
[10/30/21 00:08:35] INFO	f1: 0.847244094488189
[10/30/21 00:08:35] INFO	neg_log_loss: 0.5470199107655505
[10/30/21 00:08:35] INFO	precision: 0.9180887372013652
[10/30/21 00:08:35] INFO	recall: 0.7865497076023392
[10/30/21 00:08:35] INFO	roc_auc: 0.9453844842829598
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Metrics for: Partition.test
[10/30/21 00:08:35] INFO	No labels for generating Partition.test metrics
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Selecting Best Model
[10/30/21 00:08:35] INFO	Scoring for: Partition.train
[10/30/21 00:08:35] INFO	Best Model Selection Start: 2021-10-30 00:08:35.016707
[10/30/21 00:08:35] INFO	Scoring CATB Model
[10/30/21 00:08:35] INFO	Scoring LGB Model
[10/30/21 00:08:35] INFO	Scoring XGB Model
[10/30/21 00:08:35] INFO	Scoring BLEND Model
[10/30/21 00:08:35] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/30/21 00:08:35] INFO	Best Model Selection Complete: 0:00:00.000204
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Generating Plots for partition: train
[10/30/21 00:08:35] INFO	Generating Calibration Plot
[10/30/21 00:08:35] INFO	Calibration for Algorithm: CATB
[10/30/21 00:08:35] INFO	Calibration for Algorithm: LGB
[10/30/21 00:08:35] INFO	Calibration for Algorithm: XGB
[10/30/21 00:08:35] INFO	Writing plot to ./plots/calibration_train.png
[10/30/21 00:08:35] INFO	Generating Confusion Matrices
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: CATB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[509  40]
 [ 86 256]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: LGB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[542   7]
 [ 17 325]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: XGB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[525  24]
 [ 73 269]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/30/21 00:08:35] INFO	Generating ROC Curves
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: CATB
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: LGB
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: XGB
[10/30/21 00:08:35] INFO	Writing plot to ./plots/roc_curve_train.png
[10/30/21 00:08:35] INFO	Generating Learning Curves
[10/30/21 00:08:35] INFO	Algorithm Configuration
[10/30/21 00:08:35] INFO	Learning Curve for Algorithm: CATB
[10/30/21 00:08:36] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/30/21 00:08:36] INFO	Learning Curve for Algorithm: LGB
[10/30/21 00:08:38] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/30/21 00:08:38] INFO	Learning Curve for Algorithm: XGB
[10/30/21 00:08:38] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/30/21 00:08:39] INFO	Generating Feature Importance Plots
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: CATB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Sex_factor (45.178104)
[10/30/21 00:08:39] INFO	2. Pclass (13.721171)
[10/30/21 00:08:39] INFO	3. Age (6.651788)
[10/30/21 00:08:39] INFO	4. Fare (4.529770)
[10/30/21 00:08:39] INFO	5. var (3.586590)
[10/30/21 00:08:39] INFO	6. std (3.492385)
[10/30/21 00:08:39] INFO	7. Ticket_factor (3.315046)
[10/30/21 00:08:39] INFO	8. cluster_30 (2.831587)
[10/30/21 00:08:39] INFO	9. mean (2.733389)
[10/30/21 00:08:39] INFO	10. Name_factor (2.586310)
[10/30/21 00:08:39] INFO	11. Cabin_factor (2.101764)
[10/30/21 00:08:39] INFO	12. Embarked (2.086410)
[10/30/21 00:08:39] INFO	13. SibSp (2.085405)
[10/30/21 00:08:39] INFO	14. cluster_12 (1.876782)
[10/30/21 00:08:39] INFO	15. cluster_24 (1.263144)
[10/30/21 00:08:39] INFO	16. count_2 (1.004409)
[10/30/21 00:08:39] INFO	17. sum (0.955946)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: LGB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Fare (256.000000)
[10/30/21 00:08:39] INFO	2. sum (241.000000)
[10/30/21 00:08:39] INFO	3. Age (232.000000)
[10/30/21 00:08:39] INFO	4. std (201.000000)
[10/30/21 00:08:39] INFO	5. Ticket_factor (199.000000)
[10/30/21 00:08:39] INFO	6. Name_factor (175.000000)
[10/30/21 00:08:39] INFO	7. cluster_30 (53.000000)
[10/30/21 00:08:39] INFO	8. cluster_27 (46.000000)
[10/30/21 00:08:39] INFO	9. Sex_factor (43.000000)
[10/30/21 00:08:39] INFO	10. Pclass (43.000000)
[10/30/21 00:08:39] INFO	11. Cabin_factor (41.000000)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: XGB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Sex_factor (0.424644)
[10/30/21 00:08:39] INFO	2. Pclass (0.127452)
[10/30/21 00:08:39] INFO	3. Cabin_factor (0.081307)
[10/30/21 00:08:39] INFO	4. Age (0.051007)
[10/30/21 00:08:39] INFO	5. SibSp (0.049620)
[10/30/21 00:08:39] INFO	6. count_1 (0.046373)
[10/30/21 00:08:39] INFO	7. Embarked (0.046225)
[10/30/21 00:08:39] INFO	8. std (0.036262)
[10/30/21 00:08:39] INFO	9. cluster_30 (0.036076)
[10/30/21 00:08:39] INFO	10. Fare (0.032410)
[10/30/21 00:08:39] INFO	11. cluster_24 (0.021187)
[10/30/21 00:08:39] INFO	12. Name_factor (0.019312)
[10/30/21 00:08:39] INFO	13. sum (0.017784)
[10/30/21 00:08:39] INFO	14. cluster_15 (0.010340)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/30/21 00:08:39] INFO	================================================================================
[10/30/21 00:08:39] INFO	Saving Model Predictor
[10/30/21 00:08:39] INFO	Writing model predictor to ./model/model_20211030.pkl
[10/30/21 00:08:39] INFO	Saving Feature Map
[10/30/21 00:08:39] INFO	Writing feature map to ./model/feature_map_20211030.pkl
[10/30/21 00:08:39] INFO	Loading data from ./input/test_20211030.csv
[10/30/21 00:08:39] INFO	Saving Predictions
[10/30/21 00:08:39] INFO	Writing data frame to ./output/predictions_20211030.csv
[10/30/21 00:08:39] INFO	Saving Probabilities
[10/30/21 00:08:39] INFO	Writing data frame to ./output/probabilities_20211030.csv
[10/30/21 00:08:39] INFO	Saving Ranked Predictions
[10/30/21 00:08:39] INFO	Writing data frame to ./output/rankings_20211030.csv
[10/30/21 00:08:39] INFO	Saving Submission to ./output/submission_20211030.csv
[10/30/21 00:08:39] INFO	********************************************************************************
[10/30/21 00:08:39] INFO	AlphaPy End
[10/30/21 00:08:39] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	AlphaPy Start
[11/07/21 09:11:51] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	Model Configuration
[11/07/21 09:11:51] INFO	No transforms Found
[11/07/21 09:11:51] INFO	MODEL PARAMETERS:
[11/07/21 09:11:51] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[11/07/21 09:11:51] INFO	calibration       = False
[11/07/21 09:11:51] INFO	cal_type          = sigmoid
[11/07/21 09:11:51] INFO	calibration_plot  = False
[11/07/21 09:11:51] INFO	clustering        = True
[11/07/21 09:11:51] INFO	cluster_inc       = 3
[11/07/21 09:11:51] INFO	cluster_max       = 30
[11/07/21 09:11:51] INFO	cluster_min       = 3
[11/07/21 09:11:51] INFO	confusion_matrix  = True
[11/07/21 09:11:51] INFO	counts            = True
[11/07/21 09:11:51] INFO	cv_folds          = 3
[11/07/21 09:11:51] INFO	directory         = .
[11/07/21 09:11:51] INFO	extension         = csv
[11/07/21 09:11:51] INFO	drop              = ['PassengerId']
[11/07/21 09:11:51] INFO	encoder           = <Encoders.target: 14>
[11/07/21 09:11:51] INFO	esr               = 20
[11/07/21 09:11:51] INFO	factors           = ['Embarked']
[11/07/21 09:11:51] INFO	features [X]      = *
[11/07/21 09:11:51] INFO	feature_selection = False
[11/07/21 09:11:51] INFO	fs_percentage     = 50
[11/07/21 09:11:51] INFO	fs_score_func     = <function f_classif at 0x7f9b22909790>
[11/07/21 09:11:51] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[11/07/21 09:11:51] INFO	grid_search       = True
[11/07/21 09:11:51] INFO	gs_iters          = 50
[11/07/21 09:11:51] INFO	gs_random         = True
[11/07/21 09:11:51] INFO	gs_sample         = False
[11/07/21 09:11:51] INFO	gs_sample_pct     = 0.200000
[11/07/21 09:11:51] INFO	importances       = True
[11/07/21 09:11:51] INFO	interactions      = False
[11/07/21 09:11:51] INFO	isomap            = False
[11/07/21 09:11:51] INFO	iso_components    = 2
[11/07/21 09:11:51] INFO	iso_neighbors     = 5
[11/07/21 09:11:51] INFO	isample_pct       = 10
[11/07/21 09:11:51] INFO	leaders           = []
[11/07/21 09:11:51] INFO	learning_curve    = True
[11/07/21 09:11:51] INFO	logtransform      = False
[11/07/21 09:11:51] INFO	lv_remove         = True
[11/07/21 09:11:51] INFO	lv_threshold      = 0.100000
[11/07/21 09:11:51] INFO	model_type        = <ModelType.classification: 1>
[11/07/21 09:11:51] INFO	n_estimators      = 51
[11/07/21 09:11:51] INFO	n_jobs            = -1
[11/07/21 09:11:51] INFO	ngrams_max        = 2
[11/07/21 09:11:51] INFO	numpy             = True
[11/07/21 09:11:51] INFO	pca               = False
[11/07/21 09:11:51] INFO	pca_inc           = 1
[11/07/21 09:11:51] INFO	pca_max           = 10
[11/07/21 09:11:51] INFO	pca_min           = 2
[11/07/21 09:11:51] INFO	pca_whiten        = False
[11/07/21 09:11:51] INFO	poly_degree       = 2
[11/07/21 09:11:51] INFO	pvalue_level      = 0.010000
[11/07/21 09:11:51] INFO	rfe               = True
[11/07/21 09:11:51] INFO	rfe_step          = 3
[11/07/21 09:11:51] INFO	roc_curve         = True
[11/07/21 09:11:51] INFO	rounding          = 2
[11/07/21 09:11:51] INFO	sampling          = False
[11/07/21 09:11:51] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[11/07/21 09:11:51] INFO	sampling_ratio    = 0.500000
[11/07/21 09:11:51] INFO	scaler_option     = True
[11/07/21 09:11:51] INFO	scaler_type       = <Scalers.standard: 2>
[11/07/21 09:11:51] INFO	scipy             = False
[11/07/21 09:11:51] INFO	scorer            = roc_auc
[11/07/21 09:11:51] INFO	seed              = 42
[11/07/21 09:11:51] INFO	sentinel          = -1
[11/07/21 09:11:51] INFO	separator         = ,
[11/07/21 09:11:51] INFO	shuffle           = False
[11/07/21 09:11:51] INFO	split             = 0.400000
[11/07/21 09:11:51] INFO	submission_file   = gender_submission
[11/07/21 09:11:51] INFO	submit_probas     = False
[11/07/21 09:11:51] INFO	target [y]        = Survived
[11/07/21 09:11:51] INFO	target_value      = 1
[11/07/21 09:11:51] INFO	transforms        = None
[11/07/21 09:11:51] INFO	tsne              = False
[11/07/21 09:11:51] INFO	tsne_components   = 2
[11/07/21 09:11:51] INFO	tsne_learn_rate   = 1000.000000
[11/07/21 09:11:51] INFO	tsne_perplexity   = 30.000000
[11/07/21 09:11:51] INFO	vectorize         = False
[11/07/21 09:11:51] INFO	verbosity         = 0
[11/07/21 09:11:51] INFO	Creating Model
[11/07/21 09:11:51] INFO	Calling Pipeline
[11/07/21 09:11:51] INFO	Training Pipeline
[11/07/21 09:11:51] INFO	Loading Data
[11/07/21 09:11:51] INFO	Loading data from ./input/train.csv
[11/07/21 09:11:51] INFO	Found target Survived in data frame
[11/07/21 09:11:51] INFO	Labels (y) found for Partition.train
[11/07/21 09:11:51] INFO	Loading Data
[11/07/21 09:11:51] INFO	Loading data from ./input/test.csv
[11/07/21 09:11:51] INFO	Target Survived not found in Partition.test
[11/07/21 09:11:51] INFO	Saving New Features in Model
[11/07/21 09:11:51] INFO	Original Feature Statistics
[11/07/21 09:11:51] INFO	Number of Training Rows    : 891
[11/07/21 09:11:51] INFO	Number of Training Columns : 11
[11/07/21 09:11:51] INFO	Unique Training Values for Survived : [0 1]
[11/07/21 09:11:51] INFO	Unique Training Counts for Survived : [549 342]
[11/07/21 09:11:51] INFO	Number of Testing Rows     : 418
[11/07/21 09:11:51] INFO	Number of Testing Columns  : 11
[11/07/21 09:11:51] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[11/07/21 09:11:51] INFO	Feature Count     : 11
[11/07/21 09:11:51] INFO	Applying transforms
[11/07/21 09:11:51] INFO	No transforms Specified
[11/07/21 09:11:51] INFO	New Feature Count : 11
[11/07/21 09:11:51] INFO	Dropping Features: ['PassengerId']
[11/07/21 09:11:51] INFO	Original Feature Count : 11
[11/07/21 09:11:51] INFO	Reduced Feature Count  : 10
[11/07/21 09:11:51] INFO	Writing data frame to ./input/train_20211107.csv
[11/07/21 09:11:51] INFO	Writing data frame to ./input/test_20211107.csv
[11/07/21 09:11:51] INFO	Creating Cross-Tabulations
[11/07/21 09:11:51] INFO	Creating crosstabs for feature Embarked
[11/07/21 09:11:51] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[11/07/21 09:11:51] INFO	Feature Count     : 10
[11/07/21 09:11:51] INFO	Creating Count Features
[11/07/21 09:11:51] INFO	NA Counts
[11/07/21 09:11:51] INFO	Number Counts
[11/07/21 09:11:51] INFO	New Feature Count : 21
[11/07/21 09:11:51] INFO	Creating Base Features
[11/07/21 09:11:51] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[11/07/21 09:11:51] INFO	Feature 2: Name => Factorization
[11/07/21 09:11:51] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[11/07/21 09:11:51] INFO	Feature 3: Sex => Factorization
[11/07/21 09:11:51] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[11/07/21 09:11:51] INFO	Feature 7: Ticket => Factorization
[11/07/21 09:11:51] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[11/07/21 09:11:51] INFO	Feature 9: Cabin => Factorization
[11/07/21 09:11:51] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[11/07/21 09:11:51] INFO	Encoding: Encoders.target
[11/07/21 09:11:51] INFO	Fitting training features for Embarked
[11/07/21 09:11:51] INFO	Transforming testing features for Embarked
[11/07/21 09:11:51] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	New Feature Count : 21
[11/07/21 09:11:51] INFO	Scaling Base Features
[11/07/21 09:11:51] INFO	Creating NumPy Features
[11/07/21 09:11:51] INFO	NumPy Feature: sum
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: mean
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: std
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: var
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature Count : 4
[11/07/21 09:11:51] INFO	New Feature Count : 25
[11/07/21 09:11:51] INFO	Creating Clustering Features
[11/07/21 09:11:51] INFO	Cluster Minimum   : 3
[11/07/21 09:11:51] INFO	Cluster Maximum   : 30
[11/07/21 09:11:51] INFO	Cluster Increment : 3
[11/07/21 09:11:51] INFO	k = 3
[11/07/21 09:11:51] INFO	k = 6
[11/07/21 09:11:51] INFO	k = 9
[11/07/21 09:11:51] INFO	k = 12
[11/07/21 09:11:51] INFO	k = 15
[11/07/21 09:11:51] INFO	k = 18
[11/07/21 09:11:51] INFO	k = 21
[11/07/21 09:11:51] INFO	k = 24
[11/07/21 09:11:51] INFO	k = 27
[11/07/21 09:11:52] INFO	k = 30
[11/07/21 09:11:52] INFO	Clustering Feature Count : 10
[11/07/21 09:11:52] INFO	New Feature Count : 35
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Creating Interactions
[11/07/21 09:11:52] INFO	Initial Feature Count  : 35
[11/07/21 09:11:52] INFO	Skipping Interactions
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Removing Low-Variance Features
[11/07/21 09:11:52] INFO	Low-Variance Threshold  : 0.10
[11/07/21 09:11:52] INFO	Original Feature Count  : 35
[11/07/21 09:11:52] INFO	Reduced Feature Count   : 35
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Skipping Shuffling
[11/07/21 09:11:52] INFO	Skipping Sampling
[11/07/21 09:11:52] INFO	Getting All Estimators
[11/07/21 09:11:52] INFO	Algorithm Configuration
[11/07/21 09:11:52] INFO	Selecting Models
[11/07/21 09:11:52] INFO	Algorithm: CATB
[11/07/21 09:11:52] INFO	Fitting Initial Model
[11/07/21 09:11:52] INFO	Cross-Validation
[11/07/21 09:11:54] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[11/07/21 09:11:54] INFO	Recursive Feature Elimination with CV
[11/07/21 09:11:57] INFO	RFECV took 2.71 seconds for step 3 and 3 folds
[11/07/21 09:11:57] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[11/07/21 09:11:57] INFO	No grid is defined for grid search
[11/07/21 09:11:57] INFO	Final Model Predictions for CATB
[11/07/21 09:11:57] INFO	Skipping Calibration
[11/07/21 09:11:57] INFO	Making Predictions
[11/07/21 09:11:57] INFO	Predictions Complete
[11/07/21 09:11:57] INFO	Algorithm: LGB
[11/07/21 09:11:57] INFO	Fitting Initial Model
[11/07/21 09:11:57] INFO	Cross-Validation
[11/07/21 09:11:58] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[11/07/21 09:11:58] INFO	Recursive Feature Elimination with CV
[11/07/21 09:12:00] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[11/07/21 09:12:00] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[11/07/21 09:12:00] INFO	No grid is defined for grid search
[11/07/21 09:12:00] INFO	Final Model Predictions for LGB
[11/07/21 09:12:00] INFO	Skipping Calibration
[11/07/21 09:12:00] INFO	Making Predictions
[11/07/21 09:12:00] INFO	Predictions Complete
[11/07/21 09:12:00] INFO	Algorithm: XGB
[11/07/21 09:12:00] INFO	Fitting Initial Model
[11/07/21 09:12:00] INFO	Cross-Validation
[11/07/21 09:12:01] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[11/07/21 09:12:01] INFO	Recursive Feature Elimination with CV
[11/07/21 09:12:04] INFO	RFECV took 2.74 seconds for step 3 and 3 folds
[11/07/21 09:12:04] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[11/07/21 09:12:04] INFO	Randomized Grid Search
[11/07/21 09:13:11] INFO	Grid Search took 66.79 seconds for 50 candidate parameter settings.
[11/07/21 09:13:11] INFO	Model with rank: 1
[11/07/21 09:13:11] INFO	Mean validation score: 0.871 (std: 0.022)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[11/07/21 09:13:11] INFO	Model with rank: 2
[11/07/21 09:13:11] INFO	Mean validation score: 0.870 (std: 0.021)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[11/07/21 09:13:11] INFO	Model with rank: 3
[11/07/21 09:13:11] INFO	Mean validation score: 0.870 (std: 0.021)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[11/07/21 09:13:11] INFO	Algorithm: XGB, Best Score: 0.8710, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[11/07/21 09:13:11] INFO	Final Model Predictions for XGB
[11/07/21 09:13:11] INFO	Skipping Calibration
[11/07/21 09:13:11] INFO	Making Predictions
[11/07/21 09:13:11] INFO	Predictions Complete
[11/07/21 09:13:11] INFO	Blending Models
[11/07/21 09:13:11] INFO	Blending Start: 2021-11-07 09:13:11.069883
[11/07/21 09:13:11] INFO	Blending Complete: 0:00:00.011214
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Metrics for: Partition.train
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: CATB
[11/07/21 09:13:11] INFO	accuracy: 0.8585858585858586
[11/07/21 09:13:11] INFO	average_precision: 0.9113351686222868
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.8378391333525069
[11/07/21 09:13:11] INFO	brier_score_loss: 0.10043404518351136
[11/07/21 09:13:11] INFO	cohen_kappa: 0.6932572665125658
[11/07/21 09:13:11] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[11/07/21 09:13:11] INFO	f1: 0.8025078369905956
[11/07/21 09:13:11] INFO	neg_log_loss: 0.3371948718196211
[11/07/21 09:13:11] INFO	precision: 0.8648648648648649
[11/07/21 09:13:11] INFO	recall: 0.7485380116959064
[11/07/21 09:13:11] INFO	roc_auc: 0.9297979313797549
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: LGB
[11/07/21 09:13:11] INFO	accuracy: 0.9730639730639731
[11/07/21 09:13:11] INFO	average_precision: 0.9961113207491221
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.9687709711437062
[11/07/21 09:13:11] INFO	brier_score_loss: 0.032809498448974184
[11/07/21 09:13:11] INFO	cohen_kappa: 0.9427387092109702
[11/07/21 09:13:11] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[11/07/21 09:13:11] INFO	f1: 0.9643916913946586
[11/07/21 09:13:11] INFO	neg_log_loss: 0.1458307566281259
[11/07/21 09:13:11] INFO	precision: 0.9789156626506024
[11/07/21 09:13:11] INFO	recall: 0.9502923976608187
[11/07/21 09:13:11] INFO	roc_auc: 0.9974861257576241
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: XGB
[11/07/21 09:13:11] INFO	accuracy: 0.9023569023569024
[11/07/21 09:13:11] INFO	average_precision: 0.9472776316607258
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.88548557185313
[11/07/21 09:13:11] INFO	brier_score_loss: 0.09358055308451343
[11/07/21 09:13:11] INFO	cohen_kappa: 0.7887987052794193
[11/07/21 09:13:11] INFO	confusion_matrix: [[526  23]
 [ 64 278]]
[11/07/21 09:13:11] INFO	f1: 0.864696734059098
[11/07/21 09:13:11] INFO	neg_log_loss: 0.33849662273085346
[11/07/21 09:13:11] INFO	precision: 0.9235880398671097
[11/07/21 09:13:11] INFO	recall: 0.8128654970760234
[11/07/21 09:13:11] INFO	roc_auc: 0.9578180423736938
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Metrics for: Partition.test
[11/07/21 09:13:11] INFO	No labels for generating Partition.test metrics
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Selecting Best Model
[11/07/21 09:13:11] INFO	Scoring for: Partition.train
[11/07/21 09:13:11] INFO	Best Model Selection Start: 2021-11-07 09:13:11.102421
[11/07/21 09:13:11] INFO	Scoring CATB Model
[11/07/21 09:13:11] INFO	Scoring LGB Model
[11/07/21 09:13:11] INFO	Scoring XGB Model
[11/07/21 09:13:11] INFO	Scoring BLEND Model
[11/07/21 09:13:11] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[11/07/21 09:13:11] INFO	Best Model Selection Complete: 0:00:00.000203
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Generating Plots for partition: train
[11/07/21 09:13:11] INFO	Generating Calibration Plot
[11/07/21 09:13:11] INFO	Calibration for Algorithm: CATB
[11/07/21 09:13:11] INFO	Calibration for Algorithm: LGB
[11/07/21 09:13:11] INFO	Calibration for Algorithm: XGB
[11/07/21 09:13:11] INFO	Writing plot to ./plots/calibration_train.png
[11/07/21 09:13:11] INFO	Generating Confusion Matrices
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: CATB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[509  40]
 [ 86 256]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_CATB.png
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: LGB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[542   7]
 [ 17 325]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_LGB.png
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: XGB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[526  23]
 [ 64 278]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_XGB.png
[11/07/21 09:13:11] INFO	Generating ROC Curves
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: CATB
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: LGB
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: XGB
[11/07/21 09:13:11] INFO	Writing plot to ./plots/roc_curve_train.png
[11/07/21 09:13:11] INFO	Generating Learning Curves
[11/07/21 09:13:11] INFO	Algorithm Configuration
[11/07/21 09:13:11] INFO	Learning Curve for Algorithm: CATB
[11/07/21 09:13:12] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[11/07/21 09:13:12] INFO	Learning Curve for Algorithm: LGB
[11/07/21 09:13:14] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[11/07/21 09:13:14] INFO	Learning Curve for Algorithm: XGB
[11/07/21 09:13:15] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[11/07/21 09:13:15] INFO	Generating Feature Importance Plots
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: CATB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Sex_factor (45.178104)
[11/07/21 09:13:15] INFO	2. Pclass (13.721171)
[11/07/21 09:13:15] INFO	3. Age (6.651788)
[11/07/21 09:13:15] INFO	4. Fare (4.529770)
[11/07/21 09:13:15] INFO	5. var (3.586590)
[11/07/21 09:13:15] INFO	6. std (3.492385)
[11/07/21 09:13:15] INFO	7. Ticket_factor (3.315046)
[11/07/21 09:13:15] INFO	8. cluster_30 (2.831587)
[11/07/21 09:13:15] INFO	9. mean (2.733389)
[11/07/21 09:13:15] INFO	10. Name_factor (2.586310)
[11/07/21 09:13:15] INFO	11. Cabin_factor (2.101764)
[11/07/21 09:13:15] INFO	12. Embarked (2.086410)
[11/07/21 09:13:15] INFO	13. SibSp (2.085405)
[11/07/21 09:13:15] INFO	14. cluster_12 (1.876782)
[11/07/21 09:13:15] INFO	15. cluster_24 (1.263144)
[11/07/21 09:13:15] INFO	16. count_2 (1.004409)
[11/07/21 09:13:15] INFO	17. sum (0.955946)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: LGB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Fare (256.000000)
[11/07/21 09:13:15] INFO	2. sum (241.000000)
[11/07/21 09:13:15] INFO	3. Age (232.000000)
[11/07/21 09:13:15] INFO	4. std (201.000000)
[11/07/21 09:13:15] INFO	5. Ticket_factor (199.000000)
[11/07/21 09:13:15] INFO	6. Name_factor (175.000000)
[11/07/21 09:13:15] INFO	7. cluster_30 (53.000000)
[11/07/21 09:13:15] INFO	8. cluster_27 (46.000000)
[11/07/21 09:13:15] INFO	9. Sex_factor (43.000000)
[11/07/21 09:13:15] INFO	10. Pclass (43.000000)
[11/07/21 09:13:15] INFO	11. Cabin_factor (41.000000)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: XGB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Sex_factor (0.424644)
[11/07/21 09:13:15] INFO	2. Pclass (0.127452)
[11/07/21 09:13:15] INFO	3. Cabin_factor (0.081307)
[11/07/21 09:13:15] INFO	4. Age (0.051007)
[11/07/21 09:13:15] INFO	5. SibSp (0.049620)
[11/07/21 09:13:15] INFO	6. count_1 (0.046373)
[11/07/21 09:13:15] INFO	7. Embarked (0.046225)
[11/07/21 09:13:15] INFO	8. std (0.036262)
[11/07/21 09:13:15] INFO	9. cluster_30 (0.036076)
[11/07/21 09:13:15] INFO	10. Fare (0.032410)
[11/07/21 09:13:15] INFO	11. cluster_24 (0.021187)
[11/07/21 09:13:15] INFO	12. Name_factor (0.019312)
[11/07/21 09:13:15] INFO	13. sum (0.017784)
[11/07/21 09:13:15] INFO	14. cluster_15 (0.010340)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[11/07/21 09:13:15] INFO	================================================================================
[11/07/21 09:13:15] INFO	Saving Model Predictor
[11/07/21 09:13:15] INFO	Writing model predictor to ./model/model_20211107.pkl
[11/07/21 09:13:15] INFO	Saving Feature Map
[11/07/21 09:13:15] INFO	Writing feature map to ./model/feature_map_20211107.pkl
[11/07/21 09:13:15] INFO	Loading data from ./input/test_20211107.csv
[11/07/21 09:13:15] INFO	Saving Predictions
[11/07/21 09:13:15] INFO	Writing data frame to ./output/predictions_20211107.csv
[11/07/21 09:13:15] INFO	Saving Probabilities
[11/07/21 09:13:15] INFO	Writing data frame to ./output/probabilities_20211107.csv
[11/07/21 09:13:15] INFO	Saving Ranked Predictions
[11/07/21 09:13:15] INFO	Writing data frame to ./output/rankings_20211107.csv
[11/07/21 09:13:15] INFO	Saving Submission to ./output/submission_20211107.csv
[11/07/21 09:13:15] INFO	********************************************************************************
[11/07/21 09:13:15] INFO	AlphaPy End
[11/07/21 09:13:15] INFO	********************************************************************************

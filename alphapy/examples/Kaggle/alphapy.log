[08/07/21 19:23:27] INFO	********************************************************************************
[08/07/21 19:23:27] INFO	AlphaPy Start
[08/07/21 19:23:27] INFO	********************************************************************************
[08/07/21 19:23:27] INFO	Model Configuration
[08/07/21 19:23:27] INFO	No transforms Found
[08/07/21 19:23:27] INFO	MODEL PARAMETERS:
[08/07/21 19:23:27] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:23:27] INFO	calibration       = False
[08/07/21 19:23:27] INFO	cal_type          = sigmoid
[08/07/21 19:23:27] INFO	calibration_plot  = False
[08/07/21 19:23:27] INFO	clustering        = True
[08/07/21 19:23:27] INFO	cluster_inc       = 3
[08/07/21 19:23:27] INFO	cluster_max       = 30
[08/07/21 19:23:27] INFO	cluster_min       = 3
[08/07/21 19:23:27] INFO	confusion_matrix  = True
[08/07/21 19:23:27] INFO	counts            = True
[08/07/21 19:23:27] INFO	cv_folds          = 3
[08/07/21 19:23:27] INFO	directory         = .
[08/07/21 19:23:27] INFO	extension         = csv
[08/07/21 19:23:27] INFO	drop              = ['PassengerId']
[08/07/21 19:23:27] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:23:27] INFO	esr               = 20
[08/07/21 19:23:27] INFO	factors           = ['Embarked']
[08/07/21 19:23:27] INFO	features [X]      = *
[08/07/21 19:23:27] INFO	feature_selection = False
[08/07/21 19:23:27] INFO	fs_percentage     = 50
[08/07/21 19:23:27] INFO	fs_score_func     = <function f_classif at 0x7f88905a58b0>
[08/07/21 19:23:27] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:23:27] INFO	grid_search       = True
[08/07/21 19:23:27] INFO	gs_iters          = 50
[08/07/21 19:23:27] INFO	gs_random         = True
[08/07/21 19:23:27] INFO	gs_sample         = False
[08/07/21 19:23:27] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:23:27] INFO	importances       = True
[08/07/21 19:23:27] INFO	interactions      = False
[08/07/21 19:23:27] INFO	isomap            = False
[08/07/21 19:23:27] INFO	iso_components    = 2
[08/07/21 19:23:27] INFO	iso_neighbors     = 5
[08/07/21 19:23:27] INFO	isample_pct       = 10
[08/07/21 19:23:27] INFO	learning_curve    = True
[08/07/21 19:23:27] INFO	logtransform      = False
[08/07/21 19:23:27] INFO	lv_remove         = True
[08/07/21 19:23:27] INFO	lv_threshold      = 0.100000
[08/07/21 19:23:27] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:23:27] INFO	n_estimators      = 51
[08/07/21 19:23:27] INFO	n_jobs            = -1
[08/07/21 19:23:27] INFO	ngrams_max        = 2
[08/07/21 19:23:27] INFO	numpy             = True
[08/07/21 19:23:27] INFO	pca               = False
[08/07/21 19:23:27] INFO	pca_inc           = 1
[08/07/21 19:23:27] INFO	pca_max           = 10
[08/07/21 19:23:27] INFO	pca_min           = 2
[08/07/21 19:23:27] INFO	pca_whiten        = False
[08/07/21 19:23:27] INFO	poly_degree       = 2
[08/07/21 19:23:27] INFO	pvalue_level      = 0.010000
[08/07/21 19:23:27] INFO	rfe               = True
[08/07/21 19:23:27] INFO	rfe_step          = 3
[08/07/21 19:23:27] INFO	roc_curve         = True
[08/07/21 19:23:27] INFO	rounding          = 2
[08/07/21 19:23:27] INFO	sampling          = False
[08/07/21 19:23:27] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:23:27] INFO	sampling_ratio    = 0.500000
[08/07/21 19:23:27] INFO	scaler_option     = True
[08/07/21 19:23:27] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:23:27] INFO	scipy             = False
[08/07/21 19:23:27] INFO	scorer            = roc_auc
[08/07/21 19:23:27] INFO	seed              = 42
[08/07/21 19:23:27] INFO	sentinel          = -1
[08/07/21 19:23:27] INFO	separator         = ,
[08/07/21 19:23:27] INFO	shuffle           = False
[08/07/21 19:23:27] INFO	split             = 0.400000
[08/07/21 19:23:27] INFO	submission_file   = gender_submission
[08/07/21 19:23:27] INFO	submit_probas     = False
[08/07/21 19:23:27] INFO	target [y]        = Survived
[08/07/21 19:23:27] INFO	target_value      = 1
[08/07/21 19:23:27] INFO	transforms        = None
[08/07/21 19:23:27] INFO	tsne              = False
[08/07/21 19:23:27] INFO	tsne_components   = 2
[08/07/21 19:23:27] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:23:27] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:23:27] INFO	vectorize         = False
[08/07/21 19:23:27] INFO	verbosity         = 0
[08/07/21 19:23:27] INFO	Creating directory ./data
[08/07/21 19:23:27] INFO	Creating directory ./model
[08/07/21 19:23:27] INFO	Creating directory ./output
[08/07/21 19:23:27] INFO	Creating directory ./plots
[08/07/21 19:23:27] INFO	Creating Model
[08/07/21 19:23:27] INFO	Calling Pipeline
[08/07/21 19:23:27] INFO	Training Pipeline
[08/07/21 19:23:27] INFO	Loading Data
[08/07/21 19:23:27] INFO	Loading data from ./input/train.csv
[08/07/21 19:23:27] INFO	Found target Survived in data frame
[08/07/21 19:23:27] INFO	Labels (y) found for Partition.train
[08/07/21 19:23:27] INFO	Loading Data
[08/07/21 19:23:27] INFO	Loading data from ./input/test.csv
[08/07/21 19:23:27] INFO	Target Survived not found in Partition.test
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Original Feature Statistics
[08/07/21 19:23:27] INFO	Number of Training Rows    : 891
[08/07/21 19:23:27] INFO	Number of Training Columns : 11
[08/07/21 19:23:27] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:23:27] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:23:27] INFO	Number of Testing Rows     : 418
[08/07/21 19:23:27] INFO	Number of Testing Columns  : 11
[08/07/21 19:23:27] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:23:27] INFO	Feature Count     : 11
[08/07/21 19:23:27] INFO	Applying transforms
[08/07/21 19:23:27] INFO	No transforms Specified
[08/07/21 19:23:27] INFO	New Feature Count : 11
[08/07/21 19:23:27] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:23:27] INFO	Original Feature Count : 11
[08/07/21 19:23:27] INFO	Reduced Feature Count  : 10
[08/07/21 19:23:27] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:23:27] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:23:27] INFO	Creating Cross-Tabulations
[08/07/21 19:23:27] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:23:27] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:23:27] INFO	Feature Count     : 10
[08/07/21 19:23:27] INFO	Creating Count Features
[08/07/21 19:23:27] INFO	NA Counts
[08/07/21 19:23:27] INFO	Number Counts
[08/07/21 19:23:27] INFO	New Feature Count : 21
[08/07/21 19:23:27] INFO	Creating Base Features
[08/07/21 19:23:27] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:23:27] INFO	Feature 2: Name => Factorization
[08/07/21 19:23:27] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:23:27] INFO	Feature 3: Sex => Factorization
[08/07/21 19:23:27] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:23:27] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:23:27] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:23:27] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:23:27] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:23:27] INFO	Encoding: Encoders.target
[08/07/21 19:23:27] INFO	Fitting training features for Embarked
[08/07/21 19:23:27] INFO	Transforming testing features for Embarked
[08/07/21 19:23:27] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:23:27] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:23:27] INFO	New Feature Count : 21
[08/07/21 19:23:27] INFO	Scaling Base Features
[08/07/21 19:23:27] INFO	Creating NumPy Features
[08/07/21 19:23:27] INFO	NumPy Feature: sum
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: mean
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: std
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature: var
[08/07/21 19:23:27] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:23:27] INFO	NumPy Feature Count : 4
[08/07/21 19:23:27] INFO	New Feature Count : 25
[08/07/21 19:23:27] INFO	Creating Clustering Features
[08/07/21 19:23:27] INFO	Cluster Minimum   : 3
[08/07/21 19:23:27] INFO	Cluster Maximum   : 30
[08/07/21 19:23:27] INFO	Cluster Increment : 3
[08/07/21 19:23:27] INFO	k = 3
[08/07/21 19:23:27] INFO	k = 6
[08/07/21 19:23:27] INFO	k = 9
[08/07/21 19:23:27] INFO	k = 12
[08/07/21 19:23:27] INFO	k = 15
[08/07/21 19:23:27] INFO	k = 18
[08/07/21 19:23:27] INFO	k = 21
[08/07/21 19:23:27] INFO	k = 24
[08/07/21 19:23:27] INFO	k = 27
[08/07/21 19:23:27] INFO	k = 30
[08/07/21 19:23:27] INFO	Clustering Feature Count : 10
[08/07/21 19:23:27] INFO	New Feature Count : 35
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Creating Interactions
[08/07/21 19:23:27] INFO	Initial Feature Count  : 35
[08/07/21 19:23:27] INFO	Skipping Interactions
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Removing Low-Variance Features
[08/07/21 19:23:27] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:23:27] INFO	Original Feature Count  : 35
[08/07/21 19:23:27] INFO	Reduced Feature Count   : 35
[08/07/21 19:23:27] INFO	Saving New Features in Model
[08/07/21 19:23:27] INFO	Skipping Shuffling
[08/07/21 19:23:27] INFO	Skipping Sampling
[08/07/21 19:23:27] INFO	Getting All Estimators
[08/07/21 19:23:27] INFO	Algorithm Configuration
[08/07/21 19:23:27] INFO	Cannot load xgboost
[08/07/21 19:23:27] INFO	Cannot load lightgbm
[08/07/21 19:23:27] INFO	Cannot load catboost
[08/07/21 19:23:27] INFO	Cannot load keras
[08/07/21 19:23:27] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:23:27] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:23:27] INFO	Selecting Models
[08/07/21 19:23:27] INFO	Algorithm: CATB
[08/07/21 19:23:27] INFO	Algorithm CATB not found
[08/07/21 19:26:47] INFO	********************************************************************************
[08/07/21 19:26:47] INFO	AlphaPy Start
[08/07/21 19:26:47] INFO	********************************************************************************
[08/07/21 19:26:47] INFO	Model Configuration
[08/07/21 19:26:47] INFO	No transforms Found
[08/07/21 19:26:47] INFO	MODEL PARAMETERS:
[08/07/21 19:26:47] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:26:47] INFO	calibration       = False
[08/07/21 19:26:47] INFO	cal_type          = sigmoid
[08/07/21 19:26:47] INFO	calibration_plot  = False
[08/07/21 19:26:47] INFO	clustering        = True
[08/07/21 19:26:47] INFO	cluster_inc       = 3
[08/07/21 19:26:47] INFO	cluster_max       = 30
[08/07/21 19:26:47] INFO	cluster_min       = 3
[08/07/21 19:26:47] INFO	confusion_matrix  = True
[08/07/21 19:26:47] INFO	counts            = True
[08/07/21 19:26:47] INFO	cv_folds          = 3
[08/07/21 19:26:47] INFO	directory         = .
[08/07/21 19:26:47] INFO	extension         = csv
[08/07/21 19:26:47] INFO	drop              = ['PassengerId']
[08/07/21 19:26:47] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:26:47] INFO	esr               = 20
[08/07/21 19:26:47] INFO	factors           = ['Embarked']
[08/07/21 19:26:47] INFO	features [X]      = *
[08/07/21 19:26:47] INFO	feature_selection = False
[08/07/21 19:26:47] INFO	fs_percentage     = 50
[08/07/21 19:26:47] INFO	fs_score_func     = <function f_classif at 0x7f99f9e2e8b0>
[08/07/21 19:26:47] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:26:47] INFO	grid_search       = True
[08/07/21 19:26:47] INFO	gs_iters          = 50
[08/07/21 19:26:47] INFO	gs_random         = True
[08/07/21 19:26:47] INFO	gs_sample         = False
[08/07/21 19:26:47] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:26:47] INFO	importances       = True
[08/07/21 19:26:47] INFO	interactions      = False
[08/07/21 19:26:47] INFO	isomap            = False
[08/07/21 19:26:47] INFO	iso_components    = 2
[08/07/21 19:26:47] INFO	iso_neighbors     = 5
[08/07/21 19:26:47] INFO	isample_pct       = 10
[08/07/21 19:26:47] INFO	learning_curve    = True
[08/07/21 19:26:47] INFO	logtransform      = False
[08/07/21 19:26:47] INFO	lv_remove         = True
[08/07/21 19:26:47] INFO	lv_threshold      = 0.100000
[08/07/21 19:26:47] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:26:47] INFO	n_estimators      = 51
[08/07/21 19:26:47] INFO	n_jobs            = -1
[08/07/21 19:26:47] INFO	ngrams_max        = 2
[08/07/21 19:26:47] INFO	numpy             = True
[08/07/21 19:26:47] INFO	pca               = False
[08/07/21 19:26:47] INFO	pca_inc           = 1
[08/07/21 19:26:47] INFO	pca_max           = 10
[08/07/21 19:26:47] INFO	pca_min           = 2
[08/07/21 19:26:47] INFO	pca_whiten        = False
[08/07/21 19:26:47] INFO	poly_degree       = 2
[08/07/21 19:26:47] INFO	pvalue_level      = 0.010000
[08/07/21 19:26:47] INFO	rfe               = True
[08/07/21 19:26:47] INFO	rfe_step          = 3
[08/07/21 19:26:47] INFO	roc_curve         = True
[08/07/21 19:26:47] INFO	rounding          = 2
[08/07/21 19:26:47] INFO	sampling          = False
[08/07/21 19:26:47] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:26:47] INFO	sampling_ratio    = 0.500000
[08/07/21 19:26:47] INFO	scaler_option     = True
[08/07/21 19:26:47] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:26:47] INFO	scipy             = False
[08/07/21 19:26:47] INFO	scorer            = roc_auc
[08/07/21 19:26:47] INFO	seed              = 42
[08/07/21 19:26:47] INFO	sentinel          = -1
[08/07/21 19:26:47] INFO	separator         = ,
[08/07/21 19:26:47] INFO	shuffle           = False
[08/07/21 19:26:47] INFO	split             = 0.400000
[08/07/21 19:26:47] INFO	submission_file   = gender_submission
[08/07/21 19:26:47] INFO	submit_probas     = False
[08/07/21 19:26:47] INFO	target [y]        = Survived
[08/07/21 19:26:47] INFO	target_value      = 1
[08/07/21 19:26:47] INFO	transforms        = None
[08/07/21 19:26:47] INFO	tsne              = False
[08/07/21 19:26:47] INFO	tsne_components   = 2
[08/07/21 19:26:47] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:26:47] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:26:47] INFO	vectorize         = False
[08/07/21 19:26:47] INFO	verbosity         = 0
[08/07/21 19:26:47] INFO	Creating Model
[08/07/21 19:26:47] INFO	Calling Pipeline
[08/07/21 19:26:47] INFO	Training Pipeline
[08/07/21 19:26:47] INFO	Loading Data
[08/07/21 19:26:47] INFO	Loading data from ./input/train.csv
[08/07/21 19:26:47] INFO	Found target Survived in data frame
[08/07/21 19:26:47] INFO	Labels (y) found for Partition.train
[08/07/21 19:26:47] INFO	Loading Data
[08/07/21 19:26:47] INFO	Loading data from ./input/test.csv
[08/07/21 19:26:47] INFO	Target Survived not found in Partition.test
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Original Feature Statistics
[08/07/21 19:26:47] INFO	Number of Training Rows    : 891
[08/07/21 19:26:47] INFO	Number of Training Columns : 11
[08/07/21 19:26:47] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:26:47] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:26:47] INFO	Number of Testing Rows     : 418
[08/07/21 19:26:47] INFO	Number of Testing Columns  : 11
[08/07/21 19:26:47] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:26:47] INFO	Feature Count     : 11
[08/07/21 19:26:47] INFO	Applying transforms
[08/07/21 19:26:47] INFO	No transforms Specified
[08/07/21 19:26:47] INFO	New Feature Count : 11
[08/07/21 19:26:47] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:26:47] INFO	Original Feature Count : 11
[08/07/21 19:26:47] INFO	Reduced Feature Count  : 10
[08/07/21 19:26:47] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:26:47] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:26:47] INFO	Creating Cross-Tabulations
[08/07/21 19:26:47] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:26:47] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:26:47] INFO	Feature Count     : 10
[08/07/21 19:26:47] INFO	Creating Count Features
[08/07/21 19:26:47] INFO	NA Counts
[08/07/21 19:26:47] INFO	Number Counts
[08/07/21 19:26:47] INFO	New Feature Count : 21
[08/07/21 19:26:47] INFO	Creating Base Features
[08/07/21 19:26:47] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:26:47] INFO	Feature 2: Name => Factorization
[08/07/21 19:26:47] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:26:47] INFO	Feature 3: Sex => Factorization
[08/07/21 19:26:47] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:26:47] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:26:47] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:26:47] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:26:47] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:26:47] INFO	Encoding: Encoders.target
[08/07/21 19:26:47] INFO	Fitting training features for Embarked
[08/07/21 19:26:47] INFO	Transforming testing features for Embarked
[08/07/21 19:26:47] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:26:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:26:47] INFO	New Feature Count : 21
[08/07/21 19:26:47] INFO	Scaling Base Features
[08/07/21 19:26:47] INFO	Creating NumPy Features
[08/07/21 19:26:47] INFO	NumPy Feature: sum
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: mean
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: std
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature: var
[08/07/21 19:26:47] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:26:47] INFO	NumPy Feature Count : 4
[08/07/21 19:26:47] INFO	New Feature Count : 25
[08/07/21 19:26:47] INFO	Creating Clustering Features
[08/07/21 19:26:47] INFO	Cluster Minimum   : 3
[08/07/21 19:26:47] INFO	Cluster Maximum   : 30
[08/07/21 19:26:47] INFO	Cluster Increment : 3
[08/07/21 19:26:47] INFO	k = 3
[08/07/21 19:26:47] INFO	k = 6
[08/07/21 19:26:47] INFO	k = 9
[08/07/21 19:26:47] INFO	k = 12
[08/07/21 19:26:47] INFO	k = 15
[08/07/21 19:26:47] INFO	k = 18
[08/07/21 19:26:47] INFO	k = 21
[08/07/21 19:26:47] INFO	k = 24
[08/07/21 19:26:47] INFO	k = 27
[08/07/21 19:26:47] INFO	k = 30
[08/07/21 19:26:47] INFO	Clustering Feature Count : 10
[08/07/21 19:26:47] INFO	New Feature Count : 35
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Creating Interactions
[08/07/21 19:26:47] INFO	Initial Feature Count  : 35
[08/07/21 19:26:47] INFO	Skipping Interactions
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Removing Low-Variance Features
[08/07/21 19:26:47] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:26:47] INFO	Original Feature Count  : 35
[08/07/21 19:26:47] INFO	Reduced Feature Count   : 35
[08/07/21 19:26:47] INFO	Saving New Features in Model
[08/07/21 19:26:47] INFO	Skipping Shuffling
[08/07/21 19:26:47] INFO	Skipping Sampling
[08/07/21 19:26:47] INFO	Getting All Estimators
[08/07/21 19:26:47] INFO	Algorithm Configuration
[08/07/21 19:26:47] INFO	Cannot load xgboost
[08/07/21 19:26:47] INFO	Cannot load lightgbm
[08/07/21 19:26:47] INFO	Cannot load catboost
[08/07/21 19:26:47] INFO	Cannot load keras
[08/07/21 19:26:47] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:26:47] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:26:47] INFO	Selecting Models
[08/07/21 19:26:47] INFO	Algorithm: CATB
[08/07/21 19:26:47] INFO	Algorithm CATB not found
[08/07/21 19:27:41] INFO	********************************************************************************
[08/07/21 19:27:41] INFO	AlphaPy Start
[08/07/21 19:27:41] INFO	********************************************************************************
[08/07/21 19:27:41] INFO	Model Configuration
[08/07/21 19:27:41] INFO	No transforms Found
[08/07/21 19:27:41] INFO	MODEL PARAMETERS:
[08/07/21 19:27:41] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:27:41] INFO	calibration       = False
[08/07/21 19:27:41] INFO	cal_type          = sigmoid
[08/07/21 19:27:41] INFO	calibration_plot  = False
[08/07/21 19:27:41] INFO	clustering        = True
[08/07/21 19:27:41] INFO	cluster_inc       = 3
[08/07/21 19:27:41] INFO	cluster_max       = 30
[08/07/21 19:27:41] INFO	cluster_min       = 3
[08/07/21 19:27:41] INFO	confusion_matrix  = True
[08/07/21 19:27:41] INFO	counts            = True
[08/07/21 19:27:41] INFO	cv_folds          = 3
[08/07/21 19:27:41] INFO	directory         = .
[08/07/21 19:27:41] INFO	extension         = csv
[08/07/21 19:27:41] INFO	drop              = ['PassengerId']
[08/07/21 19:27:41] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:27:41] INFO	esr               = 20
[08/07/21 19:27:41] INFO	factors           = ['Embarked']
[08/07/21 19:27:41] INFO	features [X]      = *
[08/07/21 19:27:41] INFO	feature_selection = False
[08/07/21 19:27:41] INFO	fs_percentage     = 50
[08/07/21 19:27:41] INFO	fs_score_func     = <function f_classif at 0x7fa9eb53b700>
[08/07/21 19:27:41] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:27:41] INFO	grid_search       = True
[08/07/21 19:27:41] INFO	gs_iters          = 50
[08/07/21 19:27:41] INFO	gs_random         = True
[08/07/21 19:27:41] INFO	gs_sample         = False
[08/07/21 19:27:41] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:27:41] INFO	importances       = True
[08/07/21 19:27:41] INFO	interactions      = False
[08/07/21 19:27:41] INFO	isomap            = False
[08/07/21 19:27:41] INFO	iso_components    = 2
[08/07/21 19:27:41] INFO	iso_neighbors     = 5
[08/07/21 19:27:41] INFO	isample_pct       = 10
[08/07/21 19:27:41] INFO	learning_curve    = True
[08/07/21 19:27:41] INFO	logtransform      = False
[08/07/21 19:27:41] INFO	lv_remove         = True
[08/07/21 19:27:41] INFO	lv_threshold      = 0.100000
[08/07/21 19:27:41] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:27:41] INFO	n_estimators      = 51
[08/07/21 19:27:41] INFO	n_jobs            = -1
[08/07/21 19:27:41] INFO	ngrams_max        = 2
[08/07/21 19:27:41] INFO	numpy             = True
[08/07/21 19:27:41] INFO	pca               = False
[08/07/21 19:27:41] INFO	pca_inc           = 1
[08/07/21 19:27:41] INFO	pca_max           = 10
[08/07/21 19:27:41] INFO	pca_min           = 2
[08/07/21 19:27:41] INFO	pca_whiten        = False
[08/07/21 19:27:41] INFO	poly_degree       = 2
[08/07/21 19:27:41] INFO	pvalue_level      = 0.010000
[08/07/21 19:27:41] INFO	rfe               = True
[08/07/21 19:27:41] INFO	rfe_step          = 3
[08/07/21 19:27:41] INFO	roc_curve         = True
[08/07/21 19:27:41] INFO	rounding          = 2
[08/07/21 19:27:41] INFO	sampling          = False
[08/07/21 19:27:41] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:27:41] INFO	sampling_ratio    = 0.500000
[08/07/21 19:27:41] INFO	scaler_option     = True
[08/07/21 19:27:41] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:27:41] INFO	scipy             = False
[08/07/21 19:27:41] INFO	scorer            = roc_auc
[08/07/21 19:27:41] INFO	seed              = 42
[08/07/21 19:27:41] INFO	sentinel          = -1
[08/07/21 19:27:41] INFO	separator         = ,
[08/07/21 19:27:41] INFO	shuffle           = False
[08/07/21 19:27:41] INFO	split             = 0.400000
[08/07/21 19:27:41] INFO	submission_file   = gender_submission
[08/07/21 19:27:41] INFO	submit_probas     = False
[08/07/21 19:27:41] INFO	target [y]        = Survived
[08/07/21 19:27:41] INFO	target_value      = 1
[08/07/21 19:27:41] INFO	transforms        = None
[08/07/21 19:27:41] INFO	tsne              = False
[08/07/21 19:27:41] INFO	tsne_components   = 2
[08/07/21 19:27:41] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:27:41] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:27:41] INFO	vectorize         = False
[08/07/21 19:27:41] INFO	verbosity         = 0
[08/07/21 19:27:41] INFO	Creating Model
[08/07/21 19:27:41] INFO	Calling Pipeline
[08/07/21 19:27:41] INFO	Training Pipeline
[08/07/21 19:27:41] INFO	Loading Data
[08/07/21 19:27:41] INFO	Loading data from ./input/train.csv
[08/07/21 19:27:41] INFO	Found target Survived in data frame
[08/07/21 19:27:41] INFO	Labels (y) found for Partition.train
[08/07/21 19:27:41] INFO	Loading Data
[08/07/21 19:27:41] INFO	Loading data from ./input/test.csv
[08/07/21 19:27:41] INFO	Target Survived not found in Partition.test
[08/07/21 19:27:41] INFO	Saving New Features in Model
[08/07/21 19:27:41] INFO	Original Feature Statistics
[08/07/21 19:27:41] INFO	Number of Training Rows    : 891
[08/07/21 19:27:41] INFO	Number of Training Columns : 11
[08/07/21 19:27:41] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:27:41] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:27:41] INFO	Number of Testing Rows     : 418
[08/07/21 19:27:41] INFO	Number of Testing Columns  : 11
[08/07/21 19:27:41] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:27:41] INFO	Feature Count     : 11
[08/07/21 19:27:41] INFO	Applying transforms
[08/07/21 19:27:41] INFO	No transforms Specified
[08/07/21 19:27:41] INFO	New Feature Count : 11
[08/07/21 19:27:41] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:27:41] INFO	Original Feature Count : 11
[08/07/21 19:27:41] INFO	Reduced Feature Count  : 10
[08/07/21 19:27:41] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:27:41] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:27:41] INFO	Creating Cross-Tabulations
[08/07/21 19:27:41] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:27:41] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:27:41] INFO	Feature Count     : 10
[08/07/21 19:27:41] INFO	Creating Count Features
[08/07/21 19:27:41] INFO	NA Counts
[08/07/21 19:27:41] INFO	Number Counts
[08/07/21 19:27:41] INFO	New Feature Count : 21
[08/07/21 19:27:41] INFO	Creating Base Features
[08/07/21 19:27:41] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:27:41] INFO	Feature 2: Name => Factorization
[08/07/21 19:27:41] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:27:41] INFO	Feature 3: Sex => Factorization
[08/07/21 19:27:41] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:27:41] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:27:41] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:27:41] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:27:41] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:27:41] INFO	Encoding: Encoders.target
[08/07/21 19:27:41] INFO	Fitting training features for Embarked
[08/07/21 19:27:41] INFO	Transforming testing features for Embarked
[08/07/21 19:27:41] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:27:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:27:41] INFO	New Feature Count : 21
[08/07/21 19:27:41] INFO	Scaling Base Features
[08/07/21 19:27:41] INFO	Creating NumPy Features
[08/07/21 19:27:41] INFO	NumPy Feature: sum
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: mean
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: std
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature: var
[08/07/21 19:27:41] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:27:41] INFO	NumPy Feature Count : 4
[08/07/21 19:27:41] INFO	New Feature Count : 25
[08/07/21 19:27:41] INFO	Creating Clustering Features
[08/07/21 19:27:41] INFO	Cluster Minimum   : 3
[08/07/21 19:27:41] INFO	Cluster Maximum   : 30
[08/07/21 19:27:41] INFO	Cluster Increment : 3
[08/07/21 19:27:41] INFO	k = 3
[08/07/21 19:27:41] INFO	k = 6
[08/07/21 19:27:41] INFO	k = 9
[08/07/21 19:27:41] INFO	k = 12
[08/07/21 19:27:41] INFO	k = 15
[08/07/21 19:27:41] INFO	k = 18
[08/07/21 19:27:42] INFO	k = 21
[08/07/21 19:27:42] INFO	k = 24
[08/07/21 19:27:42] INFO	k = 27
[08/07/21 19:27:42] INFO	k = 30
[08/07/21 19:27:42] INFO	Clustering Feature Count : 10
[08/07/21 19:27:42] INFO	New Feature Count : 35
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Creating Interactions
[08/07/21 19:27:42] INFO	Initial Feature Count  : 35
[08/07/21 19:27:42] INFO	Skipping Interactions
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Removing Low-Variance Features
[08/07/21 19:27:42] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:27:42] INFO	Original Feature Count  : 35
[08/07/21 19:27:42] INFO	Reduced Feature Count   : 35
[08/07/21 19:27:42] INFO	Saving New Features in Model
[08/07/21 19:27:42] INFO	Skipping Shuffling
[08/07/21 19:27:42] INFO	Skipping Sampling
[08/07/21 19:27:42] INFO	Getting All Estimators
[08/07/21 19:27:42] INFO	Algorithm Configuration
[08/07/21 19:27:42] INFO	Cannot load xgboost
[08/07/21 19:27:42] INFO	Cannot load lightgbm
[08/07/21 19:27:42] INFO	Cannot load catboost
[08/07/21 19:27:42] INFO	Cannot load keras
[08/07/21 19:27:42] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm LGB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm LGBR not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:27:42] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:27:42] INFO	Selecting Models
[08/07/21 19:27:42] INFO	Algorithm: CATB
[08/07/21 19:27:42] INFO	Algorithm CATB not found
[08/07/21 19:27:42] INFO	Fitting Initial Model
[08/07/21 19:28:50] INFO	********************************************************************************
[08/07/21 19:28:50] INFO	AlphaPy Start
[08/07/21 19:28:50] INFO	********************************************************************************
[08/07/21 19:28:50] INFO	Model Configuration
[08/07/21 19:28:50] INFO	No transforms Found
[08/07/21 19:28:50] INFO	MODEL PARAMETERS:
[08/07/21 19:28:50] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:28:50] INFO	calibration       = False
[08/07/21 19:28:50] INFO	cal_type          = sigmoid
[08/07/21 19:28:50] INFO	calibration_plot  = False
[08/07/21 19:28:50] INFO	clustering        = True
[08/07/21 19:28:50] INFO	cluster_inc       = 3
[08/07/21 19:28:50] INFO	cluster_max       = 30
[08/07/21 19:28:50] INFO	cluster_min       = 3
[08/07/21 19:28:50] INFO	confusion_matrix  = True
[08/07/21 19:28:50] INFO	counts            = True
[08/07/21 19:28:50] INFO	cv_folds          = 3
[08/07/21 19:28:50] INFO	directory         = .
[08/07/21 19:28:50] INFO	extension         = csv
[08/07/21 19:28:50] INFO	drop              = ['PassengerId']
[08/07/21 19:28:50] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:28:50] INFO	esr               = 20
[08/07/21 19:28:50] INFO	factors           = ['Embarked']
[08/07/21 19:28:50] INFO	features [X]      = *
[08/07/21 19:28:50] INFO	feature_selection = False
[08/07/21 19:28:50] INFO	fs_percentage     = 50
[08/07/21 19:28:50] INFO	fs_score_func     = <function f_classif at 0x7f929349d8b0>
[08/07/21 19:28:50] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:28:50] INFO	grid_search       = True
[08/07/21 19:28:50] INFO	gs_iters          = 50
[08/07/21 19:28:50] INFO	gs_random         = True
[08/07/21 19:28:50] INFO	gs_sample         = False
[08/07/21 19:28:50] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:28:50] INFO	importances       = True
[08/07/21 19:28:50] INFO	interactions      = False
[08/07/21 19:28:50] INFO	isomap            = False
[08/07/21 19:28:50] INFO	iso_components    = 2
[08/07/21 19:28:50] INFO	iso_neighbors     = 5
[08/07/21 19:28:50] INFO	isample_pct       = 10
[08/07/21 19:28:50] INFO	learning_curve    = True
[08/07/21 19:28:50] INFO	logtransform      = False
[08/07/21 19:28:50] INFO	lv_remove         = True
[08/07/21 19:28:50] INFO	lv_threshold      = 0.100000
[08/07/21 19:28:50] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:28:50] INFO	n_estimators      = 51
[08/07/21 19:28:50] INFO	n_jobs            = -1
[08/07/21 19:28:50] INFO	ngrams_max        = 2
[08/07/21 19:28:50] INFO	numpy             = True
[08/07/21 19:28:50] INFO	pca               = False
[08/07/21 19:28:50] INFO	pca_inc           = 1
[08/07/21 19:28:50] INFO	pca_max           = 10
[08/07/21 19:28:50] INFO	pca_min           = 2
[08/07/21 19:28:50] INFO	pca_whiten        = False
[08/07/21 19:28:50] INFO	poly_degree       = 2
[08/07/21 19:28:50] INFO	pvalue_level      = 0.010000
[08/07/21 19:28:50] INFO	rfe               = True
[08/07/21 19:28:50] INFO	rfe_step          = 3
[08/07/21 19:28:50] INFO	roc_curve         = True
[08/07/21 19:28:50] INFO	rounding          = 2
[08/07/21 19:28:50] INFO	sampling          = False
[08/07/21 19:28:50] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:28:50] INFO	sampling_ratio    = 0.500000
[08/07/21 19:28:50] INFO	scaler_option     = True
[08/07/21 19:28:50] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:28:50] INFO	scipy             = False
[08/07/21 19:28:50] INFO	scorer            = roc_auc
[08/07/21 19:28:50] INFO	seed              = 42
[08/07/21 19:28:50] INFO	sentinel          = -1
[08/07/21 19:28:50] INFO	separator         = ,
[08/07/21 19:28:50] INFO	shuffle           = False
[08/07/21 19:28:50] INFO	split             = 0.400000
[08/07/21 19:28:50] INFO	submission_file   = gender_submission
[08/07/21 19:28:50] INFO	submit_probas     = False
[08/07/21 19:28:50] INFO	target [y]        = Survived
[08/07/21 19:28:50] INFO	target_value      = 1
[08/07/21 19:28:50] INFO	transforms        = None
[08/07/21 19:28:50] INFO	tsne              = False
[08/07/21 19:28:50] INFO	tsne_components   = 2
[08/07/21 19:28:50] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:28:50] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:28:50] INFO	vectorize         = False
[08/07/21 19:28:50] INFO	verbosity         = 0
[08/07/21 19:28:50] INFO	Creating Model
[08/07/21 19:28:50] INFO	Calling Pipeline
[08/07/21 19:28:50] INFO	Training Pipeline
[08/07/21 19:28:50] INFO	Loading Data
[08/07/21 19:28:50] INFO	Loading data from ./input/train.csv
[08/07/21 19:28:50] INFO	Found target Survived in data frame
[08/07/21 19:28:50] INFO	Labels (y) found for Partition.train
[08/07/21 19:28:50] INFO	Loading Data
[08/07/21 19:28:50] INFO	Loading data from ./input/test.csv
[08/07/21 19:28:50] INFO	Target Survived not found in Partition.test
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Original Feature Statistics
[08/07/21 19:28:50] INFO	Number of Training Rows    : 891
[08/07/21 19:28:50] INFO	Number of Training Columns : 11
[08/07/21 19:28:50] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:28:50] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:28:50] INFO	Number of Testing Rows     : 418
[08/07/21 19:28:50] INFO	Number of Testing Columns  : 11
[08/07/21 19:28:50] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:28:50] INFO	Feature Count     : 11
[08/07/21 19:28:50] INFO	Applying transforms
[08/07/21 19:28:50] INFO	No transforms Specified
[08/07/21 19:28:50] INFO	New Feature Count : 11
[08/07/21 19:28:50] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:28:50] INFO	Original Feature Count : 11
[08/07/21 19:28:50] INFO	Reduced Feature Count  : 10
[08/07/21 19:28:50] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:28:50] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:28:50] INFO	Creating Cross-Tabulations
[08/07/21 19:28:50] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:28:50] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:28:50] INFO	Feature Count     : 10
[08/07/21 19:28:50] INFO	Creating Count Features
[08/07/21 19:28:50] INFO	NA Counts
[08/07/21 19:28:50] INFO	Number Counts
[08/07/21 19:28:50] INFO	New Feature Count : 21
[08/07/21 19:28:50] INFO	Creating Base Features
[08/07/21 19:28:50] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:28:50] INFO	Feature 2: Name => Factorization
[08/07/21 19:28:50] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:28:50] INFO	Feature 3: Sex => Factorization
[08/07/21 19:28:50] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:28:50] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:28:50] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:28:50] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:28:50] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:28:50] INFO	Encoding: Encoders.target
[08/07/21 19:28:50] INFO	Fitting training features for Embarked
[08/07/21 19:28:50] INFO	Transforming testing features for Embarked
[08/07/21 19:28:50] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:28:50] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:28:50] INFO	New Feature Count : 21
[08/07/21 19:28:50] INFO	Scaling Base Features
[08/07/21 19:28:50] INFO	Creating NumPy Features
[08/07/21 19:28:50] INFO	NumPy Feature: sum
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: mean
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: std
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature: var
[08/07/21 19:28:50] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:28:50] INFO	NumPy Feature Count : 4
[08/07/21 19:28:50] INFO	New Feature Count : 25
[08/07/21 19:28:50] INFO	Creating Clustering Features
[08/07/21 19:28:50] INFO	Cluster Minimum   : 3
[08/07/21 19:28:50] INFO	Cluster Maximum   : 30
[08/07/21 19:28:50] INFO	Cluster Increment : 3
[08/07/21 19:28:50] INFO	k = 3
[08/07/21 19:28:50] INFO	k = 6
[08/07/21 19:28:50] INFO	k = 9
[08/07/21 19:28:50] INFO	k = 12
[08/07/21 19:28:50] INFO	k = 15
[08/07/21 19:28:50] INFO	k = 18
[08/07/21 19:28:50] INFO	k = 21
[08/07/21 19:28:50] INFO	k = 24
[08/07/21 19:28:50] INFO	k = 27
[08/07/21 19:28:50] INFO	k = 30
[08/07/21 19:28:50] INFO	Clustering Feature Count : 10
[08/07/21 19:28:50] INFO	New Feature Count : 35
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Creating Interactions
[08/07/21 19:28:50] INFO	Initial Feature Count  : 35
[08/07/21 19:28:50] INFO	Skipping Interactions
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Removing Low-Variance Features
[08/07/21 19:28:50] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:28:50] INFO	Original Feature Count  : 35
[08/07/21 19:28:50] INFO	Reduced Feature Count   : 35
[08/07/21 19:28:50] INFO	Saving New Features in Model
[08/07/21 19:28:50] INFO	Skipping Shuffling
[08/07/21 19:28:50] INFO	Skipping Sampling
[08/07/21 19:28:50] INFO	Getting All Estimators
[08/07/21 19:28:50] INFO	Algorithm Configuration
[08/07/21 19:28:50] INFO	Cannot load xgboost
[08/07/21 19:28:50] INFO	Cannot load catboost
[08/07/21 19:28:50] INFO	Cannot load keras
[08/07/21 19:28:50] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGB not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGBM not found (check package installation)
[08/07/21 19:28:50] INFO	Algorithm XGBR not found (check package installation)
[08/07/21 19:28:50] INFO	Selecting Models
[08/07/21 19:28:50] INFO	Algorithm: CATB
[08/07/21 19:28:50] INFO	Algorithm CATB not found
[08/07/21 19:28:50] INFO	Fitting Initial Model
[08/07/21 19:30:00] INFO	********************************************************************************
[08/07/21 19:30:00] INFO	AlphaPy Start
[08/07/21 19:30:00] INFO	********************************************************************************
[08/07/21 19:30:00] INFO	Model Configuration
[08/07/21 19:30:00] INFO	No transforms Found
[08/07/21 19:30:00] INFO	MODEL PARAMETERS:
[08/07/21 19:30:00] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:30:00] INFO	calibration       = False
[08/07/21 19:30:00] INFO	cal_type          = sigmoid
[08/07/21 19:30:00] INFO	calibration_plot  = False
[08/07/21 19:30:00] INFO	clustering        = True
[08/07/21 19:30:00] INFO	cluster_inc       = 3
[08/07/21 19:30:00] INFO	cluster_max       = 30
[08/07/21 19:30:00] INFO	cluster_min       = 3
[08/07/21 19:30:00] INFO	confusion_matrix  = True
[08/07/21 19:30:00] INFO	counts            = True
[08/07/21 19:30:00] INFO	cv_folds          = 3
[08/07/21 19:30:00] INFO	directory         = .
[08/07/21 19:30:00] INFO	extension         = csv
[08/07/21 19:30:00] INFO	drop              = ['PassengerId']
[08/07/21 19:30:00] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:30:00] INFO	esr               = 20
[08/07/21 19:30:00] INFO	factors           = ['Embarked']
[08/07/21 19:30:00] INFO	features [X]      = *
[08/07/21 19:30:00] INFO	feature_selection = False
[08/07/21 19:30:00] INFO	fs_percentage     = 50
[08/07/21 19:30:00] INFO	fs_score_func     = <function f_classif at 0x7f7f2b51d8b0>
[08/07/21 19:30:00] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:30:00] INFO	grid_search       = True
[08/07/21 19:30:00] INFO	gs_iters          = 50
[08/07/21 19:30:00] INFO	gs_random         = True
[08/07/21 19:30:00] INFO	gs_sample         = False
[08/07/21 19:30:00] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:30:00] INFO	importances       = True
[08/07/21 19:30:00] INFO	interactions      = False
[08/07/21 19:30:00] INFO	isomap            = False
[08/07/21 19:30:00] INFO	iso_components    = 2
[08/07/21 19:30:00] INFO	iso_neighbors     = 5
[08/07/21 19:30:00] INFO	isample_pct       = 10
[08/07/21 19:30:00] INFO	learning_curve    = True
[08/07/21 19:30:00] INFO	logtransform      = False
[08/07/21 19:30:00] INFO	lv_remove         = True
[08/07/21 19:30:00] INFO	lv_threshold      = 0.100000
[08/07/21 19:30:00] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:30:00] INFO	n_estimators      = 51
[08/07/21 19:30:00] INFO	n_jobs            = -1
[08/07/21 19:30:00] INFO	ngrams_max        = 2
[08/07/21 19:30:00] INFO	numpy             = True
[08/07/21 19:30:00] INFO	pca               = False
[08/07/21 19:30:00] INFO	pca_inc           = 1
[08/07/21 19:30:00] INFO	pca_max           = 10
[08/07/21 19:30:00] INFO	pca_min           = 2
[08/07/21 19:30:00] INFO	pca_whiten        = False
[08/07/21 19:30:00] INFO	poly_degree       = 2
[08/07/21 19:30:00] INFO	pvalue_level      = 0.010000
[08/07/21 19:30:00] INFO	rfe               = True
[08/07/21 19:30:00] INFO	rfe_step          = 3
[08/07/21 19:30:00] INFO	roc_curve         = True
[08/07/21 19:30:00] INFO	rounding          = 2
[08/07/21 19:30:00] INFO	sampling          = False
[08/07/21 19:30:00] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:30:00] INFO	sampling_ratio    = 0.500000
[08/07/21 19:30:00] INFO	scaler_option     = True
[08/07/21 19:30:00] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:30:00] INFO	scipy             = False
[08/07/21 19:30:00] INFO	scorer            = roc_auc
[08/07/21 19:30:00] INFO	seed              = 42
[08/07/21 19:30:00] INFO	sentinel          = -1
[08/07/21 19:30:00] INFO	separator         = ,
[08/07/21 19:30:00] INFO	shuffle           = False
[08/07/21 19:30:00] INFO	split             = 0.400000
[08/07/21 19:30:00] INFO	submission_file   = gender_submission
[08/07/21 19:30:00] INFO	submit_probas     = False
[08/07/21 19:30:00] INFO	target [y]        = Survived
[08/07/21 19:30:00] INFO	target_value      = 1
[08/07/21 19:30:00] INFO	transforms        = None
[08/07/21 19:30:00] INFO	tsne              = False
[08/07/21 19:30:00] INFO	tsne_components   = 2
[08/07/21 19:30:00] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:30:00] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:30:00] INFO	vectorize         = False
[08/07/21 19:30:00] INFO	verbosity         = 0
[08/07/21 19:30:00] INFO	Creating Model
[08/07/21 19:30:00] INFO	Calling Pipeline
[08/07/21 19:30:00] INFO	Training Pipeline
[08/07/21 19:30:00] INFO	Loading Data
[08/07/21 19:30:00] INFO	Loading data from ./input/train.csv
[08/07/21 19:30:00] INFO	Found target Survived in data frame
[08/07/21 19:30:00] INFO	Labels (y) found for Partition.train
[08/07/21 19:30:00] INFO	Loading Data
[08/07/21 19:30:00] INFO	Loading data from ./input/test.csv
[08/07/21 19:30:01] INFO	Target Survived not found in Partition.test
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Original Feature Statistics
[08/07/21 19:30:01] INFO	Number of Training Rows    : 891
[08/07/21 19:30:01] INFO	Number of Training Columns : 11
[08/07/21 19:30:01] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:30:01] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:30:01] INFO	Number of Testing Rows     : 418
[08/07/21 19:30:01] INFO	Number of Testing Columns  : 11
[08/07/21 19:30:01] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:30:01] INFO	Feature Count     : 11
[08/07/21 19:30:01] INFO	Applying transforms
[08/07/21 19:30:01] INFO	No transforms Specified
[08/07/21 19:30:01] INFO	New Feature Count : 11
[08/07/21 19:30:01] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:30:01] INFO	Original Feature Count : 11
[08/07/21 19:30:01] INFO	Reduced Feature Count  : 10
[08/07/21 19:30:01] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:30:01] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:30:01] INFO	Creating Cross-Tabulations
[08/07/21 19:30:01] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:30:01] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:30:01] INFO	Feature Count     : 10
[08/07/21 19:30:01] INFO	Creating Count Features
[08/07/21 19:30:01] INFO	NA Counts
[08/07/21 19:30:01] INFO	Number Counts
[08/07/21 19:30:01] INFO	New Feature Count : 21
[08/07/21 19:30:01] INFO	Creating Base Features
[08/07/21 19:30:01] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:30:01] INFO	Feature 2: Name => Factorization
[08/07/21 19:30:01] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:30:01] INFO	Feature 3: Sex => Factorization
[08/07/21 19:30:01] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:30:01] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:30:01] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:30:01] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:30:01] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:30:01] INFO	Encoding: Encoders.target
[08/07/21 19:30:01] INFO	Fitting training features for Embarked
[08/07/21 19:30:01] INFO	Transforming testing features for Embarked
[08/07/21 19:30:01] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:30:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:30:01] INFO	New Feature Count : 21
[08/07/21 19:30:01] INFO	Scaling Base Features
[08/07/21 19:30:01] INFO	Creating NumPy Features
[08/07/21 19:30:01] INFO	NumPy Feature: sum
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: mean
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: std
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature: var
[08/07/21 19:30:01] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:30:01] INFO	NumPy Feature Count : 4
[08/07/21 19:30:01] INFO	New Feature Count : 25
[08/07/21 19:30:01] INFO	Creating Clustering Features
[08/07/21 19:30:01] INFO	Cluster Minimum   : 3
[08/07/21 19:30:01] INFO	Cluster Maximum   : 30
[08/07/21 19:30:01] INFO	Cluster Increment : 3
[08/07/21 19:30:01] INFO	k = 3
[08/07/21 19:30:01] INFO	k = 6
[08/07/21 19:30:01] INFO	k = 9
[08/07/21 19:30:01] INFO	k = 12
[08/07/21 19:30:01] INFO	k = 15
[08/07/21 19:30:01] INFO	k = 18
[08/07/21 19:30:01] INFO	k = 21
[08/07/21 19:30:01] INFO	k = 24
[08/07/21 19:30:01] INFO	k = 27
[08/07/21 19:30:01] INFO	k = 30
[08/07/21 19:30:01] INFO	Clustering Feature Count : 10
[08/07/21 19:30:01] INFO	New Feature Count : 35
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Creating Interactions
[08/07/21 19:30:01] INFO	Initial Feature Count  : 35
[08/07/21 19:30:01] INFO	Skipping Interactions
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Removing Low-Variance Features
[08/07/21 19:30:01] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:30:01] INFO	Original Feature Count  : 35
[08/07/21 19:30:01] INFO	Reduced Feature Count   : 35
[08/07/21 19:30:01] INFO	Saving New Features in Model
[08/07/21 19:30:01] INFO	Skipping Shuffling
[08/07/21 19:30:01] INFO	Skipping Sampling
[08/07/21 19:30:01] INFO	Getting All Estimators
[08/07/21 19:30:01] INFO	Algorithm Configuration
[08/07/21 19:30:01] INFO	Cannot load catboost
[08/07/21 19:30:01] INFO	Cannot load keras
[08/07/21 19:30:01] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:30:01] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:30:01] INFO	Selecting Models
[08/07/21 19:30:01] INFO	Algorithm: CATB
[08/07/21 19:30:01] INFO	Algorithm CATB not found
[08/07/21 19:30:01] INFO	Fitting Initial Model
[08/07/21 19:33:15] INFO	********************************************************************************
[08/07/21 19:33:15] INFO	AlphaPy Start
[08/07/21 19:33:15] INFO	********************************************************************************
[08/07/21 19:33:15] INFO	Model Configuration
[08/07/21 19:33:15] INFO	No transforms Found
[08/07/21 19:33:15] INFO	MODEL PARAMETERS:
[08/07/21 19:33:15] INFO	algorithms        = ['CATB', 'KERASC', 'LGB', 'XGB']
[08/07/21 19:33:15] INFO	calibration       = False
[08/07/21 19:33:15] INFO	cal_type          = sigmoid
[08/07/21 19:33:15] INFO	calibration_plot  = False
[08/07/21 19:33:15] INFO	clustering        = True
[08/07/21 19:33:15] INFO	cluster_inc       = 3
[08/07/21 19:33:15] INFO	cluster_max       = 30
[08/07/21 19:33:15] INFO	cluster_min       = 3
[08/07/21 19:33:15] INFO	confusion_matrix  = True
[08/07/21 19:33:15] INFO	counts            = True
[08/07/21 19:33:15] INFO	cv_folds          = 3
[08/07/21 19:33:15] INFO	directory         = .
[08/07/21 19:33:15] INFO	extension         = csv
[08/07/21 19:33:15] INFO	drop              = ['PassengerId']
[08/07/21 19:33:15] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:33:15] INFO	esr               = 20
[08/07/21 19:33:15] INFO	factors           = ['Embarked']
[08/07/21 19:33:15] INFO	features [X]      = *
[08/07/21 19:33:15] INFO	feature_selection = False
[08/07/21 19:33:15] INFO	fs_percentage     = 50
[08/07/21 19:33:15] INFO	fs_score_func     = <function f_classif at 0x7fe572ec58b0>
[08/07/21 19:33:15] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:33:15] INFO	grid_search       = True
[08/07/21 19:33:15] INFO	gs_iters          = 50
[08/07/21 19:33:15] INFO	gs_random         = True
[08/07/21 19:33:15] INFO	gs_sample         = False
[08/07/21 19:33:15] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:33:15] INFO	importances       = True
[08/07/21 19:33:15] INFO	interactions      = False
[08/07/21 19:33:15] INFO	isomap            = False
[08/07/21 19:33:15] INFO	iso_components    = 2
[08/07/21 19:33:15] INFO	iso_neighbors     = 5
[08/07/21 19:33:15] INFO	isample_pct       = 10
[08/07/21 19:33:15] INFO	learning_curve    = True
[08/07/21 19:33:15] INFO	logtransform      = False
[08/07/21 19:33:15] INFO	lv_remove         = True
[08/07/21 19:33:15] INFO	lv_threshold      = 0.100000
[08/07/21 19:33:15] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:33:15] INFO	n_estimators      = 51
[08/07/21 19:33:15] INFO	n_jobs            = -1
[08/07/21 19:33:15] INFO	ngrams_max        = 2
[08/07/21 19:33:15] INFO	numpy             = True
[08/07/21 19:33:15] INFO	pca               = False
[08/07/21 19:33:15] INFO	pca_inc           = 1
[08/07/21 19:33:15] INFO	pca_max           = 10
[08/07/21 19:33:15] INFO	pca_min           = 2
[08/07/21 19:33:15] INFO	pca_whiten        = False
[08/07/21 19:33:15] INFO	poly_degree       = 2
[08/07/21 19:33:15] INFO	pvalue_level      = 0.010000
[08/07/21 19:33:15] INFO	rfe               = True
[08/07/21 19:33:15] INFO	rfe_step          = 3
[08/07/21 19:33:15] INFO	roc_curve         = True
[08/07/21 19:33:15] INFO	rounding          = 2
[08/07/21 19:33:15] INFO	sampling          = False
[08/07/21 19:33:15] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:33:15] INFO	sampling_ratio    = 0.500000
[08/07/21 19:33:15] INFO	scaler_option     = True
[08/07/21 19:33:15] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:33:15] INFO	scipy             = False
[08/07/21 19:33:15] INFO	scorer            = roc_auc
[08/07/21 19:33:15] INFO	seed              = 42
[08/07/21 19:33:15] INFO	sentinel          = -1
[08/07/21 19:33:15] INFO	separator         = ,
[08/07/21 19:33:15] INFO	shuffle           = False
[08/07/21 19:33:15] INFO	split             = 0.400000
[08/07/21 19:33:15] INFO	submission_file   = gender_submission
[08/07/21 19:33:15] INFO	submit_probas     = False
[08/07/21 19:33:15] INFO	target [y]        = Survived
[08/07/21 19:33:15] INFO	target_value      = 1
[08/07/21 19:33:15] INFO	transforms        = None
[08/07/21 19:33:15] INFO	tsne              = False
[08/07/21 19:33:15] INFO	tsne_components   = 2
[08/07/21 19:33:15] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:33:15] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:33:15] INFO	vectorize         = False
[08/07/21 19:33:15] INFO	verbosity         = 0
[08/07/21 19:33:15] INFO	Creating Model
[08/07/21 19:33:15] INFO	Calling Pipeline
[08/07/21 19:33:15] INFO	Training Pipeline
[08/07/21 19:33:15] INFO	Loading Data
[08/07/21 19:33:15] INFO	Loading data from ./input/train.csv
[08/07/21 19:33:15] INFO	Found target Survived in data frame
[08/07/21 19:33:15] INFO	Labels (y) found for Partition.train
[08/07/21 19:33:15] INFO	Loading Data
[08/07/21 19:33:15] INFO	Loading data from ./input/test.csv
[08/07/21 19:33:15] INFO	Target Survived not found in Partition.test
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Original Feature Statistics
[08/07/21 19:33:15] INFO	Number of Training Rows    : 891
[08/07/21 19:33:15] INFO	Number of Training Columns : 11
[08/07/21 19:33:15] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:33:15] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:33:15] INFO	Number of Testing Rows     : 418
[08/07/21 19:33:15] INFO	Number of Testing Columns  : 11
[08/07/21 19:33:15] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:33:15] INFO	Feature Count     : 11
[08/07/21 19:33:15] INFO	Applying transforms
[08/07/21 19:33:15] INFO	No transforms Specified
[08/07/21 19:33:15] INFO	New Feature Count : 11
[08/07/21 19:33:15] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:33:15] INFO	Original Feature Count : 11
[08/07/21 19:33:15] INFO	Reduced Feature Count  : 10
[08/07/21 19:33:15] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:33:15] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:33:15] INFO	Creating Cross-Tabulations
[08/07/21 19:33:15] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:33:15] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:33:15] INFO	Feature Count     : 10
[08/07/21 19:33:15] INFO	Creating Count Features
[08/07/21 19:33:15] INFO	NA Counts
[08/07/21 19:33:15] INFO	Number Counts
[08/07/21 19:33:15] INFO	New Feature Count : 21
[08/07/21 19:33:15] INFO	Creating Base Features
[08/07/21 19:33:15] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:33:15] INFO	Feature 2: Name => Factorization
[08/07/21 19:33:15] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:33:15] INFO	Feature 3: Sex => Factorization
[08/07/21 19:33:15] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:33:15] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:33:15] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:33:15] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:33:15] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:33:15] INFO	Encoding: Encoders.target
[08/07/21 19:33:15] INFO	Fitting training features for Embarked
[08/07/21 19:33:15] INFO	Transforming testing features for Embarked
[08/07/21 19:33:15] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:33:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:33:15] INFO	New Feature Count : 21
[08/07/21 19:33:15] INFO	Scaling Base Features
[08/07/21 19:33:15] INFO	Creating NumPy Features
[08/07/21 19:33:15] INFO	NumPy Feature: sum
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: mean
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: std
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature: var
[08/07/21 19:33:15] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:33:15] INFO	NumPy Feature Count : 4
[08/07/21 19:33:15] INFO	New Feature Count : 25
[08/07/21 19:33:15] INFO	Creating Clustering Features
[08/07/21 19:33:15] INFO	Cluster Minimum   : 3
[08/07/21 19:33:15] INFO	Cluster Maximum   : 30
[08/07/21 19:33:15] INFO	Cluster Increment : 3
[08/07/21 19:33:15] INFO	k = 3
[08/07/21 19:33:15] INFO	k = 6
[08/07/21 19:33:15] INFO	k = 9
[08/07/21 19:33:15] INFO	k = 12
[08/07/21 19:33:15] INFO	k = 15
[08/07/21 19:33:15] INFO	k = 18
[08/07/21 19:33:15] INFO	k = 21
[08/07/21 19:33:15] INFO	k = 24
[08/07/21 19:33:15] INFO	k = 27
[08/07/21 19:33:15] INFO	k = 30
[08/07/21 19:33:15] INFO	Clustering Feature Count : 10
[08/07/21 19:33:15] INFO	New Feature Count : 35
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Creating Interactions
[08/07/21 19:33:15] INFO	Initial Feature Count  : 35
[08/07/21 19:33:15] INFO	Skipping Interactions
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Removing Low-Variance Features
[08/07/21 19:33:15] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:33:15] INFO	Original Feature Count  : 35
[08/07/21 19:33:15] INFO	Reduced Feature Count   : 35
[08/07/21 19:33:15] INFO	Saving New Features in Model
[08/07/21 19:33:15] INFO	Skipping Shuffling
[08/07/21 19:33:15] INFO	Skipping Sampling
[08/07/21 19:33:15] INFO	Getting All Estimators
[08/07/21 19:33:15] INFO	Algorithm Configuration
[08/07/21 19:33:15] INFO	Cannot load catboost
[08/07/21 19:33:15] INFO	Cannot load keras
[08/07/21 19:33:15] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:33:15] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:33:15] INFO	Selecting Models
[08/07/21 19:33:15] INFO	Algorithm: CATB
[08/07/21 19:33:15] INFO	Algorithm CATB not found
[08/07/21 19:33:15] INFO	Fitting Initial Model
[08/07/21 19:44:19] INFO	********************************************************************************
[08/07/21 19:44:19] INFO	AlphaPy Start
[08/07/21 19:44:19] INFO	********************************************************************************
[08/07/21 19:44:19] INFO	Model Configuration
[08/07/21 19:44:19] INFO	No transforms Found
[08/07/21 19:44:19] INFO	MODEL PARAMETERS:
[08/07/21 19:44:19] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:44:19] INFO	calibration       = False
[08/07/21 19:44:19] INFO	cal_type          = sigmoid
[08/07/21 19:44:19] INFO	calibration_plot  = False
[08/07/21 19:44:19] INFO	clustering        = True
[08/07/21 19:44:19] INFO	cluster_inc       = 3
[08/07/21 19:44:19] INFO	cluster_max       = 30
[08/07/21 19:44:19] INFO	cluster_min       = 3
[08/07/21 19:44:19] INFO	confusion_matrix  = True
[08/07/21 19:44:19] INFO	counts            = True
[08/07/21 19:44:19] INFO	cv_folds          = 3
[08/07/21 19:44:19] INFO	directory         = .
[08/07/21 19:44:19] INFO	extension         = csv
[08/07/21 19:44:19] INFO	drop              = ['PassengerId']
[08/07/21 19:44:19] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:44:19] INFO	esr               = 20
[08/07/21 19:44:19] INFO	factors           = ['Embarked']
[08/07/21 19:44:19] INFO	features [X]      = *
[08/07/21 19:44:19] INFO	feature_selection = False
[08/07/21 19:44:19] INFO	fs_percentage     = 50
[08/07/21 19:44:19] INFO	fs_score_func     = <function f_classif at 0x7ffce2d048b0>
[08/07/21 19:44:19] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:44:19] INFO	grid_search       = True
[08/07/21 19:44:19] INFO	gs_iters          = 50
[08/07/21 19:44:19] INFO	gs_random         = True
[08/07/21 19:44:19] INFO	gs_sample         = False
[08/07/21 19:44:19] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:44:19] INFO	importances       = True
[08/07/21 19:44:19] INFO	interactions      = False
[08/07/21 19:44:19] INFO	isomap            = False
[08/07/21 19:44:19] INFO	iso_components    = 2
[08/07/21 19:44:19] INFO	iso_neighbors     = 5
[08/07/21 19:44:19] INFO	isample_pct       = 10
[08/07/21 19:44:19] INFO	learning_curve    = True
[08/07/21 19:44:19] INFO	logtransform      = False
[08/07/21 19:44:19] INFO	lv_remove         = True
[08/07/21 19:44:19] INFO	lv_threshold      = 0.100000
[08/07/21 19:44:19] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:44:19] INFO	n_estimators      = 51
[08/07/21 19:44:19] INFO	n_jobs            = -1
[08/07/21 19:44:19] INFO	ngrams_max        = 2
[08/07/21 19:44:19] INFO	numpy             = True
[08/07/21 19:44:19] INFO	pca               = False
[08/07/21 19:44:19] INFO	pca_inc           = 1
[08/07/21 19:44:19] INFO	pca_max           = 10
[08/07/21 19:44:19] INFO	pca_min           = 2
[08/07/21 19:44:19] INFO	pca_whiten        = False
[08/07/21 19:44:19] INFO	poly_degree       = 2
[08/07/21 19:44:19] INFO	pvalue_level      = 0.010000
[08/07/21 19:44:19] INFO	rfe               = True
[08/07/21 19:44:19] INFO	rfe_step          = 3
[08/07/21 19:44:19] INFO	roc_curve         = True
[08/07/21 19:44:19] INFO	rounding          = 2
[08/07/21 19:44:19] INFO	sampling          = False
[08/07/21 19:44:19] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:44:19] INFO	sampling_ratio    = 0.500000
[08/07/21 19:44:19] INFO	scaler_option     = True
[08/07/21 19:44:19] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:44:19] INFO	scipy             = False
[08/07/21 19:44:19] INFO	scorer            = roc_auc
[08/07/21 19:44:19] INFO	seed              = 42
[08/07/21 19:44:19] INFO	sentinel          = -1
[08/07/21 19:44:19] INFO	separator         = ,
[08/07/21 19:44:19] INFO	shuffle           = False
[08/07/21 19:44:19] INFO	split             = 0.400000
[08/07/21 19:44:19] INFO	submission_file   = gender_submission
[08/07/21 19:44:19] INFO	submit_probas     = False
[08/07/21 19:44:19] INFO	target [y]        = Survived
[08/07/21 19:44:19] INFO	target_value      = 1
[08/07/21 19:44:19] INFO	transforms        = None
[08/07/21 19:44:19] INFO	tsne              = False
[08/07/21 19:44:19] INFO	tsne_components   = 2
[08/07/21 19:44:19] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:44:19] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:44:19] INFO	vectorize         = False
[08/07/21 19:44:19] INFO	verbosity         = 0
[08/07/21 19:44:19] INFO	Creating Model
[08/07/21 19:44:19] INFO	Calling Pipeline
[08/07/21 19:44:19] INFO	Training Pipeline
[08/07/21 19:44:19] INFO	Loading Data
[08/07/21 19:44:19] INFO	Loading data from ./input/train.csv
[08/07/21 19:44:19] INFO	Found target Survived in data frame
[08/07/21 19:44:19] INFO	Labels (y) found for Partition.train
[08/07/21 19:44:19] INFO	Loading Data
[08/07/21 19:44:19] INFO	Loading data from ./input/test.csv
[08/07/21 19:44:19] INFO	Target Survived not found in Partition.test
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Original Feature Statistics
[08/07/21 19:44:19] INFO	Number of Training Rows    : 891
[08/07/21 19:44:19] INFO	Number of Training Columns : 11
[08/07/21 19:44:19] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:44:19] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:44:19] INFO	Number of Testing Rows     : 418
[08/07/21 19:44:19] INFO	Number of Testing Columns  : 11
[08/07/21 19:44:19] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:44:19] INFO	Feature Count     : 11
[08/07/21 19:44:19] INFO	Applying transforms
[08/07/21 19:44:19] INFO	No transforms Specified
[08/07/21 19:44:19] INFO	New Feature Count : 11
[08/07/21 19:44:19] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:44:19] INFO	Original Feature Count : 11
[08/07/21 19:44:19] INFO	Reduced Feature Count  : 10
[08/07/21 19:44:19] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:44:19] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:44:19] INFO	Creating Cross-Tabulations
[08/07/21 19:44:19] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:44:19] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:44:19] INFO	Feature Count     : 10
[08/07/21 19:44:19] INFO	Creating Count Features
[08/07/21 19:44:19] INFO	NA Counts
[08/07/21 19:44:19] INFO	Number Counts
[08/07/21 19:44:19] INFO	New Feature Count : 21
[08/07/21 19:44:19] INFO	Creating Base Features
[08/07/21 19:44:19] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:44:19] INFO	Feature 2: Name => Factorization
[08/07/21 19:44:19] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:44:19] INFO	Feature 3: Sex => Factorization
[08/07/21 19:44:19] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:44:19] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:44:19] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:44:19] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:44:19] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:44:19] INFO	Encoding: Encoders.target
[08/07/21 19:44:19] INFO	Fitting training features for Embarked
[08/07/21 19:44:19] INFO	Transforming testing features for Embarked
[08/07/21 19:44:19] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:44:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:44:19] INFO	New Feature Count : 21
[08/07/21 19:44:19] INFO	Scaling Base Features
[08/07/21 19:44:19] INFO	Creating NumPy Features
[08/07/21 19:44:19] INFO	NumPy Feature: sum
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: mean
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: std
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature: var
[08/07/21 19:44:19] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:44:19] INFO	NumPy Feature Count : 4
[08/07/21 19:44:19] INFO	New Feature Count : 25
[08/07/21 19:44:19] INFO	Creating Clustering Features
[08/07/21 19:44:19] INFO	Cluster Minimum   : 3
[08/07/21 19:44:19] INFO	Cluster Maximum   : 30
[08/07/21 19:44:19] INFO	Cluster Increment : 3
[08/07/21 19:44:19] INFO	k = 3
[08/07/21 19:44:19] INFO	k = 6
[08/07/21 19:44:19] INFO	k = 9
[08/07/21 19:44:19] INFO	k = 12
[08/07/21 19:44:19] INFO	k = 15
[08/07/21 19:44:19] INFO	k = 18
[08/07/21 19:44:19] INFO	k = 21
[08/07/21 19:44:19] INFO	k = 24
[08/07/21 19:44:19] INFO	k = 27
[08/07/21 19:44:19] INFO	k = 30
[08/07/21 19:44:19] INFO	Clustering Feature Count : 10
[08/07/21 19:44:19] INFO	New Feature Count : 35
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Creating Interactions
[08/07/21 19:44:19] INFO	Initial Feature Count  : 35
[08/07/21 19:44:19] INFO	Skipping Interactions
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Removing Low-Variance Features
[08/07/21 19:44:19] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:44:19] INFO	Original Feature Count  : 35
[08/07/21 19:44:19] INFO	Reduced Feature Count   : 35
[08/07/21 19:44:19] INFO	Saving New Features in Model
[08/07/21 19:44:19] INFO	Skipping Shuffling
[08/07/21 19:44:19] INFO	Skipping Sampling
[08/07/21 19:44:19] INFO	Getting All Estimators
[08/07/21 19:44:19] INFO	Algorithm Configuration
[08/07/21 19:44:20] INFO	Cannot load catboost
[08/07/21 19:44:20] INFO	Cannot load keras
[08/07/21 19:44:20] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:44:20] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:44:20] INFO	Selecting Models
[08/07/21 19:44:20] INFO	Algorithm: CATB
[08/07/21 19:44:20] INFO	Algorithm CATB not found
[08/07/21 19:44:20] INFO	Fitting Initial Model
[08/07/21 19:45:30] INFO	********************************************************************************
[08/07/21 19:45:30] INFO	AlphaPy Start
[08/07/21 19:45:30] INFO	********************************************************************************
[08/07/21 19:45:30] INFO	Model Configuration
[08/07/21 19:45:30] INFO	No transforms Found
[08/07/21 19:45:30] INFO	MODEL PARAMETERS:
[08/07/21 19:45:30] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:45:30] INFO	calibration       = False
[08/07/21 19:45:30] INFO	cal_type          = sigmoid
[08/07/21 19:45:30] INFO	calibration_plot  = False
[08/07/21 19:45:30] INFO	clustering        = True
[08/07/21 19:45:30] INFO	cluster_inc       = 3
[08/07/21 19:45:30] INFO	cluster_max       = 30
[08/07/21 19:45:30] INFO	cluster_min       = 3
[08/07/21 19:45:30] INFO	confusion_matrix  = True
[08/07/21 19:45:30] INFO	counts            = True
[08/07/21 19:45:30] INFO	cv_folds          = 3
[08/07/21 19:45:30] INFO	directory         = .
[08/07/21 19:45:30] INFO	extension         = csv
[08/07/21 19:45:30] INFO	drop              = ['PassengerId']
[08/07/21 19:45:30] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:45:30] INFO	esr               = 20
[08/07/21 19:45:30] INFO	factors           = ['Embarked']
[08/07/21 19:45:30] INFO	features [X]      = *
[08/07/21 19:45:30] INFO	feature_selection = False
[08/07/21 19:45:30] INFO	fs_percentage     = 50
[08/07/21 19:45:30] INFO	fs_score_func     = <function f_classif at 0x7ff24b63d8b0>
[08/07/21 19:45:30] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:45:30] INFO	grid_search       = True
[08/07/21 19:45:30] INFO	gs_iters          = 50
[08/07/21 19:45:31] INFO	gs_random         = True
[08/07/21 19:45:31] INFO	gs_sample         = False
[08/07/21 19:45:31] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:45:31] INFO	importances       = True
[08/07/21 19:45:31] INFO	interactions      = False
[08/07/21 19:45:31] INFO	isomap            = False
[08/07/21 19:45:31] INFO	iso_components    = 2
[08/07/21 19:45:31] INFO	iso_neighbors     = 5
[08/07/21 19:45:31] INFO	isample_pct       = 10
[08/07/21 19:45:31] INFO	learning_curve    = True
[08/07/21 19:45:31] INFO	logtransform      = False
[08/07/21 19:45:31] INFO	lv_remove         = True
[08/07/21 19:45:31] INFO	lv_threshold      = 0.100000
[08/07/21 19:45:31] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:45:31] INFO	n_estimators      = 51
[08/07/21 19:45:31] INFO	n_jobs            = -1
[08/07/21 19:45:31] INFO	ngrams_max        = 2
[08/07/21 19:45:31] INFO	numpy             = True
[08/07/21 19:45:31] INFO	pca               = False
[08/07/21 19:45:31] INFO	pca_inc           = 1
[08/07/21 19:45:31] INFO	pca_max           = 10
[08/07/21 19:45:31] INFO	pca_min           = 2
[08/07/21 19:45:31] INFO	pca_whiten        = False
[08/07/21 19:45:31] INFO	poly_degree       = 2
[08/07/21 19:45:31] INFO	pvalue_level      = 0.010000
[08/07/21 19:45:31] INFO	rfe               = True
[08/07/21 19:45:31] INFO	rfe_step          = 3
[08/07/21 19:45:31] INFO	roc_curve         = True
[08/07/21 19:45:31] INFO	rounding          = 2
[08/07/21 19:45:31] INFO	sampling          = False
[08/07/21 19:45:31] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:45:31] INFO	sampling_ratio    = 0.500000
[08/07/21 19:45:31] INFO	scaler_option     = True
[08/07/21 19:45:31] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:45:31] INFO	scipy             = False
[08/07/21 19:45:31] INFO	scorer            = roc_auc
[08/07/21 19:45:31] INFO	seed              = 42
[08/07/21 19:45:31] INFO	sentinel          = -1
[08/07/21 19:45:31] INFO	separator         = ,
[08/07/21 19:45:31] INFO	shuffle           = False
[08/07/21 19:45:31] INFO	split             = 0.400000
[08/07/21 19:45:31] INFO	submission_file   = gender_submission
[08/07/21 19:45:31] INFO	submit_probas     = False
[08/07/21 19:45:31] INFO	target [y]        = Survived
[08/07/21 19:45:31] INFO	target_value      = 1
[08/07/21 19:45:31] INFO	transforms        = None
[08/07/21 19:45:31] INFO	tsne              = False
[08/07/21 19:45:31] INFO	tsne_components   = 2
[08/07/21 19:45:31] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:45:31] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:45:31] INFO	vectorize         = False
[08/07/21 19:45:31] INFO	verbosity         = 0
[08/07/21 19:45:31] INFO	Creating Model
[08/07/21 19:45:31] INFO	Calling Pipeline
[08/07/21 19:45:31] INFO	Training Pipeline
[08/07/21 19:45:31] INFO	Loading Data
[08/07/21 19:45:31] INFO	Loading data from ./input/train.csv
[08/07/21 19:45:31] INFO	Found target Survived in data frame
[08/07/21 19:45:31] INFO	Labels (y) found for Partition.train
[08/07/21 19:45:31] INFO	Loading Data
[08/07/21 19:45:31] INFO	Loading data from ./input/test.csv
[08/07/21 19:45:31] INFO	Target Survived not found in Partition.test
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Original Feature Statistics
[08/07/21 19:45:31] INFO	Number of Training Rows    : 891
[08/07/21 19:45:31] INFO	Number of Training Columns : 11
[08/07/21 19:45:31] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:45:31] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:45:31] INFO	Number of Testing Rows     : 418
[08/07/21 19:45:31] INFO	Number of Testing Columns  : 11
[08/07/21 19:45:31] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:45:31] INFO	Feature Count     : 11
[08/07/21 19:45:31] INFO	Applying transforms
[08/07/21 19:45:31] INFO	No transforms Specified
[08/07/21 19:45:31] INFO	New Feature Count : 11
[08/07/21 19:45:31] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:45:31] INFO	Original Feature Count : 11
[08/07/21 19:45:31] INFO	Reduced Feature Count  : 10
[08/07/21 19:45:31] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:45:31] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:45:31] INFO	Creating Cross-Tabulations
[08/07/21 19:45:31] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:45:31] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:45:31] INFO	Feature Count     : 10
[08/07/21 19:45:31] INFO	Creating Count Features
[08/07/21 19:45:31] INFO	NA Counts
[08/07/21 19:45:31] INFO	Number Counts
[08/07/21 19:45:31] INFO	New Feature Count : 21
[08/07/21 19:45:31] INFO	Creating Base Features
[08/07/21 19:45:31] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:45:31] INFO	Feature 2: Name => Factorization
[08/07/21 19:45:31] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:45:31] INFO	Feature 3: Sex => Factorization
[08/07/21 19:45:31] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:45:31] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:45:31] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:45:31] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:45:31] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:45:31] INFO	Encoding: Encoders.target
[08/07/21 19:45:31] INFO	Fitting training features for Embarked
[08/07/21 19:45:31] INFO	Transforming testing features for Embarked
[08/07/21 19:45:31] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:45:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:45:31] INFO	New Feature Count : 21
[08/07/21 19:45:31] INFO	Scaling Base Features
[08/07/21 19:45:31] INFO	Creating NumPy Features
[08/07/21 19:45:31] INFO	NumPy Feature: sum
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: mean
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: std
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature: var
[08/07/21 19:45:31] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:45:31] INFO	NumPy Feature Count : 4
[08/07/21 19:45:31] INFO	New Feature Count : 25
[08/07/21 19:45:31] INFO	Creating Clustering Features
[08/07/21 19:45:31] INFO	Cluster Minimum   : 3
[08/07/21 19:45:31] INFO	Cluster Maximum   : 30
[08/07/21 19:45:31] INFO	Cluster Increment : 3
[08/07/21 19:45:31] INFO	k = 3
[08/07/21 19:45:31] INFO	k = 6
[08/07/21 19:45:31] INFO	k = 9
[08/07/21 19:45:31] INFO	k = 12
[08/07/21 19:45:31] INFO	k = 15
[08/07/21 19:45:31] INFO	k = 18
[08/07/21 19:45:31] INFO	k = 21
[08/07/21 19:45:31] INFO	k = 24
[08/07/21 19:45:31] INFO	k = 27
[08/07/21 19:45:31] INFO	k = 30
[08/07/21 19:45:31] INFO	Clustering Feature Count : 10
[08/07/21 19:45:31] INFO	New Feature Count : 35
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Creating Interactions
[08/07/21 19:45:31] INFO	Initial Feature Count  : 35
[08/07/21 19:45:31] INFO	Skipping Interactions
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Removing Low-Variance Features
[08/07/21 19:45:31] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:45:31] INFO	Original Feature Count  : 35
[08/07/21 19:45:31] INFO	Reduced Feature Count   : 35
[08/07/21 19:45:31] INFO	Saving New Features in Model
[08/07/21 19:45:31] INFO	Skipping Shuffling
[08/07/21 19:45:31] INFO	Skipping Sampling
[08/07/21 19:45:31] INFO	Getting All Estimators
[08/07/21 19:45:31] INFO	Algorithm Configuration
[08/07/21 19:45:31] INFO	Cannot load catboost
[08/07/21 19:45:31] INFO	Cannot load keras
[08/07/21 19:45:31] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:45:31] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:45:31] INFO	Selecting Models
[08/07/21 19:45:31] INFO	Algorithm: CATB
[08/07/21 19:45:31] INFO	Algorithm CATB not found
[08/07/21 19:45:31] INFO	Fitting Initial Model
[08/07/21 19:46:10] INFO	********************************************************************************
[08/07/21 19:46:10] INFO	AlphaPy Start
[08/07/21 19:46:10] INFO	********************************************************************************
[08/07/21 19:46:10] INFO	Model Configuration
[08/07/21 19:46:10] INFO	No transforms Found
[08/07/21 19:46:10] INFO	MODEL PARAMETERS:
[08/07/21 19:46:10] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 19:46:10] INFO	calibration       = False
[08/07/21 19:46:10] INFO	cal_type          = sigmoid
[08/07/21 19:46:10] INFO	calibration_plot  = False
[08/07/21 19:46:10] INFO	clustering        = True
[08/07/21 19:46:10] INFO	cluster_inc       = 3
[08/07/21 19:46:10] INFO	cluster_max       = 30
[08/07/21 19:46:10] INFO	cluster_min       = 3
[08/07/21 19:46:10] INFO	confusion_matrix  = True
[08/07/21 19:46:10] INFO	counts            = True
[08/07/21 19:46:10] INFO	cv_folds          = 3
[08/07/21 19:46:10] INFO	directory         = .
[08/07/21 19:46:10] INFO	extension         = csv
[08/07/21 19:46:10] INFO	drop              = ['PassengerId']
[08/07/21 19:46:10] INFO	encoder           = <Encoders.target: 14>
[08/07/21 19:46:10] INFO	esr               = 20
[08/07/21 19:46:10] INFO	factors           = ['Embarked']
[08/07/21 19:46:10] INFO	features [X]      = *
[08/07/21 19:46:10] INFO	feature_selection = False
[08/07/21 19:46:10] INFO	fs_percentage     = 50
[08/07/21 19:46:10] INFO	fs_score_func     = <function f_classif at 0x7f92d33448b0>
[08/07/21 19:46:10] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 19:46:10] INFO	grid_search       = True
[08/07/21 19:46:10] INFO	gs_iters          = 50
[08/07/21 19:46:10] INFO	gs_random         = True
[08/07/21 19:46:10] INFO	gs_sample         = False
[08/07/21 19:46:10] INFO	gs_sample_pct     = 0.200000
[08/07/21 19:46:10] INFO	importances       = True
[08/07/21 19:46:10] INFO	interactions      = False
[08/07/21 19:46:10] INFO	isomap            = False
[08/07/21 19:46:10] INFO	iso_components    = 2
[08/07/21 19:46:10] INFO	iso_neighbors     = 5
[08/07/21 19:46:10] INFO	isample_pct       = 10
[08/07/21 19:46:10] INFO	learning_curve    = True
[08/07/21 19:46:10] INFO	logtransform      = False
[08/07/21 19:46:10] INFO	lv_remove         = True
[08/07/21 19:46:10] INFO	lv_threshold      = 0.100000
[08/07/21 19:46:10] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 19:46:10] INFO	n_estimators      = 51
[08/07/21 19:46:10] INFO	n_jobs            = -1
[08/07/21 19:46:10] INFO	ngrams_max        = 2
[08/07/21 19:46:10] INFO	numpy             = True
[08/07/21 19:46:10] INFO	pca               = False
[08/07/21 19:46:10] INFO	pca_inc           = 1
[08/07/21 19:46:10] INFO	pca_max           = 10
[08/07/21 19:46:10] INFO	pca_min           = 2
[08/07/21 19:46:10] INFO	pca_whiten        = False
[08/07/21 19:46:10] INFO	poly_degree       = 2
[08/07/21 19:46:10] INFO	pvalue_level      = 0.010000
[08/07/21 19:46:10] INFO	rfe               = True
[08/07/21 19:46:10] INFO	rfe_step          = 3
[08/07/21 19:46:10] INFO	roc_curve         = True
[08/07/21 19:46:10] INFO	rounding          = 2
[08/07/21 19:46:10] INFO	sampling          = False
[08/07/21 19:46:10] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 19:46:10] INFO	sampling_ratio    = 0.500000
[08/07/21 19:46:10] INFO	scaler_option     = True
[08/07/21 19:46:10] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 19:46:10] INFO	scipy             = False
[08/07/21 19:46:10] INFO	scorer            = roc_auc
[08/07/21 19:46:10] INFO	seed              = 42
[08/07/21 19:46:10] INFO	sentinel          = -1
[08/07/21 19:46:10] INFO	separator         = ,
[08/07/21 19:46:10] INFO	shuffle           = False
[08/07/21 19:46:10] INFO	split             = 0.400000
[08/07/21 19:46:10] INFO	submission_file   = gender_submission
[08/07/21 19:46:10] INFO	submit_probas     = False
[08/07/21 19:46:10] INFO	target [y]        = Survived
[08/07/21 19:46:10] INFO	target_value      = 1
[08/07/21 19:46:10] INFO	transforms        = None
[08/07/21 19:46:10] INFO	tsne              = False
[08/07/21 19:46:10] INFO	tsne_components   = 2
[08/07/21 19:46:10] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 19:46:10] INFO	tsne_perplexity   = 30.000000
[08/07/21 19:46:10] INFO	vectorize         = False
[08/07/21 19:46:10] INFO	verbosity         = 0
[08/07/21 19:46:10] INFO	Creating Model
[08/07/21 19:46:10] INFO	Calling Pipeline
[08/07/21 19:46:10] INFO	Training Pipeline
[08/07/21 19:46:10] INFO	Loading Data
[08/07/21 19:46:10] INFO	Loading data from ./input/train.csv
[08/07/21 19:46:10] INFO	Found target Survived in data frame
[08/07/21 19:46:10] INFO	Labels (y) found for Partition.train
[08/07/21 19:46:10] INFO	Loading Data
[08/07/21 19:46:10] INFO	Loading data from ./input/test.csv
[08/07/21 19:46:10] INFO	Target Survived not found in Partition.test
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Original Feature Statistics
[08/07/21 19:46:10] INFO	Number of Training Rows    : 891
[08/07/21 19:46:10] INFO	Number of Training Columns : 11
[08/07/21 19:46:10] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 19:46:10] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 19:46:10] INFO	Number of Testing Rows     : 418
[08/07/21 19:46:10] INFO	Number of Testing Columns  : 11
[08/07/21 19:46:10] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:46:10] INFO	Feature Count     : 11
[08/07/21 19:46:10] INFO	Applying transforms
[08/07/21 19:46:10] INFO	No transforms Specified
[08/07/21 19:46:10] INFO	New Feature Count : 11
[08/07/21 19:46:10] INFO	Dropping Features: ['PassengerId']
[08/07/21 19:46:10] INFO	Original Feature Count : 11
[08/07/21 19:46:10] INFO	Reduced Feature Count  : 10
[08/07/21 19:46:10] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 19:46:10] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 19:46:10] INFO	Creating Cross-Tabulations
[08/07/21 19:46:10] INFO	Creating crosstabs for feature Embarked
[08/07/21 19:46:10] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 19:46:10] INFO	Feature Count     : 10
[08/07/21 19:46:10] INFO	Creating Count Features
[08/07/21 19:46:10] INFO	NA Counts
[08/07/21 19:46:10] INFO	Number Counts
[08/07/21 19:46:10] INFO	New Feature Count : 21
[08/07/21 19:46:10] INFO	Creating Base Features
[08/07/21 19:46:10] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 19:46:10] INFO	Feature 2: Name => Factorization
[08/07/21 19:46:10] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 19:46:10] INFO	Feature 3: Sex => Factorization
[08/07/21 19:46:10] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 19:46:10] INFO	Feature 7: Ticket => Factorization
[08/07/21 19:46:10] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 19:46:10] INFO	Feature 9: Cabin => Factorization
[08/07/21 19:46:10] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 19:46:10] INFO	Encoding: Encoders.target
[08/07/21 19:46:10] INFO	Fitting training features for Embarked
[08/07/21 19:46:10] INFO	Transforming testing features for Embarked
[08/07/21 19:46:10] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 19:46:10] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 19:46:10] INFO	New Feature Count : 21
[08/07/21 19:46:10] INFO	Scaling Base Features
[08/07/21 19:46:10] INFO	Creating NumPy Features
[08/07/21 19:46:10] INFO	NumPy Feature: sum
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: mean
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: std
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature: var
[08/07/21 19:46:10] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 19:46:10] INFO	NumPy Feature Count : 4
[08/07/21 19:46:10] INFO	New Feature Count : 25
[08/07/21 19:46:10] INFO	Creating Clustering Features
[08/07/21 19:46:10] INFO	Cluster Minimum   : 3
[08/07/21 19:46:10] INFO	Cluster Maximum   : 30
[08/07/21 19:46:10] INFO	Cluster Increment : 3
[08/07/21 19:46:10] INFO	k = 3
[08/07/21 19:46:10] INFO	k = 6
[08/07/21 19:46:10] INFO	k = 9
[08/07/21 19:46:10] INFO	k = 12
[08/07/21 19:46:10] INFO	k = 15
[08/07/21 19:46:10] INFO	k = 18
[08/07/21 19:46:10] INFO	k = 21
[08/07/21 19:46:10] INFO	k = 24
[08/07/21 19:46:10] INFO	k = 27
[08/07/21 19:46:10] INFO	k = 30
[08/07/21 19:46:10] INFO	Clustering Feature Count : 10
[08/07/21 19:46:10] INFO	New Feature Count : 35
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Creating Interactions
[08/07/21 19:46:10] INFO	Initial Feature Count  : 35
[08/07/21 19:46:10] INFO	Skipping Interactions
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Removing Low-Variance Features
[08/07/21 19:46:10] INFO	Low-Variance Threshold  : 0.10
[08/07/21 19:46:10] INFO	Original Feature Count  : 35
[08/07/21 19:46:10] INFO	Reduced Feature Count   : 35
[08/07/21 19:46:10] INFO	Saving New Features in Model
[08/07/21 19:46:10] INFO	Skipping Shuffling
[08/07/21 19:46:10] INFO	Skipping Sampling
[08/07/21 19:46:10] INFO	Getting All Estimators
[08/07/21 19:46:10] INFO	Algorithm Configuration
[08/07/21 19:46:10] INFO	Cannot load catboost
[08/07/21 19:46:10] INFO	Cannot load keras
[08/07/21 19:46:10] INFO	Algorithm CATB not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm CATBR not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 19:46:10] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 19:46:10] INFO	Selecting Models
[08/07/21 19:46:10] INFO	Algorithm: CATB
[08/07/21 19:46:10] INFO	Algorithm CATB not found
[08/07/21 19:46:10] INFO	Fitting Initial Model
[08/07/21 20:00:04] INFO	********************************************************************************
[08/07/21 20:00:04] INFO	AlphaPy Start
[08/07/21 20:00:04] INFO	********************************************************************************
[08/07/21 20:00:04] INFO	Model Configuration
[08/07/21 20:00:04] INFO	No transforms Found
[08/07/21 20:00:04] INFO	MODEL PARAMETERS:
[08/07/21 20:00:04] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 20:00:04] INFO	calibration       = False
[08/07/21 20:00:04] INFO	cal_type          = sigmoid
[08/07/21 20:00:04] INFO	calibration_plot  = False
[08/07/21 20:00:04] INFO	clustering        = True
[08/07/21 20:00:04] INFO	cluster_inc       = 3
[08/07/21 20:00:04] INFO	cluster_max       = 30
[08/07/21 20:00:04] INFO	cluster_min       = 3
[08/07/21 20:00:04] INFO	confusion_matrix  = True
[08/07/21 20:00:04] INFO	counts            = True
[08/07/21 20:00:04] INFO	cv_folds          = 3
[08/07/21 20:00:04] INFO	directory         = .
[08/07/21 20:00:04] INFO	extension         = csv
[08/07/21 20:00:04] INFO	drop              = ['PassengerId']
[08/07/21 20:00:04] INFO	encoder           = <Encoders.target: 14>
[08/07/21 20:00:04] INFO	esr               = 20
[08/07/21 20:00:04] INFO	factors           = ['Embarked']
[08/07/21 20:00:04] INFO	features [X]      = *
[08/07/21 20:00:04] INFO	feature_selection = False
[08/07/21 20:00:04] INFO	fs_percentage     = 50
[08/07/21 20:00:04] INFO	fs_score_func     = <function f_classif at 0x7f892abd58b0>
[08/07/21 20:00:04] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 20:00:04] INFO	grid_search       = True
[08/07/21 20:00:04] INFO	gs_iters          = 50
[08/07/21 20:00:04] INFO	gs_random         = True
[08/07/21 20:00:04] INFO	gs_sample         = False
[08/07/21 20:00:04] INFO	gs_sample_pct     = 0.200000
[08/07/21 20:00:04] INFO	importances       = True
[08/07/21 20:00:04] INFO	interactions      = False
[08/07/21 20:00:04] INFO	isomap            = False
[08/07/21 20:00:04] INFO	iso_components    = 2
[08/07/21 20:00:04] INFO	iso_neighbors     = 5
[08/07/21 20:00:04] INFO	isample_pct       = 10
[08/07/21 20:00:04] INFO	learning_curve    = True
[08/07/21 20:00:04] INFO	logtransform      = False
[08/07/21 20:00:04] INFO	lv_remove         = True
[08/07/21 20:00:04] INFO	lv_threshold      = 0.100000
[08/07/21 20:00:04] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 20:00:04] INFO	n_estimators      = 51
[08/07/21 20:00:04] INFO	n_jobs            = -1
[08/07/21 20:00:04] INFO	ngrams_max        = 2
[08/07/21 20:00:04] INFO	numpy             = True
[08/07/21 20:00:04] INFO	pca               = False
[08/07/21 20:00:04] INFO	pca_inc           = 1
[08/07/21 20:00:04] INFO	pca_max           = 10
[08/07/21 20:00:04] INFO	pca_min           = 2
[08/07/21 20:00:04] INFO	pca_whiten        = False
[08/07/21 20:00:04] INFO	poly_degree       = 2
[08/07/21 20:00:04] INFO	pvalue_level      = 0.010000
[08/07/21 20:00:04] INFO	rfe               = True
[08/07/21 20:00:04] INFO	rfe_step          = 3
[08/07/21 20:00:04] INFO	roc_curve         = True
[08/07/21 20:00:04] INFO	rounding          = 2
[08/07/21 20:00:04] INFO	sampling          = False
[08/07/21 20:00:04] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 20:00:04] INFO	sampling_ratio    = 0.500000
[08/07/21 20:00:04] INFO	scaler_option     = True
[08/07/21 20:00:04] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 20:00:04] INFO	scipy             = False
[08/07/21 20:00:04] INFO	scorer            = roc_auc
[08/07/21 20:00:04] INFO	seed              = 42
[08/07/21 20:00:04] INFO	sentinel          = -1
[08/07/21 20:00:04] INFO	separator         = ,
[08/07/21 20:00:04] INFO	shuffle           = False
[08/07/21 20:00:04] INFO	split             = 0.400000
[08/07/21 20:00:04] INFO	submission_file   = gender_submission
[08/07/21 20:00:04] INFO	submit_probas     = False
[08/07/21 20:00:04] INFO	target [y]        = Survived
[08/07/21 20:00:04] INFO	target_value      = 1
[08/07/21 20:00:04] INFO	transforms        = None
[08/07/21 20:00:04] INFO	tsne              = False
[08/07/21 20:00:04] INFO	tsne_components   = 2
[08/07/21 20:00:04] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 20:00:04] INFO	tsne_perplexity   = 30.000000
[08/07/21 20:00:04] INFO	vectorize         = False
[08/07/21 20:00:04] INFO	verbosity         = 0
[08/07/21 20:00:04] INFO	Creating Model
[08/07/21 20:00:04] INFO	Calling Pipeline
[08/07/21 20:00:04] INFO	Training Pipeline
[08/07/21 20:00:04] INFO	Loading Data
[08/07/21 20:00:04] INFO	Loading data from ./input/train.csv
[08/07/21 20:00:04] INFO	Found target Survived in data frame
[08/07/21 20:00:04] INFO	Labels (y) found for Partition.train
[08/07/21 20:00:04] INFO	Loading Data
[08/07/21 20:00:04] INFO	Loading data from ./input/test.csv
[08/07/21 20:00:04] INFO	Target Survived not found in Partition.test
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Original Feature Statistics
[08/07/21 20:00:04] INFO	Number of Training Rows    : 891
[08/07/21 20:00:04] INFO	Number of Training Columns : 11
[08/07/21 20:00:04] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 20:00:04] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 20:00:04] INFO	Number of Testing Rows     : 418
[08/07/21 20:00:04] INFO	Number of Testing Columns  : 11
[08/07/21 20:00:04] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:00:04] INFO	Feature Count     : 11
[08/07/21 20:00:04] INFO	Applying transforms
[08/07/21 20:00:04] INFO	No transforms Specified
[08/07/21 20:00:04] INFO	New Feature Count : 11
[08/07/21 20:00:04] INFO	Dropping Features: ['PassengerId']
[08/07/21 20:00:04] INFO	Original Feature Count : 11
[08/07/21 20:00:04] INFO	Reduced Feature Count  : 10
[08/07/21 20:00:04] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 20:00:04] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 20:00:04] INFO	Creating Cross-Tabulations
[08/07/21 20:00:04] INFO	Creating crosstabs for feature Embarked
[08/07/21 20:00:04] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:00:04] INFO	Feature Count     : 10
[08/07/21 20:00:04] INFO	Creating Count Features
[08/07/21 20:00:04] INFO	NA Counts
[08/07/21 20:00:04] INFO	Number Counts
[08/07/21 20:00:04] INFO	New Feature Count : 21
[08/07/21 20:00:04] INFO	Creating Base Features
[08/07/21 20:00:04] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 20:00:04] INFO	Feature 2: Name => Factorization
[08/07/21 20:00:04] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 20:00:04] INFO	Feature 3: Sex => Factorization
[08/07/21 20:00:04] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 20:00:04] INFO	Feature 7: Ticket => Factorization
[08/07/21 20:00:04] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 20:00:04] INFO	Feature 9: Cabin => Factorization
[08/07/21 20:00:04] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 20:00:04] INFO	Encoding: Encoders.target
[08/07/21 20:00:04] INFO	Fitting training features for Embarked
[08/07/21 20:00:04] INFO	Transforming testing features for Embarked
[08/07/21 20:00:04] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:00:04] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:00:04] INFO	New Feature Count : 21
[08/07/21 20:00:04] INFO	Scaling Base Features
[08/07/21 20:00:04] INFO	Creating NumPy Features
[08/07/21 20:00:04] INFO	NumPy Feature: sum
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: mean
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: std
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature: var
[08/07/21 20:00:04] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:00:04] INFO	NumPy Feature Count : 4
[08/07/21 20:00:04] INFO	New Feature Count : 25
[08/07/21 20:00:04] INFO	Creating Clustering Features
[08/07/21 20:00:04] INFO	Cluster Minimum   : 3
[08/07/21 20:00:04] INFO	Cluster Maximum   : 30
[08/07/21 20:00:04] INFO	Cluster Increment : 3
[08/07/21 20:00:04] INFO	k = 3
[08/07/21 20:00:04] INFO	k = 6
[08/07/21 20:00:04] INFO	k = 9
[08/07/21 20:00:04] INFO	k = 12
[08/07/21 20:00:04] INFO	k = 15
[08/07/21 20:00:04] INFO	k = 18
[08/07/21 20:00:04] INFO	k = 21
[08/07/21 20:00:04] INFO	k = 24
[08/07/21 20:00:04] INFO	k = 27
[08/07/21 20:00:04] INFO	k = 30
[08/07/21 20:00:04] INFO	Clustering Feature Count : 10
[08/07/21 20:00:04] INFO	New Feature Count : 35
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Creating Interactions
[08/07/21 20:00:04] INFO	Initial Feature Count  : 35
[08/07/21 20:00:04] INFO	Skipping Interactions
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Removing Low-Variance Features
[08/07/21 20:00:04] INFO	Low-Variance Threshold  : 0.10
[08/07/21 20:00:04] INFO	Original Feature Count  : 35
[08/07/21 20:00:04] INFO	Reduced Feature Count   : 35
[08/07/21 20:00:04] INFO	Saving New Features in Model
[08/07/21 20:00:04] INFO	Skipping Shuffling
[08/07/21 20:00:04] INFO	Skipping Sampling
[08/07/21 20:00:04] INFO	Getting All Estimators
[08/07/21 20:00:04] INFO	Algorithm Configuration
[08/07/21 20:00:06] INFO	Cannot load keras
[08/07/21 20:00:06] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:00:06] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:00:06] INFO	Selecting Models
[08/07/21 20:00:06] INFO	Algorithm: CATB
[08/07/21 20:00:06] INFO	Fitting Initial Model
[08/07/21 20:05:14] INFO	********************************************************************************
[08/07/21 20:05:14] INFO	AlphaPy Start
[08/07/21 20:05:14] INFO	********************************************************************************
[08/07/21 20:05:14] INFO	Model Configuration
[08/07/21 20:05:14] INFO	No transforms Found
[08/07/21 20:05:14] INFO	MODEL PARAMETERS:
[08/07/21 20:05:14] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/07/21 20:05:14] INFO	calibration       = False
[08/07/21 20:05:14] INFO	cal_type          = sigmoid
[08/07/21 20:05:14] INFO	calibration_plot  = False
[08/07/21 20:05:14] INFO	clustering        = True
[08/07/21 20:05:14] INFO	cluster_inc       = 3
[08/07/21 20:05:14] INFO	cluster_max       = 30
[08/07/21 20:05:14] INFO	cluster_min       = 3
[08/07/21 20:05:14] INFO	confusion_matrix  = True
[08/07/21 20:05:14] INFO	counts            = True
[08/07/21 20:05:14] INFO	cv_folds          = 3
[08/07/21 20:05:14] INFO	directory         = .
[08/07/21 20:05:14] INFO	extension         = csv
[08/07/21 20:05:14] INFO	drop              = ['PassengerId']
[08/07/21 20:05:14] INFO	encoder           = <Encoders.target: 14>
[08/07/21 20:05:14] INFO	esr               = 20
[08/07/21 20:05:14] INFO	factors           = ['Embarked']
[08/07/21 20:05:14] INFO	features [X]      = *
[08/07/21 20:05:14] INFO	feature_selection = False
[08/07/21 20:05:14] INFO	fs_percentage     = 50
[08/07/21 20:05:14] INFO	fs_score_func     = <function f_classif at 0x7f8bc8225820>
[08/07/21 20:05:14] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/07/21 20:05:14] INFO	grid_search       = True
[08/07/21 20:05:14] INFO	gs_iters          = 50
[08/07/21 20:05:14] INFO	gs_random         = True
[08/07/21 20:05:14] INFO	gs_sample         = False
[08/07/21 20:05:14] INFO	gs_sample_pct     = 0.200000
[08/07/21 20:05:14] INFO	importances       = True
[08/07/21 20:05:14] INFO	interactions      = False
[08/07/21 20:05:14] INFO	isomap            = False
[08/07/21 20:05:14] INFO	iso_components    = 2
[08/07/21 20:05:14] INFO	iso_neighbors     = 5
[08/07/21 20:05:14] INFO	isample_pct       = 10
[08/07/21 20:05:14] INFO	learning_curve    = True
[08/07/21 20:05:14] INFO	logtransform      = False
[08/07/21 20:05:14] INFO	lv_remove         = True
[08/07/21 20:05:14] INFO	lv_threshold      = 0.100000
[08/07/21 20:05:14] INFO	model_type        = <ModelType.classification: 1>
[08/07/21 20:05:14] INFO	n_estimators      = 51
[08/07/21 20:05:14] INFO	n_jobs            = -1
[08/07/21 20:05:14] INFO	ngrams_max        = 2
[08/07/21 20:05:14] INFO	numpy             = True
[08/07/21 20:05:14] INFO	pca               = False
[08/07/21 20:05:14] INFO	pca_inc           = 1
[08/07/21 20:05:14] INFO	pca_max           = 10
[08/07/21 20:05:14] INFO	pca_min           = 2
[08/07/21 20:05:14] INFO	pca_whiten        = False
[08/07/21 20:05:14] INFO	poly_degree       = 2
[08/07/21 20:05:14] INFO	pvalue_level      = 0.010000
[08/07/21 20:05:14] INFO	rfe               = True
[08/07/21 20:05:14] INFO	rfe_step          = 3
[08/07/21 20:05:14] INFO	roc_curve         = True
[08/07/21 20:05:14] INFO	rounding          = 2
[08/07/21 20:05:14] INFO	sampling          = False
[08/07/21 20:05:14] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/07/21 20:05:14] INFO	sampling_ratio    = 0.500000
[08/07/21 20:05:14] INFO	scaler_option     = True
[08/07/21 20:05:14] INFO	scaler_type       = <Scalers.standard: 2>
[08/07/21 20:05:14] INFO	scipy             = False
[08/07/21 20:05:14] INFO	scorer            = roc_auc
[08/07/21 20:05:14] INFO	seed              = 42
[08/07/21 20:05:14] INFO	sentinel          = -1
[08/07/21 20:05:14] INFO	separator         = ,
[08/07/21 20:05:14] INFO	shuffle           = False
[08/07/21 20:05:14] INFO	split             = 0.400000
[08/07/21 20:05:14] INFO	submission_file   = gender_submission
[08/07/21 20:05:14] INFO	submit_probas     = False
[08/07/21 20:05:14] INFO	target [y]        = Survived
[08/07/21 20:05:14] INFO	target_value      = 1
[08/07/21 20:05:14] INFO	transforms        = None
[08/07/21 20:05:14] INFO	tsne              = False
[08/07/21 20:05:14] INFO	tsne_components   = 2
[08/07/21 20:05:14] INFO	tsne_learn_rate   = 1000.000000
[08/07/21 20:05:14] INFO	tsne_perplexity   = 30.000000
[08/07/21 20:05:14] INFO	vectorize         = False
[08/07/21 20:05:14] INFO	verbosity         = 0
[08/07/21 20:05:14] INFO	Creating Model
[08/07/21 20:05:14] INFO	Calling Pipeline
[08/07/21 20:05:14] INFO	Training Pipeline
[08/07/21 20:05:14] INFO	Loading Data
[08/07/21 20:05:14] INFO	Loading data from ./input/train.csv
[08/07/21 20:05:14] INFO	Found target Survived in data frame
[08/07/21 20:05:14] INFO	Labels (y) found for Partition.train
[08/07/21 20:05:14] INFO	Loading Data
[08/07/21 20:05:14] INFO	Loading data from ./input/test.csv
[08/07/21 20:05:14] INFO	Target Survived not found in Partition.test
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Original Feature Statistics
[08/07/21 20:05:14] INFO	Number of Training Rows    : 891
[08/07/21 20:05:14] INFO	Number of Training Columns : 11
[08/07/21 20:05:14] INFO	Unique Training Values for Survived : [0 1]
[08/07/21 20:05:14] INFO	Unique Training Counts for Survived : [549 342]
[08/07/21 20:05:14] INFO	Number of Testing Rows     : 418
[08/07/21 20:05:14] INFO	Number of Testing Columns  : 11
[08/07/21 20:05:14] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:05:14] INFO	Feature Count     : 11
[08/07/21 20:05:14] INFO	Applying transforms
[08/07/21 20:05:14] INFO	No transforms Specified
[08/07/21 20:05:14] INFO	New Feature Count : 11
[08/07/21 20:05:14] INFO	Dropping Features: ['PassengerId']
[08/07/21 20:05:14] INFO	Original Feature Count : 11
[08/07/21 20:05:14] INFO	Reduced Feature Count  : 10
[08/07/21 20:05:14] INFO	Writing data frame to ./input/train_20210807.csv
[08/07/21 20:05:14] INFO	Writing data frame to ./input/test_20210807.csv
[08/07/21 20:05:14] INFO	Creating Cross-Tabulations
[08/07/21 20:05:14] INFO	Creating crosstabs for feature Embarked
[08/07/21 20:05:14] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/07/21 20:05:14] INFO	Feature Count     : 10
[08/07/21 20:05:14] INFO	Creating Count Features
[08/07/21 20:05:14] INFO	NA Counts
[08/07/21 20:05:14] INFO	Number Counts
[08/07/21 20:05:14] INFO	New Feature Count : 21
[08/07/21 20:05:14] INFO	Creating Base Features
[08/07/21 20:05:14] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/07/21 20:05:14] INFO	Feature 2: Name => Factorization
[08/07/21 20:05:14] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/07/21 20:05:14] INFO	Feature 3: Sex => Factorization
[08/07/21 20:05:14] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/07/21 20:05:14] INFO	Feature 7: Ticket => Factorization
[08/07/21 20:05:14] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/07/21 20:05:14] INFO	Feature 9: Cabin => Factorization
[08/07/21 20:05:14] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/07/21 20:05:14] INFO	Encoding: Encoders.target
[08/07/21 20:05:14] INFO	Fitting training features for Embarked
[08/07/21 20:05:14] INFO	Transforming testing features for Embarked
[08/07/21 20:05:14] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/07/21 20:05:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/07/21 20:05:14] INFO	New Feature Count : 21
[08/07/21 20:05:14] INFO	Scaling Base Features
[08/07/21 20:05:14] INFO	Creating NumPy Features
[08/07/21 20:05:14] INFO	NumPy Feature: sum
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: mean
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: std
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature: var
[08/07/21 20:05:14] INFO	    Imputation for Data Type float64: Median Strategy
[08/07/21 20:05:14] INFO	NumPy Feature Count : 4
[08/07/21 20:05:14] INFO	New Feature Count : 25
[08/07/21 20:05:14] INFO	Creating Clustering Features
[08/07/21 20:05:14] INFO	Cluster Minimum   : 3
[08/07/21 20:05:14] INFO	Cluster Maximum   : 30
[08/07/21 20:05:14] INFO	Cluster Increment : 3
[08/07/21 20:05:14] INFO	k = 3
[08/07/21 20:05:14] INFO	k = 6
[08/07/21 20:05:14] INFO	k = 9
[08/07/21 20:05:14] INFO	k = 12
[08/07/21 20:05:14] INFO	k = 15
[08/07/21 20:05:14] INFO	k = 18
[08/07/21 20:05:14] INFO	k = 21
[08/07/21 20:05:14] INFO	k = 24
[08/07/21 20:05:14] INFO	k = 27
[08/07/21 20:05:14] INFO	k = 30
[08/07/21 20:05:14] INFO	Clustering Feature Count : 10
[08/07/21 20:05:14] INFO	New Feature Count : 35
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Creating Interactions
[08/07/21 20:05:14] INFO	Initial Feature Count  : 35
[08/07/21 20:05:14] INFO	Skipping Interactions
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Removing Low-Variance Features
[08/07/21 20:05:14] INFO	Low-Variance Threshold  : 0.10
[08/07/21 20:05:14] INFO	Original Feature Count  : 35
[08/07/21 20:05:14] INFO	Reduced Feature Count   : 35
[08/07/21 20:05:14] INFO	Saving New Features in Model
[08/07/21 20:05:14] INFO	Skipping Shuffling
[08/07/21 20:05:14] INFO	Skipping Sampling
[08/07/21 20:05:14] INFO	Getting All Estimators
[08/07/21 20:05:14] INFO	Algorithm Configuration
[08/07/21 20:05:14] INFO	Cannot load keras
[08/07/21 20:05:14] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:05:14] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:05:14] INFO	Selecting Models
[08/07/21 20:05:14] INFO	Algorithm: CATB
[08/07/21 20:05:14] INFO	Fitting Initial Model
[08/07/21 20:05:15] INFO	Cross-Validation
[08/07/21 20:05:16] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/07/21 20:05:16] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:19] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[08/07/21 20:05:19] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/07/21 20:05:19] INFO	No grid is defined for grid search
[08/07/21 20:05:19] INFO	Final Model Predictions for CATB
[08/07/21 20:05:19] INFO	Skipping Calibration
[08/07/21 20:05:19] INFO	Making Predictions
[08/07/21 20:05:19] INFO	Predictions Complete
[08/07/21 20:05:19] INFO	Algorithm: LGB
[08/07/21 20:05:19] INFO	Fitting Initial Model
[08/07/21 20:05:19] INFO	Cross-Validation
[08/07/21 20:05:19] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/07/21 20:05:19] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:21] INFO	RFECV took 1.91 seconds for step 3 and 3 folds
[08/07/21 20:05:21] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/07/21 20:05:21] INFO	No grid is defined for grid search
[08/07/21 20:05:21] INFO	Final Model Predictions for LGB
[08/07/21 20:05:21] INFO	Skipping Calibration
[08/07/21 20:05:21] INFO	Making Predictions
[08/07/21 20:05:21] INFO	Predictions Complete
[08/07/21 20:05:21] INFO	Algorithm: XGB
[08/07/21 20:05:21] INFO	Fitting Initial Model
[08/07/21 20:05:21] INFO	Cross-Validation
[08/07/21 20:05:22] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/07/21 20:05:22] INFO	Recursive Feature Elimination with CV
[08/07/21 20:05:24] INFO	RFECV took 2.43 seconds for step 3 and 3 folds
[08/07/21 20:05:24] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/07/21 20:05:24] INFO	Randomized Grid Search
[08/07/21 20:06:17] INFO	Grid Search took 52.84 seconds for 50 candidate parameter settings.
[08/07/21 20:06:17] INFO	Model with rank: 1
[08/07/21 20:06:17] INFO	Mean validation score: 0.872 (std: 0.020)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[08/07/21 20:06:17] INFO	Model with rank: 2
[08/07/21 20:06:17] INFO	Mean validation score: 0.872 (std: 0.025)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[08/07/21 20:06:17] INFO	Model with rank: 3
[08/07/21 20:06:17] INFO	Mean validation score: 0.871 (std: 0.020)
[08/07/21 20:06:17] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[08/07/21 20:06:17] INFO	Algorithm: XGB, Best Score: 0.8724, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[08/07/21 20:06:17] INFO	Final Model Predictions for XGB
[08/07/21 20:06:17] INFO	Skipping Calibration
[08/07/21 20:06:17] INFO	Making Predictions
[08/07/21 20:06:17] INFO	Predictions Complete
[08/07/21 20:06:17] INFO	Blending Models
[08/07/21 20:06:17] INFO	Blending Start: 2021-08-07 20:06:17.602307
[08/07/21 20:06:17] INFO	Blending Complete: 0:00:00.013576
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Metrics for: Partition.train
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: CATB
[08/07/21 20:06:17] INFO	accuracy: 0.8585858585858586
[08/07/21 20:06:17] INFO	average_precision: 0.9113351686222868
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.8378391333525069
[08/07/21 20:06:17] INFO	brier_score_loss: 0.10043404518351136
[08/07/21 20:06:17] INFO	cohen_kappa: 0.6932572665125658
[08/07/21 20:06:17] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/07/21 20:06:17] INFO	f1: 0.8025078369905956
[08/07/21 20:06:17] INFO	neg_log_loss: 0.3371948718196211
[08/07/21 20:06:17] INFO	precision: 0.8648648648648649
[08/07/21 20:06:17] INFO	recall: 0.7485380116959064
[08/07/21 20:06:17] INFO	roc_auc: 0.9297979313797549
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: LGB
[08/07/21 20:06:17] INFO	accuracy: 0.9730639730639731
[08/07/21 20:06:17] INFO	average_precision: 0.9961113207491221
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.9687709711437062
[08/07/21 20:06:17] INFO	brier_score_loss: 0.032809498448974184
[08/07/21 20:06:17] INFO	cohen_kappa: 0.9427387092109702
[08/07/21 20:06:17] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/07/21 20:06:17] INFO	f1: 0.9643916913946586
[08/07/21 20:06:17] INFO	neg_log_loss: 0.1458307566281259
[08/07/21 20:06:17] INFO	precision: 0.9789156626506024
[08/07/21 20:06:17] INFO	recall: 0.9502923976608187
[08/07/21 20:06:17] INFO	roc_auc: 0.9974861257576241
[08/07/21 20:06:17] INFO	--------------------------------------------------------------------------------
[08/07/21 20:06:17] INFO	Algorithm: XGB
[08/07/21 20:06:17] INFO	accuracy: 0.9304152637485971
[08/07/21 20:06:17] INFO	average_precision: 0.9716306882839921
[08/07/21 20:06:17] INFO	balanced_accuracy: 0.9181765890135174
[08/07/21 20:06:17] INFO	brier_score_loss: 0.07412143940154169
[08/07/21 20:06:17] INFO	cohen_kappa: 0.8504167275917531
[08/07/21 20:06:17] INFO	confusion_matrix: [[533  16]
 [ 46 296]]
[08/07/21 20:06:17] INFO	f1: 0.9051987767584098
[08/07/21 20:06:17] INFO	neg_log_loss: 0.2874399062275351
[08/07/21 20:06:17] INFO	precision: 0.9487179487179487
[08/07/21 20:06:17] INFO	recall: 0.8654970760233918
[08/07/21 20:06:17] INFO	roc_auc: 0.9800967202462746
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Metrics for: Partition.test
[08/07/21 20:06:17] INFO	No labels for generating Partition.test metrics
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Selecting Best Model
[08/07/21 20:06:17] INFO	Scoring for: Partition.train
[08/07/21 20:06:17] INFO	Best Model Selection Start: 2021-08-07 20:06:17.637484
[08/07/21 20:06:17] INFO	Scoring CATB Model
[08/07/21 20:06:17] INFO	Scoring LGB Model
[08/07/21 20:06:17] INFO	Scoring XGB Model
[08/07/21 20:06:17] INFO	Scoring BLEND Model
[08/07/21 20:06:17] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[08/07/21 20:06:17] INFO	Best Model Selection Complete: 0:00:00.000218
[08/07/21 20:06:17] INFO	================================================================================
[08/07/21 20:06:17] INFO	Generating Plots for partition: train
[08/07/21 20:06:17] INFO	Generating Calibration Plot
[08/07/21 20:06:17] INFO	Calibration for Algorithm: CATB
[08/07/21 20:06:17] INFO	Calibration for Algorithm: LGB
[08/07/21 20:06:17] INFO	Calibration for Algorithm: XGB
[08/07/21 20:06:17] INFO	Writing plot to ./plots/calibration_train.png
[08/07/21 20:06:17] INFO	Generating Confusion Matrices
[08/07/21 20:06:17] INFO	Confusion Matrix for Algorithm: CATB
[08/07/21 20:06:17] INFO	Confusion Matrix:
[08/07/21 20:06:17] INFO	[[509  40]
 [ 86 256]]
[08/07/21 20:06:17] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/07/21 20:06:17] INFO	Confusion Matrix for Algorithm: LGB
[08/07/21 20:06:17] INFO	Confusion Matrix:
[08/07/21 20:06:17] INFO	[[542   7]
 [ 17 325]]
[08/07/21 20:06:17] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/07/21 20:06:18] INFO	Confusion Matrix for Algorithm: XGB
[08/07/21 20:06:18] INFO	Confusion Matrix:
[08/07/21 20:06:18] INFO	[[533  16]
 [ 46 296]]
[08/07/21 20:06:18] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/07/21 20:06:18] INFO	Generating ROC Curves
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: CATB
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: LGB
[08/07/21 20:06:18] INFO	ROC Curve for Algorithm: XGB
[08/07/21 20:06:18] INFO	Writing plot to ./plots/roc_curve_train.png
[08/07/21 20:06:18] INFO	Generating Learning Curves
[08/07/21 20:06:18] INFO	Algorithm Configuration
[08/07/21 20:06:18] INFO	Cannot load keras
[08/07/21 20:06:18] INFO	Algorithm KERASC not found (check package installation)
[08/07/21 20:06:18] INFO	Algorithm KERASR not found (check package installation)
[08/07/21 20:06:18] INFO	Learning Curve for Algorithm: CATB
[08/07/21 20:06:18] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/07/21 20:06:18] INFO	Learning Curve for Algorithm: LGB
[08/07/21 20:06:20] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/07/21 20:06:20] INFO	Learning Curve for Algorithm: XGB
[08/07/21 20:06:21] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/07/21 20:06:21] INFO	Generating Feature Importance Plots
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: CATB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Sex_factor (45.178104)
[08/07/21 20:06:21] INFO	2. Pclass (13.721171)
[08/07/21 20:06:21] INFO	3. Age (6.651788)
[08/07/21 20:06:21] INFO	4. Fare (4.529770)
[08/07/21 20:06:21] INFO	5. var (3.586590)
[08/07/21 20:06:21] INFO	6. std (3.492385)
[08/07/21 20:06:21] INFO	7. Ticket_factor (3.315046)
[08/07/21 20:06:21] INFO	8. cluster_30 (2.831587)
[08/07/21 20:06:21] INFO	9. mean (2.733389)
[08/07/21 20:06:21] INFO	10. Name_factor (2.586310)
[08/07/21 20:06:21] INFO	11. Cabin_factor (2.101764)
[08/07/21 20:06:21] INFO	12. Embarked (2.086410)
[08/07/21 20:06:21] INFO	13. SibSp (2.085405)
[08/07/21 20:06:21] INFO	14. cluster_12 (1.876782)
[08/07/21 20:06:21] INFO	15. cluster_24 (1.263144)
[08/07/21 20:06:21] INFO	16. count_2 (1.004409)
[08/07/21 20:06:21] INFO	17. sum (0.955946)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: LGB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Fare (256.000000)
[08/07/21 20:06:21] INFO	2. sum (241.000000)
[08/07/21 20:06:21] INFO	3. Age (232.000000)
[08/07/21 20:06:21] INFO	4. std (201.000000)
[08/07/21 20:06:21] INFO	5. Ticket_factor (199.000000)
[08/07/21 20:06:21] INFO	6. Name_factor (175.000000)
[08/07/21 20:06:21] INFO	7. cluster_30 (53.000000)
[08/07/21 20:06:21] INFO	8. cluster_27 (46.000000)
[08/07/21 20:06:21] INFO	9. Sex_factor (43.000000)
[08/07/21 20:06:21] INFO	10. Pclass (43.000000)
[08/07/21 20:06:21] INFO	11. Cabin_factor (41.000000)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/07/21 20:06:21] INFO	Feature Importances for Algorithm: XGB
[08/07/21 20:06:21] INFO	Feature Ranking:
[08/07/21 20:06:21] INFO	1. Sex_factor (0.424644)
[08/07/21 20:06:21] INFO	2. Pclass (0.127452)
[08/07/21 20:06:21] INFO	3. Cabin_factor (0.081307)
[08/07/21 20:06:21] INFO	4. Age (0.051007)
[08/07/21 20:06:21] INFO	5. SibSp (0.049620)
[08/07/21 20:06:21] INFO	6. count_1 (0.046373)
[08/07/21 20:06:21] INFO	7. Embarked (0.046225)
[08/07/21 20:06:21] INFO	8. std (0.036262)
[08/07/21 20:06:21] INFO	9. cluster_30 (0.036076)
[08/07/21 20:06:21] INFO	10. Fare (0.032410)
[08/07/21 20:06:21] INFO	11. cluster_24 (0.021187)
[08/07/21 20:06:21] INFO	12. Name_factor (0.019312)
[08/07/21 20:06:21] INFO	13. sum (0.017784)
[08/07/21 20:06:21] INFO	14. cluster_15 (0.010340)
[08/07/21 20:06:21] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/07/21 20:06:21] INFO	================================================================================
[08/07/21 20:06:21] INFO	Saving Model Predictor
[08/07/21 20:06:21] INFO	Writing model predictor to ./model/model_20210807.pkl
[08/07/21 20:06:21] INFO	Saving Feature Map
[08/07/21 20:06:21] INFO	Writing feature map to ./model/feature_map_20210807.pkl
[08/07/21 20:06:21] INFO	Loading data from ./input/test_20210807.csv
[08/07/21 20:06:21] INFO	Saving Predictions
[08/07/21 20:06:21] INFO	Writing data frame to ./output/predictions_20210807.csv
[08/07/21 20:06:21] INFO	Saving Probabilities
[08/07/21 20:06:21] INFO	Writing data frame to ./output/probabilities_20210807.csv
[08/07/21 20:06:21] INFO	Saving Ranked Predictions
[08/07/21 20:06:21] INFO	Writing data frame to ./output/rankings_20210807.csv
[08/07/21 20:06:21] INFO	Saving Submission to ./output/submission_20210807.csv
[08/07/21 20:06:21] INFO	********************************************************************************
[08/07/21 20:06:21] INFO	AlphaPy End
[08/07/21 20:06:21] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	AlphaPy Start
[08/22/21 09:18:26] INFO	********************************************************************************
[08/22/21 09:18:26] INFO	Model Configuration
[08/22/21 09:18:26] INFO	No transforms Found
[08/22/21 09:18:26] INFO	MODEL PARAMETERS:
[08/22/21 09:18:26] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/22/21 09:18:26] INFO	calibration       = False
[08/22/21 09:18:26] INFO	cal_type          = sigmoid
[08/22/21 09:18:26] INFO	calibration_plot  = False
[08/22/21 09:18:26] INFO	clustering        = True
[08/22/21 09:18:26] INFO	cluster_inc       = 3
[08/22/21 09:18:26] INFO	cluster_max       = 30
[08/22/21 09:18:26] INFO	cluster_min       = 3
[08/22/21 09:18:26] INFO	confusion_matrix  = True
[08/22/21 09:18:26] INFO	counts            = True
[08/22/21 09:18:26] INFO	cv_folds          = 3
[08/22/21 09:18:26] INFO	directory         = .
[08/22/21 09:18:26] INFO	extension         = csv
[08/22/21 09:18:26] INFO	drop              = ['PassengerId']
[08/22/21 09:18:26] INFO	encoder           = <Encoders.target: 14>
[08/22/21 09:18:26] INFO	esr               = 20
[08/22/21 09:18:26] INFO	factors           = ['Embarked']
[08/22/21 09:18:26] INFO	features [X]      = *
[08/22/21 09:18:26] INFO	feature_selection = False
[08/22/21 09:18:26] INFO	fs_percentage     = 50
[08/22/21 09:18:26] INFO	fs_score_func     = <function f_classif at 0x7fe6cae17b80>
[08/22/21 09:18:26] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/22/21 09:18:26] INFO	grid_search       = True
[08/22/21 09:18:26] INFO	gs_iters          = 50
[08/22/21 09:18:26] INFO	gs_random         = True
[08/22/21 09:18:26] INFO	gs_sample         = False
[08/22/21 09:18:26] INFO	gs_sample_pct     = 0.200000
[08/22/21 09:18:26] INFO	importances       = True
[08/22/21 09:18:26] INFO	interactions      = False
[08/22/21 09:18:26] INFO	isomap            = False
[08/22/21 09:18:26] INFO	iso_components    = 2
[08/22/21 09:18:26] INFO	iso_neighbors     = 5
[08/22/21 09:18:26] INFO	isample_pct       = 10
[08/22/21 09:18:26] INFO	learning_curve    = True
[08/22/21 09:18:26] INFO	logtransform      = False
[08/22/21 09:18:26] INFO	lv_remove         = True
[08/22/21 09:18:26] INFO	lv_threshold      = 0.100000
[08/22/21 09:18:26] INFO	model_type        = <ModelType.classification: 1>
[08/22/21 09:18:26] INFO	n_estimators      = 51
[08/22/21 09:18:26] INFO	n_jobs            = -1
[08/22/21 09:18:26] INFO	ngrams_max        = 2
[08/22/21 09:18:26] INFO	numpy             = True
[08/22/21 09:18:26] INFO	pca               = False
[08/22/21 09:18:26] INFO	pca_inc           = 1
[08/22/21 09:18:26] INFO	pca_max           = 10
[08/22/21 09:18:26] INFO	pca_min           = 2
[08/22/21 09:18:26] INFO	pca_whiten        = False
[08/22/21 09:18:26] INFO	poly_degree       = 2
[08/22/21 09:18:26] INFO	pvalue_level      = 0.010000
[08/22/21 09:18:26] INFO	rfe               = True
[08/22/21 09:18:26] INFO	rfe_step          = 3
[08/22/21 09:18:26] INFO	roc_curve         = True
[08/22/21 09:18:26] INFO	rounding          = 2
[08/22/21 09:18:26] INFO	sampling          = False
[08/22/21 09:18:26] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/22/21 09:18:26] INFO	sampling_ratio    = 0.500000
[08/22/21 09:18:26] INFO	scaler_option     = True
[08/22/21 09:18:26] INFO	scaler_type       = <Scalers.standard: 2>
[08/22/21 09:18:26] INFO	scipy             = False
[08/22/21 09:18:26] INFO	scorer            = roc_auc
[08/22/21 09:18:26] INFO	seed              = 42
[08/22/21 09:18:26] INFO	sentinel          = -1
[08/22/21 09:18:26] INFO	separator         = ,
[08/22/21 09:18:26] INFO	shuffle           = False
[08/22/21 09:18:26] INFO	split             = 0.400000
[08/22/21 09:18:26] INFO	submission_file   = gender_submission
[08/22/21 09:18:26] INFO	submit_probas     = False
[08/22/21 09:18:26] INFO	target [y]        = Survived
[08/22/21 09:18:26] INFO	target_value      = 1
[08/22/21 09:18:26] INFO	transforms        = None
[08/22/21 09:18:26] INFO	tsne              = False
[08/22/21 09:18:26] INFO	tsne_components   = 2
[08/22/21 09:18:26] INFO	tsne_learn_rate   = 1000.000000
[08/22/21 09:18:26] INFO	tsne_perplexity   = 30.000000
[08/22/21 09:18:26] INFO	vectorize         = False
[08/22/21 09:18:26] INFO	verbosity         = 0
[08/22/21 09:18:26] INFO	Creating Model
[08/22/21 09:18:26] INFO	Calling Pipeline
[08/22/21 09:18:26] INFO	Training Pipeline
[08/22/21 09:18:26] INFO	Loading Data
[08/22/21 09:18:26] INFO	Loading data from ./input/train.csv
[08/22/21 09:18:26] INFO	Found target Survived in data frame
[08/22/21 09:18:26] INFO	Labels (y) found for Partition.train
[08/22/21 09:18:26] INFO	Loading Data
[08/22/21 09:18:26] INFO	Loading data from ./input/test.csv
[08/22/21 09:18:26] INFO	Target Survived not found in Partition.test
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Original Feature Statistics
[08/22/21 09:18:26] INFO	Number of Training Rows    : 891
[08/22/21 09:18:26] INFO	Number of Training Columns : 11
[08/22/21 09:18:26] INFO	Unique Training Values for Survived : [0 1]
[08/22/21 09:18:26] INFO	Unique Training Counts for Survived : [549 342]
[08/22/21 09:18:26] INFO	Number of Testing Rows     : 418
[08/22/21 09:18:26] INFO	Number of Testing Columns  : 11
[08/22/21 09:18:26] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 09:18:26] INFO	Feature Count     : 11
[08/22/21 09:18:26] INFO	Applying transforms
[08/22/21 09:18:26] INFO	No transforms Specified
[08/22/21 09:18:26] INFO	New Feature Count : 11
[08/22/21 09:18:26] INFO	Dropping Features: ['PassengerId']
[08/22/21 09:18:26] INFO	Original Feature Count : 11
[08/22/21 09:18:26] INFO	Reduced Feature Count  : 10
[08/22/21 09:18:26] INFO	Writing data frame to ./input/train_20210822.csv
[08/22/21 09:18:26] INFO	Writing data frame to ./input/test_20210822.csv
[08/22/21 09:18:26] INFO	Creating Cross-Tabulations
[08/22/21 09:18:26] INFO	Creating crosstabs for feature Embarked
[08/22/21 09:18:26] INFO	NumExpr defaulting to 8 threads.
[08/22/21 09:18:26] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 09:18:26] INFO	Feature Count     : 10
[08/22/21 09:18:26] INFO	Creating Count Features
[08/22/21 09:18:26] INFO	NA Counts
[08/22/21 09:18:26] INFO	Number Counts
[08/22/21 09:18:26] INFO	New Feature Count : 21
[08/22/21 09:18:26] INFO	Creating Base Features
[08/22/21 09:18:26] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/22/21 09:18:26] INFO	Feature 2: Name => Factorization
[08/22/21 09:18:26] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/22/21 09:18:26] INFO	Feature 3: Sex => Factorization
[08/22/21 09:18:26] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/22/21 09:18:26] INFO	Feature 7: Ticket => Factorization
[08/22/21 09:18:26] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/22/21 09:18:26] INFO	Feature 9: Cabin => Factorization
[08/22/21 09:18:26] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/22/21 09:18:26] INFO	Encoding: Encoders.target
[08/22/21 09:18:26] INFO	Fitting training features for Embarked
[08/22/21 09:18:26] INFO	Transforming testing features for Embarked
[08/22/21 09:18:26] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/22/21 09:18:26] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 09:18:26] INFO	New Feature Count : 21
[08/22/21 09:18:26] INFO	Scaling Base Features
[08/22/21 09:18:26] INFO	Creating NumPy Features
[08/22/21 09:18:26] INFO	NumPy Feature: sum
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: mean
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: std
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature: var
[08/22/21 09:18:26] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 09:18:26] INFO	NumPy Feature Count : 4
[08/22/21 09:18:26] INFO	New Feature Count : 25
[08/22/21 09:18:26] INFO	Creating Clustering Features
[08/22/21 09:18:26] INFO	Cluster Minimum   : 3
[08/22/21 09:18:26] INFO	Cluster Maximum   : 30
[08/22/21 09:18:26] INFO	Cluster Increment : 3
[08/22/21 09:18:26] INFO	k = 3
[08/22/21 09:18:26] INFO	k = 6
[08/22/21 09:18:26] INFO	k = 9
[08/22/21 09:18:26] INFO	k = 12
[08/22/21 09:18:26] INFO	k = 15
[08/22/21 09:18:26] INFO	k = 18
[08/22/21 09:18:26] INFO	k = 21
[08/22/21 09:18:26] INFO	k = 24
[08/22/21 09:18:26] INFO	k = 27
[08/22/21 09:18:26] INFO	k = 30
[08/22/21 09:18:26] INFO	Clustering Feature Count : 10
[08/22/21 09:18:26] INFO	New Feature Count : 35
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Creating Interactions
[08/22/21 09:18:26] INFO	Initial Feature Count  : 35
[08/22/21 09:18:26] INFO	Skipping Interactions
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Removing Low-Variance Features
[08/22/21 09:18:26] INFO	Low-Variance Threshold  : 0.10
[08/22/21 09:18:26] INFO	Original Feature Count  : 35
[08/22/21 09:18:26] INFO	Reduced Feature Count   : 35
[08/22/21 09:18:26] INFO	Saving New Features in Model
[08/22/21 09:18:26] INFO	Skipping Shuffling
[08/22/21 09:18:26] INFO	Skipping Sampling
[08/22/21 09:18:26] INFO	Getting All Estimators
[08/22/21 09:18:26] INFO	Algorithm Configuration
[08/22/21 09:18:27] INFO	Cannot load keras
[08/22/21 09:18:27] INFO	Algorithm KERASC not found (check package installation)
[08/22/21 09:18:27] INFO	Algorithm KERASR not found (check package installation)
[08/22/21 09:18:27] INFO	Selecting Models
[08/22/21 09:18:27] INFO	Algorithm: CATB
[08/22/21 09:18:27] INFO	Fitting Initial Model
[08/22/21 09:18:27] INFO	Cross-Validation
[08/22/21 09:18:28] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/22/21 09:18:28] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:31] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[08/22/21 09:18:31] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/22/21 09:18:31] INFO	No grid is defined for grid search
[08/22/21 09:18:31] INFO	Final Model Predictions for CATB
[08/22/21 09:18:31] INFO	Skipping Calibration
[08/22/21 09:18:31] INFO	Making Predictions
[08/22/21 09:18:31] INFO	Predictions Complete
[08/22/21 09:18:31] INFO	Algorithm: LGB
[08/22/21 09:18:31] INFO	Fitting Initial Model
[08/22/21 09:18:31] INFO	Cross-Validation
[08/22/21 09:18:31] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/22/21 09:18:31] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:33] INFO	RFECV took 1.94 seconds for step 3 and 3 folds
[08/22/21 09:18:33] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/22/21 09:18:33] INFO	No grid is defined for grid search
[08/22/21 09:18:33] INFO	Final Model Predictions for LGB
[08/22/21 09:18:33] INFO	Skipping Calibration
[08/22/21 09:18:33] INFO	Making Predictions
[08/22/21 09:18:33] INFO	Predictions Complete
[08/22/21 09:18:33] INFO	Algorithm: XGB
[08/22/21 09:18:33] INFO	Fitting Initial Model
[08/22/21 09:18:33] INFO	Cross-Validation
[08/22/21 09:18:33] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/22/21 09:18:33] INFO	Recursive Feature Elimination with CV
[08/22/21 09:18:36] INFO	RFECV took 2.50 seconds for step 3 and 3 folds
[08/22/21 09:18:36] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/22/21 09:18:36] INFO	Randomized Grid Search
[08/22/21 09:19:31] INFO	Grid Search took 55.16 seconds for 50 candidate parameter settings.
[08/22/21 09:19:31] INFO	Model with rank: 1
[08/22/21 09:19:31] INFO	Mean validation score: 0.871 (std: 0.021)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[08/22/21 09:19:31] INFO	Model with rank: 2
[08/22/21 09:19:31] INFO	Mean validation score: 0.871 (std: 0.027)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[08/22/21 09:19:31] INFO	Model with rank: 3
[08/22/21 09:19:31] INFO	Mean validation score: 0.870 (std: 0.021)
[08/22/21 09:19:31] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[08/22/21 09:19:31] INFO	Algorithm: XGB, Best Score: 0.8714, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[08/22/21 09:19:31] INFO	Final Model Predictions for XGB
[08/22/21 09:19:31] INFO	Skipping Calibration
[08/22/21 09:19:31] INFO	Making Predictions
[08/22/21 09:19:31] INFO	Predictions Complete
[08/22/21 09:19:31] INFO	Blending Models
[08/22/21 09:19:31] INFO	Blending Start: 2021-08-22 09:19:31.231842
[08/22/21 09:19:31] INFO	Blending Complete: 0:00:00.018845
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Metrics for: Partition.train
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: CATB
[08/22/21 09:19:31] INFO	accuracy: 0.8585858585858586
[08/22/21 09:19:31] INFO	average_precision: 0.9113351686222868
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.8378391333525069
[08/22/21 09:19:31] INFO	brier_score_loss: 0.10043404518351136
[08/22/21 09:19:31] INFO	cohen_kappa: 0.6932572665125658
[08/22/21 09:19:31] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/22/21 09:19:31] INFO	f1: 0.8025078369905956
[08/22/21 09:19:31] INFO	neg_log_loss: 0.3371948718196211
[08/22/21 09:19:31] INFO	precision: 0.8648648648648649
[08/22/21 09:19:31] INFO	recall: 0.7485380116959064
[08/22/21 09:19:31] INFO	roc_auc: 0.9297979313797549
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: LGB
[08/22/21 09:19:31] INFO	accuracy: 0.9730639730639731
[08/22/21 09:19:31] INFO	average_precision: 0.9961113207491221
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.9687709711437062
[08/22/21 09:19:31] INFO	brier_score_loss: 0.032809498448974184
[08/22/21 09:19:31] INFO	cohen_kappa: 0.9427387092109702
[08/22/21 09:19:31] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/22/21 09:19:31] INFO	f1: 0.9643916913946586
[08/22/21 09:19:31] INFO	neg_log_loss: 0.1458307566281259
[08/22/21 09:19:31] INFO	precision: 0.9789156626506024
[08/22/21 09:19:31] INFO	recall: 0.9502923976608187
[08/22/21 09:19:31] INFO	roc_auc: 0.9974861257576241
[08/22/21 09:19:31] INFO	--------------------------------------------------------------------------------
[08/22/21 09:19:31] INFO	Algorithm: XGB
[08/22/21 09:19:31] INFO	accuracy: 0.8664421997755332
[08/22/21 09:19:31] INFO	average_precision: 0.917654266961909
[08/22/21 09:19:31] INFO	balanced_accuracy: 0.8447656025309175
[08/22/21 09:19:31] INFO	brier_score_loss: 0.13383595098411258
[08/22/21 09:19:31] INFO	cohen_kappa: 0.709476954945624
[08/22/21 09:19:31] INFO	confusion_matrix: [[515  34]
 [ 85 257]]
[08/22/21 09:19:31] INFO	f1: 0.812006319115324
[08/22/21 09:19:31] INFO	neg_log_loss: 0.4457342040993683
[08/22/21 09:19:31] INFO	precision: 0.8831615120274914
[08/22/21 09:19:31] INFO	recall: 0.7514619883040936
[08/22/21 09:19:31] INFO	roc_auc: 0.9314410038453754
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Metrics for: Partition.test
[08/22/21 09:19:31] INFO	No labels for generating Partition.test metrics
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Selecting Best Model
[08/22/21 09:19:31] INFO	Scoring for: Partition.train
[08/22/21 09:19:31] INFO	Best Model Selection Start: 2021-08-22 09:19:31.273454
[08/22/21 09:19:31] INFO	Scoring CATB Model
[08/22/21 09:19:31] INFO	Scoring LGB Model
[08/22/21 09:19:31] INFO	Scoring XGB Model
[08/22/21 09:19:31] INFO	Scoring BLEND Model
[08/22/21 09:19:31] INFO	Best Model is BLEND with a roc_auc score of 0.9981
[08/22/21 09:19:31] INFO	Best Model Selection Complete: 0:00:00.000244
[08/22/21 09:19:31] INFO	================================================================================
[08/22/21 09:19:31] INFO	Generating Plots for partition: train
[08/22/21 09:19:31] INFO	Generating Calibration Plot
[08/22/21 09:19:31] INFO	Calibration for Algorithm: CATB
[08/22/21 09:19:31] INFO	Calibration for Algorithm: LGB
[08/22/21 09:19:31] INFO	Calibration for Algorithm: XGB
[08/22/21 09:19:31] INFO	Writing plot to ./plots/calibration_train.png
[08/22/21 09:19:31] INFO	Generating Confusion Matrices
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: CATB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[509  40]
 [ 86 256]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: LGB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[542   7]
 [ 17 325]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/22/21 09:19:31] INFO	Confusion Matrix for Algorithm: XGB
[08/22/21 09:19:31] INFO	Confusion Matrix:
[08/22/21 09:19:31] INFO	[[515  34]
 [ 85 257]]
[08/22/21 09:19:31] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/22/21 09:19:31] INFO	Generating ROC Curves
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: CATB
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: LGB
[08/22/21 09:19:31] INFO	ROC Curve for Algorithm: XGB
[08/22/21 09:19:31] INFO	Writing plot to ./plots/roc_curve_train.png
[08/22/21 09:19:31] INFO	Generating Learning Curves
[08/22/21 09:19:31] INFO	Algorithm Configuration
[08/22/21 09:19:31] INFO	Cannot load keras
[08/22/21 09:19:31] INFO	Algorithm KERASC not found (check package installation)
[08/22/21 09:19:31] INFO	Algorithm KERASR not found (check package installation)
[08/22/21 09:19:31] INFO	Learning Curve for Algorithm: CATB
[08/22/21 09:19:32] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/22/21 09:19:32] INFO	Learning Curve for Algorithm: LGB
[08/22/21 09:19:34] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/22/21 09:19:34] INFO	Learning Curve for Algorithm: XGB
[08/22/21 09:19:35] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/22/21 09:19:35] INFO	Generating Feature Importance Plots
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: CATB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Sex_factor (45.178104)
[08/22/21 09:19:35] INFO	2. Pclass (13.721171)
[08/22/21 09:19:35] INFO	3. Age (6.651788)
[08/22/21 09:19:35] INFO	4. Fare (4.529770)
[08/22/21 09:19:35] INFO	5. var (3.586590)
[08/22/21 09:19:35] INFO	6. std (3.492385)
[08/22/21 09:19:35] INFO	7. Ticket_factor (3.315046)
[08/22/21 09:19:35] INFO	8. cluster_30 (2.831587)
[08/22/21 09:19:35] INFO	9. mean (2.733389)
[08/22/21 09:19:35] INFO	10. Name_factor (2.586310)
[08/22/21 09:19:35] INFO	11. Cabin_factor (2.101764)
[08/22/21 09:19:35] INFO	12. Embarked (2.086410)
[08/22/21 09:19:35] INFO	13. SibSp (2.085405)
[08/22/21 09:19:35] INFO	14. cluster_12 (1.876782)
[08/22/21 09:19:35] INFO	15. cluster_24 (1.263144)
[08/22/21 09:19:35] INFO	16. count_2 (1.004409)
[08/22/21 09:19:35] INFO	17. sum (0.955946)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: LGB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Fare (256.000000)
[08/22/21 09:19:35] INFO	2. sum (241.000000)
[08/22/21 09:19:35] INFO	3. Age (232.000000)
[08/22/21 09:19:35] INFO	4. std (201.000000)
[08/22/21 09:19:35] INFO	5. Ticket_factor (199.000000)
[08/22/21 09:19:35] INFO	6. Name_factor (175.000000)
[08/22/21 09:19:35] INFO	7. cluster_30 (53.000000)
[08/22/21 09:19:35] INFO	8. cluster_27 (46.000000)
[08/22/21 09:19:35] INFO	9. Sex_factor (43.000000)
[08/22/21 09:19:35] INFO	10. Pclass (43.000000)
[08/22/21 09:19:35] INFO	11. Cabin_factor (41.000000)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/22/21 09:19:35] INFO	Feature Importances for Algorithm: XGB
[08/22/21 09:19:35] INFO	Feature Ranking:
[08/22/21 09:19:35] INFO	1. Sex_factor (0.424644)
[08/22/21 09:19:35] INFO	2. Pclass (0.127452)
[08/22/21 09:19:35] INFO	3. Cabin_factor (0.081307)
[08/22/21 09:19:35] INFO	4. Age (0.051007)
[08/22/21 09:19:35] INFO	5. SibSp (0.049620)
[08/22/21 09:19:35] INFO	6. count_1 (0.046373)
[08/22/21 09:19:35] INFO	7. Embarked (0.046225)
[08/22/21 09:19:35] INFO	8. std (0.036262)
[08/22/21 09:19:35] INFO	9. cluster_30 (0.036076)
[08/22/21 09:19:35] INFO	10. Fare (0.032410)
[08/22/21 09:19:35] INFO	11. cluster_24 (0.021187)
[08/22/21 09:19:35] INFO	12. Name_factor (0.019312)
[08/22/21 09:19:35] INFO	13. sum (0.017784)
[08/22/21 09:19:35] INFO	14. cluster_15 (0.010340)
[08/22/21 09:19:35] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/22/21 09:19:35] INFO	================================================================================
[08/22/21 09:19:35] INFO	Saving Model Predictor
[08/22/21 09:19:35] INFO	Writing model predictor to ./model/model_20210822.pkl
[08/22/21 09:19:35] INFO	Saving Feature Map
[08/22/21 09:19:35] INFO	Writing feature map to ./model/feature_map_20210822.pkl
[08/22/21 09:19:35] INFO	Loading data from ./input/test_20210822.csv
[08/22/21 09:19:35] INFO	Saving Predictions
[08/22/21 09:19:35] INFO	Writing data frame to ./output/predictions_20210822.csv
[08/22/21 09:19:35] INFO	Saving Probabilities
[08/22/21 09:19:35] INFO	Writing data frame to ./output/probabilities_20210822.csv
[08/22/21 09:19:35] INFO	Saving Ranked Predictions
[08/22/21 09:19:35] INFO	Writing data frame to ./output/rankings_20210822.csv
[08/22/21 09:19:35] INFO	Saving Submission to ./output/submission_20210822.csv
[08/22/21 09:19:35] INFO	********************************************************************************
[08/22/21 09:19:35] INFO	AlphaPy End
[08/22/21 09:19:35] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	AlphaPy Start
[08/22/21 15:39:22] INFO	********************************************************************************
[08/22/21 15:39:22] INFO	Model Configuration
[08/22/21 15:39:22] INFO	No transforms Found
[08/22/21 15:39:22] INFO	MODEL PARAMETERS:
[08/22/21 15:39:22] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[08/22/21 15:39:22] INFO	calibration       = False
[08/22/21 15:39:22] INFO	cal_type          = sigmoid
[08/22/21 15:39:22] INFO	calibration_plot  = False
[08/22/21 15:39:22] INFO	clustering        = True
[08/22/21 15:39:22] INFO	cluster_inc       = 3
[08/22/21 15:39:22] INFO	cluster_max       = 30
[08/22/21 15:39:22] INFO	cluster_min       = 3
[08/22/21 15:39:22] INFO	confusion_matrix  = True
[08/22/21 15:39:22] INFO	counts            = True
[08/22/21 15:39:22] INFO	cv_folds          = 3
[08/22/21 15:39:22] INFO	directory         = .
[08/22/21 15:39:22] INFO	extension         = csv
[08/22/21 15:39:22] INFO	drop              = ['PassengerId']
[08/22/21 15:39:22] INFO	encoder           = <Encoders.target: 14>
[08/22/21 15:39:22] INFO	esr               = 20
[08/22/21 15:39:22] INFO	factors           = ['Embarked']
[08/22/21 15:39:22] INFO	features [X]      = *
[08/22/21 15:39:22] INFO	feature_selection = False
[08/22/21 15:39:22] INFO	fs_percentage     = 50
[08/22/21 15:39:22] INFO	fs_score_func     = <function f_classif at 0x7fba62cb5b80>
[08/22/21 15:39:22] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[08/22/21 15:39:22] INFO	grid_search       = True
[08/22/21 15:39:22] INFO	gs_iters          = 50
[08/22/21 15:39:22] INFO	gs_random         = True
[08/22/21 15:39:22] INFO	gs_sample         = False
[08/22/21 15:39:22] INFO	gs_sample_pct     = 0.200000
[08/22/21 15:39:22] INFO	importances       = True
[08/22/21 15:39:22] INFO	interactions      = False
[08/22/21 15:39:22] INFO	isomap            = False
[08/22/21 15:39:22] INFO	iso_components    = 2
[08/22/21 15:39:22] INFO	iso_neighbors     = 5
[08/22/21 15:39:22] INFO	isample_pct       = 10
[08/22/21 15:39:22] INFO	learning_curve    = True
[08/22/21 15:39:22] INFO	logtransform      = False
[08/22/21 15:39:22] INFO	lv_remove         = True
[08/22/21 15:39:22] INFO	lv_threshold      = 0.100000
[08/22/21 15:39:22] INFO	model_type        = <ModelType.classification: 1>
[08/22/21 15:39:22] INFO	n_estimators      = 51
[08/22/21 15:39:22] INFO	n_jobs            = -1
[08/22/21 15:39:22] INFO	ngrams_max        = 2
[08/22/21 15:39:22] INFO	numpy             = True
[08/22/21 15:39:22] INFO	pca               = False
[08/22/21 15:39:22] INFO	pca_inc           = 1
[08/22/21 15:39:22] INFO	pca_max           = 10
[08/22/21 15:39:22] INFO	pca_min           = 2
[08/22/21 15:39:22] INFO	pca_whiten        = False
[08/22/21 15:39:22] INFO	poly_degree       = 2
[08/22/21 15:39:22] INFO	pvalue_level      = 0.010000
[08/22/21 15:39:22] INFO	rfe               = True
[08/22/21 15:39:22] INFO	rfe_step          = 3
[08/22/21 15:39:22] INFO	roc_curve         = True
[08/22/21 15:39:22] INFO	rounding          = 2
[08/22/21 15:39:22] INFO	sampling          = False
[08/22/21 15:39:22] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[08/22/21 15:39:22] INFO	sampling_ratio    = 0.500000
[08/22/21 15:39:22] INFO	scaler_option     = True
[08/22/21 15:39:22] INFO	scaler_type       = <Scalers.standard: 2>
[08/22/21 15:39:22] INFO	scipy             = False
[08/22/21 15:39:22] INFO	scorer            = roc_auc
[08/22/21 15:39:22] INFO	seed              = 42
[08/22/21 15:39:22] INFO	sentinel          = -1
[08/22/21 15:39:22] INFO	separator         = ,
[08/22/21 15:39:22] INFO	shuffle           = False
[08/22/21 15:39:22] INFO	split             = 0.400000
[08/22/21 15:39:22] INFO	submission_file   = gender_submission
[08/22/21 15:39:22] INFO	submit_probas     = False
[08/22/21 15:39:22] INFO	target [y]        = Survived
[08/22/21 15:39:22] INFO	target_value      = 1
[08/22/21 15:39:22] INFO	transforms        = None
[08/22/21 15:39:22] INFO	tsne              = False
[08/22/21 15:39:22] INFO	tsne_components   = 2
[08/22/21 15:39:22] INFO	tsne_learn_rate   = 1000.000000
[08/22/21 15:39:22] INFO	tsne_perplexity   = 30.000000
[08/22/21 15:39:22] INFO	vectorize         = False
[08/22/21 15:39:22] INFO	verbosity         = 0
[08/22/21 15:39:22] INFO	Creating Model
[08/22/21 15:39:22] INFO	Calling Pipeline
[08/22/21 15:39:22] INFO	Training Pipeline
[08/22/21 15:39:22] INFO	Loading Data
[08/22/21 15:39:22] INFO	Loading data from ./input/train.csv
[08/22/21 15:39:22] INFO	Found target Survived in data frame
[08/22/21 15:39:22] INFO	Labels (y) found for Partition.train
[08/22/21 15:39:22] INFO	Loading Data
[08/22/21 15:39:22] INFO	Loading data from ./input/test.csv
[08/22/21 15:39:22] INFO	Target Survived not found in Partition.test
[08/22/21 15:39:22] INFO	Saving New Features in Model
[08/22/21 15:39:22] INFO	Original Feature Statistics
[08/22/21 15:39:22] INFO	Number of Training Rows    : 891
[08/22/21 15:39:22] INFO	Number of Training Columns : 11
[08/22/21 15:39:22] INFO	Unique Training Values for Survived : [0 1]
[08/22/21 15:39:22] INFO	Unique Training Counts for Survived : [549 342]
[08/22/21 15:39:22] INFO	Number of Testing Rows     : 418
[08/22/21 15:39:22] INFO	Number of Testing Columns  : 11
[08/22/21 15:39:22] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 15:39:22] INFO	Feature Count     : 11
[08/22/21 15:39:22] INFO	Applying transforms
[08/22/21 15:39:22] INFO	No transforms Specified
[08/22/21 15:39:22] INFO	New Feature Count : 11
[08/22/21 15:39:22] INFO	Dropping Features: ['PassengerId']
[08/22/21 15:39:22] INFO	Original Feature Count : 11
[08/22/21 15:39:22] INFO	Reduced Feature Count  : 10
[08/22/21 15:39:22] INFO	Writing data frame to ./input/train_20210822.csv
[08/22/21 15:39:22] INFO	Writing data frame to ./input/test_20210822.csv
[08/22/21 15:39:22] INFO	Creating Cross-Tabulations
[08/22/21 15:39:22] INFO	Creating crosstabs for feature Embarked
[08/22/21 15:39:22] INFO	NumExpr defaulting to 8 threads.
[08/22/21 15:39:22] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[08/22/21 15:39:22] INFO	Feature Count     : 10
[08/22/21 15:39:22] INFO	Creating Count Features
[08/22/21 15:39:22] INFO	NA Counts
[08/22/21 15:39:22] INFO	Number Counts
[08/22/21 15:39:22] INFO	New Feature Count : 21
[08/22/21 15:39:22] INFO	Creating Base Features
[08/22/21 15:39:22] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[08/22/21 15:39:22] INFO	Feature 2: Name => Factorization
[08/22/21 15:39:22] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[08/22/21 15:39:22] INFO	Feature 3: Sex => Factorization
[08/22/21 15:39:22] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[08/22/21 15:39:22] INFO	Feature 7: Ticket => Factorization
[08/22/21 15:39:22] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[08/22/21 15:39:22] INFO	Feature 9: Cabin => Factorization
[08/22/21 15:39:22] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[08/22/21 15:39:22] INFO	Encoding: Encoders.target
[08/22/21 15:39:22] INFO	Fitting training features for Embarked
[08/22/21 15:39:22] INFO	Transforming testing features for Embarked
[08/22/21 15:39:22] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[08/22/21 15:39:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[08/22/21 15:39:22] INFO	New Feature Count : 21
[08/22/21 15:39:22] INFO	Scaling Base Features
[08/22/21 15:39:22] INFO	Creating NumPy Features
[08/22/21 15:39:22] INFO	NumPy Feature: sum
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: mean
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: std
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature: var
[08/22/21 15:39:22] INFO	    Imputation for Data Type float64: Median Strategy
[08/22/21 15:39:22] INFO	NumPy Feature Count : 4
[08/22/21 15:39:22] INFO	New Feature Count : 25
[08/22/21 15:39:22] INFO	Creating Clustering Features
[08/22/21 15:39:22] INFO	Cluster Minimum   : 3
[08/22/21 15:39:22] INFO	Cluster Maximum   : 30
[08/22/21 15:39:22] INFO	Cluster Increment : 3
[08/22/21 15:39:22] INFO	k = 3
[08/22/21 15:39:22] INFO	k = 6
[08/22/21 15:39:22] INFO	k = 9
[08/22/21 15:39:22] INFO	k = 12
[08/22/21 15:39:22] INFO	k = 15
[08/22/21 15:39:22] INFO	k = 18
[08/22/21 15:39:22] INFO	k = 21
[08/22/21 15:39:23] INFO	k = 24
[08/22/21 15:39:23] INFO	k = 27
[08/22/21 15:39:23] INFO	k = 30
[08/22/21 15:39:23] INFO	Clustering Feature Count : 10
[08/22/21 15:39:23] INFO	New Feature Count : 35
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Creating Interactions
[08/22/21 15:39:23] INFO	Initial Feature Count  : 35
[08/22/21 15:39:23] INFO	Skipping Interactions
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Removing Low-Variance Features
[08/22/21 15:39:23] INFO	Low-Variance Threshold  : 0.10
[08/22/21 15:39:23] INFO	Original Feature Count  : 35
[08/22/21 15:39:23] INFO	Reduced Feature Count   : 35
[08/22/21 15:39:23] INFO	Saving New Features in Model
[08/22/21 15:39:23] INFO	Skipping Shuffling
[08/22/21 15:39:23] INFO	Skipping Sampling
[08/22/21 15:39:23] INFO	Getting All Estimators
[08/22/21 15:39:23] INFO	Algorithm Configuration
[08/22/21 15:39:23] INFO	Selecting Models
[08/22/21 15:39:23] INFO	Algorithm: CATB
[08/22/21 15:39:23] INFO	Fitting Initial Model
[08/22/21 15:39:24] INFO	Cross-Validation
[08/22/21 15:39:25] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[08/22/21 15:39:25] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:27] INFO	RFECV took 2.28 seconds for step 3 and 3 folds
[08/22/21 15:39:27] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[08/22/21 15:39:27] INFO	No grid is defined for grid search
[08/22/21 15:39:27] INFO	Final Model Predictions for CATB
[08/22/21 15:39:27] INFO	Skipping Calibration
[08/22/21 15:39:27] INFO	Making Predictions
[08/22/21 15:39:27] INFO	Predictions Complete
[08/22/21 15:39:27] INFO	Algorithm: LGB
[08/22/21 15:39:27] INFO	Fitting Initial Model
[08/22/21 15:39:28] INFO	Cross-Validation
[08/22/21 15:39:29] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[08/22/21 15:39:29] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:37] INFO	RFECV took 7.56 seconds for step 3 and 3 folds
[08/22/21 15:39:37] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[08/22/21 15:39:37] INFO	No grid is defined for grid search
[08/22/21 15:39:37] INFO	Final Model Predictions for LGB
[08/22/21 15:39:37] INFO	Skipping Calibration
[08/22/21 15:39:37] INFO	Making Predictions
[08/22/21 15:39:37] INFO	Predictions Complete
[08/22/21 15:39:37] INFO	Algorithm: XGB
[08/22/21 15:39:37] INFO	Fitting Initial Model
[08/22/21 15:39:37] INFO	Cross-Validation
[08/22/21 15:39:38] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[08/22/21 15:39:38] INFO	Recursive Feature Elimination with CV
[08/22/21 15:39:46] INFO	RFECV took 8.05 seconds for step 3 and 3 folds
[08/22/21 15:39:46] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[08/22/21 15:39:46] INFO	Randomized Grid Search
[08/22/21 15:41:54] INFO	Grid Search took 127.89 seconds for 50 candidate parameter settings.
[08/22/21 15:41:54] INFO	Model with rank: 1
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.026)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[08/22/21 15:41:54] INFO	Model with rank: 2
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.027)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[08/22/21 15:41:54] INFO	Model with rank: 3
[08/22/21 15:41:54] INFO	Mean validation score: 0.870 (std: 0.021)
[08/22/21 15:41:54] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[08/22/21 15:41:54] INFO	Algorithm: XGB, Best Score: 0.8701, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[08/22/21 15:41:54] INFO	Final Model Predictions for XGB
[08/22/21 15:41:54] INFO	Skipping Calibration
[08/22/21 15:41:54] INFO	Making Predictions
[08/22/21 15:41:54] INFO	Predictions Complete
[08/22/21 15:41:54] INFO	Blending Models
[08/22/21 15:41:54] INFO	Blending Start: 2021-08-22 15:41:54.223590
[08/22/21 15:41:54] INFO	Blending Complete: 0:00:00.020620
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Metrics for: Partition.train
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: CATB
[08/22/21 15:41:54] INFO	accuracy: 0.8585858585858586
[08/22/21 15:41:54] INFO	average_precision: 0.9113351686222868
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.8378391333525069
[08/22/21 15:41:54] INFO	brier_score_loss: 0.10043404518351136
[08/22/21 15:41:54] INFO	cohen_kappa: 0.6932572665125658
[08/22/21 15:41:54] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[08/22/21 15:41:54] INFO	f1: 0.8025078369905956
[08/22/21 15:41:54] INFO	neg_log_loss: 0.3371948718196211
[08/22/21 15:41:54] INFO	precision: 0.8648648648648649
[08/22/21 15:41:54] INFO	recall: 0.7485380116959064
[08/22/21 15:41:54] INFO	roc_auc: 0.9297979313797549
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: LGB
[08/22/21 15:41:54] INFO	accuracy: 0.9730639730639731
[08/22/21 15:41:54] INFO	average_precision: 0.9961113207491221
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.9687709711437062
[08/22/21 15:41:54] INFO	brier_score_loss: 0.032809498448974184
[08/22/21 15:41:54] INFO	cohen_kappa: 0.9427387092109702
[08/22/21 15:41:54] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[08/22/21 15:41:54] INFO	f1: 0.9643916913946586
[08/22/21 15:41:54] INFO	neg_log_loss: 0.1458307566281259
[08/22/21 15:41:54] INFO	precision: 0.9789156626506024
[08/22/21 15:41:54] INFO	recall: 0.9502923976608187
[08/22/21 15:41:54] INFO	roc_auc: 0.9974861257576241
[08/22/21 15:41:54] INFO	--------------------------------------------------------------------------------
[08/22/21 15:41:54] INFO	Algorithm: XGB
[08/22/21 15:41:54] INFO	accuracy: 0.9225589225589226
[08/22/21 15:41:54] INFO	average_precision: 0.9576532313408883
[08/22/21 15:41:54] INFO	balanced_accuracy: 0.9090451538682772
[08/22/21 15:41:54] INFO	brier_score_loss: 0.16912337672198585
[08/22/21 15:41:54] INFO	cohen_kappa: 0.8332478945441231
[08/22/21 15:41:54] INFO	confusion_matrix: [[531  18]
 [ 51 291]]
[08/22/21 15:41:54] INFO	f1: 0.8940092165898617
[08/22/21 15:41:54] INFO	neg_log_loss: 0.5283242148314796
[08/22/21 15:41:54] INFO	precision: 0.941747572815534
[08/22/21 15:41:54] INFO	recall: 0.8508771929824561
[08/22/21 15:41:54] INFO	roc_auc: 0.9640068598941189
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Metrics for: Partition.test
[08/22/21 15:41:54] INFO	No labels for generating Partition.test metrics
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Selecting Best Model
[08/22/21 15:41:54] INFO	Scoring for: Partition.train
[08/22/21 15:41:54] INFO	Best Model Selection Start: 2021-08-22 15:41:54.269223
[08/22/21 15:41:54] INFO	Scoring CATB Model
[08/22/21 15:41:54] INFO	Scoring LGB Model
[08/22/21 15:41:54] INFO	Scoring XGB Model
[08/22/21 15:41:54] INFO	Scoring BLEND Model
[08/22/21 15:41:54] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[08/22/21 15:41:54] INFO	Best Model Selection Complete: 0:00:00.000207
[08/22/21 15:41:54] INFO	================================================================================
[08/22/21 15:41:54] INFO	Generating Plots for partition: train
[08/22/21 15:41:54] INFO	Generating Calibration Plot
[08/22/21 15:41:54] INFO	Calibration for Algorithm: CATB
[08/22/21 15:41:54] INFO	Calibration for Algorithm: LGB
[08/22/21 15:41:54] INFO	Calibration for Algorithm: XGB
[08/22/21 15:41:54] INFO	Writing plot to ./plots/calibration_train.png
[08/22/21 15:41:54] INFO	Generating Confusion Matrices
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: CATB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[509  40]
 [ 86 256]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_CATB.png
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: LGB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[542   7]
 [ 17 325]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_LGB.png
[08/22/21 15:41:54] INFO	Confusion Matrix for Algorithm: XGB
[08/22/21 15:41:54] INFO	Confusion Matrix:
[08/22/21 15:41:54] INFO	[[531  18]
 [ 51 291]]
[08/22/21 15:41:54] INFO	Writing plot to ./plots/confusion_train_XGB.png
[08/22/21 15:41:54] INFO	Generating ROC Curves
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: CATB
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: LGB
[08/22/21 15:41:54] INFO	ROC Curve for Algorithm: XGB
[08/22/21 15:41:54] INFO	Writing plot to ./plots/roc_curve_train.png
[08/22/21 15:41:54] INFO	Generating Learning Curves
[08/22/21 15:41:54] INFO	Algorithm Configuration
[08/22/21 15:41:54] INFO	Learning Curve for Algorithm: CATB
[08/22/21 15:41:55] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[08/22/21 15:41:55] INFO	Learning Curve for Algorithm: LGB
[08/22/21 15:41:57] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[08/22/21 15:41:57] INFO	Learning Curve for Algorithm: XGB
[08/22/21 15:41:58] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[08/22/21 15:41:58] INFO	Generating Feature Importance Plots
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: CATB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Sex_factor (45.178104)
[08/22/21 15:41:58] INFO	2. Pclass (13.721171)
[08/22/21 15:41:58] INFO	3. Age (6.651788)
[08/22/21 15:41:58] INFO	4. Fare (4.529770)
[08/22/21 15:41:58] INFO	5. var (3.586590)
[08/22/21 15:41:58] INFO	6. std (3.492385)
[08/22/21 15:41:58] INFO	7. Ticket_factor (3.315046)
[08/22/21 15:41:58] INFO	8. cluster_30 (2.831587)
[08/22/21 15:41:58] INFO	9. mean (2.733389)
[08/22/21 15:41:58] INFO	10. Name_factor (2.586310)
[08/22/21 15:41:58] INFO	11. Cabin_factor (2.101764)
[08/22/21 15:41:58] INFO	12. Embarked (2.086410)
[08/22/21 15:41:58] INFO	13. SibSp (2.085405)
[08/22/21 15:41:58] INFO	14. cluster_12 (1.876782)
[08/22/21 15:41:58] INFO	15. cluster_24 (1.263144)
[08/22/21 15:41:58] INFO	16. count_2 (1.004409)
[08/22/21 15:41:58] INFO	17. sum (0.955946)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: LGB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Fare (256.000000)
[08/22/21 15:41:58] INFO	2. sum (241.000000)
[08/22/21 15:41:58] INFO	3. Age (232.000000)
[08/22/21 15:41:58] INFO	4. std (201.000000)
[08/22/21 15:41:58] INFO	5. Ticket_factor (199.000000)
[08/22/21 15:41:58] INFO	6. Name_factor (175.000000)
[08/22/21 15:41:58] INFO	7. cluster_30 (53.000000)
[08/22/21 15:41:58] INFO	8. cluster_27 (46.000000)
[08/22/21 15:41:58] INFO	9. Sex_factor (43.000000)
[08/22/21 15:41:58] INFO	10. Pclass (43.000000)
[08/22/21 15:41:58] INFO	11. Cabin_factor (41.000000)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[08/22/21 15:41:58] INFO	Feature Importances for Algorithm: XGB
[08/22/21 15:41:58] INFO	Feature Ranking:
[08/22/21 15:41:58] INFO	1. Sex_factor (0.424644)
[08/22/21 15:41:58] INFO	2. Pclass (0.127452)
[08/22/21 15:41:58] INFO	3. Cabin_factor (0.081307)
[08/22/21 15:41:58] INFO	4. Age (0.051007)
[08/22/21 15:41:58] INFO	5. SibSp (0.049620)
[08/22/21 15:41:58] INFO	6. count_1 (0.046373)
[08/22/21 15:41:58] INFO	7. Embarked (0.046225)
[08/22/21 15:41:58] INFO	8. std (0.036262)
[08/22/21 15:41:58] INFO	9. cluster_30 (0.036076)
[08/22/21 15:41:58] INFO	10. Fare (0.032410)
[08/22/21 15:41:58] INFO	11. cluster_24 (0.021187)
[08/22/21 15:41:58] INFO	12. Name_factor (0.019312)
[08/22/21 15:41:58] INFO	13. sum (0.017784)
[08/22/21 15:41:58] INFO	14. cluster_15 (0.010340)
[08/22/21 15:41:58] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[08/22/21 15:41:58] INFO	================================================================================
[08/22/21 15:41:58] INFO	Saving Model Predictor
[08/22/21 15:41:58] INFO	Writing model predictor to ./model/model_20210822.pkl
[08/22/21 15:41:58] INFO	Saving Feature Map
[08/22/21 15:41:58] INFO	Writing feature map to ./model/feature_map_20210822.pkl
[08/22/21 15:41:58] INFO	Loading data from ./input/test_20210822.csv
[08/22/21 15:41:58] INFO	Saving Predictions
[08/22/21 15:41:58] INFO	Writing data frame to ./output/predictions_20210822.csv
[08/22/21 15:41:58] INFO	Saving Probabilities
[08/22/21 15:41:58] INFO	Writing data frame to ./output/probabilities_20210822.csv
[08/22/21 15:41:58] INFO	Saving Ranked Predictions
[08/22/21 15:41:58] INFO	Writing data frame to ./output/rankings_20210822.csv
[08/22/21 15:41:58] INFO	Saving Submission to ./output/submission_20210822.csv
[08/22/21 15:41:58] INFO	********************************************************************************
[08/22/21 15:41:58] INFO	AlphaPy End
[08/22/21 15:41:58] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	AlphaPy Start
[09/04/21 13:16:30] INFO	********************************************************************************
[09/04/21 13:16:30] INFO	Model Configuration
[09/04/21 13:16:30] INFO	No transforms Found
[09/04/21 13:16:30] INFO	MODEL PARAMETERS:
[09/04/21 13:16:30] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/04/21 13:16:30] INFO	calibration       = False
[09/04/21 13:16:30] INFO	cal_type          = sigmoid
[09/04/21 13:16:30] INFO	calibration_plot  = False
[09/04/21 13:16:30] INFO	clustering        = True
[09/04/21 13:16:30] INFO	cluster_inc       = 3
[09/04/21 13:16:30] INFO	cluster_max       = 30
[09/04/21 13:16:30] INFO	cluster_min       = 3
[09/04/21 13:16:30] INFO	confusion_matrix  = True
[09/04/21 13:16:30] INFO	counts            = True
[09/04/21 13:16:30] INFO	cv_folds          = 3
[09/04/21 13:16:30] INFO	directory         = .
[09/04/21 13:16:30] INFO	extension         = csv
[09/04/21 13:16:30] INFO	drop              = ['PassengerId']
[09/04/21 13:16:30] INFO	encoder           = <Encoders.target: 14>
[09/04/21 13:16:30] INFO	esr               = 20
[09/04/21 13:16:30] INFO	factors           = ['Embarked']
[09/04/21 13:16:30] INFO	features [X]      = *
[09/04/21 13:16:30] INFO	feature_selection = False
[09/04/21 13:16:30] INFO	fs_percentage     = 50
[09/04/21 13:16:30] INFO	fs_score_func     = <function f_classif at 0x7ffb5b10cd30>
[09/04/21 13:16:30] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/04/21 13:16:30] INFO	grid_search       = True
[09/04/21 13:16:30] INFO	gs_iters          = 50
[09/04/21 13:16:30] INFO	gs_random         = True
[09/04/21 13:16:30] INFO	gs_sample         = False
[09/04/21 13:16:30] INFO	gs_sample_pct     = 0.200000
[09/04/21 13:16:30] INFO	importances       = True
[09/04/21 13:16:30] INFO	interactions      = False
[09/04/21 13:16:30] INFO	isomap            = False
[09/04/21 13:16:30] INFO	iso_components    = 2
[09/04/21 13:16:30] INFO	iso_neighbors     = 5
[09/04/21 13:16:30] INFO	isample_pct       = 10
[09/04/21 13:16:30] INFO	learning_curve    = True
[09/04/21 13:16:30] INFO	logtransform      = False
[09/04/21 13:16:30] INFO	lv_remove         = True
[09/04/21 13:16:30] INFO	lv_threshold      = 0.100000
[09/04/21 13:16:30] INFO	model_type        = <ModelType.classification: 1>
[09/04/21 13:16:30] INFO	n_estimators      = 51
[09/04/21 13:16:30] INFO	n_jobs            = -1
[09/04/21 13:16:30] INFO	ngrams_max        = 2
[09/04/21 13:16:30] INFO	numpy             = True
[09/04/21 13:16:30] INFO	pca               = False
[09/04/21 13:16:30] INFO	pca_inc           = 1
[09/04/21 13:16:30] INFO	pca_max           = 10
[09/04/21 13:16:30] INFO	pca_min           = 2
[09/04/21 13:16:30] INFO	pca_whiten        = False
[09/04/21 13:16:30] INFO	poly_degree       = 2
[09/04/21 13:16:30] INFO	pvalue_level      = 0.010000
[09/04/21 13:16:30] INFO	rfe               = True
[09/04/21 13:16:30] INFO	rfe_step          = 3
[09/04/21 13:16:30] INFO	roc_curve         = True
[09/04/21 13:16:30] INFO	rounding          = 2
[09/04/21 13:16:30] INFO	sampling          = False
[09/04/21 13:16:30] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/04/21 13:16:30] INFO	sampling_ratio    = 0.500000
[09/04/21 13:16:30] INFO	scaler_option     = True
[09/04/21 13:16:30] INFO	scaler_type       = <Scalers.standard: 2>
[09/04/21 13:16:30] INFO	scipy             = False
[09/04/21 13:16:30] INFO	scorer            = roc_auc
[09/04/21 13:16:30] INFO	seed              = 42
[09/04/21 13:16:30] INFO	sentinel          = -1
[09/04/21 13:16:30] INFO	separator         = ,
[09/04/21 13:16:30] INFO	shuffle           = False
[09/04/21 13:16:30] INFO	split             = 0.400000
[09/04/21 13:16:30] INFO	submission_file   = gender_submission
[09/04/21 13:16:30] INFO	submit_probas     = False
[09/04/21 13:16:30] INFO	target [y]        = Survived
[09/04/21 13:16:30] INFO	target_value      = 1
[09/04/21 13:16:30] INFO	transforms        = None
[09/04/21 13:16:30] INFO	tsne              = False
[09/04/21 13:16:30] INFO	tsne_components   = 2
[09/04/21 13:16:30] INFO	tsne_learn_rate   = 1000.000000
[09/04/21 13:16:30] INFO	tsne_perplexity   = 30.000000
[09/04/21 13:16:30] INFO	vectorize         = False
[09/04/21 13:16:30] INFO	verbosity         = 0
[09/04/21 13:16:30] INFO	Creating Model
[09/04/21 13:16:30] INFO	Calling Pipeline
[09/04/21 13:16:30] INFO	Training Pipeline
[09/04/21 13:16:30] INFO	Loading Data
[09/04/21 13:16:30] INFO	Loading data from ./input/train.csv
[09/04/21 13:16:30] INFO	Found target Survived in data frame
[09/04/21 13:16:30] INFO	Labels (y) found for Partition.train
[09/04/21 13:16:30] INFO	Loading Data
[09/04/21 13:16:30] INFO	Loading data from ./input/test.csv
[09/04/21 13:16:30] INFO	Target Survived not found in Partition.test
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Original Feature Statistics
[09/04/21 13:16:30] INFO	Number of Training Rows    : 891
[09/04/21 13:16:30] INFO	Number of Training Columns : 11
[09/04/21 13:16:30] INFO	Unique Training Values for Survived : [0 1]
[09/04/21 13:16:30] INFO	Unique Training Counts for Survived : [549 342]
[09/04/21 13:16:30] INFO	Number of Testing Rows     : 418
[09/04/21 13:16:30] INFO	Number of Testing Columns  : 11
[09/04/21 13:16:30] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/04/21 13:16:30] INFO	Feature Count     : 11
[09/04/21 13:16:30] INFO	Applying transforms
[09/04/21 13:16:30] INFO	No transforms Specified
[09/04/21 13:16:30] INFO	New Feature Count : 11
[09/04/21 13:16:30] INFO	Dropping Features: ['PassengerId']
[09/04/21 13:16:30] INFO	Original Feature Count : 11
[09/04/21 13:16:30] INFO	Reduced Feature Count  : 10
[09/04/21 13:16:30] INFO	Writing data frame to ./input/train_20210904.csv
[09/04/21 13:16:30] INFO	Writing data frame to ./input/test_20210904.csv
[09/04/21 13:16:30] INFO	Creating Cross-Tabulations
[09/04/21 13:16:30] INFO	Creating crosstabs for feature Embarked
[09/04/21 13:16:30] INFO	NumExpr defaulting to 8 threads.
[09/04/21 13:16:30] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/04/21 13:16:30] INFO	Feature Count     : 10
[09/04/21 13:16:30] INFO	Creating Count Features
[09/04/21 13:16:30] INFO	NA Counts
[09/04/21 13:16:30] INFO	Number Counts
[09/04/21 13:16:30] INFO	New Feature Count : 21
[09/04/21 13:16:30] INFO	Creating Base Features
[09/04/21 13:16:30] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/04/21 13:16:30] INFO	Feature 2: Name => Factorization
[09/04/21 13:16:30] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/04/21 13:16:30] INFO	Feature 3: Sex => Factorization
[09/04/21 13:16:30] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/04/21 13:16:30] INFO	Feature 7: Ticket => Factorization
[09/04/21 13:16:30] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/04/21 13:16:30] INFO	Feature 9: Cabin => Factorization
[09/04/21 13:16:30] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/04/21 13:16:30] INFO	Encoding: Encoders.target
[09/04/21 13:16:30] INFO	Fitting training features for Embarked
[09/04/21 13:16:30] INFO	Transforming testing features for Embarked
[09/04/21 13:16:30] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/04/21 13:16:30] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/04/21 13:16:30] INFO	New Feature Count : 21
[09/04/21 13:16:30] INFO	Scaling Base Features
[09/04/21 13:16:30] INFO	Creating NumPy Features
[09/04/21 13:16:30] INFO	NumPy Feature: sum
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: mean
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: std
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature: var
[09/04/21 13:16:30] INFO	    Imputation for Data Type float64: Median Strategy
[09/04/21 13:16:30] INFO	NumPy Feature Count : 4
[09/04/21 13:16:30] INFO	New Feature Count : 25
[09/04/21 13:16:30] INFO	Creating Clustering Features
[09/04/21 13:16:30] INFO	Cluster Minimum   : 3
[09/04/21 13:16:30] INFO	Cluster Maximum   : 30
[09/04/21 13:16:30] INFO	Cluster Increment : 3
[09/04/21 13:16:30] INFO	k = 3
[09/04/21 13:16:30] INFO	k = 6
[09/04/21 13:16:30] INFO	k = 9
[09/04/21 13:16:30] INFO	k = 12
[09/04/21 13:16:30] INFO	k = 15
[09/04/21 13:16:30] INFO	k = 18
[09/04/21 13:16:30] INFO	k = 21
[09/04/21 13:16:30] INFO	k = 24
[09/04/21 13:16:30] INFO	k = 27
[09/04/21 13:16:30] INFO	k = 30
[09/04/21 13:16:30] INFO	Clustering Feature Count : 10
[09/04/21 13:16:30] INFO	New Feature Count : 35
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Creating Interactions
[09/04/21 13:16:30] INFO	Initial Feature Count  : 35
[09/04/21 13:16:30] INFO	Skipping Interactions
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Removing Low-Variance Features
[09/04/21 13:16:30] INFO	Low-Variance Threshold  : 0.10
[09/04/21 13:16:30] INFO	Original Feature Count  : 35
[09/04/21 13:16:30] INFO	Reduced Feature Count   : 35
[09/04/21 13:16:30] INFO	Saving New Features in Model
[09/04/21 13:16:30] INFO	Skipping Shuffling
[09/04/21 13:16:30] INFO	Skipping Sampling
[09/04/21 13:16:30] INFO	Getting All Estimators
[09/04/21 13:16:30] INFO	Algorithm Configuration
[09/04/21 13:16:31] INFO	Selecting Models
[09/04/21 13:16:31] INFO	Algorithm: CATB
[09/04/21 13:16:31] INFO	Fitting Initial Model
[09/04/21 13:16:31] INFO	Cross-Validation
[09/04/21 13:16:33] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/04/21 13:16:33] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:35] INFO	RFECV took 2.48 seconds for step 3 and 3 folds
[09/04/21 13:16:35] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/04/21 13:16:35] INFO	No grid is defined for grid search
[09/04/21 13:16:35] INFO	Final Model Predictions for CATB
[09/04/21 13:16:35] INFO	Skipping Calibration
[09/04/21 13:16:35] INFO	Making Predictions
[09/04/21 13:16:35] INFO	Predictions Complete
[09/04/21 13:16:35] INFO	Algorithm: LGB
[09/04/21 13:16:35] INFO	Fitting Initial Model
[09/04/21 13:16:35] INFO	Cross-Validation
[09/04/21 13:16:36] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/04/21 13:16:36] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:39] INFO	RFECV took 2.99 seconds for step 3 and 3 folds
[09/04/21 13:16:39] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/04/21 13:16:39] INFO	No grid is defined for grid search
[09/04/21 13:16:39] INFO	Final Model Predictions for LGB
[09/04/21 13:16:39] INFO	Skipping Calibration
[09/04/21 13:16:39] INFO	Making Predictions
[09/04/21 13:16:39] INFO	Predictions Complete
[09/04/21 13:16:39] INFO	Algorithm: XGB
[09/04/21 13:16:39] INFO	Fitting Initial Model
[09/04/21 13:16:39] INFO	Cross-Validation
[09/04/21 13:16:39] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/04/21 13:16:39] INFO	Recursive Feature Elimination with CV
[09/04/21 13:16:42] INFO	RFECV took 2.92 seconds for step 3 and 3 folds
[09/04/21 13:16:42] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/04/21 13:16:42] INFO	Randomized Grid Search
[09/04/21 13:17:46] INFO	Grid Search took 64.01 seconds for 50 candidate parameter settings.
[09/04/21 13:17:46] INFO	Model with rank: 1
[09/04/21 13:17:46] INFO	Mean validation score: 0.873 (std: 0.023)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[09/04/21 13:17:46] INFO	Model with rank: 2
[09/04/21 13:17:46] INFO	Mean validation score: 0.871 (std: 0.013)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[09/04/21 13:17:46] INFO	Model with rank: 3
[09/04/21 13:17:46] INFO	Mean validation score: 0.870 (std: 0.020)
[09/04/21 13:17:46] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[09/04/21 13:17:46] INFO	Algorithm: XGB, Best Score: 0.8729, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[09/04/21 13:17:46] INFO	Final Model Predictions for XGB
[09/04/21 13:17:46] INFO	Skipping Calibration
[09/04/21 13:17:46] INFO	Making Predictions
[09/04/21 13:17:46] INFO	Predictions Complete
[09/04/21 13:17:46] INFO	Blending Models
[09/04/21 13:17:46] INFO	Blending Start: 2021-09-04 13:17:46.381270
[09/04/21 13:17:46] INFO	Blending Complete: 0:00:00.015735
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Metrics for: Partition.train
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: CATB
[09/04/21 13:17:46] INFO	accuracy: 0.8585858585858586
[09/04/21 13:17:46] INFO	average_precision: 0.9113351686222868
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.8378391333525069
[09/04/21 13:17:46] INFO	brier_score_loss: 0.10043404518351136
[09/04/21 13:17:46] INFO	cohen_kappa: 0.6932572665125658
[09/04/21 13:17:46] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/04/21 13:17:46] INFO	f1: 0.8025078369905956
[09/04/21 13:17:46] INFO	neg_log_loss: 0.3371948718196211
[09/04/21 13:17:46] INFO	precision: 0.8648648648648649
[09/04/21 13:17:46] INFO	recall: 0.7485380116959064
[09/04/21 13:17:46] INFO	roc_auc: 0.9297979313797549
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: LGB
[09/04/21 13:17:46] INFO	accuracy: 0.9730639730639731
[09/04/21 13:17:46] INFO	average_precision: 0.9961113207491221
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.9687709711437062
[09/04/21 13:17:46] INFO	brier_score_loss: 0.032809498448974184
[09/04/21 13:17:46] INFO	cohen_kappa: 0.9427387092109702
[09/04/21 13:17:46] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/04/21 13:17:46] INFO	f1: 0.9643916913946586
[09/04/21 13:17:46] INFO	neg_log_loss: 0.1458307566281259
[09/04/21 13:17:46] INFO	precision: 0.9789156626506024
[09/04/21 13:17:46] INFO	recall: 0.9502923976608187
[09/04/21 13:17:46] INFO	roc_auc: 0.9974861257576241
[09/04/21 13:17:46] INFO	--------------------------------------------------------------------------------
[09/04/21 13:17:46] INFO	Algorithm: XGB
[09/04/21 13:17:46] INFO	accuracy: 0.9057239057239057
[09/04/21 13:17:46] INFO	average_precision: 0.9470768333074432
[09/04/21 13:17:46] INFO	balanced_accuracy: 0.8882178122902886
[09/04/21 13:17:46] INFO	brier_score_loss: 0.1749366357341051
[09/04/21 13:17:46] INFO	cohen_kappa: 0.7957359009628611
[09/04/21 13:17:46] INFO	confusion_matrix: [[529  20]
 [ 64 278]]
[09/04/21 13:17:46] INFO	f1: 0.8687500000000001
[09/04/21 13:17:46] INFO	neg_log_loss: 0.5403209037317839
[09/04/21 13:17:46] INFO	precision: 0.9328859060402684
[09/04/21 13:17:46] INFO	recall: 0.8128654970760234
[09/04/21 13:17:46] INFO	roc_auc: 0.9570138156563236
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Metrics for: Partition.test
[09/04/21 13:17:46] INFO	No labels for generating Partition.test metrics
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Selecting Best Model
[09/04/21 13:17:46] INFO	Scoring for: Partition.train
[09/04/21 13:17:46] INFO	Best Model Selection Start: 2021-09-04 13:17:46.419438
[09/04/21 13:17:46] INFO	Scoring CATB Model
[09/04/21 13:17:46] INFO	Scoring LGB Model
[09/04/21 13:17:46] INFO	Scoring XGB Model
[09/04/21 13:17:46] INFO	Scoring BLEND Model
[09/04/21 13:17:46] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/04/21 13:17:46] INFO	Best Model Selection Complete: 0:00:00.000198
[09/04/21 13:17:46] INFO	================================================================================
[09/04/21 13:17:46] INFO	Generating Plots for partition: train
[09/04/21 13:17:46] INFO	Generating Calibration Plot
[09/04/21 13:17:46] INFO	Calibration for Algorithm: CATB
[09/04/21 13:17:46] INFO	Calibration for Algorithm: LGB
[09/04/21 13:17:46] INFO	Calibration for Algorithm: XGB
[09/04/21 13:17:46] INFO	Writing plot to ./plots/calibration_train.png
[09/04/21 13:17:46] INFO	Generating Confusion Matrices
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: CATB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[509  40]
 [ 86 256]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: LGB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[542   7]
 [ 17 325]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/04/21 13:17:46] INFO	Confusion Matrix for Algorithm: XGB
[09/04/21 13:17:46] INFO	Confusion Matrix:
[09/04/21 13:17:46] INFO	[[529  20]
 [ 64 278]]
[09/04/21 13:17:46] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/04/21 13:17:46] INFO	Generating ROC Curves
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: CATB
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: LGB
[09/04/21 13:17:46] INFO	ROC Curve for Algorithm: XGB
[09/04/21 13:17:46] INFO	Writing plot to ./plots/roc_curve_train.png
[09/04/21 13:17:46] INFO	Generating Learning Curves
[09/04/21 13:17:46] INFO	Algorithm Configuration
[09/04/21 13:17:47] INFO	Learning Curve for Algorithm: CATB
[09/04/21 13:17:47] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/04/21 13:17:47] INFO	Learning Curve for Algorithm: LGB
[09/04/21 13:17:49] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/04/21 13:17:49] INFO	Learning Curve for Algorithm: XGB
[09/04/21 13:17:50] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/04/21 13:17:50] INFO	Generating Feature Importance Plots
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: CATB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Sex_factor (45.178104)
[09/04/21 13:17:50] INFO	2. Pclass (13.721171)
[09/04/21 13:17:50] INFO	3. Age (6.651788)
[09/04/21 13:17:50] INFO	4. Fare (4.529770)
[09/04/21 13:17:50] INFO	5. var (3.586590)
[09/04/21 13:17:50] INFO	6. std (3.492385)
[09/04/21 13:17:50] INFO	7. Ticket_factor (3.315046)
[09/04/21 13:17:50] INFO	8. cluster_30 (2.831587)
[09/04/21 13:17:50] INFO	9. mean (2.733389)
[09/04/21 13:17:50] INFO	10. Name_factor (2.586310)
[09/04/21 13:17:50] INFO	11. Cabin_factor (2.101764)
[09/04/21 13:17:50] INFO	12. Embarked (2.086410)
[09/04/21 13:17:50] INFO	13. SibSp (2.085405)
[09/04/21 13:17:50] INFO	14. cluster_12 (1.876782)
[09/04/21 13:17:50] INFO	15. cluster_24 (1.263144)
[09/04/21 13:17:50] INFO	16. count_2 (1.004409)
[09/04/21 13:17:50] INFO	17. sum (0.955946)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: LGB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Fare (256.000000)
[09/04/21 13:17:50] INFO	2. sum (241.000000)
[09/04/21 13:17:50] INFO	3. Age (232.000000)
[09/04/21 13:17:50] INFO	4. std (201.000000)
[09/04/21 13:17:50] INFO	5. Ticket_factor (199.000000)
[09/04/21 13:17:50] INFO	6. Name_factor (175.000000)
[09/04/21 13:17:50] INFO	7. cluster_30 (53.000000)
[09/04/21 13:17:50] INFO	8. cluster_27 (46.000000)
[09/04/21 13:17:50] INFO	9. Sex_factor (43.000000)
[09/04/21 13:17:50] INFO	10. Pclass (43.000000)
[09/04/21 13:17:50] INFO	11. Cabin_factor (41.000000)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/04/21 13:17:50] INFO	Feature Importances for Algorithm: XGB
[09/04/21 13:17:50] INFO	Feature Ranking:
[09/04/21 13:17:50] INFO	1. Sex_factor (0.424644)
[09/04/21 13:17:50] INFO	2. Pclass (0.127452)
[09/04/21 13:17:50] INFO	3. Cabin_factor (0.081307)
[09/04/21 13:17:50] INFO	4. Age (0.051007)
[09/04/21 13:17:50] INFO	5. SibSp (0.049620)
[09/04/21 13:17:50] INFO	6. count_1 (0.046373)
[09/04/21 13:17:50] INFO	7. Embarked (0.046225)
[09/04/21 13:17:50] INFO	8. std (0.036262)
[09/04/21 13:17:50] INFO	9. cluster_30 (0.036076)
[09/04/21 13:17:50] INFO	10. Fare (0.032410)
[09/04/21 13:17:50] INFO	11. cluster_24 (0.021187)
[09/04/21 13:17:50] INFO	12. Name_factor (0.019312)
[09/04/21 13:17:50] INFO	13. sum (0.017784)
[09/04/21 13:17:50] INFO	14. cluster_15 (0.010340)
[09/04/21 13:17:50] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/04/21 13:17:50] INFO	================================================================================
[09/04/21 13:17:50] INFO	Saving Model Predictor
[09/04/21 13:17:50] INFO	Writing model predictor to ./model/model_20210904.pkl
[09/04/21 13:17:50] INFO	Saving Feature Map
[09/04/21 13:17:50] INFO	Writing feature map to ./model/feature_map_20210904.pkl
[09/04/21 13:17:50] INFO	Loading data from ./input/test_20210904.csv
[09/04/21 13:17:50] INFO	Saving Predictions
[09/04/21 13:17:50] INFO	Writing data frame to ./output/predictions_20210904.csv
[09/04/21 13:17:50] INFO	Saving Probabilities
[09/04/21 13:17:50] INFO	Writing data frame to ./output/probabilities_20210904.csv
[09/04/21 13:17:50] INFO	Saving Ranked Predictions
[09/04/21 13:17:50] INFO	Writing data frame to ./output/rankings_20210904.csv
[09/04/21 13:17:50] INFO	Saving Submission to ./output/submission_20210904.csv
[09/04/21 13:17:50] INFO	********************************************************************************
[09/04/21 13:17:50] INFO	AlphaPy End
[09/04/21 13:17:50] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	AlphaPy Start
[09/16/21 09:12:25] INFO	********************************************************************************
[09/16/21 09:12:25] INFO	Model Configuration
[09/16/21 09:14:31] INFO	********************************************************************************
[09/16/21 09:14:31] INFO	AlphaPy Start
[09/16/21 09:14:31] INFO	********************************************************************************
[09/16/21 09:14:31] INFO	Model Configuration
[09/16/21 09:14:31] INFO	No transforms Found
[09/16/21 09:14:31] INFO	MODEL PARAMETERS:
[09/16/21 09:14:31] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/16/21 09:14:31] INFO	calibration       = False
[09/16/21 09:14:31] INFO	cal_type          = sigmoid
[09/16/21 09:14:31] INFO	calibration_plot  = False
[09/16/21 09:14:31] INFO	clustering        = True
[09/16/21 09:14:31] INFO	cluster_inc       = 3
[09/16/21 09:14:31] INFO	cluster_max       = 30
[09/16/21 09:14:31] INFO	cluster_min       = 3
[09/16/21 09:14:31] INFO	confusion_matrix  = True
[09/16/21 09:14:31] INFO	counts            = True
[09/16/21 09:14:31] INFO	cv_folds          = 3
[09/16/21 09:14:31] INFO	directory         = .
[09/16/21 09:14:31] INFO	extension         = csv
[09/16/21 09:14:31] INFO	drop              = ['PassengerId']
[09/16/21 09:14:31] INFO	encoder           = <Encoders.target: 14>
[09/16/21 09:14:31] INFO	esr               = 20
[09/16/21 09:14:31] INFO	factors           = ['Embarked']
[09/16/21 09:14:31] INFO	features [X]      = *
[09/16/21 09:14:31] INFO	feature_selection = False
[09/16/21 09:14:31] INFO	fs_percentage     = 50
[09/16/21 09:14:31] INFO	fs_score_func     = <function f_classif at 0x7fa8c2d9a8b0>
[09/16/21 09:14:31] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/16/21 09:14:31] INFO	grid_search       = True
[09/16/21 09:14:31] INFO	gs_iters          = 50
[09/16/21 09:14:31] INFO	gs_random         = True
[09/16/21 09:14:31] INFO	gs_sample         = False
[09/16/21 09:14:31] INFO	gs_sample_pct     = 0.200000
[09/16/21 09:14:31] INFO	importances       = True
[09/16/21 09:14:31] INFO	interactions      = False
[09/16/21 09:14:31] INFO	isomap            = False
[09/16/21 09:14:31] INFO	iso_components    = 2
[09/16/21 09:14:31] INFO	iso_neighbors     = 5
[09/16/21 09:14:31] INFO	isample_pct       = 10
[09/16/21 09:14:31] INFO	leaders           = []
[09/16/21 09:14:31] INFO	learning_curve    = True
[09/16/21 09:14:31] INFO	logtransform      = False
[09/16/21 09:14:31] INFO	lv_remove         = True
[09/16/21 09:14:31] INFO	lv_threshold      = 0.100000
[09/16/21 09:14:31] INFO	model_type        = <ModelType.classification: 1>
[09/16/21 09:14:31] INFO	n_estimators      = 51
[09/16/21 09:14:31] INFO	n_jobs            = -1
[09/16/21 09:14:31] INFO	ngrams_max        = 2
[09/16/21 09:14:31] INFO	numpy             = True
[09/16/21 09:14:31] INFO	pca               = False
[09/16/21 09:14:31] INFO	pca_inc           = 1
[09/16/21 09:14:31] INFO	pca_max           = 10
[09/16/21 09:14:31] INFO	pca_min           = 2
[09/16/21 09:14:31] INFO	pca_whiten        = False
[09/16/21 09:14:31] INFO	poly_degree       = 2
[09/16/21 09:14:31] INFO	pvalue_level      = 0.010000
[09/16/21 09:14:31] INFO	rfe               = True
[09/16/21 09:14:31] INFO	rfe_step          = 3
[09/16/21 09:14:31] INFO	roc_curve         = True
[09/16/21 09:14:31] INFO	rounding          = 2
[09/16/21 09:14:31] INFO	sampling          = False
[09/16/21 09:14:31] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/16/21 09:14:31] INFO	sampling_ratio    = 0.500000
[09/16/21 09:14:31] INFO	scaler_option     = True
[09/16/21 09:14:31] INFO	scaler_type       = <Scalers.standard: 2>
[09/16/21 09:14:31] INFO	scipy             = False
[09/16/21 09:14:31] INFO	scorer            = roc_auc
[09/16/21 09:14:31] INFO	seed              = 42
[09/16/21 09:14:31] INFO	sentinel          = -1
[09/16/21 09:14:31] INFO	separator         = ,
[09/16/21 09:14:31] INFO	shuffle           = False
[09/16/21 09:14:31] INFO	split             = 0.400000
[09/16/21 09:14:31] INFO	submission_file   = gender_submission
[09/16/21 09:14:31] INFO	submit_probas     = False
[09/16/21 09:14:31] INFO	target [y]        = Survived
[09/16/21 09:14:31] INFO	target_value      = 1
[09/16/21 09:14:31] INFO	transforms        = None
[09/16/21 09:14:31] INFO	tsne              = False
[09/16/21 09:14:31] INFO	tsne_components   = 2
[09/16/21 09:14:31] INFO	tsne_learn_rate   = 1000.000000
[09/16/21 09:14:31] INFO	tsne_perplexity   = 30.000000
[09/16/21 09:14:31] INFO	vectorize         = False
[09/16/21 09:14:31] INFO	verbosity         = 0
[09/16/21 09:14:31] INFO	Creating Model
[09/16/21 09:14:31] INFO	Calling Pipeline
[09/16/21 09:14:31] INFO	Training Pipeline
[09/16/21 09:14:31] INFO	Loading Data
[09/16/21 09:14:31] INFO	Loading data from ./input/train.csv
[09/16/21 09:14:31] INFO	Found target Survived in data frame
[09/16/21 09:14:31] INFO	Labels (y) found for Partition.train
[09/16/21 09:14:31] INFO	Loading Data
[09/16/21 09:14:31] INFO	Loading data from ./input/test.csv
[09/16/21 09:14:31] INFO	Target Survived not found in Partition.test
[09/16/21 09:14:31] INFO	Saving New Features in Model
[09/16/21 09:14:31] INFO	Original Feature Statistics
[09/16/21 09:14:31] INFO	Number of Training Rows    : 891
[09/16/21 09:14:31] INFO	Number of Training Columns : 11
[09/16/21 09:14:31] INFO	Unique Training Values for Survived : [0 1]
[09/16/21 09:14:31] INFO	Unique Training Counts for Survived : [549 342]
[09/16/21 09:14:31] INFO	Number of Testing Rows     : 418
[09/16/21 09:14:31] INFO	Number of Testing Columns  : 11
[09/16/21 09:14:31] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:14:31] INFO	Feature Count     : 11
[09/16/21 09:14:31] INFO	Applying transforms
[09/16/21 09:14:31] INFO	No transforms Specified
[09/16/21 09:14:31] INFO	New Feature Count : 11
[09/16/21 09:14:31] INFO	Dropping Features: ['PassengerId']
[09/16/21 09:14:31] INFO	Original Feature Count : 11
[09/16/21 09:14:31] INFO	Reduced Feature Count  : 10
[09/16/21 09:14:31] INFO	Writing data frame to ./input/train_20210916.csv
[09/16/21 09:14:31] INFO	Writing data frame to ./input/test_20210916.csv
[09/16/21 09:14:31] INFO	Creating Cross-Tabulations
[09/16/21 09:14:31] INFO	Creating crosstabs for feature Embarked
[09/16/21 09:14:31] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:14:31] INFO	Feature Count     : 10
[09/16/21 09:14:31] INFO	Creating Count Features
[09/16/21 09:14:31] INFO	NA Counts
[09/16/21 09:14:31] INFO	Number Counts
[09/16/21 09:14:31] INFO	New Feature Count : 21
[09/16/21 09:14:31] INFO	Creating Base Features
[09/16/21 09:14:31] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/16/21 09:14:31] INFO	Feature 2: Name => Factorization
[09/16/21 09:14:31] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/16/21 09:14:31] INFO	Feature 3: Sex => Factorization
[09/16/21 09:14:31] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/16/21 09:14:31] INFO	Feature 7: Ticket => Factorization
[09/16/21 09:14:31] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/16/21 09:14:31] INFO	Feature 9: Cabin => Factorization
[09/16/21 09:14:31] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/16/21 09:14:31] INFO	Encoding: Encoders.target
[09/16/21 09:14:31] INFO	Fitting training features for Embarked
[09/16/21 09:14:31] INFO	Transforming testing features for Embarked
[09/16/21 09:14:31] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:14:31] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:14:31] INFO	New Feature Count : 21
[09/16/21 09:14:31] INFO	Scaling Base Features
[09/16/21 09:14:31] INFO	Creating NumPy Features
[09/16/21 09:14:31] INFO	NumPy Feature: sum
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: mean
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: std
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature: var
[09/16/21 09:14:31] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:14:31] INFO	NumPy Feature Count : 4
[09/16/21 09:14:31] INFO	New Feature Count : 25
[09/16/21 09:14:31] INFO	Creating Clustering Features
[09/16/21 09:14:31] INFO	Cluster Minimum   : 3
[09/16/21 09:14:31] INFO	Cluster Maximum   : 30
[09/16/21 09:14:31] INFO	Cluster Increment : 3
[09/16/21 09:14:31] INFO	k = 3
[09/16/21 09:14:32] INFO	k = 6
[09/16/21 09:14:32] INFO	k = 9
[09/16/21 09:14:32] INFO	k = 12
[09/16/21 09:14:32] INFO	k = 15
[09/16/21 09:14:32] INFO	k = 18
[09/16/21 09:14:32] INFO	k = 21
[09/16/21 09:14:32] INFO	k = 24
[09/16/21 09:14:32] INFO	k = 27
[09/16/21 09:14:32] INFO	k = 30
[09/16/21 09:14:32] INFO	Clustering Feature Count : 10
[09/16/21 09:14:32] INFO	New Feature Count : 35
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Creating Interactions
[09/16/21 09:14:32] INFO	Initial Feature Count  : 35
[09/16/21 09:14:32] INFO	Skipping Interactions
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Removing Low-Variance Features
[09/16/21 09:14:32] INFO	Low-Variance Threshold  : 0.10
[09/16/21 09:14:32] INFO	Original Feature Count  : 35
[09/16/21 09:14:32] INFO	Reduced Feature Count   : 35
[09/16/21 09:14:32] INFO	Saving New Features in Model
[09/16/21 09:14:32] INFO	Skipping Shuffling
[09/16/21 09:14:32] INFO	Skipping Sampling
[09/16/21 09:14:32] INFO	Getting All Estimators
[09/16/21 09:14:32] INFO	Algorithm Configuration
[09/16/21 09:14:33] INFO	Selecting Models
[09/16/21 09:14:33] INFO	Algorithm: CATB
[09/16/21 09:14:33] INFO	Fitting Initial Model
[09/16/21 09:14:33] INFO	Cross-Validation
[09/16/21 09:14:34] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/16/21 09:14:34] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:37] INFO	RFECV took 2.51 seconds for step 3 and 3 folds
[09/16/21 09:14:37] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/16/21 09:14:37] INFO	No grid is defined for grid search
[09/16/21 09:14:37] INFO	Final Model Predictions for CATB
[09/16/21 09:14:37] INFO	Skipping Calibration
[09/16/21 09:14:37] INFO	Making Predictions
[09/16/21 09:14:37] INFO	Predictions Complete
[09/16/21 09:14:37] INFO	Algorithm: LGB
[09/16/21 09:14:37] INFO	Fitting Initial Model
[09/16/21 09:14:37] INFO	Cross-Validation
[09/16/21 09:14:38] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/16/21 09:14:38] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:40] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[09/16/21 09:14:40] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/16/21 09:14:40] INFO	No grid is defined for grid search
[09/16/21 09:14:40] INFO	Final Model Predictions for LGB
[09/16/21 09:14:40] INFO	Skipping Calibration
[09/16/21 09:14:40] INFO	Making Predictions
[09/16/21 09:14:40] INFO	Predictions Complete
[09/16/21 09:14:40] INFO	Algorithm: XGB
[09/16/21 09:14:40] INFO	Fitting Initial Model
[09/16/21 09:14:40] INFO	Cross-Validation
[09/16/21 09:14:41] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/16/21 09:14:41] INFO	Recursive Feature Elimination with CV
[09/16/21 09:14:44] INFO	RFECV took 2.95 seconds for step 3 and 3 folds
[09/16/21 09:14:44] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/16/21 09:14:44] INFO	Randomized Grid Search
[09/16/21 09:16:11] INFO	Grid Search took 87.56 seconds for 50 candidate parameter settings.
[09/16/21 09:16:11] INFO	Model with rank: 1
[09/16/21 09:16:11] INFO	Mean validation score: 0.872 (std: 0.021)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Model with rank: 2
[09/16/21 09:16:11] INFO	Mean validation score: 0.870 (std: 0.024)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[09/16/21 09:16:11] INFO	Model with rank: 3
[09/16/21 09:16:11] INFO	Mean validation score: 0.869 (std: 0.021)
[09/16/21 09:16:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Algorithm: XGB, Best Score: 0.8718, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:16:11] INFO	Final Model Predictions for XGB
[09/16/21 09:16:11] INFO	Skipping Calibration
[09/16/21 09:16:11] INFO	Making Predictions
[09/16/21 09:16:11] INFO	Predictions Complete
[09/16/21 09:16:11] INFO	Blending Models
[09/16/21 09:16:11] INFO	Blending Start: 2021-09-16 09:16:11.760483
[09/16/21 09:16:11] INFO	Blending Complete: 0:00:00.015313
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Metrics for: Partition.train
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: CATB
[09/16/21 09:16:11] INFO	accuracy: 0.8585858585858586
[09/16/21 09:16:11] INFO	average_precision: 0.9113351686222868
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.8378391333525069
[09/16/21 09:16:11] INFO	brier_score_loss: 0.10043404518351136
[09/16/21 09:16:11] INFO	cohen_kappa: 0.6932572665125658
[09/16/21 09:16:11] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/16/21 09:16:11] INFO	f1: 0.8025078369905956
[09/16/21 09:16:11] INFO	neg_log_loss: 0.3371948718196211
[09/16/21 09:16:11] INFO	precision: 0.8648648648648649
[09/16/21 09:16:11] INFO	recall: 0.7485380116959064
[09/16/21 09:16:11] INFO	roc_auc: 0.9297979313797549
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: LGB
[09/16/21 09:16:11] INFO	accuracy: 0.9730639730639731
[09/16/21 09:16:11] INFO	average_precision: 0.9961113207491221
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.9687709711437062
[09/16/21 09:16:11] INFO	brier_score_loss: 0.032809498448974184
[09/16/21 09:16:11] INFO	cohen_kappa: 0.9427387092109702
[09/16/21 09:16:11] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/16/21 09:16:11] INFO	f1: 0.9643916913946586
[09/16/21 09:16:11] INFO	neg_log_loss: 0.1458307566281259
[09/16/21 09:16:11] INFO	precision: 0.9789156626506024
[09/16/21 09:16:11] INFO	recall: 0.9502923976608187
[09/16/21 09:16:11] INFO	roc_auc: 0.9974861257576241
[09/16/21 09:16:11] INFO	--------------------------------------------------------------------------------
[09/16/21 09:16:11] INFO	Algorithm: XGB
[09/16/21 09:16:11] INFO	accuracy: 0.9236812570145904
[09/16/21 09:16:11] INFO	average_precision: 0.9698555146807429
[09/16/21 09:16:11] INFO	balanced_accuracy: 0.9088534176972486
[09/16/21 09:16:11] INFO	brier_score_loss: 0.0753543675763611
[09/16/21 09:16:11] INFO	cohen_kappa: 0.8352019583843329
[09/16/21 09:16:11] INFO	confusion_matrix: [[534  15]
 [ 53 289]]
[09/16/21 09:16:11] INFO	f1: 0.8947368421052633
[09/16/21 09:16:11] INFO	neg_log_loss: 0.2905843097352821
[09/16/21 09:16:11] INFO	precision: 0.9506578947368421
[09/16/21 09:16:11] INFO	recall: 0.8450292397660819
[09/16/21 09:16:11] INFO	roc_auc: 0.9783018566452562
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Metrics for: Partition.test
[09/16/21 09:16:11] INFO	No labels for generating Partition.test metrics
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Selecting Best Model
[09/16/21 09:16:11] INFO	Scoring for: Partition.train
[09/16/21 09:16:11] INFO	Best Model Selection Start: 2021-09-16 09:16:11.799109
[09/16/21 09:16:11] INFO	Scoring CATB Model
[09/16/21 09:16:11] INFO	Scoring LGB Model
[09/16/21 09:16:11] INFO	Scoring XGB Model
[09/16/21 09:16:11] INFO	Scoring BLEND Model
[09/16/21 09:16:11] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[09/16/21 09:16:11] INFO	Best Model Selection Complete: 0:00:00.000213
[09/16/21 09:16:11] INFO	================================================================================
[09/16/21 09:16:11] INFO	Generating Plots for partition: train
[09/16/21 09:16:11] INFO	Generating Calibration Plot
[09/16/21 09:16:11] INFO	Calibration for Algorithm: CATB
[09/16/21 09:16:11] INFO	Calibration for Algorithm: LGB
[09/16/21 09:16:11] INFO	Calibration for Algorithm: XGB
[09/16/21 09:16:11] INFO	Writing plot to ./plots/calibration_train.png
[09/16/21 09:16:11] INFO	Generating Confusion Matrices
[09/16/21 09:16:11] INFO	Confusion Matrix for Algorithm: CATB
[09/16/21 09:16:11] INFO	Confusion Matrix:
[09/16/21 09:16:11] INFO	[[509  40]
 [ 86 256]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/16/21 09:16:12] INFO	Confusion Matrix for Algorithm: LGB
[09/16/21 09:16:12] INFO	Confusion Matrix:
[09/16/21 09:16:12] INFO	[[542   7]
 [ 17 325]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/16/21 09:16:12] INFO	Confusion Matrix for Algorithm: XGB
[09/16/21 09:16:12] INFO	Confusion Matrix:
[09/16/21 09:16:12] INFO	[[534  15]
 [ 53 289]]
[09/16/21 09:16:12] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/16/21 09:16:12] INFO	Generating ROC Curves
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: CATB
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: LGB
[09/16/21 09:16:12] INFO	ROC Curve for Algorithm: XGB
[09/16/21 09:16:12] INFO	Writing plot to ./plots/roc_curve_train.png
[09/16/21 09:16:12] INFO	Generating Learning Curves
[09/16/21 09:16:12] INFO	Algorithm Configuration
[09/16/21 09:16:12] INFO	Learning Curve for Algorithm: CATB
[09/16/21 09:16:12] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/16/21 09:16:13] INFO	Learning Curve for Algorithm: LGB
[09/16/21 09:16:14] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/16/21 09:16:14] INFO	Learning Curve for Algorithm: XGB
[09/16/21 09:16:15] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/16/21 09:16:15] INFO	Generating Feature Importance Plots
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: CATB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Sex_factor (45.178104)
[09/16/21 09:16:15] INFO	2. Pclass (13.721171)
[09/16/21 09:16:15] INFO	3. Age (6.651788)
[09/16/21 09:16:15] INFO	4. Fare (4.529770)
[09/16/21 09:16:15] INFO	5. var (3.586590)
[09/16/21 09:16:15] INFO	6. std (3.492385)
[09/16/21 09:16:15] INFO	7. Ticket_factor (3.315046)
[09/16/21 09:16:15] INFO	8. cluster_30 (2.831587)
[09/16/21 09:16:15] INFO	9. mean (2.733389)
[09/16/21 09:16:15] INFO	10. Name_factor (2.586310)
[09/16/21 09:16:15] INFO	11. Cabin_factor (2.101764)
[09/16/21 09:16:15] INFO	12. Embarked (2.086410)
[09/16/21 09:16:15] INFO	13. SibSp (2.085405)
[09/16/21 09:16:15] INFO	14. cluster_12 (1.876782)
[09/16/21 09:16:15] INFO	15. cluster_24 (1.263144)
[09/16/21 09:16:15] INFO	16. count_2 (1.004409)
[09/16/21 09:16:15] INFO	17. sum (0.955946)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: LGB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Fare (256.000000)
[09/16/21 09:16:15] INFO	2. sum (241.000000)
[09/16/21 09:16:15] INFO	3. Age (232.000000)
[09/16/21 09:16:15] INFO	4. std (201.000000)
[09/16/21 09:16:15] INFO	5. Ticket_factor (199.000000)
[09/16/21 09:16:15] INFO	6. Name_factor (175.000000)
[09/16/21 09:16:15] INFO	7. cluster_30 (53.000000)
[09/16/21 09:16:15] INFO	8. cluster_27 (46.000000)
[09/16/21 09:16:15] INFO	9. Sex_factor (43.000000)
[09/16/21 09:16:15] INFO	10. Pclass (43.000000)
[09/16/21 09:16:15] INFO	11. Cabin_factor (41.000000)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/16/21 09:16:15] INFO	Feature Importances for Algorithm: XGB
[09/16/21 09:16:15] INFO	Feature Ranking:
[09/16/21 09:16:15] INFO	1. Sex_factor (0.424644)
[09/16/21 09:16:15] INFO	2. Pclass (0.127452)
[09/16/21 09:16:15] INFO	3. Cabin_factor (0.081307)
[09/16/21 09:16:15] INFO	4. Age (0.051007)
[09/16/21 09:16:15] INFO	5. SibSp (0.049620)
[09/16/21 09:16:15] INFO	6. count_1 (0.046373)
[09/16/21 09:16:15] INFO	7. Embarked (0.046225)
[09/16/21 09:16:15] INFO	8. std (0.036262)
[09/16/21 09:16:15] INFO	9. cluster_30 (0.036076)
[09/16/21 09:16:15] INFO	10. Fare (0.032410)
[09/16/21 09:16:15] INFO	11. cluster_24 (0.021187)
[09/16/21 09:16:15] INFO	12. Name_factor (0.019312)
[09/16/21 09:16:15] INFO	13. sum (0.017784)
[09/16/21 09:16:15] INFO	14. cluster_15 (0.010340)
[09/16/21 09:16:15] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/16/21 09:16:16] INFO	================================================================================
[09/16/21 09:16:16] INFO	Saving Model Predictor
[09/16/21 09:16:16] INFO	Writing model predictor to ./model/model_20210916.pkl
[09/16/21 09:16:16] INFO	Saving Feature Map
[09/16/21 09:16:16] INFO	Writing feature map to ./model/feature_map_20210916.pkl
[09/16/21 09:16:16] INFO	Loading data from ./input/test_20210916.csv
[09/16/21 09:16:16] INFO	Saving Predictions
[09/16/21 09:16:16] INFO	Writing data frame to ./output/predictions_20210916.csv
[09/16/21 09:16:16] INFO	Saving Probabilities
[09/16/21 09:16:16] INFO	Writing data frame to ./output/probabilities_20210916.csv
[09/16/21 09:16:16] INFO	Saving Ranked Predictions
[09/16/21 09:16:16] INFO	Writing data frame to ./output/rankings_20210916.csv
[09/16/21 09:16:16] INFO	Saving Submission to ./output/submission_20210916.csv
[09/16/21 09:16:16] INFO	********************************************************************************
[09/16/21 09:16:16] INFO	AlphaPy End
[09/16/21 09:16:16] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	AlphaPy Start
[09/16/21 09:16:49] INFO	********************************************************************************
[09/16/21 09:16:49] INFO	Model Configuration
[09/16/21 09:16:49] INFO	No transforms Found
[09/16/21 09:16:49] INFO	MODEL PARAMETERS:
[09/16/21 09:16:49] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/16/21 09:16:49] INFO	calibration       = False
[09/16/21 09:16:49] INFO	cal_type          = sigmoid
[09/16/21 09:16:49] INFO	calibration_plot  = False
[09/16/21 09:16:49] INFO	clustering        = True
[09/16/21 09:16:49] INFO	cluster_inc       = 3
[09/16/21 09:16:49] INFO	cluster_max       = 30
[09/16/21 09:16:49] INFO	cluster_min       = 3
[09/16/21 09:16:49] INFO	confusion_matrix  = True
[09/16/21 09:16:49] INFO	counts            = True
[09/16/21 09:16:49] INFO	cv_folds          = 3
[09/16/21 09:16:49] INFO	directory         = .
[09/16/21 09:16:49] INFO	extension         = csv
[09/16/21 09:16:49] INFO	drop              = ['PassengerId']
[09/16/21 09:16:49] INFO	encoder           = <Encoders.target: 14>
[09/16/21 09:16:49] INFO	esr               = 20
[09/16/21 09:16:49] INFO	factors           = ['Embarked']
[09/16/21 09:16:49] INFO	features [X]      = *
[09/16/21 09:16:49] INFO	feature_selection = False
[09/16/21 09:16:49] INFO	fs_percentage     = 50
[09/16/21 09:16:49] INFO	fs_score_func     = <function f_classif at 0x7fe57ac8c9d0>
[09/16/21 09:16:49] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/16/21 09:16:49] INFO	grid_search       = True
[09/16/21 09:16:49] INFO	gs_iters          = 50
[09/16/21 09:16:49] INFO	gs_random         = True
[09/16/21 09:16:49] INFO	gs_sample         = False
[09/16/21 09:16:49] INFO	gs_sample_pct     = 0.200000
[09/16/21 09:16:49] INFO	importances       = True
[09/16/21 09:16:49] INFO	interactions      = False
[09/16/21 09:16:49] INFO	isomap            = False
[09/16/21 09:16:49] INFO	iso_components    = 2
[09/16/21 09:16:49] INFO	iso_neighbors     = 5
[09/16/21 09:16:49] INFO	isample_pct       = 10
[09/16/21 09:16:49] INFO	leaders           = []
[09/16/21 09:16:49] INFO	learning_curve    = True
[09/16/21 09:16:49] INFO	logtransform      = False
[09/16/21 09:16:49] INFO	lv_remove         = True
[09/16/21 09:16:49] INFO	lv_threshold      = 0.100000
[09/16/21 09:16:49] INFO	model_type        = <ModelType.classification: 1>
[09/16/21 09:16:49] INFO	n_estimators      = 51
[09/16/21 09:16:49] INFO	n_jobs            = -1
[09/16/21 09:16:49] INFO	ngrams_max        = 2
[09/16/21 09:16:49] INFO	numpy             = True
[09/16/21 09:16:49] INFO	pca               = False
[09/16/21 09:16:49] INFO	pca_inc           = 1
[09/16/21 09:16:49] INFO	pca_max           = 10
[09/16/21 09:16:49] INFO	pca_min           = 2
[09/16/21 09:16:49] INFO	pca_whiten        = False
[09/16/21 09:16:49] INFO	poly_degree       = 2
[09/16/21 09:16:49] INFO	pvalue_level      = 0.010000
[09/16/21 09:16:49] INFO	rfe               = True
[09/16/21 09:16:49] INFO	rfe_step          = 3
[09/16/21 09:16:49] INFO	roc_curve         = True
[09/16/21 09:16:49] INFO	rounding          = 2
[09/16/21 09:16:49] INFO	sampling          = False
[09/16/21 09:16:49] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/16/21 09:16:49] INFO	sampling_ratio    = 0.500000
[09/16/21 09:16:49] INFO	scaler_option     = True
[09/16/21 09:16:49] INFO	scaler_type       = <Scalers.standard: 2>
[09/16/21 09:16:49] INFO	scipy             = False
[09/16/21 09:16:49] INFO	scorer            = roc_auc
[09/16/21 09:16:49] INFO	seed              = 42
[09/16/21 09:16:49] INFO	sentinel          = -1
[09/16/21 09:16:49] INFO	separator         = ,
[09/16/21 09:16:49] INFO	shuffle           = False
[09/16/21 09:16:49] INFO	split             = 0.400000
[09/16/21 09:16:49] INFO	submission_file   = gender_submission
[09/16/21 09:16:49] INFO	submit_probas     = False
[09/16/21 09:16:49] INFO	target [y]        = Survived
[09/16/21 09:16:49] INFO	target_value      = 1
[09/16/21 09:16:49] INFO	transforms        = None
[09/16/21 09:16:49] INFO	tsne              = False
[09/16/21 09:16:49] INFO	tsne_components   = 2
[09/16/21 09:16:49] INFO	tsne_learn_rate   = 1000.000000
[09/16/21 09:16:49] INFO	tsne_perplexity   = 30.000000
[09/16/21 09:16:49] INFO	vectorize         = False
[09/16/21 09:16:49] INFO	verbosity         = 0
[09/16/21 09:16:49] INFO	Creating Model
[09/16/21 09:16:49] INFO	Calling Pipeline
[09/16/21 09:16:49] INFO	Training Pipeline
[09/16/21 09:16:49] INFO	Loading Data
[09/16/21 09:16:49] INFO	Loading data from ./input/train.csv
[09/16/21 09:16:49] INFO	Found target Survived in data frame
[09/16/21 09:16:49] INFO	Labels (y) found for Partition.train
[09/16/21 09:16:49] INFO	Loading Data
[09/16/21 09:16:49] INFO	Loading data from ./input/test.csv
[09/16/21 09:16:49] INFO	Target Survived not found in Partition.test
[09/16/21 09:16:49] INFO	Saving New Features in Model
[09/16/21 09:16:49] INFO	Original Feature Statistics
[09/16/21 09:16:49] INFO	Number of Training Rows    : 891
[09/16/21 09:16:49] INFO	Number of Training Columns : 11
[09/16/21 09:16:49] INFO	Unique Training Values for Survived : [0 1]
[09/16/21 09:16:49] INFO	Unique Training Counts for Survived : [549 342]
[09/16/21 09:16:49] INFO	Number of Testing Rows     : 418
[09/16/21 09:16:49] INFO	Number of Testing Columns  : 11
[09/16/21 09:16:49] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:16:49] INFO	Feature Count     : 11
[09/16/21 09:16:49] INFO	Applying transforms
[09/16/21 09:16:49] INFO	No transforms Specified
[09/16/21 09:16:49] INFO	New Feature Count : 11
[09/16/21 09:16:49] INFO	Dropping Features: ['PassengerId']
[09/16/21 09:16:49] INFO	Original Feature Count : 11
[09/16/21 09:16:49] INFO	Reduced Feature Count  : 10
[09/16/21 09:16:49] INFO	Writing data frame to ./input/train_20210916.csv
[09/16/21 09:16:49] INFO	Writing data frame to ./input/test_20210916.csv
[09/16/21 09:16:49] INFO	Creating Cross-Tabulations
[09/16/21 09:16:49] INFO	Creating crosstabs for feature Embarked
[09/16/21 09:16:49] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/16/21 09:16:49] INFO	Feature Count     : 10
[09/16/21 09:16:49] INFO	Creating Count Features
[09/16/21 09:16:49] INFO	NA Counts
[09/16/21 09:16:49] INFO	Number Counts
[09/16/21 09:16:49] INFO	New Feature Count : 21
[09/16/21 09:16:49] INFO	Creating Base Features
[09/16/21 09:16:49] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/16/21 09:16:49] INFO	Feature 2: Name => Factorization
[09/16/21 09:16:49] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/16/21 09:16:49] INFO	Feature 3: Sex => Factorization
[09/16/21 09:16:49] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/16/21 09:16:49] INFO	Feature 7: Ticket => Factorization
[09/16/21 09:16:49] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/16/21 09:16:49] INFO	Feature 9: Cabin => Factorization
[09/16/21 09:16:49] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/16/21 09:16:49] INFO	Encoding: Encoders.target
[09/16/21 09:16:49] INFO	Fitting training features for Embarked
[09/16/21 09:16:49] INFO	Transforming testing features for Embarked
[09/16/21 09:16:49] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/16/21 09:16:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/16/21 09:16:49] INFO	New Feature Count : 21
[09/16/21 09:16:49] INFO	Scaling Base Features
[09/16/21 09:16:49] INFO	Creating NumPy Features
[09/16/21 09:16:49] INFO	NumPy Feature: sum
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: mean
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: std
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature: var
[09/16/21 09:16:49] INFO	    Imputation for Data Type float64: Median Strategy
[09/16/21 09:16:49] INFO	NumPy Feature Count : 4
[09/16/21 09:16:49] INFO	New Feature Count : 25
[09/16/21 09:16:49] INFO	Creating Clustering Features
[09/16/21 09:16:49] INFO	Cluster Minimum   : 3
[09/16/21 09:16:49] INFO	Cluster Maximum   : 30
[09/16/21 09:16:49] INFO	Cluster Increment : 3
[09/16/21 09:16:49] INFO	k = 3
[09/16/21 09:16:50] INFO	k = 6
[09/16/21 09:16:50] INFO	k = 9
[09/16/21 09:16:50] INFO	k = 12
[09/16/21 09:16:50] INFO	k = 15
[09/16/21 09:16:50] INFO	k = 18
[09/16/21 09:16:50] INFO	k = 21
[09/16/21 09:16:50] INFO	k = 24
[09/16/21 09:16:50] INFO	k = 27
[09/16/21 09:16:50] INFO	k = 30
[09/16/21 09:16:50] INFO	Clustering Feature Count : 10
[09/16/21 09:16:50] INFO	New Feature Count : 35
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Creating Interactions
[09/16/21 09:16:50] INFO	Initial Feature Count  : 35
[09/16/21 09:16:50] INFO	Skipping Interactions
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Removing Low-Variance Features
[09/16/21 09:16:50] INFO	Low-Variance Threshold  : 0.10
[09/16/21 09:16:50] INFO	Original Feature Count  : 35
[09/16/21 09:16:50] INFO	Reduced Feature Count   : 35
[09/16/21 09:16:50] INFO	Saving New Features in Model
[09/16/21 09:16:50] INFO	Skipping Shuffling
[09/16/21 09:16:50] INFO	Skipping Sampling
[09/16/21 09:16:50] INFO	Getting All Estimators
[09/16/21 09:16:50] INFO	Algorithm Configuration
[09/16/21 09:16:50] INFO	Selecting Models
[09/16/21 09:16:50] INFO	Algorithm: CATB
[09/16/21 09:16:50] INFO	Fitting Initial Model
[09/16/21 09:16:50] INFO	Cross-Validation
[09/16/21 09:16:52] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/16/21 09:16:52] INFO	Recursive Feature Elimination with CV
[09/16/21 09:16:54] INFO	RFECV took 2.58 seconds for step 3 and 3 folds
[09/16/21 09:16:54] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/16/21 09:16:54] INFO	No grid is defined for grid search
[09/16/21 09:16:54] INFO	Final Model Predictions for CATB
[09/16/21 09:16:54] INFO	Skipping Calibration
[09/16/21 09:16:54] INFO	Making Predictions
[09/16/21 09:16:54] INFO	Predictions Complete
[09/16/21 09:16:54] INFO	Algorithm: LGB
[09/16/21 09:16:54] INFO	Fitting Initial Model
[09/16/21 09:16:54] INFO	Cross-Validation
[09/16/21 09:16:55] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/16/21 09:16:55] INFO	Recursive Feature Elimination with CV
[09/16/21 09:16:58] INFO	RFECV took 2.29 seconds for step 3 and 3 folds
[09/16/21 09:16:58] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/16/21 09:16:58] INFO	No grid is defined for grid search
[09/16/21 09:16:58] INFO	Final Model Predictions for LGB
[09/16/21 09:16:58] INFO	Skipping Calibration
[09/16/21 09:16:58] INFO	Making Predictions
[09/16/21 09:16:58] INFO	Predictions Complete
[09/16/21 09:16:58] INFO	Algorithm: XGB
[09/16/21 09:16:58] INFO	Fitting Initial Model
[09/16/21 09:16:58] INFO	Cross-Validation
[09/16/21 09:16:58] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/16/21 09:16:58] INFO	Recursive Feature Elimination with CV
[09/16/21 09:17:01] INFO	RFECV took 2.80 seconds for step 3 and 3 folds
[09/16/21 09:17:01] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/16/21 09:17:01] INFO	Randomized Grid Search
[09/16/21 09:18:18] INFO	Grid Search took 76.63 seconds for 50 candidate parameter settings.
[09/16/21 09:18:18] INFO	Model with rank: 1
[09/16/21 09:18:18] INFO	Mean validation score: 0.872 (std: 0.027)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[09/16/21 09:18:18] INFO	Model with rank: 2
[09/16/21 09:18:18] INFO	Mean validation score: 0.871 (std: 0.023)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[09/16/21 09:18:18] INFO	Model with rank: 3
[09/16/21 09:18:18] INFO	Mean validation score: 0.871 (std: 0.020)
[09/16/21 09:18:18] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[09/16/21 09:18:18] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[09/16/21 09:18:18] INFO	Final Model Predictions for XGB
[09/16/21 09:18:18] INFO	Skipping Calibration
[09/16/21 09:18:18] INFO	Making Predictions
[09/16/21 09:18:18] INFO	Predictions Complete
[09/16/21 09:18:18] INFO	Blending Models
[09/16/21 09:18:18] INFO	Blending Start: 2021-09-16 09:18:18.010436
[09/16/21 09:18:18] INFO	Blending Complete: 0:00:00.006903
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Metrics for: Partition.train
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: CATB
[09/16/21 09:18:18] INFO	accuracy: 0.8585858585858586
[09/16/21 09:18:18] INFO	average_precision: 0.9113351686222868
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.8378391333525069
[09/16/21 09:18:18] INFO	brier_score_loss: 0.10043404518351136
[09/16/21 09:18:18] INFO	cohen_kappa: 0.6932572665125658
[09/16/21 09:18:18] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/16/21 09:18:18] INFO	f1: 0.8025078369905956
[09/16/21 09:18:18] INFO	neg_log_loss: 0.3371948718196211
[09/16/21 09:18:18] INFO	precision: 0.8648648648648649
[09/16/21 09:18:18] INFO	recall: 0.7485380116959064
[09/16/21 09:18:18] INFO	roc_auc: 0.9297979313797549
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: LGB
[09/16/21 09:18:18] INFO	accuracy: 0.9730639730639731
[09/16/21 09:18:18] INFO	average_precision: 0.9961113207491221
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.9687709711437062
[09/16/21 09:18:18] INFO	brier_score_loss: 0.032809498448974184
[09/16/21 09:18:18] INFO	cohen_kappa: 0.9427387092109702
[09/16/21 09:18:18] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/16/21 09:18:18] INFO	f1: 0.9643916913946586
[09/16/21 09:18:18] INFO	neg_log_loss: 0.1458307566281259
[09/16/21 09:18:18] INFO	precision: 0.9789156626506024
[09/16/21 09:18:18] INFO	recall: 0.9502923976608187
[09/16/21 09:18:18] INFO	roc_auc: 0.9974861257576241
[09/16/21 09:18:18] INFO	--------------------------------------------------------------------------------
[09/16/21 09:18:18] INFO	Algorithm: XGB
[09/16/21 09:18:18] INFO	accuracy: 0.9438832772166106
[09/16/21 09:18:18] INFO	average_precision: 0.9803814890043973
[09/16/21 09:18:18] INFO	balanced_accuracy: 0.9335154826958105
[09/16/21 09:18:18] INFO	brier_score_loss: 0.06571987701478049
[09/16/21 09:18:18] INFO	cohen_kappa: 0.8796381850897242
[09/16/21 09:18:18] INFO	confusion_matrix: [[537  12]
 [ 38 304]]
[09/16/21 09:18:18] INFO	f1: 0.9240121580547112
[09/16/21 09:18:18] INFO	neg_log_loss: 0.2629800713532233
[09/16/21 09:18:18] INFO	precision: 0.9620253164556962
[09/16/21 09:18:18] INFO	recall: 0.8888888888888888
[09/16/21 09:18:18] INFO	roc_auc: 0.9853002268878024
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Metrics for: Partition.test
[09/16/21 09:18:18] INFO	No labels for generating Partition.test metrics
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Selecting Best Model
[09/16/21 09:18:18] INFO	Scoring for: Partition.train
[09/16/21 09:18:18] INFO	Best Model Selection Start: 2021-09-16 09:18:18.038152
[09/16/21 09:18:18] INFO	Scoring CATB Model
[09/16/21 09:18:18] INFO	Scoring LGB Model
[09/16/21 09:18:18] INFO	Scoring XGB Model
[09/16/21 09:18:18] INFO	Scoring BLEND Model
[09/16/21 09:18:18] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/16/21 09:18:18] INFO	Best Model Selection Complete: 0:00:00.000200
[09/16/21 09:18:18] INFO	================================================================================
[09/16/21 09:18:18] INFO	Generating Plots for partition: train
[09/16/21 09:18:18] INFO	Generating Calibration Plot
[09/16/21 09:18:18] INFO	Calibration for Algorithm: CATB
[09/16/21 09:18:18] INFO	Calibration for Algorithm: LGB
[09/16/21 09:18:18] INFO	Calibration for Algorithm: XGB
[09/16/21 09:18:18] INFO	Writing plot to ./plots/calibration_train.png
[09/16/21 09:18:18] INFO	Generating Confusion Matrices
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: CATB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[509  40]
 [ 86 256]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: LGB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[542   7]
 [ 17 325]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/16/21 09:18:18] INFO	Confusion Matrix for Algorithm: XGB
[09/16/21 09:18:18] INFO	Confusion Matrix:
[09/16/21 09:18:18] INFO	[[537  12]
 [ 38 304]]
[09/16/21 09:18:18] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/16/21 09:18:18] INFO	Generating ROC Curves
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: CATB
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: LGB
[09/16/21 09:18:18] INFO	ROC Curve for Algorithm: XGB
[09/16/21 09:18:18] INFO	Writing plot to ./plots/roc_curve_train.png
[09/16/21 09:18:18] INFO	Generating Learning Curves
[09/16/21 09:18:18] INFO	Algorithm Configuration
[09/16/21 09:18:18] INFO	Learning Curve for Algorithm: CATB
[09/16/21 09:18:19] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/16/21 09:18:19] INFO	Learning Curve for Algorithm: LGB
[09/16/21 09:18:20] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/16/21 09:18:20] INFO	Learning Curve for Algorithm: XGB
[09/16/21 09:18:21] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/16/21 09:18:21] INFO	Generating Feature Importance Plots
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: CATB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Sex_factor (45.178104)
[09/16/21 09:18:21] INFO	2. Pclass (13.721171)
[09/16/21 09:18:21] INFO	3. Age (6.651788)
[09/16/21 09:18:21] INFO	4. Fare (4.529770)
[09/16/21 09:18:21] INFO	5. var (3.586590)
[09/16/21 09:18:21] INFO	6. std (3.492385)
[09/16/21 09:18:21] INFO	7. Ticket_factor (3.315046)
[09/16/21 09:18:21] INFO	8. cluster_30 (2.831587)
[09/16/21 09:18:21] INFO	9. mean (2.733389)
[09/16/21 09:18:21] INFO	10. Name_factor (2.586310)
[09/16/21 09:18:21] INFO	11. Cabin_factor (2.101764)
[09/16/21 09:18:21] INFO	12. Embarked (2.086410)
[09/16/21 09:18:21] INFO	13. SibSp (2.085405)
[09/16/21 09:18:21] INFO	14. cluster_12 (1.876782)
[09/16/21 09:18:21] INFO	15. cluster_24 (1.263144)
[09/16/21 09:18:21] INFO	16. count_2 (1.004409)
[09/16/21 09:18:21] INFO	17. sum (0.955946)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: LGB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Fare (256.000000)
[09/16/21 09:18:21] INFO	2. sum (241.000000)
[09/16/21 09:18:21] INFO	3. Age (232.000000)
[09/16/21 09:18:21] INFO	4. std (201.000000)
[09/16/21 09:18:21] INFO	5. Ticket_factor (199.000000)
[09/16/21 09:18:21] INFO	6. Name_factor (175.000000)
[09/16/21 09:18:21] INFO	7. cluster_30 (53.000000)
[09/16/21 09:18:21] INFO	8. cluster_27 (46.000000)
[09/16/21 09:18:21] INFO	9. Sex_factor (43.000000)
[09/16/21 09:18:21] INFO	10. Pclass (43.000000)
[09/16/21 09:18:21] INFO	11. Cabin_factor (41.000000)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/16/21 09:18:21] INFO	Feature Importances for Algorithm: XGB
[09/16/21 09:18:21] INFO	Feature Ranking:
[09/16/21 09:18:21] INFO	1. Sex_factor (0.424644)
[09/16/21 09:18:21] INFO	2. Pclass (0.127452)
[09/16/21 09:18:21] INFO	3. Cabin_factor (0.081307)
[09/16/21 09:18:21] INFO	4. Age (0.051007)
[09/16/21 09:18:21] INFO	5. SibSp (0.049620)
[09/16/21 09:18:21] INFO	6. count_1 (0.046373)
[09/16/21 09:18:21] INFO	7. Embarked (0.046225)
[09/16/21 09:18:21] INFO	8. std (0.036262)
[09/16/21 09:18:21] INFO	9. cluster_30 (0.036076)
[09/16/21 09:18:21] INFO	10. Fare (0.032410)
[09/16/21 09:18:21] INFO	11. cluster_24 (0.021187)
[09/16/21 09:18:21] INFO	12. Name_factor (0.019312)
[09/16/21 09:18:21] INFO	13. sum (0.017784)
[09/16/21 09:18:21] INFO	14. cluster_15 (0.010340)
[09/16/21 09:18:21] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/16/21 09:18:22] INFO	================================================================================
[09/16/21 09:18:22] INFO	Saving Model Predictor
[09/16/21 09:18:22] INFO	Writing model predictor to ./model/model_20210916.pkl
[09/16/21 09:18:22] INFO	Saving Feature Map
[09/16/21 09:18:22] INFO	Writing feature map to ./model/feature_map_20210916.pkl
[09/16/21 09:18:22] INFO	Loading data from ./input/test_20210916.csv
[09/16/21 09:18:22] INFO	Saving Predictions
[09/16/21 09:18:22] INFO	Writing data frame to ./output/predictions_20210916.csv
[09/16/21 09:18:22] INFO	Saving Probabilities
[09/16/21 09:18:22] INFO	Writing data frame to ./output/probabilities_20210916.csv
[09/16/21 09:18:22] INFO	Saving Ranked Predictions
[09/16/21 09:18:22] INFO	Writing data frame to ./output/rankings_20210916.csv
[09/16/21 09:18:22] INFO	Saving Submission to ./output/submission_20210916.csv
[09/16/21 09:18:22] INFO	********************************************************************************
[09/16/21 09:18:22] INFO	AlphaPy End
[09/16/21 09:18:22] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	AlphaPy Start
[09/26/21 14:16:25] INFO	********************************************************************************
[09/26/21 14:16:25] INFO	Model Configuration
[09/26/21 14:16:25] INFO	No transforms Found
[09/26/21 14:16:25] INFO	MODEL PARAMETERS:
[09/26/21 14:16:25] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[09/26/21 14:16:25] INFO	calibration       = False
[09/26/21 14:16:25] INFO	cal_type          = sigmoid
[09/26/21 14:16:25] INFO	calibration_plot  = False
[09/26/21 14:16:25] INFO	clustering        = True
[09/26/21 14:16:25] INFO	cluster_inc       = 3
[09/26/21 14:16:25] INFO	cluster_max       = 30
[09/26/21 14:16:25] INFO	cluster_min       = 3
[09/26/21 14:16:25] INFO	confusion_matrix  = True
[09/26/21 14:16:25] INFO	counts            = True
[09/26/21 14:16:25] INFO	cv_folds          = 3
[09/26/21 14:16:25] INFO	directory         = .
[09/26/21 14:16:25] INFO	extension         = csv
[09/26/21 14:16:25] INFO	drop              = ['PassengerId']
[09/26/21 14:16:25] INFO	encoder           = <Encoders.target: 14>
[09/26/21 14:16:25] INFO	esr               = 20
[09/26/21 14:16:25] INFO	factors           = ['Embarked']
[09/26/21 14:16:25] INFO	features [X]      = *
[09/26/21 14:16:25] INFO	feature_selection = False
[09/26/21 14:16:25] INFO	fs_percentage     = 50
[09/26/21 14:16:25] INFO	fs_score_func     = <function f_classif at 0x7fb733133d30>
[09/26/21 14:16:25] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[09/26/21 14:16:25] INFO	grid_search       = True
[09/26/21 14:16:25] INFO	gs_iters          = 50
[09/26/21 14:16:25] INFO	gs_random         = True
[09/26/21 14:16:25] INFO	gs_sample         = False
[09/26/21 14:16:25] INFO	gs_sample_pct     = 0.200000
[09/26/21 14:16:25] INFO	importances       = True
[09/26/21 14:16:25] INFO	interactions      = False
[09/26/21 14:16:25] INFO	isomap            = False
[09/26/21 14:16:25] INFO	iso_components    = 2
[09/26/21 14:16:25] INFO	iso_neighbors     = 5
[09/26/21 14:16:25] INFO	isample_pct       = 10
[09/26/21 14:16:25] INFO	leaders           = []
[09/26/21 14:16:25] INFO	learning_curve    = True
[09/26/21 14:16:25] INFO	logtransform      = False
[09/26/21 14:16:25] INFO	lv_remove         = True
[09/26/21 14:16:25] INFO	lv_threshold      = 0.100000
[09/26/21 14:16:25] INFO	model_type        = <ModelType.classification: 1>
[09/26/21 14:16:25] INFO	n_estimators      = 51
[09/26/21 14:16:25] INFO	n_jobs            = -1
[09/26/21 14:16:25] INFO	ngrams_max        = 2
[09/26/21 14:16:25] INFO	numpy             = True
[09/26/21 14:16:25] INFO	pca               = False
[09/26/21 14:16:25] INFO	pca_inc           = 1
[09/26/21 14:16:25] INFO	pca_max           = 10
[09/26/21 14:16:25] INFO	pca_min           = 2
[09/26/21 14:16:25] INFO	pca_whiten        = False
[09/26/21 14:16:25] INFO	poly_degree       = 2
[09/26/21 14:16:25] INFO	pvalue_level      = 0.010000
[09/26/21 14:16:25] INFO	rfe               = True
[09/26/21 14:16:25] INFO	rfe_step          = 3
[09/26/21 14:16:25] INFO	roc_curve         = True
[09/26/21 14:16:25] INFO	rounding          = 2
[09/26/21 14:16:25] INFO	sampling          = False
[09/26/21 14:16:25] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[09/26/21 14:16:25] INFO	sampling_ratio    = 0.500000
[09/26/21 14:16:25] INFO	scaler_option     = True
[09/26/21 14:16:25] INFO	scaler_type       = <Scalers.standard: 2>
[09/26/21 14:16:25] INFO	scipy             = False
[09/26/21 14:16:25] INFO	scorer            = roc_auc
[09/26/21 14:16:25] INFO	seed              = 42
[09/26/21 14:16:25] INFO	sentinel          = -1
[09/26/21 14:16:25] INFO	separator         = ,
[09/26/21 14:16:25] INFO	shuffle           = False
[09/26/21 14:16:25] INFO	split             = 0.400000
[09/26/21 14:16:25] INFO	submission_file   = gender_submission
[09/26/21 14:16:25] INFO	submit_probas     = False
[09/26/21 14:16:25] INFO	target [y]        = Survived
[09/26/21 14:16:25] INFO	target_value      = 1
[09/26/21 14:16:25] INFO	transforms        = None
[09/26/21 14:16:25] INFO	tsne              = False
[09/26/21 14:16:25] INFO	tsne_components   = 2
[09/26/21 14:16:25] INFO	tsne_learn_rate   = 1000.000000
[09/26/21 14:16:25] INFO	tsne_perplexity   = 30.000000
[09/26/21 14:16:25] INFO	vectorize         = False
[09/26/21 14:16:25] INFO	verbosity         = 0
[09/26/21 14:16:25] INFO	Creating Model
[09/26/21 14:16:25] INFO	Calling Pipeline
[09/26/21 14:16:25] INFO	Training Pipeline
[09/26/21 14:16:25] INFO	Loading Data
[09/26/21 14:16:25] INFO	Loading data from ./input/train.csv
[09/26/21 14:16:25] INFO	Found target Survived in data frame
[09/26/21 14:16:25] INFO	Labels (y) found for Partition.train
[09/26/21 14:16:25] INFO	Loading Data
[09/26/21 14:16:25] INFO	Loading data from ./input/test.csv
[09/26/21 14:16:25] INFO	Target Survived not found in Partition.test
[09/26/21 14:16:25] INFO	Saving New Features in Model
[09/26/21 14:16:25] INFO	Original Feature Statistics
[09/26/21 14:16:25] INFO	Number of Training Rows    : 891
[09/26/21 14:16:25] INFO	Number of Training Columns : 11
[09/26/21 14:16:25] INFO	Unique Training Values for Survived : [0 1]
[09/26/21 14:16:25] INFO	Unique Training Counts for Survived : [549 342]
[09/26/21 14:16:25] INFO	Number of Testing Rows     : 418
[09/26/21 14:16:25] INFO	Number of Testing Columns  : 11
[09/26/21 14:16:25] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[09/26/21 14:16:25] INFO	Feature Count     : 11
[09/26/21 14:16:25] INFO	Applying transforms
[09/26/21 14:16:25] INFO	No transforms Specified
[09/26/21 14:16:25] INFO	New Feature Count : 11
[09/26/21 14:16:25] INFO	Dropping Features: ['PassengerId']
[09/26/21 14:16:25] INFO	Original Feature Count : 11
[09/26/21 14:16:25] INFO	Reduced Feature Count  : 10
[09/26/21 14:16:25] INFO	Writing data frame to ./input/train_20210926.csv
[09/26/21 14:16:25] INFO	Writing data frame to ./input/test_20210926.csv
[09/26/21 14:16:25] INFO	Creating Cross-Tabulations
[09/26/21 14:16:25] INFO	Creating crosstabs for feature Embarked
[09/26/21 14:16:25] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[09/26/21 14:16:25] INFO	Feature Count     : 10
[09/26/21 14:16:25] INFO	Creating Count Features
[09/26/21 14:16:25] INFO	NA Counts
[09/26/21 14:16:25] INFO	Number Counts
[09/26/21 14:16:25] INFO	New Feature Count : 21
[09/26/21 14:16:25] INFO	Creating Base Features
[09/26/21 14:16:25] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[09/26/21 14:16:25] INFO	Feature 2: Name => Factorization
[09/26/21 14:16:25] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[09/26/21 14:16:25] INFO	Feature 3: Sex => Factorization
[09/26/21 14:16:25] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[09/26/21 14:16:25] INFO	Feature 7: Ticket => Factorization
[09/26/21 14:16:25] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[09/26/21 14:16:25] INFO	Feature 9: Cabin => Factorization
[09/26/21 14:16:25] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[09/26/21 14:16:25] INFO	Encoding: Encoders.target
[09/26/21 14:16:25] INFO	Fitting training features for Embarked
[09/26/21 14:16:25] INFO	Transforming testing features for Embarked
[09/26/21 14:16:25] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[09/26/21 14:16:25] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[09/26/21 14:16:25] INFO	New Feature Count : 21
[09/26/21 14:16:25] INFO	Scaling Base Features
[09/26/21 14:16:25] INFO	Creating NumPy Features
[09/26/21 14:16:25] INFO	NumPy Feature: sum
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: mean
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: std
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature: var
[09/26/21 14:16:25] INFO	    Imputation for Data Type float64: Median Strategy
[09/26/21 14:16:25] INFO	NumPy Feature Count : 4
[09/26/21 14:16:25] INFO	New Feature Count : 25
[09/26/21 14:16:25] INFO	Creating Clustering Features
[09/26/21 14:16:25] INFO	Cluster Minimum   : 3
[09/26/21 14:16:25] INFO	Cluster Maximum   : 30
[09/26/21 14:16:25] INFO	Cluster Increment : 3
[09/26/21 14:16:25] INFO	k = 3
[09/26/21 14:16:26] INFO	k = 6
[09/26/21 14:16:26] INFO	k = 9
[09/26/21 14:16:26] INFO	k = 12
[09/26/21 14:16:26] INFO	k = 15
[09/26/21 14:16:26] INFO	k = 18
[09/26/21 14:16:26] INFO	k = 21
[09/26/21 14:16:26] INFO	k = 24
[09/26/21 14:16:26] INFO	k = 27
[09/26/21 14:16:26] INFO	k = 30
[09/26/21 14:16:26] INFO	Clustering Feature Count : 10
[09/26/21 14:16:26] INFO	New Feature Count : 35
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Creating Interactions
[09/26/21 14:16:26] INFO	Initial Feature Count  : 35
[09/26/21 14:16:26] INFO	Skipping Interactions
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Removing Low-Variance Features
[09/26/21 14:16:26] INFO	Low-Variance Threshold  : 0.10
[09/26/21 14:16:26] INFO	Original Feature Count  : 35
[09/26/21 14:16:26] INFO	Reduced Feature Count   : 35
[09/26/21 14:16:26] INFO	Saving New Features in Model
[09/26/21 14:16:26] INFO	Skipping Shuffling
[09/26/21 14:16:26] INFO	Skipping Sampling
[09/26/21 14:16:26] INFO	Getting All Estimators
[09/26/21 14:16:26] INFO	Algorithm Configuration
[09/26/21 14:16:27] INFO	Selecting Models
[09/26/21 14:16:27] INFO	Algorithm: CATB
[09/26/21 14:16:27] INFO	Fitting Initial Model
[09/26/21 14:16:27] INFO	Cross-Validation
[09/26/21 14:16:28] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[09/26/21 14:16:28] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:31] INFO	RFECV took 2.48 seconds for step 3 and 3 folds
[09/26/21 14:16:31] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[09/26/21 14:16:31] INFO	No grid is defined for grid search
[09/26/21 14:16:31] INFO	Final Model Predictions for CATB
[09/26/21 14:16:31] INFO	Skipping Calibration
[09/26/21 14:16:31] INFO	Making Predictions
[09/26/21 14:16:31] INFO	Predictions Complete
[09/26/21 14:16:31] INFO	Algorithm: LGB
[09/26/21 14:16:31] INFO	Fitting Initial Model
[09/26/21 14:16:31] INFO	Cross-Validation
[09/26/21 14:16:32] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[09/26/21 14:16:32] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:34] INFO	RFECV took 2.21 seconds for step 3 and 3 folds
[09/26/21 14:16:34] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[09/26/21 14:16:34] INFO	No grid is defined for grid search
[09/26/21 14:16:34] INFO	Final Model Predictions for LGB
[09/26/21 14:16:34] INFO	Skipping Calibration
[09/26/21 14:16:34] INFO	Making Predictions
[09/26/21 14:16:34] INFO	Predictions Complete
[09/26/21 14:16:34] INFO	Algorithm: XGB
[09/26/21 14:16:34] INFO	Fitting Initial Model
[09/26/21 14:16:34] INFO	Cross-Validation
[09/26/21 14:16:35] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[09/26/21 14:16:35] INFO	Recursive Feature Elimination with CV
[09/26/21 14:16:38] INFO	RFECV took 2.91 seconds for step 3 and 3 folds
[09/26/21 14:16:38] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[09/26/21 14:16:38] INFO	Randomized Grid Search
[09/26/21 14:17:47] INFO	Grid Search took 69.67 seconds for 50 candidate parameter settings.
[09/26/21 14:17:47] INFO	Model with rank: 1
[09/26/21 14:17:47] INFO	Mean validation score: 0.872 (std: 0.019)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[09/26/21 14:17:47] INFO	Model with rank: 2
[09/26/21 14:17:47] INFO	Mean validation score: 0.869 (std: 0.021)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[09/26/21 14:17:47] INFO	Model with rank: 3
[09/26/21 14:17:47] INFO	Mean validation score: 0.869 (std: 0.024)
[09/26/21 14:17:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[09/26/21 14:17:47] INFO	Algorithm: XGB, Best Score: 0.8718, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[09/26/21 14:17:47] INFO	Final Model Predictions for XGB
[09/26/21 14:17:47] INFO	Skipping Calibration
[09/26/21 14:17:47] INFO	Making Predictions
[09/26/21 14:17:47] INFO	Predictions Complete
[09/26/21 14:17:47] INFO	Blending Models
[09/26/21 14:17:47] INFO	Blending Start: 2021-09-26 14:17:47.752878
[09/26/21 14:17:47] INFO	Blending Complete: 0:00:00.011710
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Metrics for: Partition.train
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: CATB
[09/26/21 14:17:47] INFO	accuracy: 0.8585858585858586
[09/26/21 14:17:47] INFO	average_precision: 0.9113351686222868
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.8378391333525069
[09/26/21 14:17:47] INFO	brier_score_loss: 0.10043404518351136
[09/26/21 14:17:47] INFO	cohen_kappa: 0.6932572665125658
[09/26/21 14:17:47] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[09/26/21 14:17:47] INFO	f1: 0.8025078369905956
[09/26/21 14:17:47] INFO	neg_log_loss: 0.3371948718196211
[09/26/21 14:17:47] INFO	precision: 0.8648648648648649
[09/26/21 14:17:47] INFO	recall: 0.7485380116959064
[09/26/21 14:17:47] INFO	roc_auc: 0.9297979313797549
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: LGB
[09/26/21 14:17:47] INFO	accuracy: 0.9730639730639731
[09/26/21 14:17:47] INFO	average_precision: 0.9961113207491221
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.9687709711437062
[09/26/21 14:17:47] INFO	brier_score_loss: 0.032809498448974184
[09/26/21 14:17:47] INFO	cohen_kappa: 0.9427387092109702
[09/26/21 14:17:47] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[09/26/21 14:17:47] INFO	f1: 0.9643916913946586
[09/26/21 14:17:47] INFO	neg_log_loss: 0.1458307566281259
[09/26/21 14:17:47] INFO	precision: 0.9789156626506024
[09/26/21 14:17:47] INFO	recall: 0.9502923976608187
[09/26/21 14:17:47] INFO	roc_auc: 0.9974861257576241
[09/26/21 14:17:47] INFO	--------------------------------------------------------------------------------
[09/26/21 14:17:47] INFO	Algorithm: XGB
[09/26/21 14:17:47] INFO	accuracy: 0.9034792368125701
[09/26/21 14:17:47] INFO	average_precision: 0.9420220304254212
[09/26/21 14:17:47] INFO	balanced_accuracy: 0.8852938356821014
[09/26/21 14:17:47] INFO	brier_score_loss: 0.09082637971296194
[09/26/21 14:17:47] INFO	cohen_kappa: 0.7906359120641322
[09/26/21 14:17:47] INFO	confusion_matrix: [[529  20]
 [ 66 276]]
[09/26/21 14:17:47] INFO	f1: 0.865203761755486
[09/26/21 14:17:47] INFO	neg_log_loss: 0.3250040239189343
[09/26/21 14:17:47] INFO	precision: 0.9324324324324325
[09/26/21 14:17:47] INFO	recall: 0.8070175438596491
[09/26/21 14:17:47] INFO	roc_auc: 0.9562149149437041
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Metrics for: Partition.test
[09/26/21 14:17:47] INFO	No labels for generating Partition.test metrics
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Selecting Best Model
[09/26/21 14:17:47] INFO	Scoring for: Partition.train
[09/26/21 14:17:47] INFO	Best Model Selection Start: 2021-09-26 14:17:47.786239
[09/26/21 14:17:47] INFO	Scoring CATB Model
[09/26/21 14:17:47] INFO	Scoring LGB Model
[09/26/21 14:17:47] INFO	Scoring XGB Model
[09/26/21 14:17:47] INFO	Scoring BLEND Model
[09/26/21 14:17:47] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[09/26/21 14:17:47] INFO	Best Model Selection Complete: 0:00:00.000189
[09/26/21 14:17:47] INFO	================================================================================
[09/26/21 14:17:47] INFO	Generating Plots for partition: train
[09/26/21 14:17:47] INFO	Generating Calibration Plot
[09/26/21 14:17:47] INFO	Calibration for Algorithm: CATB
[09/26/21 14:17:47] INFO	Calibration for Algorithm: LGB
[09/26/21 14:17:47] INFO	Calibration for Algorithm: XGB
[09/26/21 14:17:47] INFO	Writing plot to ./plots/calibration_train.png
[09/26/21 14:17:47] INFO	Generating Confusion Matrices
[09/26/21 14:17:47] INFO	Confusion Matrix for Algorithm: CATB
[09/26/21 14:17:47] INFO	Confusion Matrix:
[09/26/21 14:17:47] INFO	[[509  40]
 [ 86 256]]
[09/26/21 14:17:47] INFO	Writing plot to ./plots/confusion_train_CATB.png
[09/26/21 14:17:48] INFO	Confusion Matrix for Algorithm: LGB
[09/26/21 14:17:48] INFO	Confusion Matrix:
[09/26/21 14:17:48] INFO	[[542   7]
 [ 17 325]]
[09/26/21 14:17:48] INFO	Writing plot to ./plots/confusion_train_LGB.png
[09/26/21 14:17:48] INFO	Confusion Matrix for Algorithm: XGB
[09/26/21 14:17:48] INFO	Confusion Matrix:
[09/26/21 14:17:48] INFO	[[529  20]
 [ 66 276]]
[09/26/21 14:17:48] INFO	Writing plot to ./plots/confusion_train_XGB.png
[09/26/21 14:17:48] INFO	Generating ROC Curves
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: CATB
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: LGB
[09/26/21 14:17:48] INFO	ROC Curve for Algorithm: XGB
[09/26/21 14:17:48] INFO	Writing plot to ./plots/roc_curve_train.png
[09/26/21 14:17:48] INFO	Generating Learning Curves
[09/26/21 14:17:48] INFO	Algorithm Configuration
[09/26/21 14:17:48] INFO	Learning Curve for Algorithm: CATB
[09/26/21 14:17:48] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[09/26/21 14:17:48] INFO	Learning Curve for Algorithm: LGB
[09/26/21 14:17:50] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[09/26/21 14:17:50] INFO	Learning Curve for Algorithm: XGB
[09/26/21 14:17:51] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[09/26/21 14:17:51] INFO	Generating Feature Importance Plots
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: CATB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Sex_factor (45.178104)
[09/26/21 14:17:51] INFO	2. Pclass (13.721171)
[09/26/21 14:17:51] INFO	3. Age (6.651788)
[09/26/21 14:17:51] INFO	4. Fare (4.529770)
[09/26/21 14:17:51] INFO	5. var (3.586590)
[09/26/21 14:17:51] INFO	6. std (3.492385)
[09/26/21 14:17:51] INFO	7. Ticket_factor (3.315046)
[09/26/21 14:17:51] INFO	8. cluster_30 (2.831587)
[09/26/21 14:17:51] INFO	9. mean (2.733389)
[09/26/21 14:17:51] INFO	10. Name_factor (2.586310)
[09/26/21 14:17:51] INFO	11. Cabin_factor (2.101764)
[09/26/21 14:17:51] INFO	12. Embarked (2.086410)
[09/26/21 14:17:51] INFO	13. SibSp (2.085405)
[09/26/21 14:17:51] INFO	14. cluster_12 (1.876782)
[09/26/21 14:17:51] INFO	15. cluster_24 (1.263144)
[09/26/21 14:17:51] INFO	16. count_2 (1.004409)
[09/26/21 14:17:51] INFO	17. sum (0.955946)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: LGB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Fare (256.000000)
[09/26/21 14:17:51] INFO	2. sum (241.000000)
[09/26/21 14:17:51] INFO	3. Age (232.000000)
[09/26/21 14:17:51] INFO	4. std (201.000000)
[09/26/21 14:17:51] INFO	5. Ticket_factor (199.000000)
[09/26/21 14:17:51] INFO	6. Name_factor (175.000000)
[09/26/21 14:17:51] INFO	7. cluster_30 (53.000000)
[09/26/21 14:17:51] INFO	8. cluster_27 (46.000000)
[09/26/21 14:17:51] INFO	9. Sex_factor (43.000000)
[09/26/21 14:17:51] INFO	10. Pclass (43.000000)
[09/26/21 14:17:51] INFO	11. Cabin_factor (41.000000)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[09/26/21 14:17:51] INFO	Feature Importances for Algorithm: XGB
[09/26/21 14:17:51] INFO	Feature Ranking:
[09/26/21 14:17:51] INFO	1. Sex_factor (0.424644)
[09/26/21 14:17:51] INFO	2. Pclass (0.127452)
[09/26/21 14:17:51] INFO	3. Cabin_factor (0.081307)
[09/26/21 14:17:51] INFO	4. Age (0.051007)
[09/26/21 14:17:51] INFO	5. SibSp (0.049620)
[09/26/21 14:17:51] INFO	6. count_1 (0.046373)
[09/26/21 14:17:51] INFO	7. Embarked (0.046225)
[09/26/21 14:17:51] INFO	8. std (0.036262)
[09/26/21 14:17:51] INFO	9. cluster_30 (0.036076)
[09/26/21 14:17:51] INFO	10. Fare (0.032410)
[09/26/21 14:17:51] INFO	11. cluster_24 (0.021187)
[09/26/21 14:17:51] INFO	12. Name_factor (0.019312)
[09/26/21 14:17:51] INFO	13. sum (0.017784)
[09/26/21 14:17:51] INFO	14. cluster_15 (0.010340)
[09/26/21 14:17:51] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[09/26/21 14:17:51] INFO	================================================================================
[09/26/21 14:17:51] INFO	Saving Model Predictor
[09/26/21 14:17:51] INFO	Writing model predictor to ./model/model_20210926.pkl
[09/26/21 14:17:51] INFO	Saving Feature Map
[09/26/21 14:17:51] INFO	Writing feature map to ./model/feature_map_20210926.pkl
[09/26/21 14:17:51] INFO	Loading data from ./input/test_20210926.csv
[09/26/21 14:17:51] INFO	Saving Predictions
[09/26/21 14:17:51] INFO	Writing data frame to ./output/predictions_20210926.csv
[09/26/21 14:17:51] INFO	Saving Probabilities
[09/26/21 14:17:51] INFO	Writing data frame to ./output/probabilities_20210926.csv
[09/26/21 14:17:51] INFO	Saving Ranked Predictions
[09/26/21 14:17:51] INFO	Writing data frame to ./output/rankings_20210926.csv
[09/26/21 14:17:51] INFO	Saving Submission to ./output/submission_20210926.csv
[09/26/21 14:17:51] INFO	********************************************************************************
[09/26/21 14:17:51] INFO	AlphaPy End
[09/26/21 14:17:51] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	AlphaPy Start
[10/05/21 17:04:56] INFO	********************************************************************************
[10/05/21 17:04:56] INFO	Model Configuration
[10/05/21 17:04:56] INFO	No transforms Found
[10/05/21 17:04:56] INFO	MODEL PARAMETERS:
[10/05/21 17:04:56] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/05/21 17:04:56] INFO	calibration       = False
[10/05/21 17:04:56] INFO	cal_type          = sigmoid
[10/05/21 17:04:56] INFO	calibration_plot  = False
[10/05/21 17:04:56] INFO	clustering        = True
[10/05/21 17:04:56] INFO	cluster_inc       = 3
[10/05/21 17:04:56] INFO	cluster_max       = 30
[10/05/21 17:04:56] INFO	cluster_min       = 3
[10/05/21 17:04:56] INFO	confusion_matrix  = True
[10/05/21 17:04:56] INFO	counts            = True
[10/05/21 17:04:56] INFO	cv_folds          = 3
[10/05/21 17:04:56] INFO	directory         = .
[10/05/21 17:04:56] INFO	extension         = csv
[10/05/21 17:04:56] INFO	drop              = ['PassengerId']
[10/05/21 17:04:56] INFO	encoder           = <Encoders.target: 14>
[10/05/21 17:04:56] INFO	esr               = 20
[10/05/21 17:04:56] INFO	factors           = ['Embarked']
[10/05/21 17:04:56] INFO	features [X]      = *
[10/05/21 17:04:56] INFO	feature_selection = False
[10/05/21 17:04:56] INFO	fs_percentage     = 50
[10/05/21 17:04:56] INFO	fs_score_func     = <function f_classif at 0x7f96c0915f70>
[10/05/21 17:04:56] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/05/21 17:04:56] INFO	grid_search       = True
[10/05/21 17:04:56] INFO	gs_iters          = 50
[10/05/21 17:04:56] INFO	gs_random         = True
[10/05/21 17:04:56] INFO	gs_sample         = False
[10/05/21 17:04:56] INFO	gs_sample_pct     = 0.200000
[10/05/21 17:04:56] INFO	importances       = True
[10/05/21 17:04:56] INFO	interactions      = False
[10/05/21 17:04:56] INFO	isomap            = False
[10/05/21 17:04:56] INFO	iso_components    = 2
[10/05/21 17:04:56] INFO	iso_neighbors     = 5
[10/05/21 17:04:56] INFO	isample_pct       = 10
[10/05/21 17:04:56] INFO	leaders           = []
[10/05/21 17:04:56] INFO	learning_curve    = True
[10/05/21 17:04:56] INFO	logtransform      = False
[10/05/21 17:04:56] INFO	lv_remove         = True
[10/05/21 17:04:56] INFO	lv_threshold      = 0.100000
[10/05/21 17:04:56] INFO	model_type        = <ModelType.classification: 1>
[10/05/21 17:04:56] INFO	n_estimators      = 51
[10/05/21 17:04:56] INFO	n_jobs            = -1
[10/05/21 17:04:56] INFO	ngrams_max        = 2
[10/05/21 17:04:56] INFO	numpy             = True
[10/05/21 17:04:56] INFO	pca               = False
[10/05/21 17:04:56] INFO	pca_inc           = 1
[10/05/21 17:04:56] INFO	pca_max           = 10
[10/05/21 17:04:56] INFO	pca_min           = 2
[10/05/21 17:04:56] INFO	pca_whiten        = False
[10/05/21 17:04:56] INFO	poly_degree       = 2
[10/05/21 17:04:56] INFO	pvalue_level      = 0.010000
[10/05/21 17:04:56] INFO	rfe               = True
[10/05/21 17:04:56] INFO	rfe_step          = 3
[10/05/21 17:04:56] INFO	roc_curve         = True
[10/05/21 17:04:56] INFO	rounding          = 2
[10/05/21 17:04:56] INFO	sampling          = False
[10/05/21 17:04:56] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/05/21 17:04:56] INFO	sampling_ratio    = 0.500000
[10/05/21 17:04:56] INFO	scaler_option     = True
[10/05/21 17:04:56] INFO	scaler_type       = <Scalers.standard: 2>
[10/05/21 17:04:56] INFO	scipy             = False
[10/05/21 17:04:56] INFO	scorer            = roc_auc
[10/05/21 17:04:56] INFO	seed              = 42
[10/05/21 17:04:56] INFO	sentinel          = -1
[10/05/21 17:04:56] INFO	separator         = ,
[10/05/21 17:04:56] INFO	shuffle           = False
[10/05/21 17:04:56] INFO	split             = 0.400000
[10/05/21 17:04:56] INFO	submission_file   = gender_submission
[10/05/21 17:04:56] INFO	submit_probas     = False
[10/05/21 17:04:56] INFO	target [y]        = Survived
[10/05/21 17:04:56] INFO	target_value      = 1
[10/05/21 17:04:56] INFO	transforms        = None
[10/05/21 17:04:56] INFO	tsne              = False
[10/05/21 17:04:56] INFO	tsne_components   = 2
[10/05/21 17:04:56] INFO	tsne_learn_rate   = 1000.000000
[10/05/21 17:04:56] INFO	tsne_perplexity   = 30.000000
[10/05/21 17:04:56] INFO	vectorize         = False
[10/05/21 17:04:56] INFO	verbosity         = 0
[10/05/21 17:04:56] INFO	Creating Model
[10/05/21 17:04:56] INFO	Calling Pipeline
[10/05/21 17:04:56] INFO	Training Pipeline
[10/05/21 17:04:56] INFO	Loading Data
[10/05/21 17:04:56] INFO	Loading data from ./input/train.csv
[10/05/21 17:04:56] INFO	Found target Survived in data frame
[10/05/21 17:04:56] INFO	Labels (y) found for Partition.train
[10/05/21 17:04:56] INFO	Loading Data
[10/05/21 17:04:56] INFO	Loading data from ./input/test.csv
[10/05/21 17:04:56] INFO	Target Survived not found in Partition.test
[10/05/21 17:04:56] INFO	Saving New Features in Model
[10/05/21 17:04:56] INFO	Original Feature Statistics
[10/05/21 17:04:56] INFO	Number of Training Rows    : 891
[10/05/21 17:04:56] INFO	Number of Training Columns : 11
[10/05/21 17:04:56] INFO	Unique Training Values for Survived : [0 1]
[10/05/21 17:04:56] INFO	Unique Training Counts for Survived : [549 342]
[10/05/21 17:04:56] INFO	Number of Testing Rows     : 418
[10/05/21 17:04:56] INFO	Number of Testing Columns  : 11
[10/05/21 17:04:56] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:04:56] INFO	Feature Count     : 11
[10/05/21 17:04:56] INFO	Applying transforms
[10/05/21 17:04:56] INFO	No transforms Specified
[10/05/21 17:04:56] INFO	New Feature Count : 11
[10/05/21 17:04:56] INFO	Dropping Features: ['PassengerId']
[10/05/21 17:04:56] INFO	Original Feature Count : 11
[10/05/21 17:04:56] INFO	Reduced Feature Count  : 10
[10/05/21 17:04:56] INFO	Writing data frame to ./input/train_20211005.csv
[10/05/21 17:04:56] INFO	Writing data frame to ./input/test_20211005.csv
[10/05/21 17:04:56] INFO	Creating Cross-Tabulations
[10/05/21 17:04:56] INFO	Creating crosstabs for feature Embarked
[10/05/21 17:04:56] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:04:56] INFO	Feature Count     : 10
[10/05/21 17:04:56] INFO	Creating Count Features
[10/05/21 17:04:56] INFO	NA Counts
[10/05/21 17:04:56] INFO	Number Counts
[10/05/21 17:04:56] INFO	New Feature Count : 21
[10/05/21 17:04:56] INFO	Creating Base Features
[10/05/21 17:04:56] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/05/21 17:04:56] INFO	Feature 2: Name => Factorization
[10/05/21 17:04:56] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/05/21 17:04:56] INFO	Feature 3: Sex => Factorization
[10/05/21 17:04:56] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/05/21 17:04:56] INFO	Feature 7: Ticket => Factorization
[10/05/21 17:04:56] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/05/21 17:04:56] INFO	Feature 9: Cabin => Factorization
[10/05/21 17:04:56] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/05/21 17:04:56] INFO	Encoding: Encoders.target
[10/05/21 17:04:56] INFO	Fitting training features for Embarked
[10/05/21 17:04:56] INFO	Transforming testing features for Embarked
[10/05/21 17:04:56] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:04:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:04:56] INFO	New Feature Count : 21
[10/05/21 17:04:56] INFO	Scaling Base Features
[10/05/21 17:04:56] INFO	Creating NumPy Features
[10/05/21 17:04:56] INFO	NumPy Feature: sum
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: mean
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: std
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature: var
[10/05/21 17:04:56] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:04:56] INFO	NumPy Feature Count : 4
[10/05/21 17:04:56] INFO	New Feature Count : 25
[10/05/21 17:04:56] INFO	Creating Clustering Features
[10/05/21 17:04:56] INFO	Cluster Minimum   : 3
[10/05/21 17:04:56] INFO	Cluster Maximum   : 30
[10/05/21 17:04:56] INFO	Cluster Increment : 3
[10/05/21 17:04:56] INFO	k = 3
[10/05/21 17:04:57] INFO	k = 6
[10/05/21 17:04:57] INFO	k = 9
[10/05/21 17:04:57] INFO	k = 12
[10/05/21 17:04:57] INFO	k = 15
[10/05/21 17:04:57] INFO	k = 18
[10/05/21 17:04:57] INFO	k = 21
[10/05/21 17:04:57] INFO	k = 24
[10/05/21 17:04:57] INFO	k = 27
[10/05/21 17:04:57] INFO	k = 30
[10/05/21 17:04:57] INFO	Clustering Feature Count : 10
[10/05/21 17:04:57] INFO	New Feature Count : 35
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Creating Interactions
[10/05/21 17:04:57] INFO	Initial Feature Count  : 35
[10/05/21 17:04:57] INFO	Skipping Interactions
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Removing Low-Variance Features
[10/05/21 17:04:57] INFO	Low-Variance Threshold  : 0.10
[10/05/21 17:04:57] INFO	Original Feature Count  : 35
[10/05/21 17:04:57] INFO	Reduced Feature Count   : 35
[10/05/21 17:04:57] INFO	Saving New Features in Model
[10/05/21 17:04:57] INFO	Skipping Shuffling
[10/05/21 17:04:57] INFO	Skipping Sampling
[10/05/21 17:04:57] INFO	Getting All Estimators
[10/05/21 17:04:57] INFO	Algorithm Configuration
[10/05/21 17:04:59] INFO	Selecting Models
[10/05/21 17:04:59] INFO	Algorithm: CATB
[10/05/21 17:04:59] INFO	Fitting Initial Model
[10/05/21 17:04:59] INFO	Cross-Validation
[10/05/21 17:05:01] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/05/21 17:05:01] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:03] INFO	RFECV took 2.47 seconds for step 3 and 3 folds
[10/05/21 17:05:03] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/05/21 17:05:03] INFO	No grid is defined for grid search
[10/05/21 17:05:03] INFO	Final Model Predictions for CATB
[10/05/21 17:05:03] INFO	Skipping Calibration
[10/05/21 17:05:03] INFO	Making Predictions
[10/05/21 17:05:03] INFO	Predictions Complete
[10/05/21 17:05:03] INFO	Algorithm: LGB
[10/05/21 17:05:03] INFO	Fitting Initial Model
[10/05/21 17:05:03] INFO	Cross-Validation
[10/05/21 17:05:04] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/05/21 17:05:04] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:07] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[10/05/21 17:05:07] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/05/21 17:05:07] INFO	No grid is defined for grid search
[10/05/21 17:05:07] INFO	Final Model Predictions for LGB
[10/05/21 17:05:07] INFO	Skipping Calibration
[10/05/21 17:05:07] INFO	Making Predictions
[10/05/21 17:05:07] INFO	Predictions Complete
[10/05/21 17:05:07] INFO	Algorithm: XGB
[10/05/21 17:05:07] INFO	Fitting Initial Model
[10/05/21 17:05:07] INFO	Cross-Validation
[10/05/21 17:05:07] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/05/21 17:05:07] INFO	Recursive Feature Elimination with CV
[10/05/21 17:05:10] INFO	RFECV took 2.87 seconds for step 3 and 3 folds
[10/05/21 17:05:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/05/21 17:05:10] INFO	Randomized Grid Search
[10/05/21 17:05:57] INFO	********************************************************************************
[10/05/21 17:05:57] INFO	AlphaPy Start
[10/05/21 17:05:57] INFO	********************************************************************************
[10/05/21 17:05:57] INFO	Model Configuration
[10/05/21 17:05:57] INFO	No transforms Found
[10/05/21 17:05:57] INFO	MODEL PARAMETERS:
[10/05/21 17:05:57] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/05/21 17:05:57] INFO	calibration       = False
[10/05/21 17:05:57] INFO	cal_type          = sigmoid
[10/05/21 17:05:57] INFO	calibration_plot  = False
[10/05/21 17:05:57] INFO	clustering        = True
[10/05/21 17:05:57] INFO	cluster_inc       = 3
[10/05/21 17:05:57] INFO	cluster_max       = 30
[10/05/21 17:05:57] INFO	cluster_min       = 3
[10/05/21 17:05:57] INFO	confusion_matrix  = True
[10/05/21 17:05:57] INFO	counts            = True
[10/05/21 17:05:57] INFO	cv_folds          = 3
[10/05/21 17:05:57] INFO	directory         = .
[10/05/21 17:05:57] INFO	extension         = csv
[10/05/21 17:05:57] INFO	drop              = ['PassengerId']
[10/05/21 17:05:57] INFO	encoder           = <Encoders.target: 14>
[10/05/21 17:05:57] INFO	esr               = 20
[10/05/21 17:05:57] INFO	factors           = ['Embarked']
[10/05/21 17:05:57] INFO	features [X]      = *
[10/05/21 17:05:57] INFO	feature_selection = False
[10/05/21 17:05:57] INFO	fs_percentage     = 50
[10/05/21 17:05:57] INFO	fs_score_func     = <function f_classif at 0x7f916b19df70>
[10/05/21 17:05:57] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/05/21 17:05:57] INFO	grid_search       = True
[10/05/21 17:05:57] INFO	gs_iters          = 50
[10/05/21 17:05:57] INFO	gs_random         = True
[10/05/21 17:05:57] INFO	gs_sample         = False
[10/05/21 17:05:57] INFO	gs_sample_pct     = 0.200000
[10/05/21 17:05:57] INFO	importances       = True
[10/05/21 17:05:57] INFO	interactions      = False
[10/05/21 17:05:57] INFO	isomap            = False
[10/05/21 17:05:57] INFO	iso_components    = 2
[10/05/21 17:05:57] INFO	iso_neighbors     = 5
[10/05/21 17:05:57] INFO	isample_pct       = 10
[10/05/21 17:05:57] INFO	leaders           = []
[10/05/21 17:05:57] INFO	learning_curve    = True
[10/05/21 17:05:57] INFO	logtransform      = False
[10/05/21 17:05:57] INFO	lv_remove         = True
[10/05/21 17:05:57] INFO	lv_threshold      = 0.100000
[10/05/21 17:05:57] INFO	model_type        = <ModelType.classification: 1>
[10/05/21 17:05:57] INFO	n_estimators      = 51
[10/05/21 17:05:57] INFO	n_jobs            = -1
[10/05/21 17:05:57] INFO	ngrams_max        = 2
[10/05/21 17:05:57] INFO	numpy             = True
[10/05/21 17:05:57] INFO	pca               = False
[10/05/21 17:05:57] INFO	pca_inc           = 1
[10/05/21 17:05:57] INFO	pca_max           = 10
[10/05/21 17:05:57] INFO	pca_min           = 2
[10/05/21 17:05:57] INFO	pca_whiten        = False
[10/05/21 17:05:57] INFO	poly_degree       = 2
[10/05/21 17:05:57] INFO	pvalue_level      = 0.010000
[10/05/21 17:05:57] INFO	rfe               = True
[10/05/21 17:05:57] INFO	rfe_step          = 3
[10/05/21 17:05:57] INFO	roc_curve         = True
[10/05/21 17:05:57] INFO	rounding          = 2
[10/05/21 17:05:57] INFO	sampling          = False
[10/05/21 17:05:57] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/05/21 17:05:57] INFO	sampling_ratio    = 0.500000
[10/05/21 17:05:57] INFO	scaler_option     = True
[10/05/21 17:05:57] INFO	scaler_type       = <Scalers.standard: 2>
[10/05/21 17:05:57] INFO	scipy             = False
[10/05/21 17:05:57] INFO	scorer            = roc_auc
[10/05/21 17:05:57] INFO	seed              = 42
[10/05/21 17:05:57] INFO	sentinel          = -1
[10/05/21 17:05:57] INFO	separator         = ,
[10/05/21 17:05:57] INFO	shuffle           = False
[10/05/21 17:05:57] INFO	split             = 0.400000
[10/05/21 17:05:57] INFO	submission_file   = gender_submission
[10/05/21 17:05:57] INFO	submit_probas     = False
[10/05/21 17:05:57] INFO	target [y]        = Survived
[10/05/21 17:05:57] INFO	target_value      = 1
[10/05/21 17:05:57] INFO	transforms        = None
[10/05/21 17:05:57] INFO	tsne              = False
[10/05/21 17:05:57] INFO	tsne_components   = 2
[10/05/21 17:05:57] INFO	tsne_learn_rate   = 1000.000000
[10/05/21 17:05:57] INFO	tsne_perplexity   = 30.000000
[10/05/21 17:05:57] INFO	vectorize         = False
[10/05/21 17:05:57] INFO	verbosity         = 0
[10/05/21 17:05:57] INFO	Creating Model
[10/05/21 17:05:57] INFO	Calling Pipeline
[10/05/21 17:05:57] INFO	Training Pipeline
[10/05/21 17:05:57] INFO	Loading Data
[10/05/21 17:05:57] INFO	Loading data from ./input/train.csv
[10/05/21 17:05:57] INFO	Found target Survived in data frame
[10/05/21 17:05:57] INFO	Labels (y) found for Partition.train
[10/05/21 17:05:57] INFO	Loading Data
[10/05/21 17:05:57] INFO	Loading data from ./input/test.csv
[10/05/21 17:05:57] INFO	Target Survived not found in Partition.test
[10/05/21 17:05:57] INFO	Saving New Features in Model
[10/05/21 17:05:57] INFO	Original Feature Statistics
[10/05/21 17:05:57] INFO	Number of Training Rows    : 891
[10/05/21 17:05:57] INFO	Number of Training Columns : 11
[10/05/21 17:05:57] INFO	Unique Training Values for Survived : [0 1]
[10/05/21 17:05:57] INFO	Unique Training Counts for Survived : [549 342]
[10/05/21 17:05:57] INFO	Number of Testing Rows     : 418
[10/05/21 17:05:57] INFO	Number of Testing Columns  : 11
[10/05/21 17:05:57] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:05:57] INFO	Feature Count     : 11
[10/05/21 17:05:57] INFO	Applying transforms
[10/05/21 17:05:57] INFO	No transforms Specified
[10/05/21 17:05:57] INFO	New Feature Count : 11
[10/05/21 17:05:57] INFO	Dropping Features: ['PassengerId']
[10/05/21 17:05:57] INFO	Original Feature Count : 11
[10/05/21 17:05:57] INFO	Reduced Feature Count  : 10
[10/05/21 17:05:57] INFO	Writing data frame to ./input/train_20211005.csv
[10/05/21 17:05:57] INFO	Writing data frame to ./input/test_20211005.csv
[10/05/21 17:05:57] INFO	Creating Cross-Tabulations
[10/05/21 17:05:57] INFO	Creating crosstabs for feature Embarked
[10/05/21 17:05:57] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/05/21 17:05:57] INFO	Feature Count     : 10
[10/05/21 17:05:57] INFO	Creating Count Features
[10/05/21 17:05:57] INFO	NA Counts
[10/05/21 17:05:57] INFO	Number Counts
[10/05/21 17:05:57] INFO	New Feature Count : 21
[10/05/21 17:05:57] INFO	Creating Base Features
[10/05/21 17:05:57] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/05/21 17:05:57] INFO	Feature 2: Name => Factorization
[10/05/21 17:05:57] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/05/21 17:05:57] INFO	Feature 3: Sex => Factorization
[10/05/21 17:05:57] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/05/21 17:05:57] INFO	Feature 7: Ticket => Factorization
[10/05/21 17:05:57] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/05/21 17:05:57] INFO	Feature 9: Cabin => Factorization
[10/05/21 17:05:57] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/05/21 17:05:57] INFO	Encoding: Encoders.target
[10/05/21 17:05:57] INFO	Fitting training features for Embarked
[10/05/21 17:05:57] INFO	Transforming testing features for Embarked
[10/05/21 17:05:57] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/05/21 17:05:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/05/21 17:05:57] INFO	New Feature Count : 21
[10/05/21 17:05:57] INFO	Scaling Base Features
[10/05/21 17:05:57] INFO	Creating NumPy Features
[10/05/21 17:05:57] INFO	NumPy Feature: sum
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: mean
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: std
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature: var
[10/05/21 17:05:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/05/21 17:05:57] INFO	NumPy Feature Count : 4
[10/05/21 17:05:57] INFO	New Feature Count : 25
[10/05/21 17:05:57] INFO	Creating Clustering Features
[10/05/21 17:05:57] INFO	Cluster Minimum   : 3
[10/05/21 17:05:57] INFO	Cluster Maximum   : 30
[10/05/21 17:05:57] INFO	Cluster Increment : 3
[10/05/21 17:05:57] INFO	k = 3
[10/05/21 17:05:57] INFO	k = 6
[10/05/21 17:05:57] INFO	k = 9
[10/05/21 17:05:57] INFO	k = 12
[10/05/21 17:05:57] INFO	k = 15
[10/05/21 17:05:58] INFO	k = 18
[10/05/21 17:05:58] INFO	k = 21
[10/05/21 17:05:58] INFO	k = 24
[10/05/21 17:05:58] INFO	k = 27
[10/05/21 17:05:58] INFO	k = 30
[10/05/21 17:05:58] INFO	Clustering Feature Count : 10
[10/05/21 17:05:58] INFO	New Feature Count : 35
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Creating Interactions
[10/05/21 17:05:58] INFO	Initial Feature Count  : 35
[10/05/21 17:05:58] INFO	Skipping Interactions
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Removing Low-Variance Features
[10/05/21 17:05:58] INFO	Low-Variance Threshold  : 0.10
[10/05/21 17:05:58] INFO	Original Feature Count  : 35
[10/05/21 17:05:58] INFO	Reduced Feature Count   : 35
[10/05/21 17:05:58] INFO	Saving New Features in Model
[10/05/21 17:05:58] INFO	Skipping Shuffling
[10/05/21 17:05:58] INFO	Skipping Sampling
[10/05/21 17:05:58] INFO	Getting All Estimators
[10/05/21 17:05:58] INFO	Algorithm Configuration
[10/05/21 17:05:58] INFO	Selecting Models
[10/05/21 17:05:58] INFO	Algorithm: CATB
[10/05/21 17:05:58] INFO	Fitting Initial Model
[10/05/21 17:05:58] INFO	Cross-Validation
[10/05/21 17:06:00] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/05/21 17:06:00] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:02] INFO	RFECV took 2.52 seconds for step 3 and 3 folds
[10/05/21 17:06:02] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/05/21 17:06:02] INFO	No grid is defined for grid search
[10/05/21 17:06:02] INFO	Final Model Predictions for CATB
[10/05/21 17:06:02] INFO	Skipping Calibration
[10/05/21 17:06:02] INFO	Making Predictions
[10/05/21 17:06:02] INFO	Predictions Complete
[10/05/21 17:06:02] INFO	Algorithm: LGB
[10/05/21 17:06:02] INFO	Fitting Initial Model
[10/05/21 17:06:02] INFO	Cross-Validation
[10/05/21 17:06:03] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/05/21 17:06:03] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:06] INFO	RFECV took 2.55 seconds for step 3 and 3 folds
[10/05/21 17:06:06] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/05/21 17:06:06] INFO	No grid is defined for grid search
[10/05/21 17:06:06] INFO	Final Model Predictions for LGB
[10/05/21 17:06:06] INFO	Skipping Calibration
[10/05/21 17:06:06] INFO	Making Predictions
[10/05/21 17:06:06] INFO	Predictions Complete
[10/05/21 17:06:06] INFO	Algorithm: XGB
[10/05/21 17:06:06] INFO	Fitting Initial Model
[10/05/21 17:06:06] INFO	Cross-Validation
[10/05/21 17:06:06] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/05/21 17:06:06] INFO	Recursive Feature Elimination with CV
[10/05/21 17:06:10] INFO	RFECV took 3.94 seconds for step 3 and 3 folds
[10/05/21 17:06:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/05/21 17:06:10] INFO	Randomized Grid Search
[10/05/21 17:07:18] INFO	Grid Search took 68.00 seconds for 50 candidate parameter settings.
[10/05/21 17:07:18] INFO	Model with rank: 1
[10/05/21 17:07:18] INFO	Mean validation score: 0.872 (std: 0.026)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Model with rank: 2
[10/05/21 17:07:18] INFO	Mean validation score: 0.870 (std: 0.022)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[10/05/21 17:07:18] INFO	Model with rank: 3
[10/05/21 17:07:18] INFO	Mean validation score: 0.870 (std: 0.027)
[10/05/21 17:07:18] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/05/21 17:07:18] INFO	Final Model Predictions for XGB
[10/05/21 17:07:18] INFO	Skipping Calibration
[10/05/21 17:07:18] INFO	Making Predictions
[10/05/21 17:07:18] INFO	Predictions Complete
[10/05/21 17:07:18] INFO	Blending Models
[10/05/21 17:07:18] INFO	Blending Start: 2021-10-05 17:07:18.746050
[10/05/21 17:07:18] INFO	Blending Complete: 0:00:00.017902
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Metrics for: Partition.train
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: CATB
[10/05/21 17:07:18] INFO	accuracy: 0.8585858585858586
[10/05/21 17:07:18] INFO	average_precision: 0.9113351686222868
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.8378391333525069
[10/05/21 17:07:18] INFO	brier_score_loss: 0.10043404518351136
[10/05/21 17:07:18] INFO	cohen_kappa: 0.6932572665125658
[10/05/21 17:07:18] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/05/21 17:07:18] INFO	f1: 0.8025078369905956
[10/05/21 17:07:18] INFO	neg_log_loss: 0.3371948718196211
[10/05/21 17:07:18] INFO	precision: 0.8648648648648649
[10/05/21 17:07:18] INFO	recall: 0.7485380116959064
[10/05/21 17:07:18] INFO	roc_auc: 0.9297979313797549
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: LGB
[10/05/21 17:07:18] INFO	accuracy: 0.9730639730639731
[10/05/21 17:07:18] INFO	average_precision: 0.9961113207491221
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.9687709711437062
[10/05/21 17:07:18] INFO	brier_score_loss: 0.032809498448974184
[10/05/21 17:07:18] INFO	cohen_kappa: 0.9427387092109702
[10/05/21 17:07:18] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/05/21 17:07:18] INFO	f1: 0.9643916913946586
[10/05/21 17:07:18] INFO	neg_log_loss: 0.1458307566281259
[10/05/21 17:07:18] INFO	precision: 0.9789156626506024
[10/05/21 17:07:18] INFO	recall: 0.9502923976608187
[10/05/21 17:07:18] INFO	roc_auc: 0.9974861257576241
[10/05/21 17:07:18] INFO	--------------------------------------------------------------------------------
[10/05/21 17:07:18] INFO	Algorithm: XGB
[10/05/21 17:07:18] INFO	accuracy: 0.9124579124579124
[10/05/21 17:07:18] INFO	average_precision: 0.9499339046242075
[10/05/21 17:07:18] INFO	balanced_accuracy: 0.8958872591314351
[10/05/21 17:07:18] INFO	brier_score_loss: 0.17677758259057422
[10/05/21 17:07:18] INFO	cohen_kappa: 0.8105402620344473
[10/05/21 17:07:18] INFO	confusion_matrix: [[531  18]
 [ 60 282]]
[10/05/21 17:07:18] INFO	f1: 0.8785046728971964
[10/05/21 17:07:18] INFO	neg_log_loss: 0.5441860756288073
[10/05/21 17:07:18] INFO	precision: 0.94
[10/05/21 17:07:18] INFO	recall: 0.8245614035087719
[10/05/21 17:07:18] INFO	roc_auc: 0.959865891200375
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Metrics for: Partition.test
[10/05/21 17:07:18] INFO	No labels for generating Partition.test metrics
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Selecting Best Model
[10/05/21 17:07:18] INFO	Scoring for: Partition.train
[10/05/21 17:07:18] INFO	Best Model Selection Start: 2021-10-05 17:07:18.793035
[10/05/21 17:07:18] INFO	Scoring CATB Model
[10/05/21 17:07:18] INFO	Scoring LGB Model
[10/05/21 17:07:18] INFO	Scoring XGB Model
[10/05/21 17:07:18] INFO	Scoring BLEND Model
[10/05/21 17:07:18] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/05/21 17:07:18] INFO	Best Model Selection Complete: 0:00:00.000281
[10/05/21 17:07:18] INFO	================================================================================
[10/05/21 17:07:18] INFO	Generating Plots for partition: train
[10/05/21 17:07:18] INFO	Generating Calibration Plot
[10/05/21 17:07:18] INFO	Calibration for Algorithm: CATB
[10/05/21 17:07:18] INFO	Calibration for Algorithm: LGB
[10/05/21 17:07:18] INFO	Calibration for Algorithm: XGB
[10/05/21 17:07:18] INFO	Writing plot to ./plots/calibration_train.png
[10/05/21 17:07:18] INFO	Generating Confusion Matrices
[10/05/21 17:07:18] INFO	Confusion Matrix for Algorithm: CATB
[10/05/21 17:07:18] INFO	Confusion Matrix:
[10/05/21 17:07:18] INFO	[[509  40]
 [ 86 256]]
[10/05/21 17:07:18] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/05/21 17:07:19] INFO	Confusion Matrix for Algorithm: LGB
[10/05/21 17:07:19] INFO	Confusion Matrix:
[10/05/21 17:07:19] INFO	[[542   7]
 [ 17 325]]
[10/05/21 17:07:19] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/05/21 17:07:19] INFO	Confusion Matrix for Algorithm: XGB
[10/05/21 17:07:19] INFO	Confusion Matrix:
[10/05/21 17:07:19] INFO	[[531  18]
 [ 60 282]]
[10/05/21 17:07:19] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/05/21 17:07:19] INFO	Generating ROC Curves
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: CATB
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: LGB
[10/05/21 17:07:19] INFO	ROC Curve for Algorithm: XGB
[10/05/21 17:07:19] INFO	Writing plot to ./plots/roc_curve_train.png
[10/05/21 17:07:19] INFO	Generating Learning Curves
[10/05/21 17:07:19] INFO	Algorithm Configuration
[10/05/21 17:07:19] INFO	Learning Curve for Algorithm: CATB
[10/05/21 17:07:19] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/05/21 17:07:19] INFO	Learning Curve for Algorithm: LGB
[10/05/21 17:07:22] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/05/21 17:07:22] INFO	Learning Curve for Algorithm: XGB
[10/05/21 17:07:22] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/05/21 17:07:23] INFO	Generating Feature Importance Plots
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: CATB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Sex_factor (45.178104)
[10/05/21 17:07:23] INFO	2. Pclass (13.721171)
[10/05/21 17:07:23] INFO	3. Age (6.651788)
[10/05/21 17:07:23] INFO	4. Fare (4.529770)
[10/05/21 17:07:23] INFO	5. var (3.586590)
[10/05/21 17:07:23] INFO	6. std (3.492385)
[10/05/21 17:07:23] INFO	7. Ticket_factor (3.315046)
[10/05/21 17:07:23] INFO	8. cluster_30 (2.831587)
[10/05/21 17:07:23] INFO	9. mean (2.733389)
[10/05/21 17:07:23] INFO	10. Name_factor (2.586310)
[10/05/21 17:07:23] INFO	11. Cabin_factor (2.101764)
[10/05/21 17:07:23] INFO	12. Embarked (2.086410)
[10/05/21 17:07:23] INFO	13. SibSp (2.085405)
[10/05/21 17:07:23] INFO	14. cluster_12 (1.876782)
[10/05/21 17:07:23] INFO	15. cluster_24 (1.263144)
[10/05/21 17:07:23] INFO	16. count_2 (1.004409)
[10/05/21 17:07:23] INFO	17. sum (0.955946)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: LGB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Fare (256.000000)
[10/05/21 17:07:23] INFO	2. sum (241.000000)
[10/05/21 17:07:23] INFO	3. Age (232.000000)
[10/05/21 17:07:23] INFO	4. std (201.000000)
[10/05/21 17:07:23] INFO	5. Ticket_factor (199.000000)
[10/05/21 17:07:23] INFO	6. Name_factor (175.000000)
[10/05/21 17:07:23] INFO	7. cluster_30 (53.000000)
[10/05/21 17:07:23] INFO	8. cluster_27 (46.000000)
[10/05/21 17:07:23] INFO	9. Sex_factor (43.000000)
[10/05/21 17:07:23] INFO	10. Pclass (43.000000)
[10/05/21 17:07:23] INFO	11. Cabin_factor (41.000000)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/05/21 17:07:23] INFO	Feature Importances for Algorithm: XGB
[10/05/21 17:07:23] INFO	Feature Ranking:
[10/05/21 17:07:23] INFO	1. Sex_factor (0.424644)
[10/05/21 17:07:23] INFO	2. Pclass (0.127452)
[10/05/21 17:07:23] INFO	3. Cabin_factor (0.081307)
[10/05/21 17:07:23] INFO	4. Age (0.051007)
[10/05/21 17:07:23] INFO	5. SibSp (0.049620)
[10/05/21 17:07:23] INFO	6. count_1 (0.046373)
[10/05/21 17:07:23] INFO	7. Embarked (0.046225)
[10/05/21 17:07:23] INFO	8. std (0.036262)
[10/05/21 17:07:23] INFO	9. cluster_30 (0.036076)
[10/05/21 17:07:23] INFO	10. Fare (0.032410)
[10/05/21 17:07:23] INFO	11. cluster_24 (0.021187)
[10/05/21 17:07:23] INFO	12. Name_factor (0.019312)
[10/05/21 17:07:23] INFO	13. sum (0.017784)
[10/05/21 17:07:23] INFO	14. cluster_15 (0.010340)
[10/05/21 17:07:23] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/05/21 17:07:23] INFO	================================================================================
[10/05/21 17:07:23] INFO	Saving Model Predictor
[10/05/21 17:07:23] INFO	Writing model predictor to ./model/model_20211005.pkl
[10/05/21 17:07:23] INFO	Saving Feature Map
[10/05/21 17:07:23] INFO	Writing feature map to ./model/feature_map_20211005.pkl
[10/05/21 17:07:23] INFO	Loading data from ./input/test_20211005.csv
[10/05/21 17:07:23] INFO	Saving Predictions
[10/05/21 17:07:23] INFO	Writing data frame to ./output/predictions_20211005.csv
[10/05/21 17:07:23] INFO	Saving Probabilities
[10/05/21 17:07:23] INFO	Writing data frame to ./output/probabilities_20211005.csv
[10/05/21 17:07:23] INFO	Saving Ranked Predictions
[10/05/21 17:07:23] INFO	Writing data frame to ./output/rankings_20211005.csv
[10/05/21 17:07:23] INFO	Saving Submission to ./output/submission_20211005.csv
[10/05/21 17:07:23] INFO	********************************************************************************
[10/05/21 17:07:23] INFO	AlphaPy End
[10/05/21 17:07:23] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	AlphaPy Start
[10/19/21 23:14:29] INFO	********************************************************************************
[10/19/21 23:14:29] INFO	Model Configuration
[10/19/21 23:14:29] INFO	No transforms Found
[10/19/21 23:14:29] INFO	MODEL PARAMETERS:
[10/19/21 23:14:29] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/19/21 23:14:29] INFO	calibration       = False
[10/19/21 23:14:29] INFO	cal_type          = sigmoid
[10/19/21 23:14:29] INFO	calibration_plot  = False
[10/19/21 23:14:29] INFO	clustering        = True
[10/19/21 23:14:29] INFO	cluster_inc       = 3
[10/19/21 23:14:29] INFO	cluster_max       = 30
[10/19/21 23:14:29] INFO	cluster_min       = 3
[10/19/21 23:14:29] INFO	confusion_matrix  = True
[10/19/21 23:14:29] INFO	counts            = True
[10/19/21 23:14:29] INFO	cv_folds          = 3
[10/19/21 23:14:29] INFO	directory         = .
[10/19/21 23:14:29] INFO	extension         = csv
[10/19/21 23:14:29] INFO	drop              = ['PassengerId']
[10/19/21 23:14:29] INFO	encoder           = <Encoders.target: 14>
[10/19/21 23:14:29] INFO	esr               = 20
[10/19/21 23:14:29] INFO	factors           = ['Embarked']
[10/19/21 23:14:29] INFO	features [X]      = *
[10/19/21 23:14:29] INFO	feature_selection = False
[10/19/21 23:14:29] INFO	fs_percentage     = 50
[10/19/21 23:14:29] INFO	fs_score_func     = <function f_classif at 0x7fa102be4f70>
[10/19/21 23:14:29] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/19/21 23:14:29] INFO	grid_search       = True
[10/19/21 23:14:29] INFO	gs_iters          = 50
[10/19/21 23:14:29] INFO	gs_random         = True
[10/19/21 23:14:29] INFO	gs_sample         = False
[10/19/21 23:14:29] INFO	gs_sample_pct     = 0.200000
[10/19/21 23:14:29] INFO	importances       = True
[10/19/21 23:14:29] INFO	interactions      = False
[10/19/21 23:14:29] INFO	isomap            = False
[10/19/21 23:14:29] INFO	iso_components    = 2
[10/19/21 23:14:29] INFO	iso_neighbors     = 5
[10/19/21 23:14:29] INFO	isample_pct       = 10
[10/19/21 23:14:29] INFO	leaders           = []
[10/19/21 23:14:29] INFO	learning_curve    = True
[10/19/21 23:14:29] INFO	logtransform      = False
[10/19/21 23:14:29] INFO	lv_remove         = True
[10/19/21 23:14:29] INFO	lv_threshold      = 0.100000
[10/19/21 23:14:29] INFO	model_type        = <ModelType.classification: 1>
[10/19/21 23:14:29] INFO	n_estimators      = 51
[10/19/21 23:14:29] INFO	n_jobs            = -1
[10/19/21 23:14:29] INFO	ngrams_max        = 2
[10/19/21 23:14:29] INFO	numpy             = True
[10/19/21 23:14:29] INFO	pca               = False
[10/19/21 23:14:29] INFO	pca_inc           = 1
[10/19/21 23:14:29] INFO	pca_max           = 10
[10/19/21 23:14:29] INFO	pca_min           = 2
[10/19/21 23:14:29] INFO	pca_whiten        = False
[10/19/21 23:14:29] INFO	poly_degree       = 2
[10/19/21 23:14:29] INFO	pvalue_level      = 0.010000
[10/19/21 23:14:29] INFO	rfe               = True
[10/19/21 23:14:29] INFO	rfe_step          = 3
[10/19/21 23:14:29] INFO	roc_curve         = True
[10/19/21 23:14:29] INFO	rounding          = 2
[10/19/21 23:14:29] INFO	sampling          = False
[10/19/21 23:14:29] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/19/21 23:14:29] INFO	sampling_ratio    = 0.500000
[10/19/21 23:14:29] INFO	scaler_option     = True
[10/19/21 23:14:29] INFO	scaler_type       = <Scalers.standard: 2>
[10/19/21 23:14:29] INFO	scipy             = False
[10/19/21 23:14:29] INFO	scorer            = roc_auc
[10/19/21 23:14:29] INFO	seed              = 42
[10/19/21 23:14:29] INFO	sentinel          = -1
[10/19/21 23:14:29] INFO	separator         = ,
[10/19/21 23:14:29] INFO	shuffle           = False
[10/19/21 23:14:29] INFO	split             = 0.400000
[10/19/21 23:14:29] INFO	submission_file   = gender_submission
[10/19/21 23:14:29] INFO	submit_probas     = False
[10/19/21 23:14:29] INFO	target [y]        = Survived
[10/19/21 23:14:29] INFO	target_value      = 1
[10/19/21 23:14:29] INFO	transforms        = None
[10/19/21 23:14:29] INFO	tsne              = False
[10/19/21 23:14:29] INFO	tsne_components   = 2
[10/19/21 23:14:29] INFO	tsne_learn_rate   = 1000.000000
[10/19/21 23:14:29] INFO	tsne_perplexity   = 30.000000
[10/19/21 23:14:29] INFO	vectorize         = False
[10/19/21 23:14:29] INFO	verbosity         = 0
[10/19/21 23:14:29] INFO	Creating Model
[10/19/21 23:14:29] INFO	Calling Pipeline
[10/19/21 23:14:29] INFO	Training Pipeline
[10/19/21 23:14:29] INFO	Loading Data
[10/19/21 23:14:29] INFO	Loading data from ./input/train.csv
[10/19/21 23:14:29] INFO	Found target Survived in data frame
[10/19/21 23:14:29] INFO	Labels (y) found for Partition.train
[10/19/21 23:14:29] INFO	Loading Data
[10/19/21 23:14:29] INFO	Loading data from ./input/test.csv
[10/19/21 23:14:29] INFO	Target Survived not found in Partition.test
[10/19/21 23:14:29] INFO	Saving New Features in Model
[10/19/21 23:14:29] INFO	Original Feature Statistics
[10/19/21 23:14:29] INFO	Number of Training Rows    : 891
[10/19/21 23:14:29] INFO	Number of Training Columns : 11
[10/19/21 23:14:29] INFO	Unique Training Values for Survived : [0 1]
[10/19/21 23:14:29] INFO	Unique Training Counts for Survived : [549 342]
[10/19/21 23:14:29] INFO	Number of Testing Rows     : 418
[10/19/21 23:14:29] INFO	Number of Testing Columns  : 11
[10/19/21 23:14:29] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/19/21 23:14:29] INFO	Feature Count     : 11
[10/19/21 23:14:29] INFO	Applying transforms
[10/19/21 23:14:29] INFO	No transforms Specified
[10/19/21 23:14:29] INFO	New Feature Count : 11
[10/19/21 23:14:29] INFO	Dropping Features: ['PassengerId']
[10/19/21 23:14:29] INFO	Original Feature Count : 11
[10/19/21 23:14:29] INFO	Reduced Feature Count  : 10
[10/19/21 23:14:29] INFO	Writing data frame to ./input/train_20211019.csv
[10/19/21 23:14:29] INFO	Writing data frame to ./input/test_20211019.csv
[10/19/21 23:14:29] INFO	Creating Cross-Tabulations
[10/19/21 23:14:29] INFO	Creating crosstabs for feature Embarked
[10/19/21 23:14:29] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/19/21 23:14:29] INFO	Feature Count     : 10
[10/19/21 23:14:29] INFO	Creating Count Features
[10/19/21 23:14:29] INFO	NA Counts
[10/19/21 23:14:29] INFO	Number Counts
[10/19/21 23:14:29] INFO	New Feature Count : 21
[10/19/21 23:14:29] INFO	Creating Base Features
[10/19/21 23:14:29] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/19/21 23:14:29] INFO	Feature 2: Name => Factorization
[10/19/21 23:14:29] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/19/21 23:14:29] INFO	Feature 3: Sex => Factorization
[10/19/21 23:14:29] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/19/21 23:14:29] INFO	Feature 7: Ticket => Factorization
[10/19/21 23:14:29] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/19/21 23:14:29] INFO	Feature 9: Cabin => Factorization
[10/19/21 23:14:29] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/19/21 23:14:29] INFO	Encoding: Encoders.target
[10/19/21 23:14:29] INFO	Fitting training features for Embarked
[10/19/21 23:14:29] INFO	Transforming testing features for Embarked
[10/19/21 23:14:29] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/19/21 23:14:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/19/21 23:14:29] INFO	New Feature Count : 21
[10/19/21 23:14:29] INFO	Scaling Base Features
[10/19/21 23:14:29] INFO	Creating NumPy Features
[10/19/21 23:14:29] INFO	NumPy Feature: sum
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: mean
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: std
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature: var
[10/19/21 23:14:29] INFO	    Imputation for Data Type float64: Median Strategy
[10/19/21 23:14:29] INFO	NumPy Feature Count : 4
[10/19/21 23:14:29] INFO	New Feature Count : 25
[10/19/21 23:14:29] INFO	Creating Clustering Features
[10/19/21 23:14:29] INFO	Cluster Minimum   : 3
[10/19/21 23:14:29] INFO	Cluster Maximum   : 30
[10/19/21 23:14:29] INFO	Cluster Increment : 3
[10/19/21 23:14:29] INFO	k = 3
[10/19/21 23:14:30] INFO	k = 6
[10/19/21 23:14:30] INFO	k = 9
[10/19/21 23:14:30] INFO	k = 12
[10/19/21 23:14:30] INFO	k = 15
[10/19/21 23:14:30] INFO	k = 18
[10/19/21 23:14:30] INFO	k = 21
[10/19/21 23:14:30] INFO	k = 24
[10/19/21 23:14:30] INFO	k = 27
[10/19/21 23:14:30] INFO	k = 30
[10/19/21 23:14:30] INFO	Clustering Feature Count : 10
[10/19/21 23:14:30] INFO	New Feature Count : 35
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Creating Interactions
[10/19/21 23:14:30] INFO	Initial Feature Count  : 35
[10/19/21 23:14:30] INFO	Skipping Interactions
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Removing Low-Variance Features
[10/19/21 23:14:30] INFO	Low-Variance Threshold  : 0.10
[10/19/21 23:14:30] INFO	Original Feature Count  : 35
[10/19/21 23:14:30] INFO	Reduced Feature Count   : 35
[10/19/21 23:14:30] INFO	Saving New Features in Model
[10/19/21 23:14:30] INFO	Skipping Shuffling
[10/19/21 23:14:30] INFO	Skipping Sampling
[10/19/21 23:14:30] INFO	Getting All Estimators
[10/19/21 23:14:30] INFO	Algorithm Configuration
[10/19/21 23:14:30] INFO	Selecting Models
[10/19/21 23:14:30] INFO	Algorithm: CATB
[10/19/21 23:14:30] INFO	Fitting Initial Model
[10/19/21 23:14:31] INFO	Cross-Validation
[10/19/21 23:14:32] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/19/21 23:14:32] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:35] INFO	RFECV took 2.51 seconds for step 3 and 3 folds
[10/19/21 23:14:35] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/19/21 23:14:35] INFO	No grid is defined for grid search
[10/19/21 23:14:35] INFO	Final Model Predictions for CATB
[10/19/21 23:14:35] INFO	Skipping Calibration
[10/19/21 23:14:35] INFO	Making Predictions
[10/19/21 23:14:35] INFO	Predictions Complete
[10/19/21 23:14:35] INFO	Algorithm: LGB
[10/19/21 23:14:35] INFO	Fitting Initial Model
[10/19/21 23:14:35] INFO	Cross-Validation
[10/19/21 23:14:36] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/19/21 23:14:36] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:38] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[10/19/21 23:14:38] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/19/21 23:14:38] INFO	No grid is defined for grid search
[10/19/21 23:14:38] INFO	Final Model Predictions for LGB
[10/19/21 23:14:38] INFO	Skipping Calibration
[10/19/21 23:14:38] INFO	Making Predictions
[10/19/21 23:14:38] INFO	Predictions Complete
[10/19/21 23:14:38] INFO	Algorithm: XGB
[10/19/21 23:14:38] INFO	Fitting Initial Model
[10/19/21 23:14:38] INFO	Cross-Validation
[10/19/21 23:14:38] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/19/21 23:14:38] INFO	Recursive Feature Elimination with CV
[10/19/21 23:14:42] INFO	RFECV took 3.16 seconds for step 3 and 3 folds
[10/19/21 23:14:42] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/19/21 23:14:42] INFO	Randomized Grid Search
[10/19/21 23:16:02] INFO	Grid Search took 80.51 seconds for 50 candidate parameter settings.
[10/19/21 23:16:02] INFO	Model with rank: 1
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.020)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Model with rank: 2
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.022)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[10/19/21 23:16:02] INFO	Model with rank: 3
[10/19/21 23:16:02] INFO	Mean validation score: 0.872 (std: 0.021)
[10/19/21 23:16:02] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Algorithm: XGB, Best Score: 0.8724, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/19/21 23:16:02] INFO	Final Model Predictions for XGB
[10/19/21 23:16:02] INFO	Skipping Calibration
[10/19/21 23:16:02] INFO	Making Predictions
[10/19/21 23:16:02] INFO	Predictions Complete
[10/19/21 23:16:02] INFO	Blending Models
[10/19/21 23:16:02] INFO	Blending Start: 2021-10-19 23:16:02.629081
[10/19/21 23:16:02] INFO	Blending Complete: 0:00:00.014905
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Metrics for: Partition.train
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: CATB
[10/19/21 23:16:02] INFO	accuracy: 0.8585858585858586
[10/19/21 23:16:02] INFO	average_precision: 0.9113351686222868
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.8378391333525069
[10/19/21 23:16:02] INFO	brier_score_loss: 0.10043404518351136
[10/19/21 23:16:02] INFO	cohen_kappa: 0.6932572665125658
[10/19/21 23:16:02] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/19/21 23:16:02] INFO	f1: 0.8025078369905956
[10/19/21 23:16:02] INFO	neg_log_loss: 0.3371948718196211
[10/19/21 23:16:02] INFO	precision: 0.8648648648648649
[10/19/21 23:16:02] INFO	recall: 0.7485380116959064
[10/19/21 23:16:02] INFO	roc_auc: 0.9297979313797549
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: LGB
[10/19/21 23:16:02] INFO	accuracy: 0.9730639730639731
[10/19/21 23:16:02] INFO	average_precision: 0.9961113207491221
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.9687709711437062
[10/19/21 23:16:02] INFO	brier_score_loss: 0.032809498448974184
[10/19/21 23:16:02] INFO	cohen_kappa: 0.9427387092109702
[10/19/21 23:16:02] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/19/21 23:16:02] INFO	f1: 0.9643916913946586
[10/19/21 23:16:02] INFO	neg_log_loss: 0.1458307566281259
[10/19/21 23:16:02] INFO	precision: 0.9789156626506024
[10/19/21 23:16:02] INFO	recall: 0.9502923976608187
[10/19/21 23:16:02] INFO	roc_auc: 0.9974861257576241
[10/19/21 23:16:02] INFO	--------------------------------------------------------------------------------
[10/19/21 23:16:02] INFO	Algorithm: XGB
[10/19/21 23:16:02] INFO	accuracy: 0.9304152637485971
[10/19/21 23:16:02] INFO	average_precision: 0.9716306882839921
[10/19/21 23:16:02] INFO	balanced_accuracy: 0.9181765890135174
[10/19/21 23:16:02] INFO	brier_score_loss: 0.07412143940154169
[10/19/21 23:16:02] INFO	cohen_kappa: 0.8504167275917531
[10/19/21 23:16:02] INFO	confusion_matrix: [[533  16]
 [ 46 296]]
[10/19/21 23:16:02] INFO	f1: 0.9051987767584098
[10/19/21 23:16:02] INFO	neg_log_loss: 0.2874399062275351
[10/19/21 23:16:02] INFO	precision: 0.9487179487179487
[10/19/21 23:16:02] INFO	recall: 0.8654970760233918
[10/19/21 23:16:02] INFO	roc_auc: 0.9800967202462746
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Metrics for: Partition.test
[10/19/21 23:16:02] INFO	No labels for generating Partition.test metrics
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Selecting Best Model
[10/19/21 23:16:02] INFO	Scoring for: Partition.train
[10/19/21 23:16:02] INFO	Best Model Selection Start: 2021-10-19 23:16:02.667204
[10/19/21 23:16:02] INFO	Scoring CATB Model
[10/19/21 23:16:02] INFO	Scoring LGB Model
[10/19/21 23:16:02] INFO	Scoring XGB Model
[10/19/21 23:16:02] INFO	Scoring BLEND Model
[10/19/21 23:16:02] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[10/19/21 23:16:02] INFO	Best Model Selection Complete: 0:00:00.000221
[10/19/21 23:16:02] INFO	================================================================================
[10/19/21 23:16:02] INFO	Generating Plots for partition: train
[10/19/21 23:16:02] INFO	Generating Calibration Plot
[10/19/21 23:16:02] INFO	Calibration for Algorithm: CATB
[10/19/21 23:16:02] INFO	Calibration for Algorithm: LGB
[10/19/21 23:16:02] INFO	Calibration for Algorithm: XGB
[10/19/21 23:16:02] INFO	Writing plot to ./plots/calibration_train.png
[10/19/21 23:16:02] INFO	Generating Confusion Matrices
[10/19/21 23:16:02] INFO	Confusion Matrix for Algorithm: CATB
[10/19/21 23:16:02] INFO	Confusion Matrix:
[10/19/21 23:16:02] INFO	[[509  40]
 [ 86 256]]
[10/19/21 23:16:02] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/19/21 23:16:02] INFO	Confusion Matrix for Algorithm: LGB
[10/19/21 23:16:02] INFO	Confusion Matrix:
[10/19/21 23:16:02] INFO	[[542   7]
 [ 17 325]]
[10/19/21 23:16:02] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/19/21 23:16:03] INFO	Confusion Matrix for Algorithm: XGB
[10/19/21 23:16:03] INFO	Confusion Matrix:
[10/19/21 23:16:03] INFO	[[533  16]
 [ 46 296]]
[10/19/21 23:16:03] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/19/21 23:16:03] INFO	Generating ROC Curves
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: CATB
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: LGB
[10/19/21 23:16:03] INFO	ROC Curve for Algorithm: XGB
[10/19/21 23:16:03] INFO	Writing plot to ./plots/roc_curve_train.png
[10/19/21 23:16:03] INFO	Generating Learning Curves
[10/19/21 23:16:03] INFO	Algorithm Configuration
[10/19/21 23:16:03] INFO	Learning Curve for Algorithm: CATB
[10/19/21 23:16:03] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/19/21 23:16:03] INFO	Learning Curve for Algorithm: LGB
[10/19/21 23:16:05] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/19/21 23:16:05] INFO	Learning Curve for Algorithm: XGB
[10/19/21 23:16:06] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/19/21 23:16:06] INFO	Generating Feature Importance Plots
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: CATB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Sex_factor (45.178104)
[10/19/21 23:16:06] INFO	2. Pclass (13.721171)
[10/19/21 23:16:06] INFO	3. Age (6.651788)
[10/19/21 23:16:06] INFO	4. Fare (4.529770)
[10/19/21 23:16:06] INFO	5. var (3.586590)
[10/19/21 23:16:06] INFO	6. std (3.492385)
[10/19/21 23:16:06] INFO	7. Ticket_factor (3.315046)
[10/19/21 23:16:06] INFO	8. cluster_30 (2.831587)
[10/19/21 23:16:06] INFO	9. mean (2.733389)
[10/19/21 23:16:06] INFO	10. Name_factor (2.586310)
[10/19/21 23:16:06] INFO	11. Cabin_factor (2.101764)
[10/19/21 23:16:06] INFO	12. Embarked (2.086410)
[10/19/21 23:16:06] INFO	13. SibSp (2.085405)
[10/19/21 23:16:06] INFO	14. cluster_12 (1.876782)
[10/19/21 23:16:06] INFO	15. cluster_24 (1.263144)
[10/19/21 23:16:06] INFO	16. count_2 (1.004409)
[10/19/21 23:16:06] INFO	17. sum (0.955946)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: LGB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Fare (256.000000)
[10/19/21 23:16:06] INFO	2. sum (241.000000)
[10/19/21 23:16:06] INFO	3. Age (232.000000)
[10/19/21 23:16:06] INFO	4. std (201.000000)
[10/19/21 23:16:06] INFO	5. Ticket_factor (199.000000)
[10/19/21 23:16:06] INFO	6. Name_factor (175.000000)
[10/19/21 23:16:06] INFO	7. cluster_30 (53.000000)
[10/19/21 23:16:06] INFO	8. cluster_27 (46.000000)
[10/19/21 23:16:06] INFO	9. Sex_factor (43.000000)
[10/19/21 23:16:06] INFO	10. Pclass (43.000000)
[10/19/21 23:16:06] INFO	11. Cabin_factor (41.000000)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/19/21 23:16:06] INFO	Feature Importances for Algorithm: XGB
[10/19/21 23:16:06] INFO	Feature Ranking:
[10/19/21 23:16:06] INFO	1. Sex_factor (0.424644)
[10/19/21 23:16:06] INFO	2. Pclass (0.127452)
[10/19/21 23:16:06] INFO	3. Cabin_factor (0.081307)
[10/19/21 23:16:06] INFO	4. Age (0.051007)
[10/19/21 23:16:06] INFO	5. SibSp (0.049620)
[10/19/21 23:16:06] INFO	6. count_1 (0.046373)
[10/19/21 23:16:06] INFO	7. Embarked (0.046225)
[10/19/21 23:16:06] INFO	8. std (0.036262)
[10/19/21 23:16:06] INFO	9. cluster_30 (0.036076)
[10/19/21 23:16:06] INFO	10. Fare (0.032410)
[10/19/21 23:16:06] INFO	11. cluster_24 (0.021187)
[10/19/21 23:16:06] INFO	12. Name_factor (0.019312)
[10/19/21 23:16:06] INFO	13. sum (0.017784)
[10/19/21 23:16:06] INFO	14. cluster_15 (0.010340)
[10/19/21 23:16:06] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/19/21 23:16:06] INFO	================================================================================
[10/19/21 23:16:06] INFO	Saving Model Predictor
[10/19/21 23:16:06] INFO	Writing model predictor to ./model/model_20211019.pkl
[10/19/21 23:16:06] INFO	Saving Feature Map
[10/19/21 23:16:06] INFO	Writing feature map to ./model/feature_map_20211019.pkl
[10/19/21 23:16:06] INFO	Loading data from ./input/test_20211019.csv
[10/19/21 23:16:07] INFO	Saving Predictions
[10/19/21 23:16:07] INFO	Writing data frame to ./output/predictions_20211019.csv
[10/19/21 23:16:07] INFO	Saving Probabilities
[10/19/21 23:16:07] INFO	Writing data frame to ./output/probabilities_20211019.csv
[10/19/21 23:16:07] INFO	Saving Ranked Predictions
[10/19/21 23:16:07] INFO	Writing data frame to ./output/rankings_20211019.csv
[10/19/21 23:16:07] INFO	Saving Submission to ./output/submission_20211019.csv
[10/19/21 23:16:07] INFO	********************************************************************************
[10/19/21 23:16:07] INFO	AlphaPy End
[10/19/21 23:16:07] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	AlphaPy Start
[10/22/21 08:41:15] INFO	********************************************************************************
[10/22/21 08:41:15] INFO	Model Configuration
[10/22/21 08:41:15] INFO	No transforms Found
[10/22/21 08:41:15] INFO	MODEL PARAMETERS:
[10/22/21 08:41:15] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/22/21 08:41:15] INFO	calibration       = False
[10/22/21 08:41:15] INFO	cal_type          = sigmoid
[10/22/21 08:41:15] INFO	calibration_plot  = False
[10/22/21 08:41:15] INFO	clustering        = True
[10/22/21 08:41:15] INFO	cluster_inc       = 3
[10/22/21 08:41:15] INFO	cluster_max       = 30
[10/22/21 08:41:15] INFO	cluster_min       = 3
[10/22/21 08:41:15] INFO	confusion_matrix  = True
[10/22/21 08:41:15] INFO	counts            = True
[10/22/21 08:41:15] INFO	cv_folds          = 3
[10/22/21 08:41:15] INFO	directory         = .
[10/22/21 08:41:15] INFO	extension         = csv
[10/22/21 08:41:15] INFO	drop              = ['PassengerId']
[10/22/21 08:41:15] INFO	encoder           = <Encoders.target: 14>
[10/22/21 08:41:15] INFO	esr               = 20
[10/22/21 08:41:15] INFO	factors           = ['Embarked']
[10/22/21 08:41:15] INFO	features [X]      = *
[10/22/21 08:41:15] INFO	feature_selection = False
[10/22/21 08:41:15] INFO	fs_percentage     = 50
[10/22/21 08:41:15] INFO	fs_score_func     = <function f_classif at 0x7f8f52c715e0>
[10/22/21 08:41:15] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/22/21 08:41:15] INFO	grid_search       = True
[10/22/21 08:41:15] INFO	gs_iters          = 50
[10/22/21 08:41:15] INFO	gs_random         = True
[10/22/21 08:41:15] INFO	gs_sample         = False
[10/22/21 08:41:15] INFO	gs_sample_pct     = 0.200000
[10/22/21 08:41:15] INFO	importances       = True
[10/22/21 08:41:15] INFO	interactions      = False
[10/22/21 08:41:15] INFO	isomap            = False
[10/22/21 08:41:15] INFO	iso_components    = 2
[10/22/21 08:41:15] INFO	iso_neighbors     = 5
[10/22/21 08:41:15] INFO	isample_pct       = 10
[10/22/21 08:41:15] INFO	leaders           = []
[10/22/21 08:41:15] INFO	learning_curve    = True
[10/22/21 08:41:15] INFO	logtransform      = False
[10/22/21 08:41:15] INFO	lv_remove         = True
[10/22/21 08:41:15] INFO	lv_threshold      = 0.100000
[10/22/21 08:41:15] INFO	model_type        = <ModelType.classification: 1>
[10/22/21 08:41:15] INFO	n_estimators      = 51
[10/22/21 08:41:15] INFO	n_jobs            = -1
[10/22/21 08:41:15] INFO	ngrams_max        = 2
[10/22/21 08:41:15] INFO	numpy             = True
[10/22/21 08:41:15] INFO	pca               = False
[10/22/21 08:41:15] INFO	pca_inc           = 1
[10/22/21 08:41:15] INFO	pca_max           = 10
[10/22/21 08:41:15] INFO	pca_min           = 2
[10/22/21 08:41:15] INFO	pca_whiten        = False
[10/22/21 08:41:15] INFO	poly_degree       = 2
[10/22/21 08:41:15] INFO	pvalue_level      = 0.010000
[10/22/21 08:41:15] INFO	rfe               = True
[10/22/21 08:41:15] INFO	rfe_step          = 3
[10/22/21 08:41:15] INFO	roc_curve         = True
[10/22/21 08:41:15] INFO	rounding          = 2
[10/22/21 08:41:15] INFO	sampling          = False
[10/22/21 08:41:15] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/22/21 08:41:15] INFO	sampling_ratio    = 0.500000
[10/22/21 08:41:15] INFO	scaler_option     = True
[10/22/21 08:41:15] INFO	scaler_type       = <Scalers.standard: 2>
[10/22/21 08:41:15] INFO	scipy             = False
[10/22/21 08:41:15] INFO	scorer            = roc_auc
[10/22/21 08:41:15] INFO	seed              = 42
[10/22/21 08:41:15] INFO	sentinel          = -1
[10/22/21 08:41:15] INFO	separator         = ,
[10/22/21 08:41:15] INFO	shuffle           = False
[10/22/21 08:41:15] INFO	split             = 0.400000
[10/22/21 08:41:15] INFO	submission_file   = gender_submission
[10/22/21 08:41:15] INFO	submit_probas     = False
[10/22/21 08:41:15] INFO	target [y]        = Survived
[10/22/21 08:41:15] INFO	target_value      = 1
[10/22/21 08:41:15] INFO	transforms        = None
[10/22/21 08:41:15] INFO	tsne              = False
[10/22/21 08:41:15] INFO	tsne_components   = 2
[10/22/21 08:41:15] INFO	tsne_learn_rate   = 1000.000000
[10/22/21 08:41:15] INFO	tsne_perplexity   = 30.000000
[10/22/21 08:41:15] INFO	vectorize         = False
[10/22/21 08:41:15] INFO	verbosity         = 0
[10/22/21 08:41:15] INFO	Creating Model
[10/22/21 08:41:15] INFO	Calling Pipeline
[10/22/21 08:41:15] INFO	Training Pipeline
[10/22/21 08:41:15] INFO	Loading Data
[10/22/21 08:41:15] INFO	Loading data from ./input/train.csv
[10/22/21 08:41:15] INFO	Found target Survived in data frame
[10/22/21 08:41:15] INFO	Labels (y) found for Partition.train
[10/22/21 08:41:15] INFO	Loading Data
[10/22/21 08:41:15] INFO	Loading data from ./input/test.csv
[10/22/21 08:41:15] INFO	Target Survived not found in Partition.test
[10/22/21 08:41:15] INFO	Saving New Features in Model
[10/22/21 08:41:15] INFO	Original Feature Statistics
[10/22/21 08:41:15] INFO	Number of Training Rows    : 891
[10/22/21 08:41:15] INFO	Number of Training Columns : 11
[10/22/21 08:41:15] INFO	Unique Training Values for Survived : [0 1]
[10/22/21 08:41:15] INFO	Unique Training Counts for Survived : [549 342]
[10/22/21 08:41:15] INFO	Number of Testing Rows     : 418
[10/22/21 08:41:15] INFO	Number of Testing Columns  : 11
[10/22/21 08:41:15] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 08:41:15] INFO	Feature Count     : 11
[10/22/21 08:41:15] INFO	Applying transforms
[10/22/21 08:41:15] INFO	No transforms Specified
[10/22/21 08:41:15] INFO	New Feature Count : 11
[10/22/21 08:41:15] INFO	Dropping Features: ['PassengerId']
[10/22/21 08:41:15] INFO	Original Feature Count : 11
[10/22/21 08:41:15] INFO	Reduced Feature Count  : 10
[10/22/21 08:41:15] INFO	Writing data frame to ./input/train_20211022.csv
[10/22/21 08:41:15] INFO	Writing data frame to ./input/test_20211022.csv
[10/22/21 08:41:15] INFO	Creating Cross-Tabulations
[10/22/21 08:41:15] INFO	Creating crosstabs for feature Embarked
[10/22/21 08:41:15] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 08:41:15] INFO	Feature Count     : 10
[10/22/21 08:41:15] INFO	Creating Count Features
[10/22/21 08:41:15] INFO	NA Counts
[10/22/21 08:41:15] INFO	Number Counts
[10/22/21 08:41:15] INFO	New Feature Count : 21
[10/22/21 08:41:15] INFO	Creating Base Features
[10/22/21 08:41:15] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/22/21 08:41:15] INFO	Feature 2: Name => Factorization
[10/22/21 08:41:15] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/22/21 08:41:15] INFO	Feature 3: Sex => Factorization
[10/22/21 08:41:15] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/22/21 08:41:15] INFO	Feature 7: Ticket => Factorization
[10/22/21 08:41:15] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/22/21 08:41:15] INFO	Feature 9: Cabin => Factorization
[10/22/21 08:41:15] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/22/21 08:41:15] INFO	Encoding: Encoders.target
[10/22/21 08:41:15] INFO	Fitting training features for Embarked
[10/22/21 08:41:15] INFO	Transforming testing features for Embarked
[10/22/21 08:41:15] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/22/21 08:41:15] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 08:41:15] INFO	New Feature Count : 21
[10/22/21 08:41:15] INFO	Scaling Base Features
[10/22/21 08:41:15] INFO	Creating NumPy Features
[10/22/21 08:41:15] INFO	NumPy Feature: sum
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: mean
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: std
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature: var
[10/22/21 08:41:15] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 08:41:15] INFO	NumPy Feature Count : 4
[10/22/21 08:41:15] INFO	New Feature Count : 25
[10/22/21 08:41:15] INFO	Creating Clustering Features
[10/22/21 08:41:15] INFO	Cluster Minimum   : 3
[10/22/21 08:41:15] INFO	Cluster Maximum   : 30
[10/22/21 08:41:15] INFO	Cluster Increment : 3
[10/22/21 08:41:15] INFO	k = 3
[10/22/21 08:41:15] INFO	k = 6
[10/22/21 08:41:15] INFO	k = 9
[10/22/21 08:41:15] INFO	k = 12
[10/22/21 08:41:16] INFO	k = 15
[10/22/21 08:41:16] INFO	k = 18
[10/22/21 08:41:16] INFO	k = 21
[10/22/21 08:41:16] INFO	k = 24
[10/22/21 08:41:16] INFO	k = 27
[10/22/21 08:41:16] INFO	k = 30
[10/22/21 08:41:16] INFO	Clustering Feature Count : 10
[10/22/21 08:41:16] INFO	New Feature Count : 35
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Creating Interactions
[10/22/21 08:41:16] INFO	Initial Feature Count  : 35
[10/22/21 08:41:16] INFO	Skipping Interactions
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Removing Low-Variance Features
[10/22/21 08:41:16] INFO	Low-Variance Threshold  : 0.10
[10/22/21 08:41:16] INFO	Original Feature Count  : 35
[10/22/21 08:41:16] INFO	Reduced Feature Count   : 35
[10/22/21 08:41:16] INFO	Saving New Features in Model
[10/22/21 08:41:16] INFO	Skipping Shuffling
[10/22/21 08:41:16] INFO	Skipping Sampling
[10/22/21 08:41:16] INFO	Getting All Estimators
[10/22/21 08:41:16] INFO	Algorithm Configuration
[10/22/21 08:41:16] INFO	Selecting Models
[10/22/21 08:41:16] INFO	Algorithm: CATB
[10/22/21 08:41:16] INFO	Fitting Initial Model
[10/22/21 08:41:17] INFO	Cross-Validation
[10/22/21 08:41:18] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/22/21 08:41:18] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:21] INFO	RFECV took 2.66 seconds for step 3 and 3 folds
[10/22/21 08:41:21] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/22/21 08:41:21] INFO	No grid is defined for grid search
[10/22/21 08:41:21] INFO	Final Model Predictions for CATB
[10/22/21 08:41:21] INFO	Skipping Calibration
[10/22/21 08:41:21] INFO	Making Predictions
[10/22/21 08:41:21] INFO	Predictions Complete
[10/22/21 08:41:21] INFO	Algorithm: LGB
[10/22/21 08:41:21] INFO	Fitting Initial Model
[10/22/21 08:41:21] INFO	Cross-Validation
[10/22/21 08:41:22] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/22/21 08:41:22] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:24] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[10/22/21 08:41:24] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/22/21 08:41:24] INFO	No grid is defined for grid search
[10/22/21 08:41:24] INFO	Final Model Predictions for LGB
[10/22/21 08:41:24] INFO	Skipping Calibration
[10/22/21 08:41:24] INFO	Making Predictions
[10/22/21 08:41:24] INFO	Predictions Complete
[10/22/21 08:41:24] INFO	Algorithm: XGB
[10/22/21 08:41:24] INFO	Fitting Initial Model
[10/22/21 08:41:25] INFO	Cross-Validation
[10/22/21 08:41:25] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/22/21 08:41:25] INFO	Recursive Feature Elimination with CV
[10/22/21 08:41:28] INFO	RFECV took 2.79 seconds for step 3 and 3 folds
[10/22/21 08:41:28] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/22/21 08:41:28] INFO	Randomized Grid Search
[10/22/21 08:42:48] INFO	Grid Search took 80.46 seconds for 50 candidate parameter settings.
[10/22/21 08:42:48] INFO	Model with rank: 1
[10/22/21 08:42:48] INFO	Mean validation score: 0.872 (std: 0.021)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[10/22/21 08:42:48] INFO	Model with rank: 2
[10/22/21 08:42:48] INFO	Mean validation score: 0.870 (std: 0.020)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[10/22/21 08:42:48] INFO	Model with rank: 3
[10/22/21 08:42:48] INFO	Mean validation score: 0.869 (std: 0.021)
[10/22/21 08:42:48] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 08:42:48] INFO	Algorithm: XGB, Best Score: 0.8723, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[10/22/21 08:42:48] INFO	Final Model Predictions for XGB
[10/22/21 08:42:48] INFO	Skipping Calibration
[10/22/21 08:42:48] INFO	Making Predictions
[10/22/21 08:42:48] INFO	Predictions Complete
[10/22/21 08:42:48] INFO	Blending Models
[10/22/21 08:42:48] INFO	Blending Start: 2021-10-22 08:42:48.601150
[10/22/21 08:42:48] INFO	Blending Complete: 0:00:00.013806
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Metrics for: Partition.train
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: CATB
[10/22/21 08:42:48] INFO	accuracy: 0.8585858585858586
[10/22/21 08:42:48] INFO	average_precision: 0.9113351686222868
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.8378391333525069
[10/22/21 08:42:48] INFO	brier_score_loss: 0.10043404518351136
[10/22/21 08:42:48] INFO	cohen_kappa: 0.6932572665125658
[10/22/21 08:42:48] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/22/21 08:42:48] INFO	f1: 0.8025078369905956
[10/22/21 08:42:48] INFO	neg_log_loss: 0.3371948718196211
[10/22/21 08:42:48] INFO	precision: 0.8648648648648649
[10/22/21 08:42:48] INFO	recall: 0.7485380116959064
[10/22/21 08:42:48] INFO	roc_auc: 0.9297979313797549
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: LGB
[10/22/21 08:42:48] INFO	accuracy: 0.9730639730639731
[10/22/21 08:42:48] INFO	average_precision: 0.9961113207491221
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.9687709711437062
[10/22/21 08:42:48] INFO	brier_score_loss: 0.032809498448974184
[10/22/21 08:42:48] INFO	cohen_kappa: 0.9427387092109702
[10/22/21 08:42:48] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/22/21 08:42:48] INFO	f1: 0.9643916913946586
[10/22/21 08:42:48] INFO	neg_log_loss: 0.1458307566281259
[10/22/21 08:42:48] INFO	precision: 0.9789156626506024
[10/22/21 08:42:48] INFO	recall: 0.9502923976608187
[10/22/21 08:42:48] INFO	roc_auc: 0.9974861257576241
[10/22/21 08:42:48] INFO	--------------------------------------------------------------------------------
[10/22/21 08:42:48] INFO	Algorithm: XGB
[10/22/21 08:42:48] INFO	accuracy: 0.9438832772166106
[10/22/21 08:42:48] INFO	average_precision: 0.9799994752632971
[10/22/21 08:42:48] INFO	balanced_accuracy: 0.9346179656792254
[10/22/21 08:42:48] INFO	brier_score_loss: 0.05492226465405633
[10/22/21 08:42:48] INFO	cohen_kappa: 0.8799068368188655
[10/22/21 08:42:48] INFO	confusion_matrix: [[535  14]
 [ 36 306]]
[10/22/21 08:42:48] INFO	f1: 0.9244712990936558
[10/22/21 08:42:48] INFO	neg_log_loss: 0.21545422471449296
[10/22/21 08:42:48] INFO	precision: 0.95625
[10/22/21 08:42:48] INFO	recall: 0.8947368421052632
[10/22/21 08:42:48] INFO	roc_auc: 0.9858008713343772
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Metrics for: Partition.test
[10/22/21 08:42:48] INFO	No labels for generating Partition.test metrics
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Selecting Best Model
[10/22/21 08:42:48] INFO	Scoring for: Partition.train
[10/22/21 08:42:48] INFO	Best Model Selection Start: 2021-10-22 08:42:48.637402
[10/22/21 08:42:48] INFO	Scoring CATB Model
[10/22/21 08:42:48] INFO	Scoring LGB Model
[10/22/21 08:42:48] INFO	Scoring XGB Model
[10/22/21 08:42:48] INFO	Scoring BLEND Model
[10/22/21 08:42:48] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/22/21 08:42:48] INFO	Best Model Selection Complete: 0:00:00.000262
[10/22/21 08:42:48] INFO	================================================================================
[10/22/21 08:42:48] INFO	Generating Plots for partition: train
[10/22/21 08:42:48] INFO	Generating Calibration Plot
[10/22/21 08:42:48] INFO	Calibration for Algorithm: CATB
[10/22/21 08:42:48] INFO	Calibration for Algorithm: LGB
[10/22/21 08:42:48] INFO	Calibration for Algorithm: XGB
[10/22/21 08:42:48] INFO	Writing plot to ./plots/calibration_train.png
[10/22/21 08:42:48] INFO	Generating Confusion Matrices
[10/22/21 08:42:48] INFO	Confusion Matrix for Algorithm: CATB
[10/22/21 08:42:48] INFO	Confusion Matrix:
[10/22/21 08:42:48] INFO	[[509  40]
 [ 86 256]]
[10/22/21 08:42:48] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/22/21 08:42:48] INFO	Confusion Matrix for Algorithm: LGB
[10/22/21 08:42:48] INFO	Confusion Matrix:
[10/22/21 08:42:48] INFO	[[542   7]
 [ 17 325]]
[10/22/21 08:42:48] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/22/21 08:42:49] INFO	Confusion Matrix for Algorithm: XGB
[10/22/21 08:42:49] INFO	Confusion Matrix:
[10/22/21 08:42:49] INFO	[[535  14]
 [ 36 306]]
[10/22/21 08:42:49] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/22/21 08:42:49] INFO	Generating ROC Curves
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: CATB
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: LGB
[10/22/21 08:42:49] INFO	ROC Curve for Algorithm: XGB
[10/22/21 08:42:49] INFO	Writing plot to ./plots/roc_curve_train.png
[10/22/21 08:42:49] INFO	Generating Learning Curves
[10/22/21 08:42:49] INFO	Algorithm Configuration
[10/22/21 08:42:49] INFO	Learning Curve for Algorithm: CATB
[10/22/21 08:42:49] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/22/21 08:42:49] INFO	Learning Curve for Algorithm: LGB
[10/22/21 08:42:51] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/22/21 08:42:51] INFO	Learning Curve for Algorithm: XGB
[10/22/21 08:42:52] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/22/21 08:42:52] INFO	Generating Feature Importance Plots
[10/22/21 08:42:52] INFO	Feature Importances for Algorithm: CATB
[10/22/21 08:42:52] INFO	Feature Ranking:
[10/22/21 08:42:52] INFO	1. Sex_factor (45.178104)
[10/22/21 08:42:52] INFO	2. Pclass (13.721171)
[10/22/21 08:42:52] INFO	3. Age (6.651788)
[10/22/21 08:42:52] INFO	4. Fare (4.529770)
[10/22/21 08:42:52] INFO	5. var (3.586590)
[10/22/21 08:42:52] INFO	6. std (3.492385)
[10/22/21 08:42:52] INFO	7. Ticket_factor (3.315046)
[10/22/21 08:42:52] INFO	8. cluster_30 (2.831587)
[10/22/21 08:42:52] INFO	9. mean (2.733389)
[10/22/21 08:42:52] INFO	10. Name_factor (2.586310)
[10/22/21 08:42:52] INFO	11. Cabin_factor (2.101764)
[10/22/21 08:42:52] INFO	12. Embarked (2.086410)
[10/22/21 08:42:52] INFO	13. SibSp (2.085405)
[10/22/21 08:42:52] INFO	14. cluster_12 (1.876782)
[10/22/21 08:42:52] INFO	15. cluster_24 (1.263144)
[10/22/21 08:42:52] INFO	16. count_2 (1.004409)
[10/22/21 08:42:52] INFO	17. sum (0.955946)
[10/22/21 08:42:52] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/22/21 08:42:52] INFO	Feature Importances for Algorithm: LGB
[10/22/21 08:42:52] INFO	Feature Ranking:
[10/22/21 08:42:52] INFO	1. Fare (256.000000)
[10/22/21 08:42:52] INFO	2. sum (241.000000)
[10/22/21 08:42:52] INFO	3. Age (232.000000)
[10/22/21 08:42:52] INFO	4. std (201.000000)
[10/22/21 08:42:52] INFO	5. Ticket_factor (199.000000)
[10/22/21 08:42:52] INFO	6. Name_factor (175.000000)
[10/22/21 08:42:52] INFO	7. cluster_30 (53.000000)
[10/22/21 08:42:52] INFO	8. cluster_27 (46.000000)
[10/22/21 08:42:52] INFO	9. Sex_factor (43.000000)
[10/22/21 08:42:52] INFO	10. Pclass (43.000000)
[10/22/21 08:42:52] INFO	11. Cabin_factor (41.000000)
[10/22/21 08:42:52] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/22/21 08:42:53] INFO	Feature Importances for Algorithm: XGB
[10/22/21 08:42:53] INFO	Feature Ranking:
[10/22/21 08:42:53] INFO	1. Sex_factor (0.424644)
[10/22/21 08:42:53] INFO	2. Pclass (0.127452)
[10/22/21 08:42:53] INFO	3. Cabin_factor (0.081307)
[10/22/21 08:42:53] INFO	4. Age (0.051007)
[10/22/21 08:42:53] INFO	5. SibSp (0.049620)
[10/22/21 08:42:53] INFO	6. count_1 (0.046373)
[10/22/21 08:42:53] INFO	7. Embarked (0.046225)
[10/22/21 08:42:53] INFO	8. std (0.036262)
[10/22/21 08:42:53] INFO	9. cluster_30 (0.036076)
[10/22/21 08:42:53] INFO	10. Fare (0.032410)
[10/22/21 08:42:53] INFO	11. cluster_24 (0.021187)
[10/22/21 08:42:53] INFO	12. Name_factor (0.019312)
[10/22/21 08:42:53] INFO	13. sum (0.017784)
[10/22/21 08:42:53] INFO	14. cluster_15 (0.010340)
[10/22/21 08:42:53] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/22/21 08:42:53] INFO	================================================================================
[10/22/21 08:42:53] INFO	Saving Model Predictor
[10/22/21 08:42:53] INFO	Writing model predictor to ./model/model_20211022.pkl
[10/22/21 08:42:53] INFO	Saving Feature Map
[10/22/21 08:42:53] INFO	Writing feature map to ./model/feature_map_20211022.pkl
[10/22/21 08:42:53] INFO	Loading data from ./input/test_20211022.csv
[10/22/21 08:42:53] INFO	Saving Predictions
[10/22/21 08:42:53] INFO	Writing data frame to ./output/predictions_20211022.csv
[10/22/21 08:42:53] INFO	Saving Probabilities
[10/22/21 08:42:53] INFO	Writing data frame to ./output/probabilities_20211022.csv
[10/22/21 08:42:53] INFO	Saving Ranked Predictions
[10/22/21 08:42:53] INFO	Writing data frame to ./output/rankings_20211022.csv
[10/22/21 08:42:53] INFO	Saving Submission to ./output/submission_20211022.csv
[10/22/21 08:42:53] INFO	********************************************************************************
[10/22/21 08:42:53] INFO	AlphaPy End
[10/22/21 08:42:53] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	AlphaPy Start
[10/22/21 09:20:57] INFO	********************************************************************************
[10/22/21 09:20:57] INFO	Model Configuration
[10/22/21 09:20:57] INFO	No transforms Found
[10/22/21 09:20:57] INFO	MODEL PARAMETERS:
[10/22/21 09:20:57] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/22/21 09:20:57] INFO	calibration       = False
[10/22/21 09:20:57] INFO	cal_type          = sigmoid
[10/22/21 09:20:57] INFO	calibration_plot  = False
[10/22/21 09:20:57] INFO	clustering        = True
[10/22/21 09:20:57] INFO	cluster_inc       = 3
[10/22/21 09:20:57] INFO	cluster_max       = 30
[10/22/21 09:20:57] INFO	cluster_min       = 3
[10/22/21 09:20:57] INFO	confusion_matrix  = True
[10/22/21 09:20:57] INFO	counts            = True
[10/22/21 09:20:57] INFO	cv_folds          = 3
[10/22/21 09:20:57] INFO	directory         = .
[10/22/21 09:20:57] INFO	extension         = csv
[10/22/21 09:20:57] INFO	drop              = ['PassengerId']
[10/22/21 09:20:57] INFO	encoder           = <Encoders.target: 14>
[10/22/21 09:20:57] INFO	esr               = 20
[10/22/21 09:20:57] INFO	factors           = ['Embarked']
[10/22/21 09:20:57] INFO	features [X]      = *
[10/22/21 09:20:57] INFO	feature_selection = False
[10/22/21 09:20:57] INFO	fs_percentage     = 50
[10/22/21 09:20:57] INFO	fs_score_func     = <function f_classif at 0x7fddd034a5e0>
[10/22/21 09:20:57] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/22/21 09:20:57] INFO	grid_search       = True
[10/22/21 09:20:57] INFO	gs_iters          = 50
[10/22/21 09:20:57] INFO	gs_random         = True
[10/22/21 09:20:57] INFO	gs_sample         = False
[10/22/21 09:20:57] INFO	gs_sample_pct     = 0.200000
[10/22/21 09:20:57] INFO	importances       = True
[10/22/21 09:20:57] INFO	interactions      = False
[10/22/21 09:20:57] INFO	isomap            = False
[10/22/21 09:20:57] INFO	iso_components    = 2
[10/22/21 09:20:57] INFO	iso_neighbors     = 5
[10/22/21 09:20:57] INFO	isample_pct       = 10
[10/22/21 09:20:57] INFO	leaders           = []
[10/22/21 09:20:57] INFO	learning_curve    = True
[10/22/21 09:20:57] INFO	logtransform      = False
[10/22/21 09:20:57] INFO	lv_remove         = True
[10/22/21 09:20:57] INFO	lv_threshold      = 0.100000
[10/22/21 09:20:57] INFO	model_type        = <ModelType.classification: 1>
[10/22/21 09:20:57] INFO	n_estimators      = 51
[10/22/21 09:20:57] INFO	n_jobs            = -1
[10/22/21 09:20:57] INFO	ngrams_max        = 2
[10/22/21 09:20:57] INFO	numpy             = True
[10/22/21 09:20:57] INFO	pca               = False
[10/22/21 09:20:57] INFO	pca_inc           = 1
[10/22/21 09:20:57] INFO	pca_max           = 10
[10/22/21 09:20:57] INFO	pca_min           = 2
[10/22/21 09:20:57] INFO	pca_whiten        = False
[10/22/21 09:20:57] INFO	poly_degree       = 2
[10/22/21 09:20:57] INFO	pvalue_level      = 0.010000
[10/22/21 09:20:57] INFO	rfe               = True
[10/22/21 09:20:57] INFO	rfe_step          = 3
[10/22/21 09:20:57] INFO	roc_curve         = True
[10/22/21 09:20:57] INFO	rounding          = 2
[10/22/21 09:20:57] INFO	sampling          = False
[10/22/21 09:20:57] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/22/21 09:20:57] INFO	sampling_ratio    = 0.500000
[10/22/21 09:20:57] INFO	scaler_option     = True
[10/22/21 09:20:57] INFO	scaler_type       = <Scalers.standard: 2>
[10/22/21 09:20:57] INFO	scipy             = False
[10/22/21 09:20:57] INFO	scorer            = roc_auc
[10/22/21 09:20:57] INFO	seed              = 42
[10/22/21 09:20:57] INFO	sentinel          = -1
[10/22/21 09:20:57] INFO	separator         = ,
[10/22/21 09:20:57] INFO	shuffle           = False
[10/22/21 09:20:57] INFO	split             = 0.400000
[10/22/21 09:20:57] INFO	submission_file   = gender_submission
[10/22/21 09:20:57] INFO	submit_probas     = False
[10/22/21 09:20:57] INFO	target [y]        = Survived
[10/22/21 09:20:57] INFO	target_value      = 1
[10/22/21 09:20:57] INFO	transforms        = None
[10/22/21 09:20:57] INFO	tsne              = False
[10/22/21 09:20:57] INFO	tsne_components   = 2
[10/22/21 09:20:57] INFO	tsne_learn_rate   = 1000.000000
[10/22/21 09:20:57] INFO	tsne_perplexity   = 30.000000
[10/22/21 09:20:57] INFO	vectorize         = False
[10/22/21 09:20:57] INFO	verbosity         = 0
[10/22/21 09:20:57] INFO	Creating Model
[10/22/21 09:20:57] INFO	Calling Pipeline
[10/22/21 09:20:57] INFO	Training Pipeline
[10/22/21 09:20:57] INFO	Loading Data
[10/22/21 09:20:57] INFO	Loading data from ./input/train.csv
[10/22/21 09:20:57] INFO	Found target Survived in data frame
[10/22/21 09:20:57] INFO	Labels (y) found for Partition.train
[10/22/21 09:20:57] INFO	Loading Data
[10/22/21 09:20:57] INFO	Loading data from ./input/test.csv
[10/22/21 09:20:57] INFO	Target Survived not found in Partition.test
[10/22/21 09:20:57] INFO	Saving New Features in Model
[10/22/21 09:20:57] INFO	Original Feature Statistics
[10/22/21 09:20:57] INFO	Number of Training Rows    : 891
[10/22/21 09:20:57] INFO	Number of Training Columns : 11
[10/22/21 09:20:57] INFO	Unique Training Values for Survived : [0 1]
[10/22/21 09:20:57] INFO	Unique Training Counts for Survived : [549 342]
[10/22/21 09:20:57] INFO	Number of Testing Rows     : 418
[10/22/21 09:20:57] INFO	Number of Testing Columns  : 11
[10/22/21 09:20:57] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 09:20:57] INFO	Feature Count     : 11
[10/22/21 09:20:57] INFO	Applying transforms
[10/22/21 09:20:57] INFO	No transforms Specified
[10/22/21 09:20:57] INFO	New Feature Count : 11
[10/22/21 09:20:57] INFO	Dropping Features: ['PassengerId']
[10/22/21 09:20:57] INFO	Original Feature Count : 11
[10/22/21 09:20:57] INFO	Reduced Feature Count  : 10
[10/22/21 09:20:57] INFO	Writing data frame to ./input/train_20211022.csv
[10/22/21 09:20:57] INFO	Writing data frame to ./input/test_20211022.csv
[10/22/21 09:20:57] INFO	Creating Cross-Tabulations
[10/22/21 09:20:57] INFO	Creating crosstabs for feature Embarked
[10/22/21 09:20:57] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/22/21 09:20:57] INFO	Feature Count     : 10
[10/22/21 09:20:57] INFO	Creating Count Features
[10/22/21 09:20:57] INFO	NA Counts
[10/22/21 09:20:57] INFO	Number Counts
[10/22/21 09:20:57] INFO	New Feature Count : 21
[10/22/21 09:20:57] INFO	Creating Base Features
[10/22/21 09:20:57] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/22/21 09:20:57] INFO	Feature 2: Name => Factorization
[10/22/21 09:20:57] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/22/21 09:20:57] INFO	Feature 3: Sex => Factorization
[10/22/21 09:20:57] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/22/21 09:20:57] INFO	Feature 7: Ticket => Factorization
[10/22/21 09:20:57] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/22/21 09:20:57] INFO	Feature 9: Cabin => Factorization
[10/22/21 09:20:57] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/22/21 09:20:57] INFO	Encoding: Encoders.target
[10/22/21 09:20:57] INFO	Fitting training features for Embarked
[10/22/21 09:20:57] INFO	Transforming testing features for Embarked
[10/22/21 09:20:57] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/22/21 09:20:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/22/21 09:20:57] INFO	New Feature Count : 21
[10/22/21 09:20:57] INFO	Scaling Base Features
[10/22/21 09:20:57] INFO	Creating NumPy Features
[10/22/21 09:20:57] INFO	NumPy Feature: sum
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: mean
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: std
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature: var
[10/22/21 09:20:57] INFO	    Imputation for Data Type float64: Median Strategy
[10/22/21 09:20:57] INFO	NumPy Feature Count : 4
[10/22/21 09:20:57] INFO	New Feature Count : 25
[10/22/21 09:20:57] INFO	Creating Clustering Features
[10/22/21 09:20:57] INFO	Cluster Minimum   : 3
[10/22/21 09:20:57] INFO	Cluster Maximum   : 30
[10/22/21 09:20:57] INFO	Cluster Increment : 3
[10/22/21 09:20:57] INFO	k = 3
[10/22/21 09:20:58] INFO	k = 6
[10/22/21 09:20:58] INFO	k = 9
[10/22/21 09:20:58] INFO	k = 12
[10/22/21 09:20:58] INFO	k = 15
[10/22/21 09:20:58] INFO	k = 18
[10/22/21 09:20:58] INFO	k = 21
[10/22/21 09:20:58] INFO	k = 24
[10/22/21 09:20:58] INFO	k = 27
[10/22/21 09:20:58] INFO	k = 30
[10/22/21 09:20:58] INFO	Clustering Feature Count : 10
[10/22/21 09:20:58] INFO	New Feature Count : 35
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Creating Interactions
[10/22/21 09:20:58] INFO	Initial Feature Count  : 35
[10/22/21 09:20:58] INFO	Skipping Interactions
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Removing Low-Variance Features
[10/22/21 09:20:58] INFO	Low-Variance Threshold  : 0.10
[10/22/21 09:20:58] INFO	Original Feature Count  : 35
[10/22/21 09:20:58] INFO	Reduced Feature Count   : 35
[10/22/21 09:20:58] INFO	Saving New Features in Model
[10/22/21 09:20:58] INFO	Skipping Shuffling
[10/22/21 09:20:58] INFO	Skipping Sampling
[10/22/21 09:20:58] INFO	Getting All Estimators
[10/22/21 09:20:58] INFO	Algorithm Configuration
[10/22/21 09:20:59] INFO	Selecting Models
[10/22/21 09:20:59] INFO	Algorithm: CATB
[10/22/21 09:20:59] INFO	Fitting Initial Model
[10/22/21 09:20:59] INFO	Cross-Validation
[10/22/21 09:21:01] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/22/21 09:21:01] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:03] INFO	RFECV took 2.86 seconds for step 3 and 3 folds
[10/22/21 09:21:03] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/22/21 09:21:03] INFO	No grid is defined for grid search
[10/22/21 09:21:03] INFO	Final Model Predictions for CATB
[10/22/21 09:21:03] INFO	Skipping Calibration
[10/22/21 09:21:03] INFO	Making Predictions
[10/22/21 09:21:03] INFO	Predictions Complete
[10/22/21 09:21:03] INFO	Algorithm: LGB
[10/22/21 09:21:03] INFO	Fitting Initial Model
[10/22/21 09:21:04] INFO	Cross-Validation
[10/22/21 09:21:05] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/22/21 09:21:05] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:07] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[10/22/21 09:21:07] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/22/21 09:21:07] INFO	No grid is defined for grid search
[10/22/21 09:21:07] INFO	Final Model Predictions for LGB
[10/22/21 09:21:07] INFO	Skipping Calibration
[10/22/21 09:21:07] INFO	Making Predictions
[10/22/21 09:21:07] INFO	Predictions Complete
[10/22/21 09:21:07] INFO	Algorithm: XGB
[10/22/21 09:21:07] INFO	Fitting Initial Model
[10/22/21 09:21:07] INFO	Cross-Validation
[10/22/21 09:21:08] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/22/21 09:21:08] INFO	Recursive Feature Elimination with CV
[10/22/21 09:21:10] INFO	RFECV took 2.70 seconds for step 3 and 3 folds
[10/22/21 09:21:10] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/22/21 09:21:10] INFO	Randomized Grid Search
[10/22/21 09:22:38] INFO	Grid Search took 87.43 seconds for 50 candidate parameter settings.
[10/22/21 09:22:38] INFO	Model with rank: 1
[10/22/21 09:22:38] INFO	Mean validation score: 0.871 (std: 0.023)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/22/21 09:22:38] INFO	Model with rank: 2
[10/22/21 09:22:38] INFO	Mean validation score: 0.868 (std: 0.018)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 09:22:38] INFO	Model with rank: 3
[10/22/21 09:22:38] INFO	Mean validation score: 0.868 (std: 0.020)
[10/22/21 09:22:38] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/22/21 09:22:38] INFO	Algorithm: XGB, Best Score: 0.8707, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[10/22/21 09:22:38] INFO	Final Model Predictions for XGB
[10/22/21 09:22:38] INFO	Skipping Calibration
[10/22/21 09:22:38] INFO	Making Predictions
[10/22/21 09:22:38] INFO	Predictions Complete
[10/22/21 09:22:38] INFO	Blending Models
[10/22/21 09:22:38] INFO	Blending Start: 2021-10-22 09:22:38.257465
[10/22/21 09:22:38] INFO	Blending Complete: 0:00:00.011166
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Metrics for: Partition.train
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: CATB
[10/22/21 09:22:38] INFO	accuracy: 0.8585858585858586
[10/22/21 09:22:38] INFO	average_precision: 0.9113351686222868
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.8378391333525069
[10/22/21 09:22:38] INFO	brier_score_loss: 0.10043404518351136
[10/22/21 09:22:38] INFO	cohen_kappa: 0.6932572665125658
[10/22/21 09:22:38] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/22/21 09:22:38] INFO	f1: 0.8025078369905956
[10/22/21 09:22:38] INFO	neg_log_loss: 0.3371948718196211
[10/22/21 09:22:38] INFO	precision: 0.8648648648648649
[10/22/21 09:22:38] INFO	recall: 0.7485380116959064
[10/22/21 09:22:38] INFO	roc_auc: 0.9297979313797549
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: LGB
[10/22/21 09:22:38] INFO	accuracy: 0.9730639730639731
[10/22/21 09:22:38] INFO	average_precision: 0.9961113207491221
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.9687709711437062
[10/22/21 09:22:38] INFO	brier_score_loss: 0.032809498448974184
[10/22/21 09:22:38] INFO	cohen_kappa: 0.9427387092109702
[10/22/21 09:22:38] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/22/21 09:22:38] INFO	f1: 0.9643916913946586
[10/22/21 09:22:38] INFO	neg_log_loss: 0.1458307566281259
[10/22/21 09:22:38] INFO	precision: 0.9789156626506024
[10/22/21 09:22:38] INFO	recall: 0.9502923976608187
[10/22/21 09:22:38] INFO	roc_auc: 0.9974861257576241
[10/22/21 09:22:38] INFO	--------------------------------------------------------------------------------
[10/22/21 09:22:38] INFO	Algorithm: XGB
[10/22/21 09:22:38] INFO	accuracy: 0.9292929292929293
[10/22/21 09:22:38] INFO	average_precision: 0.9729467120088303
[10/22/21 09:22:38] INFO	balanced_accuracy: 0.915612117726009
[10/22/21 09:22:38] INFO	brier_score_loss: 0.07965308322437895
[10/22/21 09:22:38] INFO	cohen_kappa: 0.8475769202570933
[10/22/21 09:22:38] INFO	confusion_matrix: [[535  14]
 [ 49 293]]
[10/22/21 09:22:38] INFO	f1: 0.9029275808936826
[10/22/21 09:22:38] INFO	neg_log_loss: 0.305648740301563
[10/22/21 09:22:38] INFO	precision: 0.9543973941368078
[10/22/21 09:22:38] INFO	recall: 0.8567251461988304
[10/22/21 09:22:38] INFO	roc_auc: 0.9796173798187028
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Metrics for: Partition.test
[10/22/21 09:22:38] INFO	No labels for generating Partition.test metrics
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Selecting Best Model
[10/22/21 09:22:38] INFO	Scoring for: Partition.train
[10/22/21 09:22:38] INFO	Best Model Selection Start: 2021-10-22 09:22:38.289742
[10/22/21 09:22:38] INFO	Scoring CATB Model
[10/22/21 09:22:38] INFO	Scoring LGB Model
[10/22/21 09:22:38] INFO	Scoring XGB Model
[10/22/21 09:22:38] INFO	Scoring BLEND Model
[10/22/21 09:22:38] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[10/22/21 09:22:38] INFO	Best Model Selection Complete: 0:00:00.000198
[10/22/21 09:22:38] INFO	================================================================================
[10/22/21 09:22:38] INFO	Generating Plots for partition: train
[10/22/21 09:22:38] INFO	Generating Calibration Plot
[10/22/21 09:22:38] INFO	Calibration for Algorithm: CATB
[10/22/21 09:22:38] INFO	Calibration for Algorithm: LGB
[10/22/21 09:22:38] INFO	Calibration for Algorithm: XGB
[10/22/21 09:22:38] INFO	Writing plot to ./plots/calibration_train.png
[10/22/21 09:22:38] INFO	Generating Confusion Matrices
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: CATB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[509  40]
 [ 86 256]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: LGB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[542   7]
 [ 17 325]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/22/21 09:22:38] INFO	Confusion Matrix for Algorithm: XGB
[10/22/21 09:22:38] INFO	Confusion Matrix:
[10/22/21 09:22:38] INFO	[[535  14]
 [ 49 293]]
[10/22/21 09:22:38] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/22/21 09:22:38] INFO	Generating ROC Curves
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: CATB
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: LGB
[10/22/21 09:22:38] INFO	ROC Curve for Algorithm: XGB
[10/22/21 09:22:38] INFO	Writing plot to ./plots/roc_curve_train.png
[10/22/21 09:22:38] INFO	Generating Learning Curves
[10/22/21 09:22:38] INFO	Algorithm Configuration
[10/22/21 09:22:38] INFO	Learning Curve for Algorithm: CATB
[10/22/21 09:22:39] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/22/21 09:22:39] INFO	Learning Curve for Algorithm: LGB
[10/22/21 09:22:41] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/22/21 09:22:41] INFO	Learning Curve for Algorithm: XGB
[10/22/21 09:22:42] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/22/21 09:22:42] INFO	Generating Feature Importance Plots
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: CATB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Sex_factor (45.178104)
[10/22/21 09:22:42] INFO	2. Pclass (13.721171)
[10/22/21 09:22:42] INFO	3. Age (6.651788)
[10/22/21 09:22:42] INFO	4. Fare (4.529770)
[10/22/21 09:22:42] INFO	5. var (3.586590)
[10/22/21 09:22:42] INFO	6. std (3.492385)
[10/22/21 09:22:42] INFO	7. Ticket_factor (3.315046)
[10/22/21 09:22:42] INFO	8. cluster_30 (2.831587)
[10/22/21 09:22:42] INFO	9. mean (2.733389)
[10/22/21 09:22:42] INFO	10. Name_factor (2.586310)
[10/22/21 09:22:42] INFO	11. Cabin_factor (2.101764)
[10/22/21 09:22:42] INFO	12. Embarked (2.086410)
[10/22/21 09:22:42] INFO	13. SibSp (2.085405)
[10/22/21 09:22:42] INFO	14. cluster_12 (1.876782)
[10/22/21 09:22:42] INFO	15. cluster_24 (1.263144)
[10/22/21 09:22:42] INFO	16. count_2 (1.004409)
[10/22/21 09:22:42] INFO	17. sum (0.955946)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: LGB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Fare (256.000000)
[10/22/21 09:22:42] INFO	2. sum (241.000000)
[10/22/21 09:22:42] INFO	3. Age (232.000000)
[10/22/21 09:22:42] INFO	4. std (201.000000)
[10/22/21 09:22:42] INFO	5. Ticket_factor (199.000000)
[10/22/21 09:22:42] INFO	6. Name_factor (175.000000)
[10/22/21 09:22:42] INFO	7. cluster_30 (53.000000)
[10/22/21 09:22:42] INFO	8. cluster_27 (46.000000)
[10/22/21 09:22:42] INFO	9. Sex_factor (43.000000)
[10/22/21 09:22:42] INFO	10. Pclass (43.000000)
[10/22/21 09:22:42] INFO	11. Cabin_factor (41.000000)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/22/21 09:22:42] INFO	Feature Importances for Algorithm: XGB
[10/22/21 09:22:42] INFO	Feature Ranking:
[10/22/21 09:22:42] INFO	1. Sex_factor (0.424644)
[10/22/21 09:22:42] INFO	2. Pclass (0.127452)
[10/22/21 09:22:42] INFO	3. Cabin_factor (0.081307)
[10/22/21 09:22:42] INFO	4. Age (0.051007)
[10/22/21 09:22:42] INFO	5. SibSp (0.049620)
[10/22/21 09:22:42] INFO	6. count_1 (0.046373)
[10/22/21 09:22:42] INFO	7. Embarked (0.046225)
[10/22/21 09:22:42] INFO	8. std (0.036262)
[10/22/21 09:22:42] INFO	9. cluster_30 (0.036076)
[10/22/21 09:22:42] INFO	10. Fare (0.032410)
[10/22/21 09:22:42] INFO	11. cluster_24 (0.021187)
[10/22/21 09:22:42] INFO	12. Name_factor (0.019312)
[10/22/21 09:22:42] INFO	13. sum (0.017784)
[10/22/21 09:22:42] INFO	14. cluster_15 (0.010340)
[10/22/21 09:22:42] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/22/21 09:22:42] INFO	================================================================================
[10/22/21 09:22:42] INFO	Saving Model Predictor
[10/22/21 09:22:42] INFO	Writing model predictor to ./model/model_20211022.pkl
[10/22/21 09:22:42] INFO	Saving Feature Map
[10/22/21 09:22:42] INFO	Writing feature map to ./model/feature_map_20211022.pkl
[10/22/21 09:22:42] INFO	Loading data from ./input/test_20211022.csv
[10/22/21 09:22:42] INFO	Saving Predictions
[10/22/21 09:22:42] INFO	Writing data frame to ./output/predictions_20211022.csv
[10/22/21 09:22:42] INFO	Saving Probabilities
[10/22/21 09:22:42] INFO	Writing data frame to ./output/probabilities_20211022.csv
[10/22/21 09:22:42] INFO	Saving Ranked Predictions
[10/22/21 09:22:42] INFO	Writing data frame to ./output/rankings_20211022.csv
[10/22/21 09:22:42] INFO	Saving Submission to ./output/submission_20211022.csv
[10/22/21 09:22:42] INFO	********************************************************************************
[10/22/21 09:22:42] INFO	AlphaPy End
[10/22/21 09:22:42] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	AlphaPy Start
[10/30/21 00:07:14] INFO	********************************************************************************
[10/30/21 00:07:14] INFO	Model Configuration
[10/30/21 00:07:14] INFO	No transforms Found
[10/30/21 00:07:14] INFO	MODEL PARAMETERS:
[10/30/21 00:07:14] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[10/30/21 00:07:14] INFO	calibration       = False
[10/30/21 00:07:14] INFO	cal_type          = sigmoid
[10/30/21 00:07:14] INFO	calibration_plot  = False
[10/30/21 00:07:14] INFO	clustering        = True
[10/30/21 00:07:14] INFO	cluster_inc       = 3
[10/30/21 00:07:14] INFO	cluster_max       = 30
[10/30/21 00:07:14] INFO	cluster_min       = 3
[10/30/21 00:07:14] INFO	confusion_matrix  = True
[10/30/21 00:07:14] INFO	counts            = True
[10/30/21 00:07:14] INFO	cv_folds          = 3
[10/30/21 00:07:14] INFO	directory         = .
[10/30/21 00:07:14] INFO	extension         = csv
[10/30/21 00:07:14] INFO	drop              = ['PassengerId']
[10/30/21 00:07:14] INFO	encoder           = <Encoders.target: 14>
[10/30/21 00:07:14] INFO	esr               = 20
[10/30/21 00:07:14] INFO	factors           = ['Embarked']
[10/30/21 00:07:14] INFO	features [X]      = *
[10/30/21 00:07:14] INFO	feature_selection = False
[10/30/21 00:07:14] INFO	fs_percentage     = 50
[10/30/21 00:07:14] INFO	fs_score_func     = <function f_classif at 0x7fc8d8a19820>
[10/30/21 00:07:14] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[10/30/21 00:07:14] INFO	grid_search       = True
[10/30/21 00:07:14] INFO	gs_iters          = 50
[10/30/21 00:07:14] INFO	gs_random         = True
[10/30/21 00:07:14] INFO	gs_sample         = False
[10/30/21 00:07:14] INFO	gs_sample_pct     = 0.200000
[10/30/21 00:07:14] INFO	importances       = True
[10/30/21 00:07:14] INFO	interactions      = False
[10/30/21 00:07:14] INFO	isomap            = False
[10/30/21 00:07:14] INFO	iso_components    = 2
[10/30/21 00:07:14] INFO	iso_neighbors     = 5
[10/30/21 00:07:14] INFO	isample_pct       = 10
[10/30/21 00:07:14] INFO	leaders           = []
[10/30/21 00:07:14] INFO	learning_curve    = True
[10/30/21 00:07:14] INFO	logtransform      = False
[10/30/21 00:07:14] INFO	lv_remove         = True
[10/30/21 00:07:14] INFO	lv_threshold      = 0.100000
[10/30/21 00:07:14] INFO	model_type        = <ModelType.classification: 1>
[10/30/21 00:07:14] INFO	n_estimators      = 51
[10/30/21 00:07:14] INFO	n_jobs            = -1
[10/30/21 00:07:14] INFO	ngrams_max        = 2
[10/30/21 00:07:14] INFO	numpy             = True
[10/30/21 00:07:14] INFO	pca               = False
[10/30/21 00:07:14] INFO	pca_inc           = 1
[10/30/21 00:07:14] INFO	pca_max           = 10
[10/30/21 00:07:14] INFO	pca_min           = 2
[10/30/21 00:07:14] INFO	pca_whiten        = False
[10/30/21 00:07:14] INFO	poly_degree       = 2
[10/30/21 00:07:14] INFO	pvalue_level      = 0.010000
[10/30/21 00:07:14] INFO	rfe               = True
[10/30/21 00:07:14] INFO	rfe_step          = 3
[10/30/21 00:07:14] INFO	roc_curve         = True
[10/30/21 00:07:14] INFO	rounding          = 2
[10/30/21 00:07:14] INFO	sampling          = False
[10/30/21 00:07:14] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[10/30/21 00:07:14] INFO	sampling_ratio    = 0.500000
[10/30/21 00:07:14] INFO	scaler_option     = True
[10/30/21 00:07:14] INFO	scaler_type       = <Scalers.standard: 2>
[10/30/21 00:07:14] INFO	scipy             = False
[10/30/21 00:07:14] INFO	scorer            = roc_auc
[10/30/21 00:07:14] INFO	seed              = 42
[10/30/21 00:07:14] INFO	sentinel          = -1
[10/30/21 00:07:14] INFO	separator         = ,
[10/30/21 00:07:14] INFO	shuffle           = False
[10/30/21 00:07:14] INFO	split             = 0.400000
[10/30/21 00:07:14] INFO	submission_file   = gender_submission
[10/30/21 00:07:14] INFO	submit_probas     = False
[10/30/21 00:07:14] INFO	target [y]        = Survived
[10/30/21 00:07:14] INFO	target_value      = 1
[10/30/21 00:07:14] INFO	transforms        = None
[10/30/21 00:07:14] INFO	tsne              = False
[10/30/21 00:07:14] INFO	tsne_components   = 2
[10/30/21 00:07:14] INFO	tsne_learn_rate   = 1000.000000
[10/30/21 00:07:14] INFO	tsne_perplexity   = 30.000000
[10/30/21 00:07:14] INFO	vectorize         = False
[10/30/21 00:07:14] INFO	verbosity         = 0
[10/30/21 00:07:14] INFO	Creating Model
[10/30/21 00:07:14] INFO	Calling Pipeline
[10/30/21 00:07:14] INFO	Training Pipeline
[10/30/21 00:07:14] INFO	Loading Data
[10/30/21 00:07:14] INFO	Loading data from ./input/train.csv
[10/30/21 00:07:14] INFO	Found target Survived in data frame
[10/30/21 00:07:14] INFO	Labels (y) found for Partition.train
[10/30/21 00:07:14] INFO	Loading Data
[10/30/21 00:07:14] INFO	Loading data from ./input/test.csv
[10/30/21 00:07:14] INFO	Target Survived not found in Partition.test
[10/30/21 00:07:14] INFO	Saving New Features in Model
[10/30/21 00:07:14] INFO	Original Feature Statistics
[10/30/21 00:07:14] INFO	Number of Training Rows    : 891
[10/30/21 00:07:14] INFO	Number of Training Columns : 11
[10/30/21 00:07:14] INFO	Unique Training Values for Survived : [0 1]
[10/30/21 00:07:14] INFO	Unique Training Counts for Survived : [549 342]
[10/30/21 00:07:14] INFO	Number of Testing Rows     : 418
[10/30/21 00:07:14] INFO	Number of Testing Columns  : 11
[10/30/21 00:07:14] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[10/30/21 00:07:14] INFO	Feature Count     : 11
[10/30/21 00:07:14] INFO	Applying transforms
[10/30/21 00:07:14] INFO	No transforms Specified
[10/30/21 00:07:14] INFO	New Feature Count : 11
[10/30/21 00:07:14] INFO	Dropping Features: ['PassengerId']
[10/30/21 00:07:14] INFO	Original Feature Count : 11
[10/30/21 00:07:14] INFO	Reduced Feature Count  : 10
[10/30/21 00:07:14] INFO	Writing data frame to ./input/train_20211030.csv
[10/30/21 00:07:14] INFO	Writing data frame to ./input/test_20211030.csv
[10/30/21 00:07:14] INFO	Creating Cross-Tabulations
[10/30/21 00:07:14] INFO	Creating crosstabs for feature Embarked
[10/30/21 00:07:14] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[10/30/21 00:07:14] INFO	Feature Count     : 10
[10/30/21 00:07:14] INFO	Creating Count Features
[10/30/21 00:07:14] INFO	NA Counts
[10/30/21 00:07:14] INFO	Number Counts
[10/30/21 00:07:14] INFO	New Feature Count : 21
[10/30/21 00:07:14] INFO	Creating Base Features
[10/30/21 00:07:14] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[10/30/21 00:07:14] INFO	Feature 2: Name => Factorization
[10/30/21 00:07:14] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[10/30/21 00:07:14] INFO	Feature 3: Sex => Factorization
[10/30/21 00:07:14] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[10/30/21 00:07:14] INFO	Feature 7: Ticket => Factorization
[10/30/21 00:07:14] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[10/30/21 00:07:14] INFO	Feature 9: Cabin => Factorization
[10/30/21 00:07:14] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[10/30/21 00:07:14] INFO	Encoding: Encoders.target
[10/30/21 00:07:14] INFO	Fitting training features for Embarked
[10/30/21 00:07:14] INFO	Transforming testing features for Embarked
[10/30/21 00:07:14] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[10/30/21 00:07:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[10/30/21 00:07:14] INFO	New Feature Count : 21
[10/30/21 00:07:14] INFO	Scaling Base Features
[10/30/21 00:07:14] INFO	Creating NumPy Features
[10/30/21 00:07:14] INFO	NumPy Feature: sum
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: mean
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: std
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature: var
[10/30/21 00:07:14] INFO	    Imputation for Data Type float64: Median Strategy
[10/30/21 00:07:14] INFO	NumPy Feature Count : 4
[10/30/21 00:07:14] INFO	New Feature Count : 25
[10/30/21 00:07:14] INFO	Creating Clustering Features
[10/30/21 00:07:14] INFO	Cluster Minimum   : 3
[10/30/21 00:07:14] INFO	Cluster Maximum   : 30
[10/30/21 00:07:14] INFO	Cluster Increment : 3
[10/30/21 00:07:14] INFO	k = 3
[10/30/21 00:07:15] INFO	k = 6
[10/30/21 00:07:15] INFO	k = 9
[10/30/21 00:07:15] INFO	k = 12
[10/30/21 00:07:15] INFO	k = 15
[10/30/21 00:07:15] INFO	k = 18
[10/30/21 00:07:15] INFO	k = 21
[10/30/21 00:07:15] INFO	k = 24
[10/30/21 00:07:15] INFO	k = 27
[10/30/21 00:07:15] INFO	k = 30
[10/30/21 00:07:15] INFO	Clustering Feature Count : 10
[10/30/21 00:07:15] INFO	New Feature Count : 35
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Creating Interactions
[10/30/21 00:07:15] INFO	Initial Feature Count  : 35
[10/30/21 00:07:15] INFO	Skipping Interactions
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Removing Low-Variance Features
[10/30/21 00:07:15] INFO	Low-Variance Threshold  : 0.10
[10/30/21 00:07:15] INFO	Original Feature Count  : 35
[10/30/21 00:07:15] INFO	Reduced Feature Count   : 35
[10/30/21 00:07:15] INFO	Saving New Features in Model
[10/30/21 00:07:15] INFO	Skipping Shuffling
[10/30/21 00:07:15] INFO	Skipping Sampling
[10/30/21 00:07:15] INFO	Getting All Estimators
[10/30/21 00:07:15] INFO	Algorithm Configuration
[10/30/21 00:07:15] INFO	Selecting Models
[10/30/21 00:07:15] INFO	Algorithm: CATB
[10/30/21 00:07:15] INFO	Fitting Initial Model
[10/30/21 00:07:16] INFO	Cross-Validation
[10/30/21 00:07:17] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[10/30/21 00:07:17] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:20] INFO	RFECV took 2.58 seconds for step 3 and 3 folds
[10/30/21 00:07:20] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[10/30/21 00:07:20] INFO	No grid is defined for grid search
[10/30/21 00:07:20] INFO	Final Model Predictions for CATB
[10/30/21 00:07:20] INFO	Skipping Calibration
[10/30/21 00:07:20] INFO	Making Predictions
[10/30/21 00:07:20] INFO	Predictions Complete
[10/30/21 00:07:20] INFO	Algorithm: LGB
[10/30/21 00:07:20] INFO	Fitting Initial Model
[10/30/21 00:07:20] INFO	Cross-Validation
[10/30/21 00:07:21] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[10/30/21 00:07:21] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:23] INFO	RFECV took 2.30 seconds for step 3 and 3 folds
[10/30/21 00:07:23] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[10/30/21 00:07:23] INFO	No grid is defined for grid search
[10/30/21 00:07:23] INFO	Final Model Predictions for LGB
[10/30/21 00:07:23] INFO	Skipping Calibration
[10/30/21 00:07:23] INFO	Making Predictions
[10/30/21 00:07:23] INFO	Predictions Complete
[10/30/21 00:07:23] INFO	Algorithm: XGB
[10/30/21 00:07:23] INFO	Fitting Initial Model
[10/30/21 00:07:23] INFO	Cross-Validation
[10/30/21 00:07:24] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[10/30/21 00:07:24] INFO	Recursive Feature Elimination with CV
[10/30/21 00:07:27] INFO	RFECV took 2.61 seconds for step 3 and 3 folds
[10/30/21 00:07:27] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[10/30/21 00:07:27] INFO	Randomized Grid Search
[10/30/21 00:08:34] INFO	Grid Search took 67.66 seconds for 50 candidate parameter settings.
[10/30/21 00:08:34] INFO	Model with rank: 1
[10/30/21 00:08:34] INFO	Mean validation score: 0.872 (std: 0.024)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Model with rank: 2
[10/30/21 00:08:34] INFO	Mean validation score: 0.871 (std: 0.021)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[10/30/21 00:08:34] INFO	Model with rank: 3
[10/30/21 00:08:34] INFO	Mean validation score: 0.870 (std: 0.023)
[10/30/21 00:08:34] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[10/30/21 00:08:34] INFO	Final Model Predictions for XGB
[10/30/21 00:08:34] INFO	Skipping Calibration
[10/30/21 00:08:34] INFO	Making Predictions
[10/30/21 00:08:34] INFO	Predictions Complete
[10/30/21 00:08:34] INFO	Blending Models
[10/30/21 00:08:34] INFO	Blending Start: 2021-10-30 00:08:34.970798
[10/30/21 00:08:34] INFO	Blending Complete: 0:00:00.019175
[10/30/21 00:08:34] INFO	================================================================================
[10/30/21 00:08:34] INFO	Metrics for: Partition.train
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: CATB
[10/30/21 00:08:35] INFO	accuracy: 0.8585858585858586
[10/30/21 00:08:35] INFO	average_precision: 0.9113351686222868
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.8378391333525069
[10/30/21 00:08:35] INFO	brier_score_loss: 0.10043404518351136
[10/30/21 00:08:35] INFO	cohen_kappa: 0.6932572665125658
[10/30/21 00:08:35] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[10/30/21 00:08:35] INFO	f1: 0.8025078369905956
[10/30/21 00:08:35] INFO	neg_log_loss: 0.3371948718196211
[10/30/21 00:08:35] INFO	precision: 0.8648648648648649
[10/30/21 00:08:35] INFO	recall: 0.7485380116959064
[10/30/21 00:08:35] INFO	roc_auc: 0.9297979313797549
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: LGB
[10/30/21 00:08:35] INFO	accuracy: 0.9730639730639731
[10/30/21 00:08:35] INFO	average_precision: 0.9961113207491221
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.9687709711437062
[10/30/21 00:08:35] INFO	brier_score_loss: 0.032809498448974184
[10/30/21 00:08:35] INFO	cohen_kappa: 0.9427387092109702
[10/30/21 00:08:35] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[10/30/21 00:08:35] INFO	f1: 0.9643916913946586
[10/30/21 00:08:35] INFO	neg_log_loss: 0.1458307566281259
[10/30/21 00:08:35] INFO	precision: 0.9789156626506024
[10/30/21 00:08:35] INFO	recall: 0.9502923976608187
[10/30/21 00:08:35] INFO	roc_auc: 0.9974861257576241
[10/30/21 00:08:35] INFO	--------------------------------------------------------------------------------
[10/30/21 00:08:35] INFO	Algorithm: XGB
[10/30/21 00:08:35] INFO	accuracy: 0.8911335578002245
[10/30/21 00:08:35] INFO	average_precision: 0.9341195593208514
[10/30/21 00:08:35] INFO	balanced_accuracy: 0.8714169303039019
[10/30/21 00:08:35] INFO	brier_score_loss: 0.17819410720682557
[10/30/21 00:08:35] INFO	cohen_kappa: 0.7634554277409661
[10/30/21 00:08:35] INFO	confusion_matrix: [[525  24]
 [ 73 269]]
[10/30/21 00:08:35] INFO	f1: 0.847244094488189
[10/30/21 00:08:35] INFO	neg_log_loss: 0.5470199107655505
[10/30/21 00:08:35] INFO	precision: 0.9180887372013652
[10/30/21 00:08:35] INFO	recall: 0.7865497076023392
[10/30/21 00:08:35] INFO	roc_auc: 0.9453844842829598
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Metrics for: Partition.test
[10/30/21 00:08:35] INFO	No labels for generating Partition.test metrics
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Selecting Best Model
[10/30/21 00:08:35] INFO	Scoring for: Partition.train
[10/30/21 00:08:35] INFO	Best Model Selection Start: 2021-10-30 00:08:35.016707
[10/30/21 00:08:35] INFO	Scoring CATB Model
[10/30/21 00:08:35] INFO	Scoring LGB Model
[10/30/21 00:08:35] INFO	Scoring XGB Model
[10/30/21 00:08:35] INFO	Scoring BLEND Model
[10/30/21 00:08:35] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[10/30/21 00:08:35] INFO	Best Model Selection Complete: 0:00:00.000204
[10/30/21 00:08:35] INFO	================================================================================
[10/30/21 00:08:35] INFO	Generating Plots for partition: train
[10/30/21 00:08:35] INFO	Generating Calibration Plot
[10/30/21 00:08:35] INFO	Calibration for Algorithm: CATB
[10/30/21 00:08:35] INFO	Calibration for Algorithm: LGB
[10/30/21 00:08:35] INFO	Calibration for Algorithm: XGB
[10/30/21 00:08:35] INFO	Writing plot to ./plots/calibration_train.png
[10/30/21 00:08:35] INFO	Generating Confusion Matrices
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: CATB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[509  40]
 [ 86 256]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_CATB.png
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: LGB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[542   7]
 [ 17 325]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_LGB.png
[10/30/21 00:08:35] INFO	Confusion Matrix for Algorithm: XGB
[10/30/21 00:08:35] INFO	Confusion Matrix:
[10/30/21 00:08:35] INFO	[[525  24]
 [ 73 269]]
[10/30/21 00:08:35] INFO	Writing plot to ./plots/confusion_train_XGB.png
[10/30/21 00:08:35] INFO	Generating ROC Curves
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: CATB
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: LGB
[10/30/21 00:08:35] INFO	ROC Curve for Algorithm: XGB
[10/30/21 00:08:35] INFO	Writing plot to ./plots/roc_curve_train.png
[10/30/21 00:08:35] INFO	Generating Learning Curves
[10/30/21 00:08:35] INFO	Algorithm Configuration
[10/30/21 00:08:35] INFO	Learning Curve for Algorithm: CATB
[10/30/21 00:08:36] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[10/30/21 00:08:36] INFO	Learning Curve for Algorithm: LGB
[10/30/21 00:08:38] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[10/30/21 00:08:38] INFO	Learning Curve for Algorithm: XGB
[10/30/21 00:08:38] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[10/30/21 00:08:39] INFO	Generating Feature Importance Plots
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: CATB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Sex_factor (45.178104)
[10/30/21 00:08:39] INFO	2. Pclass (13.721171)
[10/30/21 00:08:39] INFO	3. Age (6.651788)
[10/30/21 00:08:39] INFO	4. Fare (4.529770)
[10/30/21 00:08:39] INFO	5. var (3.586590)
[10/30/21 00:08:39] INFO	6. std (3.492385)
[10/30/21 00:08:39] INFO	7. Ticket_factor (3.315046)
[10/30/21 00:08:39] INFO	8. cluster_30 (2.831587)
[10/30/21 00:08:39] INFO	9. mean (2.733389)
[10/30/21 00:08:39] INFO	10. Name_factor (2.586310)
[10/30/21 00:08:39] INFO	11. Cabin_factor (2.101764)
[10/30/21 00:08:39] INFO	12. Embarked (2.086410)
[10/30/21 00:08:39] INFO	13. SibSp (2.085405)
[10/30/21 00:08:39] INFO	14. cluster_12 (1.876782)
[10/30/21 00:08:39] INFO	15. cluster_24 (1.263144)
[10/30/21 00:08:39] INFO	16. count_2 (1.004409)
[10/30/21 00:08:39] INFO	17. sum (0.955946)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: LGB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Fare (256.000000)
[10/30/21 00:08:39] INFO	2. sum (241.000000)
[10/30/21 00:08:39] INFO	3. Age (232.000000)
[10/30/21 00:08:39] INFO	4. std (201.000000)
[10/30/21 00:08:39] INFO	5. Ticket_factor (199.000000)
[10/30/21 00:08:39] INFO	6. Name_factor (175.000000)
[10/30/21 00:08:39] INFO	7. cluster_30 (53.000000)
[10/30/21 00:08:39] INFO	8. cluster_27 (46.000000)
[10/30/21 00:08:39] INFO	9. Sex_factor (43.000000)
[10/30/21 00:08:39] INFO	10. Pclass (43.000000)
[10/30/21 00:08:39] INFO	11. Cabin_factor (41.000000)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[10/30/21 00:08:39] INFO	Feature Importances for Algorithm: XGB
[10/30/21 00:08:39] INFO	Feature Ranking:
[10/30/21 00:08:39] INFO	1. Sex_factor (0.424644)
[10/30/21 00:08:39] INFO	2. Pclass (0.127452)
[10/30/21 00:08:39] INFO	3. Cabin_factor (0.081307)
[10/30/21 00:08:39] INFO	4. Age (0.051007)
[10/30/21 00:08:39] INFO	5. SibSp (0.049620)
[10/30/21 00:08:39] INFO	6. count_1 (0.046373)
[10/30/21 00:08:39] INFO	7. Embarked (0.046225)
[10/30/21 00:08:39] INFO	8. std (0.036262)
[10/30/21 00:08:39] INFO	9. cluster_30 (0.036076)
[10/30/21 00:08:39] INFO	10. Fare (0.032410)
[10/30/21 00:08:39] INFO	11. cluster_24 (0.021187)
[10/30/21 00:08:39] INFO	12. Name_factor (0.019312)
[10/30/21 00:08:39] INFO	13. sum (0.017784)
[10/30/21 00:08:39] INFO	14. cluster_15 (0.010340)
[10/30/21 00:08:39] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[10/30/21 00:08:39] INFO	================================================================================
[10/30/21 00:08:39] INFO	Saving Model Predictor
[10/30/21 00:08:39] INFO	Writing model predictor to ./model/model_20211030.pkl
[10/30/21 00:08:39] INFO	Saving Feature Map
[10/30/21 00:08:39] INFO	Writing feature map to ./model/feature_map_20211030.pkl
[10/30/21 00:08:39] INFO	Loading data from ./input/test_20211030.csv
[10/30/21 00:08:39] INFO	Saving Predictions
[10/30/21 00:08:39] INFO	Writing data frame to ./output/predictions_20211030.csv
[10/30/21 00:08:39] INFO	Saving Probabilities
[10/30/21 00:08:39] INFO	Writing data frame to ./output/probabilities_20211030.csv
[10/30/21 00:08:39] INFO	Saving Ranked Predictions
[10/30/21 00:08:39] INFO	Writing data frame to ./output/rankings_20211030.csv
[10/30/21 00:08:39] INFO	Saving Submission to ./output/submission_20211030.csv
[10/30/21 00:08:39] INFO	********************************************************************************
[10/30/21 00:08:39] INFO	AlphaPy End
[10/30/21 00:08:39] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	AlphaPy Start
[11/07/21 09:11:51] INFO	********************************************************************************
[11/07/21 09:11:51] INFO	Model Configuration
[11/07/21 09:11:51] INFO	No transforms Found
[11/07/21 09:11:51] INFO	MODEL PARAMETERS:
[11/07/21 09:11:51] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[11/07/21 09:11:51] INFO	calibration       = False
[11/07/21 09:11:51] INFO	cal_type          = sigmoid
[11/07/21 09:11:51] INFO	calibration_plot  = False
[11/07/21 09:11:51] INFO	clustering        = True
[11/07/21 09:11:51] INFO	cluster_inc       = 3
[11/07/21 09:11:51] INFO	cluster_max       = 30
[11/07/21 09:11:51] INFO	cluster_min       = 3
[11/07/21 09:11:51] INFO	confusion_matrix  = True
[11/07/21 09:11:51] INFO	counts            = True
[11/07/21 09:11:51] INFO	cv_folds          = 3
[11/07/21 09:11:51] INFO	directory         = .
[11/07/21 09:11:51] INFO	extension         = csv
[11/07/21 09:11:51] INFO	drop              = ['PassengerId']
[11/07/21 09:11:51] INFO	encoder           = <Encoders.target: 14>
[11/07/21 09:11:51] INFO	esr               = 20
[11/07/21 09:11:51] INFO	factors           = ['Embarked']
[11/07/21 09:11:51] INFO	features [X]      = *
[11/07/21 09:11:51] INFO	feature_selection = False
[11/07/21 09:11:51] INFO	fs_percentage     = 50
[11/07/21 09:11:51] INFO	fs_score_func     = <function f_classif at 0x7f9b22909790>
[11/07/21 09:11:51] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[11/07/21 09:11:51] INFO	grid_search       = True
[11/07/21 09:11:51] INFO	gs_iters          = 50
[11/07/21 09:11:51] INFO	gs_random         = True
[11/07/21 09:11:51] INFO	gs_sample         = False
[11/07/21 09:11:51] INFO	gs_sample_pct     = 0.200000
[11/07/21 09:11:51] INFO	importances       = True
[11/07/21 09:11:51] INFO	interactions      = False
[11/07/21 09:11:51] INFO	isomap            = False
[11/07/21 09:11:51] INFO	iso_components    = 2
[11/07/21 09:11:51] INFO	iso_neighbors     = 5
[11/07/21 09:11:51] INFO	isample_pct       = 10
[11/07/21 09:11:51] INFO	leaders           = []
[11/07/21 09:11:51] INFO	learning_curve    = True
[11/07/21 09:11:51] INFO	logtransform      = False
[11/07/21 09:11:51] INFO	lv_remove         = True
[11/07/21 09:11:51] INFO	lv_threshold      = 0.100000
[11/07/21 09:11:51] INFO	model_type        = <ModelType.classification: 1>
[11/07/21 09:11:51] INFO	n_estimators      = 51
[11/07/21 09:11:51] INFO	n_jobs            = -1
[11/07/21 09:11:51] INFO	ngrams_max        = 2
[11/07/21 09:11:51] INFO	numpy             = True
[11/07/21 09:11:51] INFO	pca               = False
[11/07/21 09:11:51] INFO	pca_inc           = 1
[11/07/21 09:11:51] INFO	pca_max           = 10
[11/07/21 09:11:51] INFO	pca_min           = 2
[11/07/21 09:11:51] INFO	pca_whiten        = False
[11/07/21 09:11:51] INFO	poly_degree       = 2
[11/07/21 09:11:51] INFO	pvalue_level      = 0.010000
[11/07/21 09:11:51] INFO	rfe               = True
[11/07/21 09:11:51] INFO	rfe_step          = 3
[11/07/21 09:11:51] INFO	roc_curve         = True
[11/07/21 09:11:51] INFO	rounding          = 2
[11/07/21 09:11:51] INFO	sampling          = False
[11/07/21 09:11:51] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[11/07/21 09:11:51] INFO	sampling_ratio    = 0.500000
[11/07/21 09:11:51] INFO	scaler_option     = True
[11/07/21 09:11:51] INFO	scaler_type       = <Scalers.standard: 2>
[11/07/21 09:11:51] INFO	scipy             = False
[11/07/21 09:11:51] INFO	scorer            = roc_auc
[11/07/21 09:11:51] INFO	seed              = 42
[11/07/21 09:11:51] INFO	sentinel          = -1
[11/07/21 09:11:51] INFO	separator         = ,
[11/07/21 09:11:51] INFO	shuffle           = False
[11/07/21 09:11:51] INFO	split             = 0.400000
[11/07/21 09:11:51] INFO	submission_file   = gender_submission
[11/07/21 09:11:51] INFO	submit_probas     = False
[11/07/21 09:11:51] INFO	target [y]        = Survived
[11/07/21 09:11:51] INFO	target_value      = 1
[11/07/21 09:11:51] INFO	transforms        = None
[11/07/21 09:11:51] INFO	tsne              = False
[11/07/21 09:11:51] INFO	tsne_components   = 2
[11/07/21 09:11:51] INFO	tsne_learn_rate   = 1000.000000
[11/07/21 09:11:51] INFO	tsne_perplexity   = 30.000000
[11/07/21 09:11:51] INFO	vectorize         = False
[11/07/21 09:11:51] INFO	verbosity         = 0
[11/07/21 09:11:51] INFO	Creating Model
[11/07/21 09:11:51] INFO	Calling Pipeline
[11/07/21 09:11:51] INFO	Training Pipeline
[11/07/21 09:11:51] INFO	Loading Data
[11/07/21 09:11:51] INFO	Loading data from ./input/train.csv
[11/07/21 09:11:51] INFO	Found target Survived in data frame
[11/07/21 09:11:51] INFO	Labels (y) found for Partition.train
[11/07/21 09:11:51] INFO	Loading Data
[11/07/21 09:11:51] INFO	Loading data from ./input/test.csv
[11/07/21 09:11:51] INFO	Target Survived not found in Partition.test
[11/07/21 09:11:51] INFO	Saving New Features in Model
[11/07/21 09:11:51] INFO	Original Feature Statistics
[11/07/21 09:11:51] INFO	Number of Training Rows    : 891
[11/07/21 09:11:51] INFO	Number of Training Columns : 11
[11/07/21 09:11:51] INFO	Unique Training Values for Survived : [0 1]
[11/07/21 09:11:51] INFO	Unique Training Counts for Survived : [549 342]
[11/07/21 09:11:51] INFO	Number of Testing Rows     : 418
[11/07/21 09:11:51] INFO	Number of Testing Columns  : 11
[11/07/21 09:11:51] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[11/07/21 09:11:51] INFO	Feature Count     : 11
[11/07/21 09:11:51] INFO	Applying transforms
[11/07/21 09:11:51] INFO	No transforms Specified
[11/07/21 09:11:51] INFO	New Feature Count : 11
[11/07/21 09:11:51] INFO	Dropping Features: ['PassengerId']
[11/07/21 09:11:51] INFO	Original Feature Count : 11
[11/07/21 09:11:51] INFO	Reduced Feature Count  : 10
[11/07/21 09:11:51] INFO	Writing data frame to ./input/train_20211107.csv
[11/07/21 09:11:51] INFO	Writing data frame to ./input/test_20211107.csv
[11/07/21 09:11:51] INFO	Creating Cross-Tabulations
[11/07/21 09:11:51] INFO	Creating crosstabs for feature Embarked
[11/07/21 09:11:51] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[11/07/21 09:11:51] INFO	Feature Count     : 10
[11/07/21 09:11:51] INFO	Creating Count Features
[11/07/21 09:11:51] INFO	NA Counts
[11/07/21 09:11:51] INFO	Number Counts
[11/07/21 09:11:51] INFO	New Feature Count : 21
[11/07/21 09:11:51] INFO	Creating Base Features
[11/07/21 09:11:51] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[11/07/21 09:11:51] INFO	Feature 2: Name => Factorization
[11/07/21 09:11:51] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[11/07/21 09:11:51] INFO	Feature 3: Sex => Factorization
[11/07/21 09:11:51] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[11/07/21 09:11:51] INFO	Feature 7: Ticket => Factorization
[11/07/21 09:11:51] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[11/07/21 09:11:51] INFO	Feature 9: Cabin => Factorization
[11/07/21 09:11:51] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[11/07/21 09:11:51] INFO	Encoding: Encoders.target
[11/07/21 09:11:51] INFO	Fitting training features for Embarked
[11/07/21 09:11:51] INFO	Transforming testing features for Embarked
[11/07/21 09:11:51] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[11/07/21 09:11:51] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/07/21 09:11:51] INFO	New Feature Count : 21
[11/07/21 09:11:51] INFO	Scaling Base Features
[11/07/21 09:11:51] INFO	Creating NumPy Features
[11/07/21 09:11:51] INFO	NumPy Feature: sum
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: mean
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: std
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature: var
[11/07/21 09:11:51] INFO	    Imputation for Data Type float64: Median Strategy
[11/07/21 09:11:51] INFO	NumPy Feature Count : 4
[11/07/21 09:11:51] INFO	New Feature Count : 25
[11/07/21 09:11:51] INFO	Creating Clustering Features
[11/07/21 09:11:51] INFO	Cluster Minimum   : 3
[11/07/21 09:11:51] INFO	Cluster Maximum   : 30
[11/07/21 09:11:51] INFO	Cluster Increment : 3
[11/07/21 09:11:51] INFO	k = 3
[11/07/21 09:11:51] INFO	k = 6
[11/07/21 09:11:51] INFO	k = 9
[11/07/21 09:11:51] INFO	k = 12
[11/07/21 09:11:51] INFO	k = 15
[11/07/21 09:11:51] INFO	k = 18
[11/07/21 09:11:51] INFO	k = 21
[11/07/21 09:11:51] INFO	k = 24
[11/07/21 09:11:51] INFO	k = 27
[11/07/21 09:11:52] INFO	k = 30
[11/07/21 09:11:52] INFO	Clustering Feature Count : 10
[11/07/21 09:11:52] INFO	New Feature Count : 35
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Creating Interactions
[11/07/21 09:11:52] INFO	Initial Feature Count  : 35
[11/07/21 09:11:52] INFO	Skipping Interactions
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Removing Low-Variance Features
[11/07/21 09:11:52] INFO	Low-Variance Threshold  : 0.10
[11/07/21 09:11:52] INFO	Original Feature Count  : 35
[11/07/21 09:11:52] INFO	Reduced Feature Count   : 35
[11/07/21 09:11:52] INFO	Saving New Features in Model
[11/07/21 09:11:52] INFO	Skipping Shuffling
[11/07/21 09:11:52] INFO	Skipping Sampling
[11/07/21 09:11:52] INFO	Getting All Estimators
[11/07/21 09:11:52] INFO	Algorithm Configuration
[11/07/21 09:11:52] INFO	Selecting Models
[11/07/21 09:11:52] INFO	Algorithm: CATB
[11/07/21 09:11:52] INFO	Fitting Initial Model
[11/07/21 09:11:52] INFO	Cross-Validation
[11/07/21 09:11:54] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[11/07/21 09:11:54] INFO	Recursive Feature Elimination with CV
[11/07/21 09:11:57] INFO	RFECV took 2.71 seconds for step 3 and 3 folds
[11/07/21 09:11:57] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[11/07/21 09:11:57] INFO	No grid is defined for grid search
[11/07/21 09:11:57] INFO	Final Model Predictions for CATB
[11/07/21 09:11:57] INFO	Skipping Calibration
[11/07/21 09:11:57] INFO	Making Predictions
[11/07/21 09:11:57] INFO	Predictions Complete
[11/07/21 09:11:57] INFO	Algorithm: LGB
[11/07/21 09:11:57] INFO	Fitting Initial Model
[11/07/21 09:11:57] INFO	Cross-Validation
[11/07/21 09:11:58] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[11/07/21 09:11:58] INFO	Recursive Feature Elimination with CV
[11/07/21 09:12:00] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[11/07/21 09:12:00] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[11/07/21 09:12:00] INFO	No grid is defined for grid search
[11/07/21 09:12:00] INFO	Final Model Predictions for LGB
[11/07/21 09:12:00] INFO	Skipping Calibration
[11/07/21 09:12:00] INFO	Making Predictions
[11/07/21 09:12:00] INFO	Predictions Complete
[11/07/21 09:12:00] INFO	Algorithm: XGB
[11/07/21 09:12:00] INFO	Fitting Initial Model
[11/07/21 09:12:00] INFO	Cross-Validation
[11/07/21 09:12:01] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[11/07/21 09:12:01] INFO	Recursive Feature Elimination with CV
[11/07/21 09:12:04] INFO	RFECV took 2.74 seconds for step 3 and 3 folds
[11/07/21 09:12:04] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[11/07/21 09:12:04] INFO	Randomized Grid Search
[11/07/21 09:13:11] INFO	Grid Search took 66.79 seconds for 50 candidate parameter settings.
[11/07/21 09:13:11] INFO	Model with rank: 1
[11/07/21 09:13:11] INFO	Mean validation score: 0.871 (std: 0.022)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[11/07/21 09:13:11] INFO	Model with rank: 2
[11/07/21 09:13:11] INFO	Mean validation score: 0.870 (std: 0.021)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[11/07/21 09:13:11] INFO	Model with rank: 3
[11/07/21 09:13:11] INFO	Mean validation score: 0.870 (std: 0.021)
[11/07/21 09:13:11] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[11/07/21 09:13:11] INFO	Algorithm: XGB, Best Score: 0.8710, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[11/07/21 09:13:11] INFO	Final Model Predictions for XGB
[11/07/21 09:13:11] INFO	Skipping Calibration
[11/07/21 09:13:11] INFO	Making Predictions
[11/07/21 09:13:11] INFO	Predictions Complete
[11/07/21 09:13:11] INFO	Blending Models
[11/07/21 09:13:11] INFO	Blending Start: 2021-11-07 09:13:11.069883
[11/07/21 09:13:11] INFO	Blending Complete: 0:00:00.011214
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Metrics for: Partition.train
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: CATB
[11/07/21 09:13:11] INFO	accuracy: 0.8585858585858586
[11/07/21 09:13:11] INFO	average_precision: 0.9113351686222868
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.8378391333525069
[11/07/21 09:13:11] INFO	brier_score_loss: 0.10043404518351136
[11/07/21 09:13:11] INFO	cohen_kappa: 0.6932572665125658
[11/07/21 09:13:11] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[11/07/21 09:13:11] INFO	f1: 0.8025078369905956
[11/07/21 09:13:11] INFO	neg_log_loss: 0.3371948718196211
[11/07/21 09:13:11] INFO	precision: 0.8648648648648649
[11/07/21 09:13:11] INFO	recall: 0.7485380116959064
[11/07/21 09:13:11] INFO	roc_auc: 0.9297979313797549
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: LGB
[11/07/21 09:13:11] INFO	accuracy: 0.9730639730639731
[11/07/21 09:13:11] INFO	average_precision: 0.9961113207491221
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.9687709711437062
[11/07/21 09:13:11] INFO	brier_score_loss: 0.032809498448974184
[11/07/21 09:13:11] INFO	cohen_kappa: 0.9427387092109702
[11/07/21 09:13:11] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[11/07/21 09:13:11] INFO	f1: 0.9643916913946586
[11/07/21 09:13:11] INFO	neg_log_loss: 0.1458307566281259
[11/07/21 09:13:11] INFO	precision: 0.9789156626506024
[11/07/21 09:13:11] INFO	recall: 0.9502923976608187
[11/07/21 09:13:11] INFO	roc_auc: 0.9974861257576241
[11/07/21 09:13:11] INFO	--------------------------------------------------------------------------------
[11/07/21 09:13:11] INFO	Algorithm: XGB
[11/07/21 09:13:11] INFO	accuracy: 0.9023569023569024
[11/07/21 09:13:11] INFO	average_precision: 0.9472776316607258
[11/07/21 09:13:11] INFO	balanced_accuracy: 0.88548557185313
[11/07/21 09:13:11] INFO	brier_score_loss: 0.09358055308451343
[11/07/21 09:13:11] INFO	cohen_kappa: 0.7887987052794193
[11/07/21 09:13:11] INFO	confusion_matrix: [[526  23]
 [ 64 278]]
[11/07/21 09:13:11] INFO	f1: 0.864696734059098
[11/07/21 09:13:11] INFO	neg_log_loss: 0.33849662273085346
[11/07/21 09:13:11] INFO	precision: 0.9235880398671097
[11/07/21 09:13:11] INFO	recall: 0.8128654970760234
[11/07/21 09:13:11] INFO	roc_auc: 0.9578180423736938
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Metrics for: Partition.test
[11/07/21 09:13:11] INFO	No labels for generating Partition.test metrics
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Selecting Best Model
[11/07/21 09:13:11] INFO	Scoring for: Partition.train
[11/07/21 09:13:11] INFO	Best Model Selection Start: 2021-11-07 09:13:11.102421
[11/07/21 09:13:11] INFO	Scoring CATB Model
[11/07/21 09:13:11] INFO	Scoring LGB Model
[11/07/21 09:13:11] INFO	Scoring XGB Model
[11/07/21 09:13:11] INFO	Scoring BLEND Model
[11/07/21 09:13:11] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[11/07/21 09:13:11] INFO	Best Model Selection Complete: 0:00:00.000203
[11/07/21 09:13:11] INFO	================================================================================
[11/07/21 09:13:11] INFO	Generating Plots for partition: train
[11/07/21 09:13:11] INFO	Generating Calibration Plot
[11/07/21 09:13:11] INFO	Calibration for Algorithm: CATB
[11/07/21 09:13:11] INFO	Calibration for Algorithm: LGB
[11/07/21 09:13:11] INFO	Calibration for Algorithm: XGB
[11/07/21 09:13:11] INFO	Writing plot to ./plots/calibration_train.png
[11/07/21 09:13:11] INFO	Generating Confusion Matrices
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: CATB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[509  40]
 [ 86 256]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_CATB.png
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: LGB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[542   7]
 [ 17 325]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_LGB.png
[11/07/21 09:13:11] INFO	Confusion Matrix for Algorithm: XGB
[11/07/21 09:13:11] INFO	Confusion Matrix:
[11/07/21 09:13:11] INFO	[[526  23]
 [ 64 278]]
[11/07/21 09:13:11] INFO	Writing plot to ./plots/confusion_train_XGB.png
[11/07/21 09:13:11] INFO	Generating ROC Curves
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: CATB
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: LGB
[11/07/21 09:13:11] INFO	ROC Curve for Algorithm: XGB
[11/07/21 09:13:11] INFO	Writing plot to ./plots/roc_curve_train.png
[11/07/21 09:13:11] INFO	Generating Learning Curves
[11/07/21 09:13:11] INFO	Algorithm Configuration
[11/07/21 09:13:11] INFO	Learning Curve for Algorithm: CATB
[11/07/21 09:13:12] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[11/07/21 09:13:12] INFO	Learning Curve for Algorithm: LGB
[11/07/21 09:13:14] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[11/07/21 09:13:14] INFO	Learning Curve for Algorithm: XGB
[11/07/21 09:13:15] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[11/07/21 09:13:15] INFO	Generating Feature Importance Plots
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: CATB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Sex_factor (45.178104)
[11/07/21 09:13:15] INFO	2. Pclass (13.721171)
[11/07/21 09:13:15] INFO	3. Age (6.651788)
[11/07/21 09:13:15] INFO	4. Fare (4.529770)
[11/07/21 09:13:15] INFO	5. var (3.586590)
[11/07/21 09:13:15] INFO	6. std (3.492385)
[11/07/21 09:13:15] INFO	7. Ticket_factor (3.315046)
[11/07/21 09:13:15] INFO	8. cluster_30 (2.831587)
[11/07/21 09:13:15] INFO	9. mean (2.733389)
[11/07/21 09:13:15] INFO	10. Name_factor (2.586310)
[11/07/21 09:13:15] INFO	11. Cabin_factor (2.101764)
[11/07/21 09:13:15] INFO	12. Embarked (2.086410)
[11/07/21 09:13:15] INFO	13. SibSp (2.085405)
[11/07/21 09:13:15] INFO	14. cluster_12 (1.876782)
[11/07/21 09:13:15] INFO	15. cluster_24 (1.263144)
[11/07/21 09:13:15] INFO	16. count_2 (1.004409)
[11/07/21 09:13:15] INFO	17. sum (0.955946)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: LGB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Fare (256.000000)
[11/07/21 09:13:15] INFO	2. sum (241.000000)
[11/07/21 09:13:15] INFO	3. Age (232.000000)
[11/07/21 09:13:15] INFO	4. std (201.000000)
[11/07/21 09:13:15] INFO	5. Ticket_factor (199.000000)
[11/07/21 09:13:15] INFO	6. Name_factor (175.000000)
[11/07/21 09:13:15] INFO	7. cluster_30 (53.000000)
[11/07/21 09:13:15] INFO	8. cluster_27 (46.000000)
[11/07/21 09:13:15] INFO	9. Sex_factor (43.000000)
[11/07/21 09:13:15] INFO	10. Pclass (43.000000)
[11/07/21 09:13:15] INFO	11. Cabin_factor (41.000000)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[11/07/21 09:13:15] INFO	Feature Importances for Algorithm: XGB
[11/07/21 09:13:15] INFO	Feature Ranking:
[11/07/21 09:13:15] INFO	1. Sex_factor (0.424644)
[11/07/21 09:13:15] INFO	2. Pclass (0.127452)
[11/07/21 09:13:15] INFO	3. Cabin_factor (0.081307)
[11/07/21 09:13:15] INFO	4. Age (0.051007)
[11/07/21 09:13:15] INFO	5. SibSp (0.049620)
[11/07/21 09:13:15] INFO	6. count_1 (0.046373)
[11/07/21 09:13:15] INFO	7. Embarked (0.046225)
[11/07/21 09:13:15] INFO	8. std (0.036262)
[11/07/21 09:13:15] INFO	9. cluster_30 (0.036076)
[11/07/21 09:13:15] INFO	10. Fare (0.032410)
[11/07/21 09:13:15] INFO	11. cluster_24 (0.021187)
[11/07/21 09:13:15] INFO	12. Name_factor (0.019312)
[11/07/21 09:13:15] INFO	13. sum (0.017784)
[11/07/21 09:13:15] INFO	14. cluster_15 (0.010340)
[11/07/21 09:13:15] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[11/07/21 09:13:15] INFO	================================================================================
[11/07/21 09:13:15] INFO	Saving Model Predictor
[11/07/21 09:13:15] INFO	Writing model predictor to ./model/model_20211107.pkl
[11/07/21 09:13:15] INFO	Saving Feature Map
[11/07/21 09:13:15] INFO	Writing feature map to ./model/feature_map_20211107.pkl
[11/07/21 09:13:15] INFO	Loading data from ./input/test_20211107.csv
[11/07/21 09:13:15] INFO	Saving Predictions
[11/07/21 09:13:15] INFO	Writing data frame to ./output/predictions_20211107.csv
[11/07/21 09:13:15] INFO	Saving Probabilities
[11/07/21 09:13:15] INFO	Writing data frame to ./output/probabilities_20211107.csv
[11/07/21 09:13:15] INFO	Saving Ranked Predictions
[11/07/21 09:13:15] INFO	Writing data frame to ./output/rankings_20211107.csv
[11/07/21 09:13:15] INFO	Saving Submission to ./output/submission_20211107.csv
[11/07/21 09:13:15] INFO	********************************************************************************
[11/07/21 09:13:15] INFO	AlphaPy End
[11/07/21 09:13:15] INFO	********************************************************************************
[11/11/21 14:35:57] INFO	********************************************************************************
[11/11/21 14:35:57] INFO	AlphaPy Start
[11/11/21 14:35:57] INFO	********************************************************************************
[11/11/21 14:35:57] INFO	Model Configuration
[11/11/21 14:35:57] INFO	No transforms Found
[11/11/21 14:35:57] INFO	MODEL PARAMETERS:
[11/11/21 14:35:57] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[11/11/21 14:35:57] INFO	calibration       = False
[11/11/21 14:35:57] INFO	cal_type          = sigmoid
[11/11/21 14:35:57] INFO	calibration_plot  = False
[11/11/21 14:35:57] INFO	clustering        = True
[11/11/21 14:35:57] INFO	cluster_inc       = 3
[11/11/21 14:35:57] INFO	cluster_max       = 30
[11/11/21 14:35:57] INFO	cluster_min       = 3
[11/11/21 14:35:57] INFO	confusion_matrix  = True
[11/11/21 14:35:57] INFO	counts            = True
[11/11/21 14:35:57] INFO	cv_folds          = 3
[11/11/21 14:35:57] INFO	directory         = .
[11/11/21 14:35:57] INFO	extension         = csv
[11/11/21 14:35:57] INFO	drop              = ['PassengerId']
[11/11/21 14:35:57] INFO	encoder           = <Encoders.target: 14>
[11/11/21 14:35:57] INFO	esr               = 20
[11/11/21 14:35:57] INFO	factors           = ['Embarked']
[11/11/21 14:35:57] INFO	features [X]      = *
[11/11/21 14:35:57] INFO	feature_selection = False
[11/11/21 14:35:57] INFO	fs_percentage     = 50
[11/11/21 14:35:57] INFO	fs_score_func     = <function f_classif at 0x7fa252aa5dc0>
[11/11/21 14:35:57] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[11/11/21 14:35:57] INFO	grid_search       = True
[11/11/21 14:35:57] INFO	gs_iters          = 50
[11/11/21 14:35:57] INFO	gs_random         = True
[11/11/21 14:35:57] INFO	gs_sample         = False
[11/11/21 14:35:57] INFO	gs_sample_pct     = 0.200000
[11/11/21 14:35:57] INFO	importances       = True
[11/11/21 14:35:57] INFO	interactions      = False
[11/11/21 14:35:57] INFO	isomap            = False
[11/11/21 14:35:57] INFO	iso_components    = 2
[11/11/21 14:35:57] INFO	iso_neighbors     = 5
[11/11/21 14:35:57] INFO	isample_pct       = 10
[11/11/21 14:35:57] INFO	leaders           = []
[11/11/21 14:35:57] INFO	learning_curve    = True
[11/11/21 14:35:57] INFO	logtransform      = False
[11/11/21 14:35:57] INFO	lv_remove         = True
[11/11/21 14:35:57] INFO	lv_threshold      = 0.100000
[11/11/21 14:35:57] INFO	model_type        = <ModelType.classification: 1>
[11/11/21 14:35:57] INFO	n_estimators      = 51
[11/11/21 14:35:57] INFO	n_jobs            = -1
[11/11/21 14:35:57] INFO	ngrams_max        = 2
[11/11/21 14:35:57] INFO	numpy             = True
[11/11/21 14:35:57] INFO	pca               = False
[11/11/21 14:35:57] INFO	pca_inc           = 1
[11/11/21 14:35:57] INFO	pca_max           = 10
[11/11/21 14:35:57] INFO	pca_min           = 2
[11/11/21 14:35:57] INFO	pca_whiten        = False
[11/11/21 14:35:57] INFO	poly_degree       = 2
[11/11/21 14:35:57] INFO	pvalue_level      = 0.010000
[11/11/21 14:35:57] INFO	rfe               = True
[11/11/21 14:35:57] INFO	rfe_step          = 3
[11/11/21 14:35:57] INFO	roc_curve         = True
[11/11/21 14:35:57] INFO	rounding          = 2
[11/11/21 14:35:57] INFO	sampling          = False
[11/11/21 14:35:57] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[11/11/21 14:35:57] INFO	sampling_ratio    = 0.500000
[11/11/21 14:35:57] INFO	scaler_option     = True
[11/11/21 14:35:57] INFO	scaler_type       = <Scalers.standard: 2>
[11/11/21 14:35:57] INFO	scipy             = False
[11/11/21 14:35:57] INFO	scorer            = roc_auc
[11/11/21 14:35:57] INFO	seed              = 42
[11/11/21 14:35:57] INFO	sentinel          = -1
[11/11/21 14:35:57] INFO	separator         = ,
[11/11/21 14:35:57] INFO	shuffle           = False
[11/11/21 14:35:57] INFO	split             = 0.400000
[11/11/21 14:35:57] INFO	submission_file   = gender_submission
[11/11/21 14:35:57] INFO	submit_probas     = False
[11/11/21 14:35:57] INFO	target [y]        = Survived
[11/11/21 14:35:57] INFO	target_value      = 1
[11/11/21 14:35:57] INFO	transforms        = None
[11/11/21 14:35:57] INFO	tsne              = False
[11/11/21 14:35:57] INFO	tsne_components   = 2
[11/11/21 14:35:57] INFO	tsne_learn_rate   = 1000.000000
[11/11/21 14:35:57] INFO	tsne_perplexity   = 30.000000
[11/11/21 14:35:57] INFO	vectorize         = False
[11/11/21 14:35:57] INFO	verbosity         = 0
[11/11/21 14:35:57] INFO	Creating Model
[11/11/21 14:35:57] INFO	Calling Pipeline
[11/11/21 14:35:57] INFO	Training Pipeline
[11/11/21 14:35:57] INFO	Loading Data
[11/11/21 14:35:57] INFO	Loading data from ./input/train.csv
[11/11/21 14:35:57] INFO	Found target Survived in data frame
[11/11/21 14:35:57] INFO	Labels (y) found for Partition.train
[11/11/21 14:35:57] INFO	Loading Data
[11/11/21 14:35:57] INFO	Loading data from ./input/test.csv
[11/11/21 14:35:57] INFO	Target Survived not found in Partition.test
[11/11/21 14:35:57] INFO	Saving New Features in Model
[11/11/21 14:35:57] INFO	Original Feature Statistics
[11/11/21 14:35:57] INFO	Number of Training Rows    : 891
[11/11/21 14:35:57] INFO	Number of Training Columns : 11
[11/11/21 14:35:57] INFO	Unique Training Values for Survived : [0 1]
[11/11/21 14:35:57] INFO	Unique Training Counts for Survived : [549 342]
[11/11/21 14:35:57] INFO	Number of Testing Rows     : 418
[11/11/21 14:35:57] INFO	Number of Testing Columns  : 11
[11/11/21 14:35:57] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[11/11/21 14:35:57] INFO	Feature Count     : 11
[11/11/21 14:35:57] INFO	Applying transforms
[11/11/21 14:35:57] INFO	No transforms Specified
[11/11/21 14:35:57] INFO	New Feature Count : 11
[11/11/21 14:35:57] INFO	Dropping Features: ['PassengerId']
[11/11/21 14:35:57] INFO	Original Feature Count : 11
[11/11/21 14:35:57] INFO	Reduced Feature Count  : 10
[11/11/21 14:35:57] INFO	Writing data frame to ./input/train_20211111.csv
[11/11/21 14:35:57] INFO	Writing data frame to ./input/test_20211111.csv
[11/11/21 14:35:57] INFO	Creating Cross-Tabulations
[11/11/21 14:35:57] INFO	Creating crosstabs for feature Embarked
[11/11/21 14:35:57] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[11/11/21 14:35:57] INFO	Feature Count     : 10
[11/11/21 14:35:57] INFO	Creating Count Features
[11/11/21 14:35:57] INFO	NA Counts
[11/11/21 14:35:57] INFO	Number Counts
[11/11/21 14:35:57] INFO	New Feature Count : 21
[11/11/21 14:35:57] INFO	Creating Base Features
[11/11/21 14:35:57] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[11/11/21 14:35:57] INFO	Feature 2: Name => Factorization
[11/11/21 14:35:57] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[11/11/21 14:35:57] INFO	Feature 3: Sex => Factorization
[11/11/21 14:35:57] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[11/11/21 14:35:57] INFO	Feature 7: Ticket => Factorization
[11/11/21 14:35:57] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[11/11/21 14:35:57] INFO	Feature 9: Cabin => Factorization
[11/11/21 14:35:57] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[11/11/21 14:35:57] INFO	Encoding: Encoders.target
[11/11/21 14:35:57] INFO	Fitting training features for Embarked
[11/11/21 14:35:57] INFO	Transforming testing features for Embarked
[11/11/21 14:35:57] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[11/11/21 14:35:57] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/11/21 14:35:57] INFO	New Feature Count : 21
[11/11/21 14:35:57] INFO	Scaling Base Features
[11/11/21 14:35:57] INFO	Creating NumPy Features
[11/11/21 14:35:57] INFO	NumPy Feature: sum
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	NumPy Feature: mean
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	NumPy Feature: std
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	NumPy Feature: var
[11/11/21 14:35:57] INFO	    Imputation for Data Type float64: Median Strategy
[11/11/21 14:35:57] INFO	NumPy Feature Count : 4
[11/11/21 14:35:57] INFO	New Feature Count : 25
[11/11/21 14:35:57] INFO	Creating Clustering Features
[11/11/21 14:35:57] INFO	Cluster Minimum   : 3
[11/11/21 14:35:57] INFO	Cluster Maximum   : 30
[11/11/21 14:35:57] INFO	Cluster Increment : 3
[11/11/21 14:35:57] INFO	k = 3
[11/11/21 14:35:58] INFO	k = 6
[11/11/21 14:35:58] INFO	k = 9
[11/11/21 14:35:58] INFO	k = 12
[11/11/21 14:35:58] INFO	k = 15
[11/11/21 14:35:58] INFO	k = 18
[11/11/21 14:35:58] INFO	k = 21
[11/11/21 14:35:58] INFO	k = 24
[11/11/21 14:35:58] INFO	k = 27
[11/11/21 14:35:58] INFO	k = 30
[11/11/21 14:35:58] INFO	Clustering Feature Count : 10
[11/11/21 14:35:58] INFO	New Feature Count : 35
[11/11/21 14:35:58] INFO	Saving New Features in Model
[11/11/21 14:35:58] INFO	Creating Interactions
[11/11/21 14:35:58] INFO	Initial Feature Count  : 35
[11/11/21 14:35:58] INFO	Skipping Interactions
[11/11/21 14:35:58] INFO	Saving New Features in Model
[11/11/21 14:35:58] INFO	Removing Low-Variance Features
[11/11/21 14:35:58] INFO	Low-Variance Threshold  : 0.10
[11/11/21 14:35:58] INFO	Original Feature Count  : 35
[11/11/21 14:35:58] INFO	Reduced Feature Count   : 35
[11/11/21 14:35:58] INFO	Saving New Features in Model
[11/11/21 14:35:58] INFO	Skipping Shuffling
[11/11/21 14:35:58] INFO	Skipping Sampling
[11/11/21 14:35:58] INFO	Getting All Estimators
[11/11/21 14:35:58] INFO	Algorithm Configuration
[11/11/21 14:35:59] INFO	Selecting Models
[11/11/21 14:35:59] INFO	Algorithm: CATB
[11/11/21 14:35:59] INFO	Fitting Initial Model
[11/11/21 14:35:59] INFO	Cross-Validation
[11/11/21 14:36:00] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[11/11/21 14:36:00] INFO	Recursive Feature Elimination with CV
[11/11/21 14:36:03] INFO	RFECV took 2.56 seconds for step 3 and 3 folds
[11/11/21 14:36:03] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[11/11/21 14:36:03] INFO	No grid is defined for grid search
[11/11/21 14:36:03] INFO	Final Model Predictions for CATB
[11/11/21 14:36:03] INFO	Skipping Calibration
[11/11/21 14:36:03] INFO	Making Predictions
[11/11/21 14:36:03] INFO	Predictions Complete
[11/11/21 14:36:03] INFO	Algorithm: LGB
[11/11/21 14:36:03] INFO	Fitting Initial Model
[11/11/21 14:36:03] INFO	Cross-Validation
[11/11/21 14:36:04] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[11/11/21 14:36:04] INFO	Recursive Feature Elimination with CV
[11/11/21 14:36:07] INFO	RFECV took 3.25 seconds for step 3 and 3 folds
[11/11/21 14:36:07] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[11/11/21 14:36:07] INFO	No grid is defined for grid search
[11/11/21 14:36:07] INFO	Final Model Predictions for LGB
[11/11/21 14:36:07] INFO	Skipping Calibration
[11/11/21 14:36:07] INFO	Making Predictions
[11/11/21 14:36:07] INFO	Predictions Complete
[11/11/21 14:36:07] INFO	Algorithm: XGB
[11/11/21 14:36:07] INFO	Fitting Initial Model
[11/11/21 14:36:07] INFO	Cross-Validation
[11/11/21 14:36:08] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[11/11/21 14:36:08] INFO	Recursive Feature Elimination with CV
[11/11/21 14:36:11] INFO	RFECV took 2.86 seconds for step 3 and 3 folds
[11/11/21 14:36:11] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[11/11/21 14:36:11] INFO	Randomized Grid Search
[11/11/21 14:37:29] INFO	Grid Search took 77.96 seconds for 50 candidate parameter settings.
[11/11/21 14:37:29] INFO	Model with rank: 1
[11/11/21 14:37:29] INFO	Mean validation score: 0.870 (std: 0.024)
[11/11/21 14:37:29] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[11/11/21 14:37:29] INFO	Model with rank: 2
[11/11/21 14:37:29] INFO	Mean validation score: 0.869 (std: 0.020)
[11/11/21 14:37:29] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[11/11/21 14:37:29] INFO	Model with rank: 3
[11/11/21 14:37:29] INFO	Mean validation score: 0.869 (std: 0.026)
[11/11/21 14:37:29] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[11/11/21 14:37:29] INFO	Algorithm: XGB, Best Score: 0.8702, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[11/11/21 14:37:29] INFO	Final Model Predictions for XGB
[11/11/21 14:37:29] INFO	Skipping Calibration
[11/11/21 14:37:29] INFO	Making Predictions
[11/11/21 14:37:29] INFO	Predictions Complete
[11/11/21 14:37:29] INFO	Blending Models
[11/11/21 14:37:29] INFO	Blending Start: 2021-11-11 14:37:29.047679
[11/11/21 14:37:29] INFO	Blending Complete: 0:00:00.016073
[11/11/21 14:37:29] INFO	================================================================================
[11/11/21 14:37:29] INFO	Metrics for: Partition.train
[11/11/21 14:37:29] INFO	--------------------------------------------------------------------------------
[11/11/21 14:37:29] INFO	Algorithm: CATB
[11/11/21 14:37:29] INFO	accuracy: 0.8585858585858586
[11/11/21 14:37:29] INFO	average_precision: 0.9113351686222868
[11/11/21 14:37:29] INFO	balanced_accuracy: 0.8378391333525069
[11/11/21 14:37:29] INFO	brier_score_loss: 0.10043404518351136
[11/11/21 14:37:29] INFO	cohen_kappa: 0.6932572665125658
[11/11/21 14:37:29] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[11/11/21 14:37:29] INFO	f1: 0.8025078369905956
[11/11/21 14:37:29] INFO	neg_log_loss: 0.3371948718196211
[11/11/21 14:37:29] INFO	precision: 0.8648648648648649
[11/11/21 14:37:29] INFO	recall: 0.7485380116959064
[11/11/21 14:37:29] INFO	roc_auc: 0.9297979313797549
[11/11/21 14:37:29] INFO	--------------------------------------------------------------------------------
[11/11/21 14:37:29] INFO	Algorithm: LGB
[11/11/21 14:37:29] INFO	accuracy: 0.9730639730639731
[11/11/21 14:37:29] INFO	average_precision: 0.9961113207491221
[11/11/21 14:37:29] INFO	balanced_accuracy: 0.9687709711437062
[11/11/21 14:37:29] INFO	brier_score_loss: 0.032809498448974184
[11/11/21 14:37:29] INFO	cohen_kappa: 0.9427387092109702
[11/11/21 14:37:29] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[11/11/21 14:37:29] INFO	f1: 0.9643916913946586
[11/11/21 14:37:29] INFO	neg_log_loss: 0.1458307566281259
[11/11/21 14:37:29] INFO	precision: 0.9789156626506024
[11/11/21 14:37:29] INFO	recall: 0.9502923976608187
[11/11/21 14:37:29] INFO	roc_auc: 0.9974861257576241
[11/11/21 14:37:29] INFO	--------------------------------------------------------------------------------
[11/11/21 14:37:29] INFO	Algorithm: XGB
[11/11/21 14:37:29] INFO	accuracy: 0.8967452300785634
[11/11/21 14:37:29] INFO	average_precision: 0.9430683286874123
[11/11/21 14:37:29] INFO	balanced_accuracy: 0.8792781133160771
[11/11/21 14:37:29] INFO	brier_score_loss: 0.12040609436182667
[11/11/21 14:37:29] INFO	cohen_kappa: 0.7765346680406301
[11/11/21 14:37:29] INFO	confusion_matrix: [[524  25]
 [ 67 275]]
[11/11/21 14:37:29] INFO	f1: 0.8566978193146417
[11/11/21 14:37:29] INFO	neg_log_loss: 0.41514900642814057
[11/11/21 14:37:29] INFO	precision: 0.9166666666666666
[11/11/21 14:37:29] INFO	recall: 0.804093567251462
[11/11/21 14:37:29] INFO	roc_auc: 0.9537090297084545
[11/11/21 14:37:29] INFO	================================================================================
[11/11/21 14:37:29] INFO	Metrics for: Partition.test
[11/11/21 14:37:29] INFO	No labels for generating Partition.test metrics
[11/11/21 14:37:29] INFO	================================================================================
[11/11/21 14:37:29] INFO	Selecting Best Model
[11/11/21 14:37:29] INFO	Scoring for: Partition.train
[11/11/21 14:37:29] INFO	Best Model Selection Start: 2021-11-11 14:37:29.087570
[11/11/21 14:37:29] INFO	Scoring CATB Model
[11/11/21 14:37:29] INFO	Scoring LGB Model
[11/11/21 14:37:29] INFO	Scoring XGB Model
[11/11/21 14:37:29] INFO	Scoring BLEND Model
[11/11/21 14:37:29] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[11/11/21 14:37:29] INFO	Best Model Selection Complete: 0:00:00.000202
[11/11/21 14:37:29] INFO	================================================================================
[11/11/21 14:37:29] INFO	Generating Plots for partition: train
[11/11/21 14:37:29] INFO	Generating Calibration Plot
[11/11/21 14:37:29] INFO	Calibration for Algorithm: CATB
[11/11/21 14:37:29] INFO	Calibration for Algorithm: LGB
[11/11/21 14:37:29] INFO	Calibration for Algorithm: XGB
[11/11/21 14:37:29] INFO	Writing plot to ./plots/calibration_train.png
[11/11/21 14:37:29] INFO	Generating Confusion Matrices
[11/11/21 14:37:29] INFO	Confusion Matrix for Algorithm: CATB
[11/11/21 14:37:29] INFO	Confusion Matrix:
[11/11/21 14:37:29] INFO	[[509  40]
 [ 86 256]]
[11/11/21 14:37:29] INFO	Writing plot to ./plots/confusion_train_CATB.png
[11/11/21 14:37:29] INFO	Confusion Matrix for Algorithm: LGB
[11/11/21 14:37:29] INFO	Confusion Matrix:
[11/11/21 14:37:29] INFO	[[542   7]
 [ 17 325]]
[11/11/21 14:37:29] INFO	Writing plot to ./plots/confusion_train_LGB.png
[11/11/21 14:37:29] INFO	Confusion Matrix for Algorithm: XGB
[11/11/21 14:37:29] INFO	Confusion Matrix:
[11/11/21 14:37:29] INFO	[[524  25]
 [ 67 275]]
[11/11/21 14:37:29] INFO	Writing plot to ./plots/confusion_train_XGB.png
[11/11/21 14:37:29] INFO	Generating ROC Curves
[11/11/21 14:37:29] INFO	ROC Curve for Algorithm: CATB
[11/11/21 14:37:29] INFO	ROC Curve for Algorithm: LGB
[11/11/21 14:37:29] INFO	ROC Curve for Algorithm: XGB
[11/11/21 14:37:29] INFO	Writing plot to ./plots/roc_curve_train.png
[11/11/21 14:37:29] INFO	Generating Learning Curves
[11/11/21 14:37:29] INFO	Algorithm Configuration
[11/11/21 14:37:29] INFO	Learning Curve for Algorithm: CATB
[11/11/21 14:37:30] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[11/11/21 14:37:30] INFO	Learning Curve for Algorithm: LGB
[11/11/21 14:37:32] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[11/11/21 14:37:32] INFO	Learning Curve for Algorithm: XGB
[11/11/21 14:37:33] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[11/11/21 14:37:33] INFO	Generating Feature Importance Plots
[11/11/21 14:37:33] INFO	Feature Importances for Algorithm: CATB
[11/11/21 14:37:33] INFO	Feature Ranking:
[11/11/21 14:37:33] INFO	1. Sex_factor (45.178104)
[11/11/21 14:37:33] INFO	2. Pclass (13.721171)
[11/11/21 14:37:33] INFO	3. Age (6.651788)
[11/11/21 14:37:33] INFO	4. Fare (4.529770)
[11/11/21 14:37:33] INFO	5. var (3.586590)
[11/11/21 14:37:33] INFO	6. std (3.492385)
[11/11/21 14:37:33] INFO	7. Ticket_factor (3.315046)
[11/11/21 14:37:33] INFO	8. cluster_30 (2.831587)
[11/11/21 14:37:33] INFO	9. mean (2.733389)
[11/11/21 14:37:33] INFO	10. Name_factor (2.586310)
[11/11/21 14:37:33] INFO	11. Cabin_factor (2.101764)
[11/11/21 14:37:33] INFO	12. Embarked (2.086410)
[11/11/21 14:37:33] INFO	13. SibSp (2.085405)
[11/11/21 14:37:33] INFO	14. cluster_12 (1.876782)
[11/11/21 14:37:33] INFO	15. cluster_24 (1.263144)
[11/11/21 14:37:33] INFO	16. count_2 (1.004409)
[11/11/21 14:37:33] INFO	17. sum (0.955946)
[11/11/21 14:37:33] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[11/11/21 14:37:33] INFO	Feature Importances for Algorithm: LGB
[11/11/21 14:37:33] INFO	Feature Ranking:
[11/11/21 14:37:33] INFO	1. Fare (256.000000)
[11/11/21 14:37:33] INFO	2. sum (241.000000)
[11/11/21 14:37:33] INFO	3. Age (232.000000)
[11/11/21 14:37:33] INFO	4. std (201.000000)
[11/11/21 14:37:33] INFO	5. Ticket_factor (199.000000)
[11/11/21 14:37:33] INFO	6. Name_factor (175.000000)
[11/11/21 14:37:33] INFO	7. cluster_30 (53.000000)
[11/11/21 14:37:33] INFO	8. cluster_27 (46.000000)
[11/11/21 14:37:33] INFO	9. Sex_factor (43.000000)
[11/11/21 14:37:33] INFO	10. Pclass (43.000000)
[11/11/21 14:37:33] INFO	11. Cabin_factor (41.000000)
[11/11/21 14:37:33] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[11/11/21 14:37:33] INFO	Feature Importances for Algorithm: XGB
[11/11/21 14:37:33] INFO	Feature Ranking:
[11/11/21 14:37:33] INFO	1. Sex_factor (0.424644)
[11/11/21 14:37:33] INFO	2. Pclass (0.127452)
[11/11/21 14:37:33] INFO	3. Cabin_factor (0.081307)
[11/11/21 14:37:33] INFO	4. Age (0.051007)
[11/11/21 14:37:33] INFO	5. SibSp (0.049620)
[11/11/21 14:37:33] INFO	6. count_1 (0.046373)
[11/11/21 14:37:33] INFO	7. Embarked (0.046225)
[11/11/21 14:37:33] INFO	8. std (0.036262)
[11/11/21 14:37:33] INFO	9. cluster_30 (0.036076)
[11/11/21 14:37:33] INFO	10. Fare (0.032410)
[11/11/21 14:37:33] INFO	11. cluster_24 (0.021187)
[11/11/21 14:37:33] INFO	12. Name_factor (0.019312)
[11/11/21 14:37:33] INFO	13. sum (0.017784)
[11/11/21 14:37:33] INFO	14. cluster_15 (0.010340)
[11/11/21 14:37:33] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[11/11/21 14:37:33] INFO	================================================================================
[11/11/21 14:37:33] INFO	Saving Model Predictor
[11/11/21 14:37:33] INFO	Writing model predictor to ./model/model_20211111.pkl
[11/11/21 14:37:33] INFO	Saving Feature Map
[11/11/21 14:37:33] INFO	Writing feature map to ./model/feature_map_20211111.pkl
[11/11/21 14:37:33] INFO	Loading data from ./input/test_20211111.csv
[11/11/21 14:37:33] INFO	Saving Predictions
[11/11/21 14:37:33] INFO	Writing data frame to ./output/predictions_20211111.csv
[11/11/21 14:37:33] INFO	Saving Probabilities
[11/11/21 14:37:33] INFO	Writing data frame to ./output/probabilities_20211111.csv
[11/11/21 14:37:33] INFO	Saving Ranked Predictions
[11/11/21 14:37:33] INFO	Writing data frame to ./output/rankings_20211111.csv
[11/11/21 14:37:33] INFO	Saving Submission to ./output/submission_20211111.csv
[11/11/21 14:37:33] INFO	********************************************************************************
[11/11/21 14:37:33] INFO	AlphaPy End
[11/11/21 14:37:33] INFO	********************************************************************************
[11/25/21 18:49:40] INFO	********************************************************************************
[11/25/21 18:49:40] INFO	AlphaPy Start
[11/25/21 18:49:40] INFO	********************************************************************************
[11/25/21 18:49:40] INFO	Model Configuration
[11/25/21 18:49:40] INFO	No transforms Found
[11/25/21 18:49:40] INFO	MODEL PARAMETERS:
[11/25/21 18:49:40] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[11/25/21 18:49:40] INFO	calibration       = False
[11/25/21 18:49:40] INFO	cal_type          = sigmoid
[11/25/21 18:49:40] INFO	calibration_plot  = False
[11/25/21 18:49:40] INFO	clustering        = True
[11/25/21 18:49:40] INFO	cluster_inc       = 3
[11/25/21 18:49:40] INFO	cluster_max       = 30
[11/25/21 18:49:40] INFO	cluster_min       = 3
[11/25/21 18:49:40] INFO	confusion_matrix  = True
[11/25/21 18:49:40] INFO	counts            = True
[11/25/21 18:49:40] INFO	cv_folds          = 3
[11/25/21 18:49:40] INFO	directory         = .
[11/25/21 18:49:40] INFO	extension         = csv
[11/25/21 18:49:40] INFO	drop              = ['PassengerId']
[11/25/21 18:49:40] INFO	encoder           = <Encoders.target: 14>
[11/25/21 18:49:40] INFO	esr               = 20
[11/25/21 18:49:40] INFO	factors           = ['Embarked']
[11/25/21 18:49:40] INFO	features [X]      = *
[11/25/21 18:49:40] INFO	feature_selection = False
[11/25/21 18:49:40] INFO	fs_percentage     = 50
[11/25/21 18:49:40] INFO	fs_score_func     = <function f_classif at 0x7faa6a4f0dc0>
[11/25/21 18:49:40] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[11/25/21 18:49:40] INFO	grid_search       = True
[11/25/21 18:49:40] INFO	gs_iters          = 50
[11/25/21 18:49:40] INFO	gs_random         = True
[11/25/21 18:49:40] INFO	gs_sample         = False
[11/25/21 18:49:40] INFO	gs_sample_pct     = 0.200000
[11/25/21 18:49:40] INFO	importances       = True
[11/25/21 18:49:40] INFO	interactions      = False
[11/25/21 18:49:40] INFO	isomap            = False
[11/25/21 18:49:40] INFO	iso_components    = 2
[11/25/21 18:49:40] INFO	iso_neighbors     = 5
[11/25/21 18:49:40] INFO	isample_pct       = 10
[11/25/21 18:49:40] INFO	leaders           = []
[11/25/21 18:49:40] INFO	learning_curve    = True
[11/25/21 18:49:40] INFO	logtransform      = False
[11/25/21 18:49:40] INFO	lv_remove         = True
[11/25/21 18:49:40] INFO	lv_threshold      = 0.100000
[11/25/21 18:49:40] INFO	model_type        = <ModelType.classification: 1>
[11/25/21 18:49:40] INFO	n_estimators      = 51
[11/25/21 18:49:40] INFO	n_jobs            = -1
[11/25/21 18:49:40] INFO	ngrams_max        = 2
[11/25/21 18:49:40] INFO	numpy             = True
[11/25/21 18:49:40] INFO	pca               = False
[11/25/21 18:49:40] INFO	pca_inc           = 1
[11/25/21 18:49:40] INFO	pca_max           = 10
[11/25/21 18:49:40] INFO	pca_min           = 2
[11/25/21 18:49:40] INFO	pca_whiten        = False
[11/25/21 18:49:40] INFO	poly_degree       = 2
[11/25/21 18:49:40] INFO	pvalue_level      = 0.010000
[11/25/21 18:49:40] INFO	rfe               = True
[11/25/21 18:49:40] INFO	rfe_step          = 3
[11/25/21 18:49:40] INFO	roc_curve         = True
[11/25/21 18:49:40] INFO	rounding          = 2
[11/25/21 18:49:40] INFO	sampling          = False
[11/25/21 18:49:40] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[11/25/21 18:49:40] INFO	sampling_ratio    = 0.500000
[11/25/21 18:49:40] INFO	scaler_option     = True
[11/25/21 18:49:40] INFO	scaler_type       = <Scalers.standard: 2>
[11/25/21 18:49:40] INFO	scipy             = False
[11/25/21 18:49:40] INFO	scorer            = roc_auc
[11/25/21 18:49:40] INFO	seed              = 42
[11/25/21 18:49:40] INFO	sentinel          = -1
[11/25/21 18:49:40] INFO	separator         = ,
[11/25/21 18:49:40] INFO	shuffle           = False
[11/25/21 18:49:40] INFO	split             = 0.400000
[11/25/21 18:49:40] INFO	submission_file   = gender_submission
[11/25/21 18:49:40] INFO	submit_probas     = False
[11/25/21 18:49:40] INFO	target [y]        = Survived
[11/25/21 18:49:40] INFO	target_value      = 1
[11/25/21 18:49:40] INFO	transforms        = None
[11/25/21 18:49:40] INFO	tsne              = False
[11/25/21 18:49:40] INFO	tsne_components   = 2
[11/25/21 18:49:40] INFO	tsne_learn_rate   = 1000.000000
[11/25/21 18:49:40] INFO	tsne_perplexity   = 30.000000
[11/25/21 18:49:40] INFO	vectorize         = False
[11/25/21 18:49:40] INFO	verbosity         = 0
[11/25/21 18:49:40] INFO	Creating Model
[11/25/21 18:49:40] INFO	Calling Pipeline
[11/25/21 18:49:40] INFO	Training Pipeline
[11/25/21 18:49:40] INFO	Loading Data
[11/25/21 18:49:40] INFO	Loading data from ./input/train.csv
[11/25/21 18:49:40] INFO	Found target Survived in data frame
[11/25/21 18:49:40] INFO	Labels (y) found for Partition.train
[11/25/21 18:49:40] INFO	Loading Data
[11/25/21 18:49:40] INFO	Loading data from ./input/test.csv
[11/25/21 18:49:40] INFO	Target Survived not found in Partition.test
[11/25/21 18:49:40] INFO	Saving New Features in Model
[11/25/21 18:49:40] INFO	Original Feature Statistics
[11/25/21 18:49:40] INFO	Number of Training Rows    : 891
[11/25/21 18:49:40] INFO	Number of Training Columns : 11
[11/25/21 18:49:40] INFO	Unique Training Values for Survived : [0 1]
[11/25/21 18:49:40] INFO	Unique Training Counts for Survived : [549 342]
[11/25/21 18:49:40] INFO	Number of Testing Rows     : 418
[11/25/21 18:49:40] INFO	Number of Testing Columns  : 11
[11/25/21 18:49:40] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[11/25/21 18:49:40] INFO	Feature Count     : 11
[11/25/21 18:49:40] INFO	Applying transforms
[11/25/21 18:49:40] INFO	No transforms Specified
[11/25/21 18:49:40] INFO	New Feature Count : 11
[11/25/21 18:49:40] INFO	Dropping Features: ['PassengerId']
[11/25/21 18:49:40] INFO	Original Feature Count : 11
[11/25/21 18:49:40] INFO	Reduced Feature Count  : 10
[11/25/21 18:49:40] INFO	Writing data frame to ./input/train_20211125.csv
[11/25/21 18:49:40] INFO	Writing data frame to ./input/test_20211125.csv
[11/25/21 18:49:40] INFO	Creating Cross-Tabulations
[11/25/21 18:49:40] INFO	Creating crosstabs for feature Embarked
[11/25/21 18:49:41] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[11/25/21 18:49:41] INFO	Feature Count     : 10
[11/25/21 18:49:41] INFO	Creating Count Features
[11/25/21 18:49:41] INFO	NA Counts
[11/25/21 18:49:41] INFO	Number Counts
[11/25/21 18:49:41] INFO	New Feature Count : 21
[11/25/21 18:49:41] INFO	Creating Base Features
[11/25/21 18:49:41] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[11/25/21 18:49:41] INFO	Feature 2: Name => Factorization
[11/25/21 18:49:41] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[11/25/21 18:49:41] INFO	Feature 3: Sex => Factorization
[11/25/21 18:49:41] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[11/25/21 18:49:41] INFO	Feature 7: Ticket => Factorization
[11/25/21 18:49:41] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[11/25/21 18:49:41] INFO	Feature 9: Cabin => Factorization
[11/25/21 18:49:41] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[11/25/21 18:49:41] INFO	Encoding: Encoders.target
[11/25/21 18:49:41] INFO	Fitting training features for Embarked
[11/25/21 18:49:41] INFO	Transforming testing features for Embarked
[11/25/21 18:49:41] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[11/25/21 18:49:41] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/25/21 18:49:41] INFO	New Feature Count : 21
[11/25/21 18:49:41] INFO	Scaling Base Features
[11/25/21 18:49:41] INFO	Creating NumPy Features
[11/25/21 18:49:41] INFO	NumPy Feature: sum
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	NumPy Feature: mean
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	NumPy Feature: std
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	NumPy Feature: var
[11/25/21 18:49:41] INFO	    Imputation for Data Type float64: Median Strategy
[11/25/21 18:49:41] INFO	NumPy Feature Count : 4
[11/25/21 18:49:41] INFO	New Feature Count : 25
[11/25/21 18:49:41] INFO	Creating Clustering Features
[11/25/21 18:49:41] INFO	Cluster Minimum   : 3
[11/25/21 18:49:41] INFO	Cluster Maximum   : 30
[11/25/21 18:49:41] INFO	Cluster Increment : 3
[11/25/21 18:49:41] INFO	k = 3
[11/25/21 18:49:42] INFO	k = 6
[11/25/21 18:49:42] INFO	k = 9
[11/25/21 18:49:42] INFO	k = 12
[11/25/21 18:49:42] INFO	k = 15
[11/25/21 18:49:42] INFO	k = 18
[11/25/21 18:49:42] INFO	k = 21
[11/25/21 18:49:42] INFO	k = 24
[11/25/21 18:49:42] INFO	k = 27
[11/25/21 18:49:42] INFO	k = 30
[11/25/21 18:49:43] INFO	Clustering Feature Count : 10
[11/25/21 18:49:43] INFO	New Feature Count : 35
[11/25/21 18:49:43] INFO	Saving New Features in Model
[11/25/21 18:49:43] INFO	Creating Interactions
[11/25/21 18:49:43] INFO	Initial Feature Count  : 35
[11/25/21 18:49:43] INFO	Skipping Interactions
[11/25/21 18:49:43] INFO	Saving New Features in Model
[11/25/21 18:49:43] INFO	Removing Low-Variance Features
[11/25/21 18:49:43] INFO	Low-Variance Threshold  : 0.10
[11/25/21 18:49:43] INFO	Original Feature Count  : 35
[11/25/21 18:49:43] INFO	Reduced Feature Count   : 35
[11/25/21 18:49:43] INFO	Saving New Features in Model
[11/25/21 18:49:43] INFO	Skipping Shuffling
[11/25/21 18:49:43] INFO	Skipping Sampling
[11/25/21 18:49:43] INFO	Getting All Estimators
[11/25/21 18:49:43] INFO	Algorithm Configuration
[11/25/21 18:49:43] INFO	Selecting Models
[11/25/21 18:49:43] INFO	Algorithm: CATB
[11/25/21 18:49:43] INFO	Fitting Initial Model
[11/25/21 18:49:43] INFO	Cross-Validation
[11/25/21 18:49:45] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[11/25/21 18:49:45] INFO	Recursive Feature Elimination with CV
[11/25/21 18:49:47] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[11/25/21 18:49:47] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[11/25/21 18:49:47] INFO	No grid is defined for grid search
[11/25/21 18:49:47] INFO	Final Model Predictions for CATB
[11/25/21 18:49:47] INFO	Skipping Calibration
[11/25/21 18:49:47] INFO	Making Predictions
[11/25/21 18:49:47] INFO	Predictions Complete
[11/25/21 18:49:47] INFO	Algorithm: LGB
[11/25/21 18:49:47] INFO	Fitting Initial Model
[11/25/21 18:49:47] INFO	Cross-Validation
[11/25/21 18:49:48] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[11/25/21 18:49:48] INFO	Recursive Feature Elimination with CV
[11/25/21 18:49:50] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[11/25/21 18:49:50] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[11/25/21 18:49:50] INFO	No grid is defined for grid search
[11/25/21 18:49:50] INFO	Final Model Predictions for LGB
[11/25/21 18:49:50] INFO	Skipping Calibration
[11/25/21 18:49:50] INFO	Making Predictions
[11/25/21 18:49:50] INFO	Predictions Complete
[11/25/21 18:49:50] INFO	Algorithm: XGB
[11/25/21 18:49:50] INFO	Fitting Initial Model
[11/25/21 18:49:50] INFO	Cross-Validation
[11/25/21 18:49:51] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[11/25/21 18:49:51] INFO	Recursive Feature Elimination with CV
[11/25/21 18:49:53] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[11/25/21 18:49:53] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[11/25/21 18:49:53] INFO	Randomized Grid Search
[11/25/21 18:50:55] INFO	Grid Search took 61.62 seconds for 50 candidate parameter settings.
[11/25/21 18:50:55] INFO	Model with rank: 1
[11/25/21 18:50:55] INFO	Mean validation score: 0.871 (std: 0.020)
[11/25/21 18:50:55] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[11/25/21 18:50:55] INFO	Model with rank: 2
[11/25/21 18:50:55] INFO	Mean validation score: 0.870 (std: 0.020)
[11/25/21 18:50:55] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[11/25/21 18:50:55] INFO	Model with rank: 3
[11/25/21 18:50:55] INFO	Mean validation score: 0.869 (std: 0.023)
[11/25/21 18:50:55] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[11/25/21 18:50:55] INFO	Algorithm: XGB, Best Score: 0.8711, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[11/25/21 18:50:55] INFO	Final Model Predictions for XGB
[11/25/21 18:50:55] INFO	Skipping Calibration
[11/25/21 18:50:55] INFO	Making Predictions
[11/25/21 18:50:55] INFO	Predictions Complete
[11/25/21 18:50:55] INFO	Blending Models
[11/25/21 18:50:55] INFO	Blending Start: 2021-11-25 18:50:55.069971
[11/25/21 18:50:55] INFO	Blending Complete: 0:00:00.008802
[11/25/21 18:50:55] INFO	================================================================================
[11/25/21 18:50:55] INFO	Metrics for: Partition.train
[11/25/21 18:50:55] INFO	--------------------------------------------------------------------------------
[11/25/21 18:50:55] INFO	Algorithm: CATB
[11/25/21 18:50:55] INFO	accuracy: 0.8585858585858586
[11/25/21 18:50:55] INFO	average_precision: 0.9113351686222868
[11/25/21 18:50:55] INFO	balanced_accuracy: 0.8378391333525069
[11/25/21 18:50:55] INFO	brier_score_loss: 0.10043404518351136
[11/25/21 18:50:55] INFO	cohen_kappa: 0.6932572665125658
[11/25/21 18:50:55] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[11/25/21 18:50:55] INFO	f1: 0.8025078369905956
[11/25/21 18:50:55] INFO	neg_log_loss: 0.3371948718196211
[11/25/21 18:50:55] INFO	precision: 0.8648648648648649
[11/25/21 18:50:55] INFO	recall: 0.7485380116959064
[11/25/21 18:50:55] INFO	roc_auc: 0.9297979313797549
[11/25/21 18:50:55] INFO	--------------------------------------------------------------------------------
[11/25/21 18:50:55] INFO	Algorithm: LGB
[11/25/21 18:50:55] INFO	accuracy: 0.9730639730639731
[11/25/21 18:50:55] INFO	average_precision: 0.9961113207491221
[11/25/21 18:50:55] INFO	balanced_accuracy: 0.9687709711437062
[11/25/21 18:50:55] INFO	brier_score_loss: 0.032809498448974184
[11/25/21 18:50:55] INFO	cohen_kappa: 0.9427387092109702
[11/25/21 18:50:55] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[11/25/21 18:50:55] INFO	f1: 0.9643916913946586
[11/25/21 18:50:55] INFO	neg_log_loss: 0.1458307566281259
[11/25/21 18:50:55] INFO	precision: 0.9789156626506024
[11/25/21 18:50:55] INFO	recall: 0.9502923976608187
[11/25/21 18:50:55] INFO	roc_auc: 0.9974861257576241
[11/25/21 18:50:55] INFO	--------------------------------------------------------------------------------
[11/25/21 18:50:55] INFO	Algorithm: XGB
[11/25/21 18:50:55] INFO	accuracy: 0.9270482603815937
[11/25/21 18:50:55] INFO	average_precision: 0.9709402433999754
[11/25/21 18:50:55] INFO	balanced_accuracy: 0.9126881411178218
[11/25/21 18:50:55] INFO	brier_score_loss: 0.0744489049696746
[11/25/21 18:50:55] INFO	cohen_kappa: 0.8425611039072248
[11/25/21 18:50:55] INFO	confusion_matrix: [[535  14]
 [ 51 291]]
[11/25/21 18:50:55] INFO	f1: 0.8995363214837713
[11/25/21 18:50:55] INFO	neg_log_loss: 0.2881813540001108
[11/25/21 18:50:55] INFO	precision: 0.9540983606557377
[11/25/21 18:50:55] INFO	recall: 0.8508771929824561
[11/25/21 18:50:55] INFO	roc_auc: 0.9792552114956486
[11/25/21 18:50:55] INFO	================================================================================
[11/25/21 18:50:55] INFO	Metrics for: Partition.test
[11/25/21 18:50:55] INFO	No labels for generating Partition.test metrics
[11/25/21 18:50:55] INFO	================================================================================
[11/25/21 18:50:55] INFO	Selecting Best Model
[11/25/21 18:50:55] INFO	Scoring for: Partition.train
[11/25/21 18:50:55] INFO	Best Model Selection Start: 2021-11-25 18:50:55.099905
[11/25/21 18:50:55] INFO	Scoring CATB Model
[11/25/21 18:50:55] INFO	Scoring LGB Model
[11/25/21 18:50:55] INFO	Scoring XGB Model
[11/25/21 18:50:55] INFO	Scoring BLEND Model
[11/25/21 18:50:55] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[11/25/21 18:50:55] INFO	Best Model Selection Complete: 0:00:00.000199
[11/25/21 18:50:55] INFO	================================================================================
[11/25/21 18:50:55] INFO	Generating Plots for partition: train
[11/25/21 18:50:55] INFO	Generating Calibration Plot
[11/25/21 18:50:55] INFO	Calibration for Algorithm: CATB
[11/25/21 18:50:55] INFO	Calibration for Algorithm: LGB
[11/25/21 18:50:55] INFO	Calibration for Algorithm: XGB
[11/25/21 18:50:55] INFO	Writing plot to ./plots/calibration_train.png
[11/25/21 18:50:55] INFO	Generating Confusion Matrices
[11/25/21 18:50:55] INFO	Confusion Matrix for Algorithm: CATB
[11/25/21 18:50:55] INFO	Confusion Matrix:
[11/25/21 18:50:55] INFO	[[509  40]
 [ 86 256]]
[11/25/21 18:50:55] INFO	Writing plot to ./plots/confusion_train_CATB.png
[11/25/21 18:50:55] INFO	Confusion Matrix for Algorithm: LGB
[11/25/21 18:50:55] INFO	Confusion Matrix:
[11/25/21 18:50:55] INFO	[[542   7]
 [ 17 325]]
[11/25/21 18:50:55] INFO	Writing plot to ./plots/confusion_train_LGB.png
[11/25/21 18:50:55] INFO	Confusion Matrix for Algorithm: XGB
[11/25/21 18:50:55] INFO	Confusion Matrix:
[11/25/21 18:50:55] INFO	[[535  14]
 [ 51 291]]
[11/25/21 18:50:55] INFO	Writing plot to ./plots/confusion_train_XGB.png
[11/25/21 18:50:55] INFO	Generating ROC Curves
[11/25/21 18:50:55] INFO	ROC Curve for Algorithm: CATB
[11/25/21 18:50:55] INFO	ROC Curve for Algorithm: LGB
[11/25/21 18:50:55] INFO	ROC Curve for Algorithm: XGB
[11/25/21 18:50:55] INFO	Writing plot to ./plots/roc_curve_train.png
[11/25/21 18:50:55] INFO	Generating Learning Curves
[11/25/21 18:50:55] INFO	Algorithm Configuration
[11/25/21 18:50:55] INFO	Learning Curve for Algorithm: CATB
[11/25/21 18:50:56] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[11/25/21 18:50:56] INFO	Learning Curve for Algorithm: LGB
[11/25/21 18:50:57] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[11/25/21 18:50:57] INFO	Learning Curve for Algorithm: XGB
[11/25/21 18:50:58] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[11/25/21 18:50:58] INFO	Generating Feature Importance Plots
[11/25/21 18:50:58] INFO	Feature Importances for Algorithm: CATB
[11/25/21 18:50:58] INFO	Feature Ranking:
[11/25/21 18:50:58] INFO	1. Sex_factor (45.178104)
[11/25/21 18:50:58] INFO	2. Pclass (13.721171)
[11/25/21 18:50:58] INFO	3. Age (6.651788)
[11/25/21 18:50:58] INFO	4. Fare (4.529770)
[11/25/21 18:50:58] INFO	5. var (3.586590)
[11/25/21 18:50:58] INFO	6. std (3.492385)
[11/25/21 18:50:58] INFO	7. Ticket_factor (3.315046)
[11/25/21 18:50:58] INFO	8. cluster_30 (2.831587)
[11/25/21 18:50:58] INFO	9. mean (2.733389)
[11/25/21 18:50:58] INFO	10. Name_factor (2.586310)
[11/25/21 18:50:58] INFO	11. Cabin_factor (2.101764)
[11/25/21 18:50:58] INFO	12. Embarked (2.086410)
[11/25/21 18:50:58] INFO	13. SibSp (2.085405)
[11/25/21 18:50:58] INFO	14. cluster_12 (1.876782)
[11/25/21 18:50:58] INFO	15. cluster_24 (1.263144)
[11/25/21 18:50:58] INFO	16. count_2 (1.004409)
[11/25/21 18:50:58] INFO	17. sum (0.955946)
[11/25/21 18:50:58] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[11/25/21 18:50:58] INFO	Feature Importances for Algorithm: LGB
[11/25/21 18:50:58] INFO	Feature Ranking:
[11/25/21 18:50:58] INFO	1. Fare (256.000000)
[11/25/21 18:50:58] INFO	2. sum (241.000000)
[11/25/21 18:50:58] INFO	3. Age (232.000000)
[11/25/21 18:50:58] INFO	4. std (201.000000)
[11/25/21 18:50:58] INFO	5. Ticket_factor (199.000000)
[11/25/21 18:50:58] INFO	6. Name_factor (175.000000)
[11/25/21 18:50:58] INFO	7. cluster_30 (53.000000)
[11/25/21 18:50:58] INFO	8. cluster_27 (46.000000)
[11/25/21 18:50:58] INFO	9. Sex_factor (43.000000)
[11/25/21 18:50:58] INFO	10. Pclass (43.000000)
[11/25/21 18:50:58] INFO	11. Cabin_factor (41.000000)
[11/25/21 18:50:58] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[11/25/21 18:50:58] INFO	Feature Importances for Algorithm: XGB
[11/25/21 18:50:58] INFO	Feature Ranking:
[11/25/21 18:50:58] INFO	1. Sex_factor (0.424644)
[11/25/21 18:50:58] INFO	2. Pclass (0.127452)
[11/25/21 18:50:58] INFO	3. Cabin_factor (0.081307)
[11/25/21 18:50:58] INFO	4. Age (0.051007)
[11/25/21 18:50:58] INFO	5. SibSp (0.049620)
[11/25/21 18:50:58] INFO	6. count_1 (0.046373)
[11/25/21 18:50:58] INFO	7. Embarked (0.046225)
[11/25/21 18:50:58] INFO	8. std (0.036262)
[11/25/21 18:50:58] INFO	9. cluster_30 (0.036076)
[11/25/21 18:50:58] INFO	10. Fare (0.032410)
[11/25/21 18:50:58] INFO	11. cluster_24 (0.021187)
[11/25/21 18:50:58] INFO	12. Name_factor (0.019312)
[11/25/21 18:50:58] INFO	13. sum (0.017784)
[11/25/21 18:50:58] INFO	14. cluster_15 (0.010340)
[11/25/21 18:50:58] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[11/25/21 18:50:58] INFO	================================================================================
[11/25/21 18:50:58] INFO	Saving Model Predictor
[11/25/21 18:50:58] INFO	Writing model predictor to ./model/model_20211125.pkl
[11/25/21 18:50:58] INFO	Saving Feature Map
[11/25/21 18:50:58] INFO	Writing feature map to ./model/feature_map_20211125.pkl
[11/25/21 18:50:58] INFO	Loading data from ./input/test_20211125.csv
[11/25/21 18:50:58] INFO	Saving Predictions
[11/25/21 18:50:58] INFO	Writing data frame to ./output/predictions_20211125.csv
[11/25/21 18:50:58] INFO	Saving Probabilities
[11/25/21 18:50:58] INFO	Writing data frame to ./output/probabilities_20211125.csv
[11/25/21 18:50:58] INFO	Saving Ranked Predictions
[11/25/21 18:50:58] INFO	Writing data frame to ./output/rankings_20211125.csv
[11/25/21 18:50:58] INFO	Saving Submission to ./output/submission_20211125.csv
[11/25/21 18:50:58] INFO	********************************************************************************
[11/25/21 18:50:58] INFO	AlphaPy End
[11/25/21 18:50:58] INFO	********************************************************************************
[11/26/21 18:50:36] INFO	********************************************************************************
[11/26/21 18:50:36] INFO	AlphaPy Start
[11/26/21 18:50:36] INFO	********************************************************************************
[11/26/21 18:50:36] INFO	Model Configuration
[11/26/21 18:50:36] INFO	No transforms Found
[11/26/21 18:50:36] INFO	MODEL PARAMETERS:
[11/26/21 18:50:36] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[11/26/21 18:50:36] INFO	calibration       = False
[11/26/21 18:50:36] INFO	cal_type          = sigmoid
[11/26/21 18:50:36] INFO	calibration_plot  = False
[11/26/21 18:50:36] INFO	clustering        = True
[11/26/21 18:50:36] INFO	cluster_inc       = 3
[11/26/21 18:50:36] INFO	cluster_max       = 30
[11/26/21 18:50:36] INFO	cluster_min       = 3
[11/26/21 18:50:36] INFO	confusion_matrix  = True
[11/26/21 18:50:36] INFO	counts            = True
[11/26/21 18:50:36] INFO	cv_folds          = 3
[11/26/21 18:50:36] INFO	directory         = .
[11/26/21 18:50:36] INFO	extension         = csv
[11/26/21 18:50:36] INFO	drop              = ['PassengerId']
[11/26/21 18:50:36] INFO	encoder           = <Encoders.target: 14>
[11/26/21 18:50:36] INFO	esr               = 20
[11/26/21 18:50:36] INFO	factors           = ['Embarked']
[11/26/21 18:50:36] INFO	features [X]      = *
[11/26/21 18:50:36] INFO	feature_selection = False
[11/26/21 18:50:36] INFO	fs_percentage     = 50
[11/26/21 18:50:36] INFO	fs_score_func     = <function f_classif at 0x7fcd32fafd30>
[11/26/21 18:50:36] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[11/26/21 18:50:36] INFO	grid_search       = True
[11/26/21 18:50:36] INFO	gs_iters          = 50
[11/26/21 18:50:36] INFO	gs_random         = True
[11/26/21 18:50:36] INFO	gs_sample         = False
[11/26/21 18:50:36] INFO	gs_sample_pct     = 0.200000
[11/26/21 18:50:36] INFO	importances       = True
[11/26/21 18:50:36] INFO	interactions      = False
[11/26/21 18:50:36] INFO	isomap            = False
[11/26/21 18:50:36] INFO	iso_components    = 2
[11/26/21 18:50:36] INFO	iso_neighbors     = 5
[11/26/21 18:50:36] INFO	isample_pct       = 10
[11/26/21 18:50:36] INFO	leaders           = []
[11/26/21 18:50:36] INFO	learning_curve    = True
[11/26/21 18:50:36] INFO	logtransform      = False
[11/26/21 18:50:36] INFO	lv_remove         = True
[11/26/21 18:50:36] INFO	lv_threshold      = 0.100000
[11/26/21 18:50:36] INFO	model_type        = <ModelType.classification: 1>
[11/26/21 18:50:36] INFO	n_estimators      = 51
[11/26/21 18:50:36] INFO	n_jobs            = -1
[11/26/21 18:50:36] INFO	ngrams_max        = 2
[11/26/21 18:50:36] INFO	numpy             = True
[11/26/21 18:50:36] INFO	pca               = False
[11/26/21 18:50:36] INFO	pca_inc           = 1
[11/26/21 18:50:36] INFO	pca_max           = 10
[11/26/21 18:50:36] INFO	pca_min           = 2
[11/26/21 18:50:36] INFO	pca_whiten        = False
[11/26/21 18:50:36] INFO	poly_degree       = 2
[11/26/21 18:50:36] INFO	pvalue_level      = 0.010000
[11/26/21 18:50:36] INFO	rfe               = True
[11/26/21 18:50:36] INFO	rfe_step          = 3
[11/26/21 18:50:36] INFO	roc_curve         = True
[11/26/21 18:50:36] INFO	rounding          = 2
[11/26/21 18:50:36] INFO	sampling          = False
[11/26/21 18:50:36] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[11/26/21 18:50:36] INFO	sampling_ratio    = 0.500000
[11/26/21 18:50:36] INFO	scaler_option     = True
[11/26/21 18:50:36] INFO	scaler_type       = <Scalers.standard: 2>
[11/26/21 18:50:36] INFO	scipy             = False
[11/26/21 18:50:36] INFO	scorer            = roc_auc
[11/26/21 18:50:36] INFO	seed              = 42
[11/26/21 18:50:36] INFO	sentinel          = -1
[11/26/21 18:50:36] INFO	separator         = ,
[11/26/21 18:50:36] INFO	shuffle           = False
[11/26/21 18:50:36] INFO	split             = 0.400000
[11/26/21 18:50:36] INFO	submission_file   = gender_submission
[11/26/21 18:50:36] INFO	submit_probas     = False
[11/26/21 18:50:36] INFO	target [y]        = Survived
[11/26/21 18:50:36] INFO	target_value      = 1
[11/26/21 18:50:36] INFO	transforms        = None
[11/26/21 18:50:36] INFO	tsne              = False
[11/26/21 18:50:36] INFO	tsne_components   = 2
[11/26/21 18:50:36] INFO	tsne_learn_rate   = 1000.000000
[11/26/21 18:50:36] INFO	tsne_perplexity   = 30.000000
[11/26/21 18:50:36] INFO	vectorize         = False
[11/26/21 18:50:36] INFO	verbosity         = 0
[11/26/21 18:50:36] INFO	Creating Model
[11/26/21 18:50:36] INFO	Calling Pipeline
[11/26/21 18:50:36] INFO	Training Pipeline
[11/26/21 18:50:36] INFO	Loading Data
[11/26/21 18:50:36] INFO	Loading data from ./input/train.csv
[11/26/21 18:50:36] INFO	Found target Survived in data frame
[11/26/21 18:50:36] INFO	Labels (y) found for Partition.train
[11/26/21 18:50:36] INFO	Loading Data
[11/26/21 18:50:36] INFO	Loading data from ./input/test.csv
[11/26/21 18:50:36] INFO	Target Survived not found in Partition.test
[11/26/21 18:50:36] INFO	Saving New Features in Model
[11/26/21 18:50:36] INFO	Original Feature Statistics
[11/26/21 18:50:36] INFO	Number of Training Rows    : 891
[11/26/21 18:50:36] INFO	Number of Training Columns : 11
[11/26/21 18:50:36] INFO	Unique Training Values for Survived : [0 1]
[11/26/21 18:50:36] INFO	Unique Training Counts for Survived : [549 342]
[11/26/21 18:50:36] INFO	Number of Testing Rows     : 418
[11/26/21 18:50:36] INFO	Number of Testing Columns  : 11
[11/26/21 18:50:36] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[11/26/21 18:50:36] INFO	Feature Count     : 11
[11/26/21 18:50:36] INFO	Applying transforms
[11/26/21 18:50:36] INFO	No transforms Specified
[11/26/21 18:50:36] INFO	New Feature Count : 11
[11/26/21 18:50:36] INFO	Dropping Features: ['PassengerId']
[11/26/21 18:50:36] INFO	Original Feature Count : 11
[11/26/21 18:50:36] INFO	Reduced Feature Count  : 10
[11/26/21 18:50:36] INFO	Writing data frame to ./input/train_20211126.csv
[11/26/21 18:50:36] INFO	Writing data frame to ./input/test_20211126.csv
[11/26/21 18:50:36] INFO	Creating Cross-Tabulations
[11/26/21 18:50:36] INFO	Creating crosstabs for feature Embarked
[11/26/21 18:50:36] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[11/26/21 18:50:36] INFO	Feature Count     : 10
[11/26/21 18:50:36] INFO	Creating Count Features
[11/26/21 18:50:36] INFO	NA Counts
[11/26/21 18:50:36] INFO	Number Counts
[11/26/21 18:50:36] INFO	New Feature Count : 21
[11/26/21 18:50:36] INFO	Creating Base Features
[11/26/21 18:50:36] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[11/26/21 18:50:36] INFO	Feature 2: Name => Factorization
[11/26/21 18:50:36] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[11/26/21 18:50:36] INFO	Feature 3: Sex => Factorization
[11/26/21 18:50:36] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[11/26/21 18:50:36] INFO	Feature 7: Ticket => Factorization
[11/26/21 18:50:36] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[11/26/21 18:50:36] INFO	Feature 9: Cabin => Factorization
[11/26/21 18:50:36] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[11/26/21 18:50:36] INFO	Encoding: Encoders.target
[11/26/21 18:50:36] INFO	Fitting training features for Embarked
[11/26/21 18:50:36] INFO	Transforming testing features for Embarked
[11/26/21 18:50:36] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[11/26/21 18:50:36] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[11/26/21 18:50:36] INFO	New Feature Count : 21
[11/26/21 18:50:36] INFO	Scaling Base Features
[11/26/21 18:50:36] INFO	Creating NumPy Features
[11/26/21 18:50:36] INFO	NumPy Feature: sum
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	NumPy Feature: mean
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	NumPy Feature: std
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	NumPy Feature: var
[11/26/21 18:50:36] INFO	    Imputation for Data Type float64: Median Strategy
[11/26/21 18:50:36] INFO	NumPy Feature Count : 4
[11/26/21 18:50:36] INFO	New Feature Count : 25
[11/26/21 18:50:36] INFO	Creating Clustering Features
[11/26/21 18:50:36] INFO	Cluster Minimum   : 3
[11/26/21 18:50:36] INFO	Cluster Maximum   : 30
[11/26/21 18:50:36] INFO	Cluster Increment : 3
[11/26/21 18:50:36] INFO	k = 3
[11/26/21 18:50:38] INFO	k = 6
[11/26/21 18:50:38] INFO	k = 9
[11/26/21 18:50:38] INFO	k = 12
[11/26/21 18:50:38] INFO	k = 15
[11/26/21 18:50:38] INFO	k = 18
[11/26/21 18:50:38] INFO	k = 21
[11/26/21 18:50:38] INFO	k = 24
[11/26/21 18:50:38] INFO	k = 27
[11/26/21 18:50:38] INFO	k = 30
[11/26/21 18:50:38] INFO	Clustering Feature Count : 10
[11/26/21 18:50:38] INFO	New Feature Count : 35
[11/26/21 18:50:38] INFO	Saving New Features in Model
[11/26/21 18:50:38] INFO	Creating Interactions
[11/26/21 18:50:38] INFO	Initial Feature Count  : 35
[11/26/21 18:50:38] INFO	Skipping Interactions
[11/26/21 18:50:38] INFO	Saving New Features in Model
[11/26/21 18:50:38] INFO	Removing Low-Variance Features
[11/26/21 18:50:38] INFO	Low-Variance Threshold  : 0.10
[11/26/21 18:50:38] INFO	Original Feature Count  : 35
[11/26/21 18:50:38] INFO	Reduced Feature Count   : 35
[11/26/21 18:50:38] INFO	Saving New Features in Model
[11/26/21 18:50:38] INFO	Skipping Shuffling
[11/26/21 18:50:38] INFO	Skipping Sampling
[11/26/21 18:50:38] INFO	Getting All Estimators
[11/26/21 18:50:38] INFO	Algorithm Configuration
[11/26/21 18:50:39] INFO	Selecting Models
[11/26/21 18:50:39] INFO	Algorithm: CATB
[11/26/21 18:50:39] INFO	Fitting Initial Model
[11/26/21 18:50:39] INFO	Cross-Validation
[11/26/21 18:50:40] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[11/26/21 18:50:40] INFO	Recursive Feature Elimination with CV
[11/26/21 18:50:43] INFO	RFECV took 2.43 seconds for step 3 and 3 folds
[11/26/21 18:50:43] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[11/26/21 18:50:43] INFO	No grid is defined for grid search
[11/26/21 18:50:43] INFO	Final Model Predictions for CATB
[11/26/21 18:50:43] INFO	Skipping Calibration
[11/26/21 18:50:43] INFO	Making Predictions
[11/26/21 18:50:43] INFO	Predictions Complete
[11/26/21 18:50:43] INFO	Algorithm: LGB
[11/26/21 18:50:43] INFO	Fitting Initial Model
[11/26/21 18:50:43] INFO	Cross-Validation
[11/26/21 18:50:43] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[11/26/21 18:50:43] INFO	Recursive Feature Elimination with CV
[11/26/21 18:50:46] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[11/26/21 18:50:46] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[11/26/21 18:50:46] INFO	No grid is defined for grid search
[11/26/21 18:50:46] INFO	Final Model Predictions for LGB
[11/26/21 18:50:46] INFO	Skipping Calibration
[11/26/21 18:50:46] INFO	Making Predictions
[11/26/21 18:50:46] INFO	Predictions Complete
[11/26/21 18:50:46] INFO	Algorithm: XGB
[11/26/21 18:50:46] INFO	Fitting Initial Model
[11/26/21 18:50:46] INFO	Cross-Validation
[11/26/21 18:50:46] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[11/26/21 18:50:46] INFO	Recursive Feature Elimination with CV
[11/26/21 18:50:49] INFO	RFECV took 2.47 seconds for step 3 and 3 folds
[11/26/21 18:50:49] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[11/26/21 18:50:49] INFO	Randomized Grid Search
[12/19/21 22:22:47] INFO	********************************************************************************
[12/19/21 22:22:47] INFO	AlphaPy Start
[12/19/21 22:22:47] INFO	********************************************************************************
[12/19/21 22:22:47] INFO	Model Configuration
[12/19/21 22:22:47] INFO	No transforms Found
[12/19/21 22:22:47] INFO	MODEL PARAMETERS:
[12/19/21 22:22:47] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:22:47] INFO	calibration       = False
[12/19/21 22:22:47] INFO	cal_type          = sigmoid
[12/19/21 22:22:47] INFO	calibration_plot  = False
[12/19/21 22:22:47] INFO	clustering        = True
[12/19/21 22:22:47] INFO	cluster_inc       = 3
[12/19/21 22:22:47] INFO	cluster_max       = 30
[12/19/21 22:22:47] INFO	cluster_min       = 3
[12/19/21 22:22:47] INFO	confusion_matrix  = True
[12/19/21 22:22:47] INFO	counts            = True
[12/19/21 22:22:47] INFO	cv_folds          = 3
[12/19/21 22:22:47] INFO	directory         = .
[12/19/21 22:22:47] INFO	extension         = csv
[12/19/21 22:22:47] INFO	drop              = ['PassengerId']
[12/19/21 22:22:47] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:22:47] INFO	esr               = 20
[12/19/21 22:22:47] INFO	factors           = ['Embarked']
[12/19/21 22:22:47] INFO	features [X]      = *
[12/19/21 22:22:47] INFO	feature_selection = False
[12/19/21 22:22:47] INFO	fs_percentage     = 50
[12/19/21 22:22:47] INFO	fs_score_func     = <function f_classif at 0x7fe22b268ee0>
[12/19/21 22:22:47] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:22:47] INFO	grid_search       = True
[12/19/21 22:22:47] INFO	gs_iters          = 50
[12/19/21 22:22:47] INFO	gs_random         = True
[12/19/21 22:22:47] INFO	gs_sample         = False
[12/19/21 22:22:47] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:22:47] INFO	importances       = True
[12/19/21 22:22:47] INFO	interactions      = False
[12/19/21 22:22:47] INFO	isomap            = False
[12/19/21 22:22:47] INFO	iso_components    = 2
[12/19/21 22:22:47] INFO	iso_neighbors     = 5
[12/19/21 22:22:47] INFO	isample_pct       = 10
[12/19/21 22:22:47] INFO	leaders           = []
[12/19/21 22:22:47] INFO	learning_curve    = True
[12/19/21 22:22:47] INFO	logtransform      = False
[12/19/21 22:22:47] INFO	lv_remove         = True
[12/19/21 22:22:47] INFO	lv_threshold      = 0.100000
[12/19/21 22:22:47] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:22:47] INFO	n_estimators      = 51
[12/19/21 22:22:47] INFO	n_jobs            = -1
[12/19/21 22:22:47] INFO	ngrams_max        = 2
[12/19/21 22:22:47] INFO	numpy             = True
[12/19/21 22:22:47] INFO	pca               = False
[12/19/21 22:22:47] INFO	pca_inc           = 1
[12/19/21 22:22:47] INFO	pca_max           = 10
[12/19/21 22:22:47] INFO	pca_min           = 2
[12/19/21 22:22:47] INFO	pca_whiten        = False
[12/19/21 22:22:47] INFO	poly_degree       = 2
[12/19/21 22:22:47] INFO	pvalue_level      = 0.010000
[12/19/21 22:22:47] INFO	rfe               = True
[12/19/21 22:22:47] INFO	rfe_step          = 3
[12/19/21 22:22:47] INFO	roc_curve         = True
[12/19/21 22:22:47] INFO	rounding          = 2
[12/19/21 22:22:47] INFO	sampling          = False
[12/19/21 22:22:47] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:22:47] INFO	sampling_ratio    = 0.500000
[12/19/21 22:22:47] INFO	scaler_option     = True
[12/19/21 22:22:47] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:22:47] INFO	scipy             = False
[12/19/21 22:22:47] INFO	scorer            = roc_auc
[12/19/21 22:22:47] INFO	seed              = 42
[12/19/21 22:22:47] INFO	sentinel          = -1
[12/19/21 22:22:47] INFO	separator         = ,
[12/19/21 22:22:47] INFO	shuffle           = False
[12/19/21 22:22:47] INFO	split             = 0.400000
[12/19/21 22:22:47] INFO	submission_file   = gender_submission
[12/19/21 22:22:47] INFO	submit_probas     = False
[12/19/21 22:22:47] INFO	target [y]        = Survived
[12/19/21 22:22:47] INFO	target_value      = 1
[12/19/21 22:22:47] INFO	transforms        = None
[12/19/21 22:22:47] INFO	tsne              = False
[12/19/21 22:22:47] INFO	tsne_components   = 2
[12/19/21 22:22:47] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:22:47] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:22:47] INFO	vectorize         = False
[12/19/21 22:22:47] INFO	verbosity         = 0
[12/19/21 22:22:47] INFO	Creating Model
[12/19/21 22:22:47] INFO	Calling Pipeline
[12/19/21 22:22:47] INFO	Training Pipeline
[12/19/21 22:22:47] INFO	Loading Data
[12/19/21 22:22:47] INFO	Loading data from ./input/train.csv
[12/19/21 22:22:47] INFO	Found target Survived in data frame
[12/19/21 22:22:47] INFO	Labels (y) found for Partition.train
[12/19/21 22:22:47] INFO	Loading Data
[12/19/21 22:22:47] INFO	Loading data from ./input/test.csv
[12/19/21 22:22:47] INFO	Target Survived not found in Partition.test
[12/19/21 22:22:47] INFO	Saving New Features in Model
[12/19/21 22:22:47] INFO	Original Feature Statistics
[12/19/21 22:22:47] INFO	Number of Training Rows    : 891
[12/19/21 22:22:47] INFO	Number of Training Columns : 11
[12/19/21 22:22:47] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:22:47] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:22:47] INFO	Number of Testing Rows     : 418
[12/19/21 22:22:47] INFO	Number of Testing Columns  : 11
[12/19/21 22:22:47] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:22:47] INFO	Feature Count     : 11
[12/19/21 22:22:47] INFO	Applying transforms
[12/19/21 22:22:47] INFO	No transforms Specified
[12/19/21 22:22:47] INFO	New Feature Count : 11
[12/19/21 22:22:47] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:22:47] INFO	Original Feature Count : 11
[12/19/21 22:22:47] INFO	Reduced Feature Count  : 10
[12/19/21 22:22:47] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:22:47] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:22:47] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:22:47] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:22:47] INFO	Creating Cross-Tabulations
[12/19/21 22:22:47] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:22:47] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:22:47] INFO	Feature Count     : 10
[12/19/21 22:22:47] INFO	Creating Count Features
[12/19/21 22:22:47] INFO	NA Counts
[12/19/21 22:22:47] INFO	Number Counts
[12/19/21 22:22:47] INFO	New Feature Count : 21
[12/19/21 22:22:47] INFO	Creating Base Features
[12/19/21 22:22:47] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:22:47] INFO	Feature 2: Name => Factorization
[12/19/21 22:22:47] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:22:47] INFO	Feature 3: Sex => Factorization
[12/19/21 22:22:47] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:22:47] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:22:47] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:22:47] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:22:47] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:22:47] INFO	Encoding: Encoders.target
[12/19/21 22:22:47] INFO	Fitting training features for Embarked
[12/19/21 22:22:47] INFO	Transforming testing features for Embarked
[12/19/21 22:22:47] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:22:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:22:47] INFO	New Feature Count : 21
[12/19/21 22:22:47] INFO	Scaling Base Features
[12/19/21 22:22:47] INFO	Creating NumPy Features
[12/19/21 22:22:47] INFO	NumPy Feature: sum
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	NumPy Feature: mean
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	NumPy Feature: std
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	NumPy Feature: var
[12/19/21 22:22:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:22:47] INFO	NumPy Feature Count : 4
[12/19/21 22:22:47] INFO	New Feature Count : 25
[12/19/21 22:22:47] INFO	Creating Clustering Features
[12/19/21 22:22:47] INFO	Cluster Minimum   : 3
[12/19/21 22:22:47] INFO	Cluster Maximum   : 30
[12/19/21 22:22:47] INFO	Cluster Increment : 3
[12/19/21 22:22:47] INFO	k = 3
[12/19/21 22:22:49] INFO	k = 6
[12/19/21 22:22:49] INFO	k = 9
[12/19/21 22:22:49] INFO	k = 12
[12/19/21 22:22:49] INFO	k = 15
[12/19/21 22:22:49] INFO	k = 18
[12/19/21 22:22:49] INFO	k = 21
[12/19/21 22:22:49] INFO	k = 24
[12/19/21 22:22:49] INFO	k = 27
[12/19/21 22:22:49] INFO	k = 30
[12/19/21 22:22:49] INFO	Clustering Feature Count : 10
[12/19/21 22:22:49] INFO	New Feature Count : 35
[12/19/21 22:22:49] INFO	Saving New Features in Model
[12/19/21 22:22:49] INFO	Creating Interactions
[12/19/21 22:22:49] INFO	Initial Feature Count  : 35
[12/19/21 22:22:49] INFO	Skipping Interactions
[12/19/21 22:22:49] INFO	Saving New Features in Model
[12/19/21 22:22:49] INFO	Removing Low-Variance Features
[12/19/21 22:22:49] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:22:49] INFO	Original Feature Count  : 35
[12/19/21 22:22:49] INFO	Reduced Feature Count   : 35
[12/19/21 22:22:49] INFO	Saving New Features in Model
[12/19/21 22:22:49] INFO	Skipping Shuffling
[12/19/21 22:22:49] INFO	Skipping Sampling
[12/19/21 22:22:49] INFO	Getting All Estimators
[12/19/21 22:22:49] INFO	Algorithm Configuration
[12/19/21 22:22:50] INFO	Selecting Models
[12/19/21 22:22:50] INFO	Algorithm: CATB
[12/19/21 22:22:50] INFO	Fitting Initial Model
[12/19/21 22:22:50] INFO	Cross-Validation
[12/19/21 22:22:51] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/19/21 22:22:51] INFO	Recursive Feature Elimination with CV
[12/19/21 22:22:54] INFO	RFECV took 2.38 seconds for step 3 and 3 folds
[12/19/21 22:22:54] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/19/21 22:22:54] INFO	No grid is defined for grid search
[12/19/21 22:22:54] INFO	Final Model Predictions for CATB
[12/19/21 22:22:54] INFO	Skipping Calibration
[12/19/21 22:22:54] INFO	Making Predictions
[12/19/21 22:22:54] INFO	Predictions Complete
[12/19/21 22:22:54] INFO	Algorithm: LGB
[12/19/21 22:22:54] INFO	Fitting Initial Model
[12/19/21 22:22:54] INFO	Cross-Validation
[12/19/21 22:22:55] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/19/21 22:22:55] INFO	Recursive Feature Elimination with CV
[12/19/21 22:22:57] INFO	RFECV took 2.61 seconds for step 3 and 3 folds
[12/19/21 22:22:57] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/19/21 22:22:57] INFO	No grid is defined for grid search
[12/19/21 22:22:57] INFO	Final Model Predictions for LGB
[12/19/21 22:22:57] INFO	Skipping Calibration
[12/19/21 22:22:57] INFO	Making Predictions
[12/19/21 22:22:57] INFO	Predictions Complete
[12/19/21 22:22:57] INFO	Algorithm: XGB
[12/19/21 22:22:57] INFO	Fitting Initial Model
[12/19/21 22:22:58] INFO	Cross-Validation
[12/19/21 22:22:58] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/19/21 22:22:58] INFO	Recursive Feature Elimination with CV
[12/19/21 22:23:00] INFO	RFECV took 2.46 seconds for step 3 and 3 folds
[12/19/21 22:23:00] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/19/21 22:23:00] INFO	Randomized Grid Search
[12/19/21 22:23:56] INFO	Grid Search took 55.35 seconds for 50 candidate parameter settings.
[12/19/21 22:23:56] INFO	Model with rank: 1
[12/19/21 22:23:56] INFO	Mean validation score: 0.874 (std: 0.020)
[12/19/21 22:23:56] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:23:56] INFO	Model with rank: 2
[12/19/21 22:23:56] INFO	Mean validation score: 0.872 (std: 0.022)
[12/19/21 22:23:56] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:23:56] INFO	Model with rank: 3
[12/19/21 22:23:56] INFO	Mean validation score: 0.870 (std: 0.021)
[12/19/21 22:23:56] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:23:56] INFO	Algorithm: XGB, Best Score: 0.8739, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:23:56] INFO	Final Model Predictions for XGB
[12/19/21 22:23:56] INFO	Skipping Calibration
[12/19/21 22:23:56] INFO	Making Predictions
[12/19/21 22:23:56] INFO	Predictions Complete
[12/19/21 22:23:56] INFO	Blending Models
[12/19/21 22:23:56] INFO	Blending Start: 2021-12-19 22:23:56.079548
[12/19/21 22:23:56] INFO	Blending Complete: 0:00:00.011548
[12/19/21 22:23:56] INFO	================================================================================
[12/19/21 22:23:56] INFO	Metrics for: Partition.train
[12/19/21 22:23:56] INFO	--------------------------------------------------------------------------------
[12/19/21 22:23:56] INFO	Algorithm: CATB
[12/19/21 22:23:56] INFO	accuracy: 0.8585858585858586
[12/19/21 22:23:56] INFO	average_precision: 0.9113351686222868
[12/19/21 22:23:56] INFO	balanced_accuracy: 0.8378391333525069
[12/19/21 22:23:56] INFO	brier_score_loss: 0.10043404518351136
[12/19/21 22:23:56] INFO	cohen_kappa: 0.6932572665125658
[12/19/21 22:23:56] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/19/21 22:23:56] INFO	f1: 0.8025078369905956
[12/19/21 22:23:56] INFO	neg_log_loss: 0.3371948718196211
[12/19/21 22:23:56] INFO	precision: 0.8648648648648649
[12/19/21 22:23:56] INFO	recall: 0.7485380116959064
[12/19/21 22:23:56] INFO	roc_auc: 0.9297979313797549
[12/19/21 22:23:56] INFO	--------------------------------------------------------------------------------
[12/19/21 22:23:56] INFO	Algorithm: LGB
[12/19/21 22:23:56] INFO	accuracy: 0.9730639730639731
[12/19/21 22:23:56] INFO	average_precision: 0.9961113207491221
[12/19/21 22:23:56] INFO	balanced_accuracy: 0.9687709711437062
[12/19/21 22:23:56] INFO	brier_score_loss: 0.032809498448974184
[12/19/21 22:23:56] INFO	cohen_kappa: 0.9427387092109702
[12/19/21 22:23:56] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/19/21 22:23:56] INFO	f1: 0.9643916913946586
[12/19/21 22:23:56] INFO	neg_log_loss: 0.1458307566281259
[12/19/21 22:23:56] INFO	precision: 0.9789156626506024
[12/19/21 22:23:56] INFO	recall: 0.9502923976608187
[12/19/21 22:23:56] INFO	roc_auc: 0.9974861257576241
[12/19/21 22:23:56] INFO	--------------------------------------------------------------------------------
[12/19/21 22:23:56] INFO	Algorithm: XGB
[12/19/21 22:23:56] INFO	accuracy: 0.9046015712682379
[12/19/21 22:23:56] INFO	average_precision: 0.9488766207165115
[12/19/21 22:23:56] INFO	balanced_accuracy: 0.8878583069696098
[12/19/21 22:23:56] INFO	brier_score_loss: 0.08579760205612244
[12/19/21 22:23:56] INFO	cohen_kappa: 0.793653907456904
[12/19/21 22:23:56] INFO	confusion_matrix: [[527  22]
 [ 63 279]]
[12/19/21 22:23:56] INFO	f1: 0.8678071539657854
[12/19/21 22:23:56] INFO	neg_log_loss: 0.3116556849042173
[12/19/21 22:23:56] INFO	precision: 0.9269102990033222
[12/19/21 22:23:56] INFO	recall: 0.8157894736842105
[12/19/21 22:23:56] INFO	roc_auc: 0.9625262305733976
[12/19/21 22:23:56] INFO	================================================================================
[12/19/21 22:23:56] INFO	Metrics for: Partition.test
[12/19/21 22:23:56] INFO	No labels for generating Partition.test metrics
[12/19/21 22:23:56] INFO	================================================================================
[12/19/21 22:23:56] INFO	Selecting Best Model
[12/19/21 22:23:56] INFO	Scoring for: Partition.train
[12/19/21 22:23:56] INFO	Best Model Selection Start: 2021-12-19 22:23:56.113113
[12/19/21 22:23:56] INFO	Scoring CATB Model
[12/19/21 22:23:56] INFO	Scoring LGB Model
[12/19/21 22:23:56] INFO	Scoring XGB Model
[12/19/21 22:23:56] INFO	Scoring BLEND Model
[12/19/21 22:23:56] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/19/21 22:23:56] INFO	Best Model Selection Complete: 0:00:00.000206
[12/19/21 22:23:56] INFO	================================================================================
[12/19/21 22:23:56] INFO	Generating Plots for partition: train
[12/19/21 22:23:56] INFO	Generating Calibration Plot
[12/19/21 22:23:56] INFO	Calibration for Algorithm: CATB
[12/19/21 22:23:56] INFO	Calibration for Algorithm: LGB
[12/19/21 22:23:56] INFO	Calibration for Algorithm: XGB
[12/19/21 22:23:56] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:23:56] INFO	Generating Confusion Matrices
[12/19/21 22:23:56] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:23:56] INFO	Confusion Matrix:
[12/19/21 22:23:56] INFO	[[509  40]
 [ 86 256]]
[12/19/21 22:23:56] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:23:56] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:23:56] INFO	Confusion Matrix:
[12/19/21 22:23:56] INFO	[[542   7]
 [ 17 325]]
[12/19/21 22:23:56] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:23:56] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:23:56] INFO	Confusion Matrix:
[12/19/21 22:23:56] INFO	[[527  22]
 [ 63 279]]
[12/19/21 22:23:56] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:23:56] INFO	Generating ROC Curves
[12/19/21 22:23:56] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:23:56] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:23:56] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:23:56] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:23:56] INFO	Generating Learning Curves
[12/19/21 22:23:56] INFO	Algorithm Configuration
[12/19/21 22:23:56] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:23:57] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:23:57] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:23:59] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:23:59] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:24:00] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:24:00] INFO	Generating Feature Importance Plots
[12/19/21 22:24:00] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:24:00] INFO	Feature Ranking:
[12/19/21 22:24:00] INFO	1. Sex_factor (45.178104)
[12/19/21 22:24:00] INFO	2. Pclass (13.721171)
[12/19/21 22:24:00] INFO	3. Age (6.651788)
[12/19/21 22:24:00] INFO	4. Fare (4.529770)
[12/19/21 22:24:00] INFO	5. var (3.586590)
[12/19/21 22:24:00] INFO	6. std (3.492385)
[12/19/21 22:24:00] INFO	7. Ticket_factor (3.315046)
[12/19/21 22:24:00] INFO	8. cluster_30 (2.831587)
[12/19/21 22:24:00] INFO	9. mean (2.733389)
[12/19/21 22:24:00] INFO	10. Name_factor (2.586310)
[12/19/21 22:24:00] INFO	11. Cabin_factor (2.101764)
[12/19/21 22:24:00] INFO	12. Embarked (2.086410)
[12/19/21 22:24:00] INFO	13. SibSp (2.085405)
[12/19/21 22:24:00] INFO	14. cluster_12 (1.876782)
[12/19/21 22:24:00] INFO	15. cluster_24 (1.263144)
[12/19/21 22:24:00] INFO	16. count_2 (1.004409)
[12/19/21 22:24:00] INFO	17. sum (0.955946)
[12/19/21 22:24:00] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:24:00] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:24:00] INFO	Feature Ranking:
[12/19/21 22:24:00] INFO	1. Fare (256.000000)
[12/19/21 22:24:00] INFO	2. sum (241.000000)
[12/19/21 22:24:00] INFO	3. Age (232.000000)
[12/19/21 22:24:00] INFO	4. std (201.000000)
[12/19/21 22:24:00] INFO	5. Ticket_factor (199.000000)
[12/19/21 22:24:00] INFO	6. Name_factor (175.000000)
[12/19/21 22:24:00] INFO	7. cluster_30 (53.000000)
[12/19/21 22:24:00] INFO	8. cluster_27 (46.000000)
[12/19/21 22:24:00] INFO	9. Sex_factor (43.000000)
[12/19/21 22:24:00] INFO	10. Pclass (43.000000)
[12/19/21 22:24:00] INFO	11. Cabin_factor (41.000000)
[12/19/21 22:24:00] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:24:00] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:24:00] INFO	Feature Ranking:
[12/19/21 22:24:00] INFO	1. Sex_factor (0.424644)
[12/19/21 22:24:00] INFO	2. Pclass (0.127452)
[12/19/21 22:24:00] INFO	3. Cabin_factor (0.081307)
[12/19/21 22:24:00] INFO	4. Age (0.051007)
[12/19/21 22:24:00] INFO	5. SibSp (0.049620)
[12/19/21 22:24:00] INFO	6. count_1 (0.046373)
[12/19/21 22:24:00] INFO	7. Embarked (0.046225)
[12/19/21 22:24:00] INFO	8. std (0.036262)
[12/19/21 22:24:00] INFO	9. cluster_30 (0.036076)
[12/19/21 22:24:00] INFO	10. Fare (0.032410)
[12/19/21 22:24:00] INFO	11. cluster_24 (0.021187)
[12/19/21 22:24:00] INFO	12. Name_factor (0.019312)
[12/19/21 22:24:00] INFO	13. sum (0.017784)
[12/19/21 22:24:00] INFO	14. cluster_15 (0.010340)
[12/19/21 22:24:00] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:24:00] INFO	================================================================================
[12/19/21 22:24:00] INFO	Saving Model Predictor
[12/19/21 22:24:00] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:24:00] INFO	Saving Feature Map
[12/19/21 22:24:00] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:24:00] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:24:00] INFO	Saving Predictions
[12/19/21 22:24:00] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:24:00] INFO	Saving Probabilities
[12/19/21 22:24:00] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:24:00] INFO	Saving Ranked Predictions
[12/19/21 22:24:00] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:24:00] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:24:00] INFO	********************************************************************************
[12/19/21 22:24:00] INFO	AlphaPy End
[12/19/21 22:24:00] INFO	********************************************************************************
[12/19/21 22:32:32] INFO	********************************************************************************
[12/19/21 22:32:32] INFO	AlphaPy Start
[12/19/21 22:32:32] INFO	********************************************************************************
[12/19/21 22:32:32] INFO	Model Configuration
[12/19/21 22:32:32] INFO	No transforms Found
[12/19/21 22:32:32] INFO	MODEL PARAMETERS:
[12/19/21 22:32:32] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:32:32] INFO	calibration       = False
[12/19/21 22:32:32] INFO	cal_type          = sigmoid
[12/19/21 22:32:32] INFO	calibration_plot  = False
[12/19/21 22:32:32] INFO	clustering        = True
[12/19/21 22:32:32] INFO	cluster_inc       = 3
[12/19/21 22:32:32] INFO	cluster_max       = 30
[12/19/21 22:32:32] INFO	cluster_min       = 3
[12/19/21 22:32:32] INFO	confusion_matrix  = True
[12/19/21 22:32:32] INFO	counts            = True
[12/19/21 22:32:32] INFO	cv_folds          = 3
[12/19/21 22:32:32] INFO	directory         = .
[12/19/21 22:32:32] INFO	extension         = csv
[12/19/21 22:32:32] INFO	drop              = ['PassengerId']
[12/19/21 22:32:32] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:32:32] INFO	esr               = 20
[12/19/21 22:32:32] INFO	factors           = ['Embarked']
[12/19/21 22:32:32] INFO	features [X]      = *
[12/19/21 22:32:32] INFO	feature_selection = False
[12/19/21 22:32:32] INFO	fs_percentage     = 50
[12/19/21 22:32:32] INFO	fs_score_func     = <function f_classif at 0x7f871328be50>
[12/19/21 22:32:32] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:32:32] INFO	grid_search       = True
[12/19/21 22:32:32] INFO	gs_iters          = 50
[12/19/21 22:32:32] INFO	gs_random         = True
[12/19/21 22:32:32] INFO	gs_sample         = False
[12/19/21 22:32:32] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:32:32] INFO	importances       = True
[12/19/21 22:32:32] INFO	interactions      = False
[12/19/21 22:32:32] INFO	isomap            = False
[12/19/21 22:32:32] INFO	iso_components    = 2
[12/19/21 22:32:32] INFO	iso_neighbors     = 5
[12/19/21 22:32:32] INFO	isample_pct       = 10
[12/19/21 22:32:32] INFO	leaders           = []
[12/19/21 22:32:32] INFO	learning_curve    = True
[12/19/21 22:32:32] INFO	logtransform      = False
[12/19/21 22:32:32] INFO	lv_remove         = True
[12/19/21 22:32:32] INFO	lv_threshold      = 0.100000
[12/19/21 22:32:32] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:32:32] INFO	n_estimators      = 51
[12/19/21 22:32:32] INFO	n_jobs            = -1
[12/19/21 22:32:32] INFO	ngrams_max        = 2
[12/19/21 22:32:32] INFO	numpy             = True
[12/19/21 22:32:32] INFO	pca               = False
[12/19/21 22:32:32] INFO	pca_inc           = 1
[12/19/21 22:32:32] INFO	pca_max           = 10
[12/19/21 22:32:32] INFO	pca_min           = 2
[12/19/21 22:32:32] INFO	pca_whiten        = False
[12/19/21 22:32:32] INFO	poly_degree       = 2
[12/19/21 22:32:32] INFO	pvalue_level      = 0.010000
[12/19/21 22:32:32] INFO	rfe               = True
[12/19/21 22:32:32] INFO	rfe_step          = 3
[12/19/21 22:32:32] INFO	roc_curve         = True
[12/19/21 22:32:32] INFO	rounding          = 2
[12/19/21 22:32:32] INFO	sampling          = True
[12/19/21 22:32:32] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:32:32] INFO	sampling_ratio    = 0.500000
[12/19/21 22:32:32] INFO	scaler_option     = True
[12/19/21 22:32:32] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:32:32] INFO	scipy             = False
[12/19/21 22:32:32] INFO	scorer            = roc_auc
[12/19/21 22:32:32] INFO	seed              = 42
[12/19/21 22:32:32] INFO	sentinel          = -1
[12/19/21 22:32:32] INFO	separator         = ,
[12/19/21 22:32:32] INFO	shuffle           = False
[12/19/21 22:32:32] INFO	split             = 0.400000
[12/19/21 22:32:32] INFO	submission_file   = gender_submission
[12/19/21 22:32:32] INFO	submit_probas     = False
[12/19/21 22:32:32] INFO	target [y]        = Survived
[12/19/21 22:32:32] INFO	target_value      = 1
[12/19/21 22:32:32] INFO	transforms        = None
[12/19/21 22:32:32] INFO	tsne              = False
[12/19/21 22:32:32] INFO	tsne_components   = 2
[12/19/21 22:32:32] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:32:32] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:32:32] INFO	vectorize         = False
[12/19/21 22:32:32] INFO	verbosity         = 0
[12/19/21 22:32:32] INFO	Creating Model
[12/19/21 22:32:32] INFO	Calling Pipeline
[12/19/21 22:32:32] INFO	Training Pipeline
[12/19/21 22:32:32] INFO	Loading Data
[12/19/21 22:32:32] INFO	Loading data from ./input/train.csv
[12/19/21 22:32:32] INFO	Found target Survived in data frame
[12/19/21 22:32:32] INFO	Labels (y) found for Partition.train
[12/19/21 22:32:32] INFO	Loading Data
[12/19/21 22:32:32] INFO	Loading data from ./input/test.csv
[12/19/21 22:32:32] INFO	Target Survived not found in Partition.test
[12/19/21 22:32:32] INFO	Saving New Features in Model
[12/19/21 22:32:32] INFO	Original Feature Statistics
[12/19/21 22:32:32] INFO	Number of Training Rows    : 891
[12/19/21 22:32:32] INFO	Number of Training Columns : 11
[12/19/21 22:32:32] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:32:32] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:32:32] INFO	Number of Testing Rows     : 418
[12/19/21 22:32:32] INFO	Number of Testing Columns  : 11
[12/19/21 22:32:32] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:32:32] INFO	Feature Count     : 11
[12/19/21 22:32:32] INFO	Applying transforms
[12/19/21 22:32:32] INFO	No transforms Specified
[12/19/21 22:32:32] INFO	New Feature Count : 11
[12/19/21 22:32:32] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:32:32] INFO	Original Feature Count : 11
[12/19/21 22:32:32] INFO	Reduced Feature Count  : 10
[12/19/21 22:32:32] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:32:32] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:32:32] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:32:32] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:32:32] INFO	Creating Cross-Tabulations
[12/19/21 22:32:32] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:32:32] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:32:32] INFO	Feature Count     : 10
[12/19/21 22:32:32] INFO	Creating Count Features
[12/19/21 22:32:32] INFO	NA Counts
[12/19/21 22:32:32] INFO	Number Counts
[12/19/21 22:32:32] INFO	New Feature Count : 21
[12/19/21 22:32:32] INFO	Creating Base Features
[12/19/21 22:32:32] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:32:32] INFO	Feature 2: Name => Factorization
[12/19/21 22:32:32] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:32:32] INFO	Feature 3: Sex => Factorization
[12/19/21 22:32:32] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:32:32] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:32:32] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:32:32] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:32:32] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:32:32] INFO	Encoding: Encoders.target
[12/19/21 22:32:32] INFO	Fitting training features for Embarked
[12/19/21 22:32:32] INFO	Transforming testing features for Embarked
[12/19/21 22:32:32] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:32:32] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:32:32] INFO	New Feature Count : 21
[12/19/21 22:32:32] INFO	Scaling Base Features
[12/19/21 22:32:32] INFO	Creating NumPy Features
[12/19/21 22:32:32] INFO	NumPy Feature: sum
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	NumPy Feature: mean
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	NumPy Feature: std
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	NumPy Feature: var
[12/19/21 22:32:32] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:32:32] INFO	NumPy Feature Count : 4
[12/19/21 22:32:32] INFO	New Feature Count : 25
[12/19/21 22:32:32] INFO	Creating Clustering Features
[12/19/21 22:32:32] INFO	Cluster Minimum   : 3
[12/19/21 22:32:32] INFO	Cluster Maximum   : 30
[12/19/21 22:32:32] INFO	Cluster Increment : 3
[12/19/21 22:32:32] INFO	k = 3
[12/19/21 22:32:34] INFO	k = 6
[12/19/21 22:32:34] INFO	k = 9
[12/19/21 22:32:34] INFO	k = 12
[12/19/21 22:32:34] INFO	k = 15
[12/19/21 22:32:34] INFO	k = 18
[12/19/21 22:32:34] INFO	k = 21
[12/19/21 22:32:34] INFO	k = 24
[12/19/21 22:32:34] INFO	k = 27
[12/19/21 22:32:34] INFO	k = 30
[12/19/21 22:32:34] INFO	Clustering Feature Count : 10
[12/19/21 22:32:34] INFO	New Feature Count : 35
[12/19/21 22:32:34] INFO	Saving New Features in Model
[12/19/21 22:32:34] INFO	Creating Interactions
[12/19/21 22:32:34] INFO	Initial Feature Count  : 35
[12/19/21 22:32:34] INFO	Skipping Interactions
[12/19/21 22:32:34] INFO	Saving New Features in Model
[12/19/21 22:32:34] INFO	Removing Low-Variance Features
[12/19/21 22:32:34] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:32:34] INFO	Original Feature Count  : 35
[12/19/21 22:32:34] INFO	Reduced Feature Count   : 35
[12/19/21 22:32:34] INFO	Saving New Features in Model
[12/19/21 22:32:34] INFO	Skipping Shuffling
[12/19/21 22:32:34] INFO	Sampling Data
[12/19/21 22:32:34] INFO	Sampling Ratio for target Survived [1]: 0.500000
[12/19/21 22:36:19] INFO	********************************************************************************
[12/19/21 22:36:19] INFO	AlphaPy Start
[12/19/21 22:36:19] INFO	********************************************************************************
[12/19/21 22:36:19] INFO	Model Configuration
[12/19/21 22:36:19] INFO	No transforms Found
[12/19/21 22:36:19] INFO	MODEL PARAMETERS:
[12/19/21 22:36:19] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:36:19] INFO	calibration       = False
[12/19/21 22:36:19] INFO	cal_type          = sigmoid
[12/19/21 22:36:19] INFO	calibration_plot  = False
[12/19/21 22:36:19] INFO	clustering        = True
[12/19/21 22:36:19] INFO	cluster_inc       = 3
[12/19/21 22:36:19] INFO	cluster_max       = 30
[12/19/21 22:36:19] INFO	cluster_min       = 3
[12/19/21 22:36:19] INFO	confusion_matrix  = True
[12/19/21 22:36:19] INFO	counts            = True
[12/19/21 22:36:19] INFO	cv_folds          = 3
[12/19/21 22:36:19] INFO	directory         = .
[12/19/21 22:36:19] INFO	extension         = csv
[12/19/21 22:36:19] INFO	drop              = ['PassengerId']
[12/19/21 22:36:19] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:36:19] INFO	esr               = 20
[12/19/21 22:36:19] INFO	factors           = ['Embarked']
[12/19/21 22:36:19] INFO	features [X]      = *
[12/19/21 22:36:19] INFO	feature_selection = False
[12/19/21 22:36:19] INFO	fs_percentage     = 50
[12/19/21 22:36:19] INFO	fs_score_func     = <function f_classif at 0x7fc8d2f38ee0>
[12/19/21 22:36:19] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:36:19] INFO	grid_search       = True
[12/19/21 22:36:19] INFO	gs_iters          = 50
[12/19/21 22:36:19] INFO	gs_random         = True
[12/19/21 22:36:19] INFO	gs_sample         = False
[12/19/21 22:36:19] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:36:19] INFO	importances       = True
[12/19/21 22:36:19] INFO	interactions      = False
[12/19/21 22:36:19] INFO	isomap            = False
[12/19/21 22:36:19] INFO	iso_components    = 2
[12/19/21 22:36:19] INFO	iso_neighbors     = 5
[12/19/21 22:36:19] INFO	isample_pct       = 10
[12/19/21 22:36:19] INFO	leaders           = []
[12/19/21 22:36:19] INFO	learning_curve    = True
[12/19/21 22:36:19] INFO	logtransform      = False
[12/19/21 22:36:19] INFO	lv_remove         = True
[12/19/21 22:36:19] INFO	lv_threshold      = 0.100000
[12/19/21 22:36:19] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:36:19] INFO	n_estimators      = 51
[12/19/21 22:36:19] INFO	n_jobs            = -1
[12/19/21 22:36:19] INFO	ngrams_max        = 2
[12/19/21 22:36:19] INFO	numpy             = True
[12/19/21 22:36:19] INFO	pca               = False
[12/19/21 22:36:19] INFO	pca_inc           = 1
[12/19/21 22:36:19] INFO	pca_max           = 10
[12/19/21 22:36:19] INFO	pca_min           = 2
[12/19/21 22:36:19] INFO	pca_whiten        = False
[12/19/21 22:36:19] INFO	poly_degree       = 2
[12/19/21 22:36:19] INFO	pvalue_level      = 0.010000
[12/19/21 22:36:19] INFO	rfe               = True
[12/19/21 22:36:19] INFO	rfe_step          = 3
[12/19/21 22:36:19] INFO	roc_curve         = True
[12/19/21 22:36:19] INFO	rounding          = 2
[12/19/21 22:36:19] INFO	sampling          = True
[12/19/21 22:36:19] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:36:19] INFO	sampling_ratio    = 1.000000
[12/19/21 22:36:19] INFO	scaler_option     = True
[12/19/21 22:36:19] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:36:19] INFO	scipy             = False
[12/19/21 22:36:19] INFO	scorer            = roc_auc
[12/19/21 22:36:19] INFO	seed              = 42
[12/19/21 22:36:19] INFO	sentinel          = -1
[12/19/21 22:36:19] INFO	separator         = ,
[12/19/21 22:36:19] INFO	shuffle           = False
[12/19/21 22:36:19] INFO	split             = 0.400000
[12/19/21 22:36:19] INFO	submission_file   = gender_submission
[12/19/21 22:36:19] INFO	submit_probas     = False
[12/19/21 22:36:19] INFO	target [y]        = Survived
[12/19/21 22:36:19] INFO	target_value      = 1
[12/19/21 22:36:19] INFO	transforms        = None
[12/19/21 22:36:19] INFO	tsne              = False
[12/19/21 22:36:19] INFO	tsne_components   = 2
[12/19/21 22:36:19] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:36:19] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:36:19] INFO	vectorize         = False
[12/19/21 22:36:19] INFO	verbosity         = 0
[12/19/21 22:36:19] INFO	Creating Model
[12/19/21 22:36:19] INFO	Calling Pipeline
[12/19/21 22:36:19] INFO	Training Pipeline
[12/19/21 22:36:19] INFO	Loading Data
[12/19/21 22:36:19] INFO	Loading data from ./input/train.csv
[12/19/21 22:36:19] INFO	Found target Survived in data frame
[12/19/21 22:36:19] INFO	Labels (y) found for Partition.train
[12/19/21 22:36:19] INFO	Loading Data
[12/19/21 22:36:19] INFO	Loading data from ./input/test.csv
[12/19/21 22:36:19] INFO	Target Survived not found in Partition.test
[12/19/21 22:36:19] INFO	Saving New Features in Model
[12/19/21 22:36:19] INFO	Original Feature Statistics
[12/19/21 22:36:19] INFO	Number of Training Rows    : 891
[12/19/21 22:36:19] INFO	Number of Training Columns : 11
[12/19/21 22:36:19] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:36:19] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:36:19] INFO	Number of Testing Rows     : 418
[12/19/21 22:36:19] INFO	Number of Testing Columns  : 11
[12/19/21 22:36:19] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:36:19] INFO	Feature Count     : 11
[12/19/21 22:36:19] INFO	Applying transforms
[12/19/21 22:36:19] INFO	No transforms Specified
[12/19/21 22:36:19] INFO	New Feature Count : 11
[12/19/21 22:36:19] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:36:19] INFO	Original Feature Count : 11
[12/19/21 22:36:19] INFO	Reduced Feature Count  : 10
[12/19/21 22:36:19] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:36:19] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:36:19] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:36:19] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:36:19] INFO	Creating Cross-Tabulations
[12/19/21 22:36:19] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:36:19] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:36:19] INFO	Feature Count     : 10
[12/19/21 22:36:19] INFO	Creating Count Features
[12/19/21 22:36:19] INFO	NA Counts
[12/19/21 22:36:19] INFO	Number Counts
[12/19/21 22:36:19] INFO	New Feature Count : 21
[12/19/21 22:36:19] INFO	Creating Base Features
[12/19/21 22:36:19] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:36:19] INFO	Feature 2: Name => Factorization
[12/19/21 22:36:19] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:36:19] INFO	Feature 3: Sex => Factorization
[12/19/21 22:36:19] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:36:19] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:36:19] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:36:19] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:36:19] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:36:19] INFO	Encoding: Encoders.target
[12/19/21 22:36:19] INFO	Fitting training features for Embarked
[12/19/21 22:36:19] INFO	Transforming testing features for Embarked
[12/19/21 22:36:19] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:36:19] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:36:19] INFO	New Feature Count : 21
[12/19/21 22:36:19] INFO	Scaling Base Features
[12/19/21 22:36:19] INFO	Creating NumPy Features
[12/19/21 22:36:19] INFO	NumPy Feature: sum
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	NumPy Feature: mean
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	NumPy Feature: std
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	NumPy Feature: var
[12/19/21 22:36:19] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:36:19] INFO	NumPy Feature Count : 4
[12/19/21 22:36:19] INFO	New Feature Count : 25
[12/19/21 22:36:19] INFO	Creating Clustering Features
[12/19/21 22:36:19] INFO	Cluster Minimum   : 3
[12/19/21 22:36:19] INFO	Cluster Maximum   : 30
[12/19/21 22:36:19] INFO	Cluster Increment : 3
[12/19/21 22:36:19] INFO	k = 3
[12/19/21 22:36:21] INFO	k = 6
[12/19/21 22:36:21] INFO	k = 9
[12/19/21 22:36:21] INFO	k = 12
[12/19/21 22:36:21] INFO	k = 15
[12/19/21 22:36:21] INFO	k = 18
[12/19/21 22:36:21] INFO	k = 21
[12/19/21 22:36:21] INFO	k = 24
[12/19/21 22:36:21] INFO	k = 27
[12/19/21 22:36:21] INFO	k = 30
[12/19/21 22:36:21] INFO	Clustering Feature Count : 10
[12/19/21 22:36:21] INFO	New Feature Count : 35
[12/19/21 22:36:21] INFO	Saving New Features in Model
[12/19/21 22:36:21] INFO	Creating Interactions
[12/19/21 22:36:21] INFO	Initial Feature Count  : 35
[12/19/21 22:36:21] INFO	Skipping Interactions
[12/19/21 22:36:21] INFO	Saving New Features in Model
[12/19/21 22:36:21] INFO	Removing Low-Variance Features
[12/19/21 22:36:21] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:36:21] INFO	Original Feature Count  : 35
[12/19/21 22:36:21] INFO	Reduced Feature Count   : 35
[12/19/21 22:36:21] INFO	Saving New Features in Model
[12/19/21 22:36:21] INFO	Skipping Shuffling
[12/19/21 22:36:21] INFO	Sampling Data
[12/19/21 22:36:21] INFO	Sampling Ratio for target Survived [1]: 1.000000
[12/19/21 22:36:21] INFO	Original Samples : 891
[12/19/21 22:36:21] INFO	New Samples      : 684
[12/19/21 22:36:21] INFO	Getting All Estimators
[12/19/21 22:36:21] INFO	Algorithm Configuration
[12/19/21 22:36:21] INFO	Selecting Models
[12/19/21 22:36:21] INFO	Algorithm: CATB
[12/19/21 22:36:21] INFO	Fitting Initial Model
[12/19/21 22:36:21] INFO	Cross-Validation
[12/19/21 22:36:23] INFO	Cross-Validation Scores: [0.51323484 0.7606956  0.56544321]
[12/19/21 22:36:23] INFO	Recursive Feature Elimination with CV
[12/19/21 22:36:26] INFO	RFECV took 2.52 seconds for step 3 and 3 folds
[12/19/21 22:36:26] INFO	Algorithm: CATB, Selected Features: 1, Ranking: [ 2  7  1  3  7  8  4  3  5 10  5  8 12  6  9 12 13 13 13 12 11  4  7  3
  6 10  8  9  5 11  9 11  6 10  4]
[12/19/21 22:36:26] INFO	No grid is defined for grid search
[12/19/21 22:36:26] INFO	Final Model Predictions for CATB
[12/19/21 22:36:26] INFO	Skipping Calibration
[12/19/21 22:36:26] INFO	Making Predictions
[12/19/21 22:36:26] INFO	Predictions Complete
[12/19/21 22:36:26] INFO	Algorithm: LGB
[12/19/21 22:36:26] INFO	Fitting Initial Model
[12/19/21 22:36:26] INFO	Cross-Validation
[12/19/21 22:36:27] INFO	Cross-Validation Scores: [0.38865805 0.67978609 0.31917513]
[12/19/21 22:36:27] INFO	Recursive Feature Elimination with CV
[12/19/21 22:36:28] INFO	RFECV took 1.75 seconds for step 3 and 3 folds
[12/19/21 22:36:28] INFO	Algorithm: LGB, Selected Features: 20, Ranking: [1 1 1 1 1 3 1 1 1 3 4 2 2 1 5 5 5 6 6 4 3 1 6 1 1 4 2 1 1 1 1 1 1 1 1]
[12/19/21 22:36:28] INFO	No grid is defined for grid search
[12/19/21 22:36:28] INFO	Final Model Predictions for LGB
[12/19/21 22:36:28] INFO	Skipping Calibration
[12/19/21 22:36:28] INFO	Making Predictions
[12/19/21 22:36:28] INFO	Predictions Complete
[12/19/21 22:36:28] INFO	Algorithm: XGB
[12/19/21 22:36:28] INFO	Fitting Initial Model
[12/19/21 22:36:28] INFO	Cross-Validation
[12/19/21 22:36:29] INFO	Cross-Validation Scores: [0.3079409  0.77208372 0.29470606]
[12/19/21 22:36:29] INFO	Recursive Feature Elimination with CV
[12/19/21 22:36:31] INFO	RFECV took 2.49 seconds for step 3 and 3 folds
[12/19/21 22:36:31] INFO	Algorithm: XGB, Selected Features: 1, Ranking: [ 2  5  1  4  3 10  6  3  3  9  8  8  5  8 11 12 11 13 12 12 13  6 13  5
  9  9  4  7 10  7  7 10  6 11  4]
[12/19/21 22:36:31] INFO	Randomized Grid Search
[12/19/21 22:36:47] INFO	Grid Search took 15.70 seconds for 50 candidate parameter settings.
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:36:47] INFO	Model with rank: 1
[12/19/21 22:36:47] INFO	Mean validation score: 0.762 (std: 0.015)
[12/19/21 22:36:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[12/19/21 22:36:47] INFO	Algorithm: XGB, Best Score: 0.7617, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:36:47] INFO	Final Model Predictions for XGB
[12/19/21 22:36:47] INFO	Skipping Calibration
[12/19/21 22:36:47] INFO	Making Predictions
[12/19/21 22:36:47] INFO	Predictions Complete
[12/19/21 22:36:47] INFO	Blending Models
[12/19/21 22:36:47] INFO	Blending Start: 2021-12-19 22:36:47.322865
[12/19/21 22:36:47] INFO	Blending Complete: 0:00:00.009133
[12/19/21 22:36:47] INFO	================================================================================
[12/19/21 22:36:47] INFO	Metrics for: Partition.train
[12/19/21 22:36:47] INFO	--------------------------------------------------------------------------------
[12/19/21 22:36:47] INFO	Algorithm: CATB
[12/19/21 22:36:47] INFO	accuracy: 0.7616959064327485
[12/19/21 22:36:47] INFO	average_precision: 0.7124569553966217
[12/19/21 22:36:47] INFO	balanced_accuracy: 0.7616959064327485
[12/19/21 22:36:47] INFO	brier_score_loss: 0.1796970977286416
[12/19/21 22:36:47] INFO	cohen_kappa: 0.5233918128654971
[12/19/21 22:36:47] INFO	confusion_matrix: [[288  54]
 [109 233]]
[12/19/21 22:36:47] INFO	f1: 0.740858505564388
[12/19/21 22:36:47] INFO	neg_log_loss: 0.5440169618201504
[12/19/21 22:36:47] INFO	precision: 0.8118466898954704
[12/19/21 22:36:47] INFO	recall: 0.6812865497076024
[12/19/21 22:36:47] INFO	roc_auc: 0.7616959064327485
[12/19/21 22:36:47] INFO	--------------------------------------------------------------------------------
[12/19/21 22:36:47] INFO	Algorithm: LGB
[12/19/21 22:36:47] INFO	accuracy: 0.9692982456140351
[12/19/21 22:36:47] INFO	average_precision: 0.9961778179955005
[12/19/21 22:36:47] INFO	balanced_accuracy: 0.9692982456140351
[12/19/21 22:36:47] INFO	brier_score_loss: 0.0398919394847438
[12/19/21 22:36:47] INFO	cohen_kappa: 0.9385964912280702
[12/19/21 22:36:47] INFO	confusion_matrix: [[333   9]
 [ 12 330]]
[12/19/21 22:36:47] INFO	f1: 0.9691629955947135
[12/19/21 22:36:47] INFO	neg_log_loss: 0.17010650304931121
[12/19/21 22:36:47] INFO	precision: 0.9734513274336283
[12/19/21 22:36:47] INFO	recall: 0.9649122807017544
[12/19/21 22:36:47] INFO	roc_auc: 0.9960158681303649
[12/19/21 22:36:47] INFO	--------------------------------------------------------------------------------
[12/19/21 22:36:47] INFO	Algorithm: XGB
[12/19/21 22:36:47] INFO	accuracy: 0.7616959064327485
[12/19/21 22:36:47] INFO	average_precision: 0.7124569553966217
[12/19/21 22:36:47] INFO	balanced_accuracy: 0.7616959064327485
[12/19/21 22:36:47] INFO	brier_score_loss: 0.17970015415104082
[12/19/21 22:36:47] INFO	cohen_kappa: 0.5233918128654971
[12/19/21 22:36:47] INFO	confusion_matrix: [[288  54]
 [109 233]]
[12/19/21 22:36:47] INFO	f1: 0.740858505564388
[12/19/21 22:36:47] INFO	neg_log_loss: 0.5440268125058266
[12/19/21 22:36:47] INFO	precision: 0.8118466898954704
[12/19/21 22:36:47] INFO	recall: 0.6812865497076024
[12/19/21 22:36:47] INFO	roc_auc: 0.7616959064327485
[12/19/21 22:36:47] INFO	================================================================================
[12/19/21 22:36:47] INFO	Metrics for: Partition.test
[12/19/21 22:36:47] INFO	No labels for generating Partition.test metrics
[12/19/21 22:36:47] INFO	================================================================================
[12/19/21 22:36:47] INFO	Selecting Best Model
[12/19/21 22:36:47] INFO	Scoring for: Partition.train
[12/19/21 22:36:47] INFO	Best Model Selection Start: 2021-12-19 22:36:47.350979
[12/19/21 22:36:47] INFO	Scoring CATB Model
[12/19/21 22:36:47] INFO	Scoring LGB Model
[12/19/21 22:36:47] INFO	Scoring XGB Model
[12/19/21 22:36:47] INFO	Scoring BLEND Model
[12/19/21 22:36:47] INFO	Best Model is BLEND with a roc_auc score of 0.9969
[12/19/21 22:36:47] INFO	Best Model Selection Complete: 0:00:00.000259
[12/19/21 22:36:47] INFO	================================================================================
[12/19/21 22:36:47] INFO	Generating Plots for partition: train
[12/19/21 22:36:47] INFO	Generating Calibration Plot
[12/19/21 22:36:47] INFO	Calibration for Algorithm: CATB
[12/19/21 22:36:47] INFO	Calibration for Algorithm: LGB
[12/19/21 22:36:47] INFO	Calibration for Algorithm: XGB
[12/19/21 22:36:47] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:36:47] INFO	Generating Confusion Matrices
[12/19/21 22:36:47] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:36:47] INFO	Confusion Matrix:
[12/19/21 22:36:47] INFO	[[288  54]
 [109 233]]
[12/19/21 22:36:47] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:36:47] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:36:47] INFO	Confusion Matrix:
[12/19/21 22:36:47] INFO	[[333   9]
 [ 12 330]]
[12/19/21 22:36:47] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:36:47] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:36:47] INFO	Confusion Matrix:
[12/19/21 22:36:47] INFO	[[288  54]
 [109 233]]
[12/19/21 22:36:47] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:36:47] INFO	Generating ROC Curves
[12/19/21 22:36:47] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:36:47] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:36:47] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:36:47] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:36:47] INFO	Generating Learning Curves
[12/19/21 22:36:47] INFO	Algorithm Configuration
[12/19/21 22:36:47] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:36:48] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:36:48] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:36:49] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:36:49] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:36:50] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:36:50] INFO	Generating Feature Importance Plots
[12/19/21 22:36:50] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:36:50] INFO	Feature Ranking:
[12/19/21 22:36:50] INFO	1. Sex_factor (100.000000)
[12/19/21 22:36:50] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:36:50] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:36:50] INFO	Feature Ranking:
[12/19/21 22:36:50] INFO	1. Fare (172.000000)
[12/19/21 22:36:50] INFO	2. sum (169.000000)
[12/19/21 22:36:50] INFO	3. Age (169.000000)
[12/19/21 22:36:50] INFO	4. std (152.000000)
[12/19/21 22:36:50] INFO	5. Name_factor (145.000000)
[12/19/21 22:36:50] INFO	6. Ticket_factor (145.000000)
[12/19/21 22:36:50] INFO	7. Sex_factor (38.000000)
[12/19/21 22:36:50] INFO	8. cluster_30 (35.000000)
[12/19/21 22:36:50] INFO	9. cluster_18 (35.000000)
[12/19/21 22:36:50] INFO	10. cluster_27 (34.000000)
[12/19/21 22:36:50] INFO	11. Cabin_factor (34.000000)
[12/19/21 22:36:50] INFO	12. cluster_24 (32.000000)
[12/19/21 22:36:50] INFO	13. cluster_12 (31.000000)
[12/19/21 22:36:50] INFO	14. Pclass (28.000000)
[12/19/21 22:36:50] INFO	15. cluster_15 (24.000000)
[12/19/21 22:36:50] INFO	16. count_2 (23.000000)
[12/19/21 22:36:50] INFO	17. var (22.000000)
[12/19/21 22:36:50] INFO	18. SibSp (17.000000)
[12/19/21 22:36:50] INFO	19. cluster_9 (14.000000)
[12/19/21 22:36:50] INFO	20. cluster_21 (14.000000)
[12/19/21 22:36:50] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:36:50] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:36:50] INFO	Feature Ranking:
[12/19/21 22:36:50] INFO	1. Sex_factor (1.000000)
[12/19/21 22:36:50] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:36:50] INFO	================================================================================
[12/19/21 22:36:50] INFO	Saving Model Predictor
[12/19/21 22:36:50] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:36:50] INFO	Saving Feature Map
[12/19/21 22:36:50] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:36:50] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:36:50] INFO	Saving Predictions
[12/19/21 22:36:50] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:36:50] INFO	Saving Probabilities
[12/19/21 22:36:50] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:36:50] INFO	Saving Ranked Predictions
[12/19/21 22:36:50] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:36:50] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:36:50] INFO	********************************************************************************
[12/19/21 22:36:50] INFO	AlphaPy End
[12/19/21 22:36:50] INFO	********************************************************************************
[12/19/21 22:42:54] INFO	********************************************************************************
[12/19/21 22:42:54] INFO	AlphaPy Start
[12/19/21 22:42:54] INFO	********************************************************************************
[12/19/21 22:42:54] INFO	Model Configuration
[12/19/21 22:42:54] INFO	No transforms Found
[12/19/21 22:42:54] INFO	MODEL PARAMETERS:
[12/19/21 22:42:54] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:42:54] INFO	calibration       = False
[12/19/21 22:42:54] INFO	cal_type          = sigmoid
[12/19/21 22:42:54] INFO	calibration_plot  = False
[12/19/21 22:42:54] INFO	clustering        = True
[12/19/21 22:42:54] INFO	cluster_inc       = 3
[12/19/21 22:42:54] INFO	cluster_max       = 30
[12/19/21 22:42:54] INFO	cluster_min       = 3
[12/19/21 22:42:54] INFO	confusion_matrix  = True
[12/19/21 22:42:54] INFO	counts            = True
[12/19/21 22:42:54] INFO	cv_folds          = 3
[12/19/21 22:42:54] INFO	directory         = .
[12/19/21 22:42:54] INFO	extension         = csv
[12/19/21 22:42:54] INFO	drop              = ['PassengerId']
[12/19/21 22:42:54] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:42:54] INFO	esr               = 20
[12/19/21 22:42:54] INFO	factors           = ['Embarked']
[12/19/21 22:42:54] INFO	features [X]      = *
[12/19/21 22:42:54] INFO	feature_selection = False
[12/19/21 22:42:54] INFO	fs_percentage     = 50
[12/19/21 22:42:54] INFO	fs_score_func     = <function f_classif at 0x7fa68a1f1dc0>
[12/19/21 22:42:54] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:42:54] INFO	grid_search       = True
[12/19/21 22:42:54] INFO	gs_iters          = 50
[12/19/21 22:42:54] INFO	gs_random         = True
[12/19/21 22:42:54] INFO	gs_sample         = False
[12/19/21 22:42:54] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:42:54] INFO	importances       = True
[12/19/21 22:42:54] INFO	interactions      = False
[12/19/21 22:42:54] INFO	isomap            = False
[12/19/21 22:42:54] INFO	iso_components    = 2
[12/19/21 22:42:54] INFO	iso_neighbors     = 5
[12/19/21 22:42:54] INFO	isample_pct       = 10
[12/19/21 22:42:54] INFO	leaders           = []
[12/19/21 22:42:54] INFO	learning_curve    = True
[12/19/21 22:42:54] INFO	logtransform      = False
[12/19/21 22:42:54] INFO	lv_remove         = True
[12/19/21 22:42:54] INFO	lv_threshold      = 0.100000
[12/19/21 22:42:54] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:42:54] INFO	n_estimators      = 51
[12/19/21 22:42:54] INFO	n_jobs            = -1
[12/19/21 22:42:54] INFO	ngrams_max        = 2
[12/19/21 22:42:54] INFO	numpy             = True
[12/19/21 22:42:54] INFO	pca               = False
[12/19/21 22:42:54] INFO	pca_inc           = 1
[12/19/21 22:42:54] INFO	pca_max           = 10
[12/19/21 22:42:54] INFO	pca_min           = 2
[12/19/21 22:42:54] INFO	pca_whiten        = False
[12/19/21 22:42:54] INFO	poly_degree       = 2
[12/19/21 22:42:54] INFO	pvalue_level      = 0.010000
[12/19/21 22:42:54] INFO	rfe               = True
[12/19/21 22:42:54] INFO	rfe_step          = 3
[12/19/21 22:42:54] INFO	roc_curve         = True
[12/19/21 22:42:54] INFO	rounding          = 2
[12/19/21 22:42:54] INFO	sampling          = True
[12/19/21 22:42:54] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:42:54] INFO	sampling_ratio    = 1.000000
[12/19/21 22:42:54] INFO	scaler_option     = True
[12/19/21 22:42:54] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:42:54] INFO	scipy             = False
[12/19/21 22:42:54] INFO	scorer            = roc_auc
[12/19/21 22:42:54] INFO	seed              = 42
[12/19/21 22:42:54] INFO	sentinel          = -1
[12/19/21 22:42:54] INFO	separator         = ,
[12/19/21 22:42:54] INFO	shuffle           = False
[12/19/21 22:42:54] INFO	split             = 0.400000
[12/19/21 22:42:54] INFO	submission_file   = gender_submission
[12/19/21 22:42:54] INFO	submit_probas     = False
[12/19/21 22:42:54] INFO	target [y]        = Survived
[12/19/21 22:42:54] INFO	target_value      = 1
[12/19/21 22:42:54] INFO	transforms        = None
[12/19/21 22:42:54] INFO	tsne              = False
[12/19/21 22:42:54] INFO	tsne_components   = 2
[12/19/21 22:42:54] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:42:54] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:42:54] INFO	vectorize         = False
[12/19/21 22:42:54] INFO	verbosity         = 0
[12/19/21 22:42:54] INFO	Creating Model
[12/19/21 22:42:54] INFO	Calling Pipeline
[12/19/21 22:42:54] INFO	Training Pipeline
[12/19/21 22:42:54] INFO	Loading Data
[12/19/21 22:42:54] INFO	Loading data from ./input/train.csv
[12/19/21 22:42:54] INFO	Found target Survived in data frame
[12/19/21 22:42:54] INFO	Labels (y) found for Partition.train
[12/19/21 22:42:54] INFO	Loading Data
[12/19/21 22:42:54] INFO	Loading data from ./input/test.csv
[12/19/21 22:42:54] INFO	Target Survived not found in Partition.test
[12/19/21 22:42:54] INFO	Saving New Features in Model
[12/19/21 22:42:54] INFO	Original Feature Statistics
[12/19/21 22:42:54] INFO	Number of Training Rows    : 891
[12/19/21 22:42:54] INFO	Number of Training Columns : 11
[12/19/21 22:42:54] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:42:54] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:42:54] INFO	Number of Testing Rows     : 418
[12/19/21 22:42:54] INFO	Number of Testing Columns  : 11
[12/19/21 22:42:54] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:42:54] INFO	Feature Count     : 11
[12/19/21 22:42:54] INFO	Applying transforms
[12/19/21 22:42:54] INFO	No transforms Specified
[12/19/21 22:42:54] INFO	New Feature Count : 11
[12/19/21 22:42:54] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:42:54] INFO	Original Feature Count : 11
[12/19/21 22:42:54] INFO	Reduced Feature Count  : 10
[12/19/21 22:42:54] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:42:54] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:42:54] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:42:54] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:42:54] INFO	Creating Cross-Tabulations
[12/19/21 22:42:54] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:42:54] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:42:54] INFO	Feature Count     : 10
[12/19/21 22:42:54] INFO	Creating Count Features
[12/19/21 22:42:54] INFO	NA Counts
[12/19/21 22:42:54] INFO	Number Counts
[12/19/21 22:42:54] INFO	New Feature Count : 21
[12/19/21 22:42:54] INFO	Creating Base Features
[12/19/21 22:42:54] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:42:54] INFO	Feature 2: Name => Factorization
[12/19/21 22:42:54] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:42:54] INFO	Feature 3: Sex => Factorization
[12/19/21 22:42:54] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:42:54] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:42:54] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:42:54] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:42:54] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:42:54] INFO	Encoding: Encoders.target
[12/19/21 22:42:54] INFO	Fitting training features for Embarked
[12/19/21 22:42:54] INFO	Transforming testing features for Embarked
[12/19/21 22:42:54] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:42:54] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:42:54] INFO	New Feature Count : 21
[12/19/21 22:42:54] INFO	Scaling Base Features
[12/19/21 22:42:54] INFO	Creating NumPy Features
[12/19/21 22:42:54] INFO	NumPy Feature: sum
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	NumPy Feature: mean
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	NumPy Feature: std
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	NumPy Feature: var
[12/19/21 22:42:54] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:42:54] INFO	NumPy Feature Count : 4
[12/19/21 22:42:54] INFO	New Feature Count : 25
[12/19/21 22:42:54] INFO	Creating Clustering Features
[12/19/21 22:42:54] INFO	Cluster Minimum   : 3
[12/19/21 22:42:54] INFO	Cluster Maximum   : 30
[12/19/21 22:42:54] INFO	Cluster Increment : 3
[12/19/21 22:42:54] INFO	k = 3
[12/19/21 22:42:56] INFO	k = 6
[12/19/21 22:42:56] INFO	k = 9
[12/19/21 22:42:56] INFO	k = 12
[12/19/21 22:42:56] INFO	k = 15
[12/19/21 22:42:56] INFO	k = 18
[12/19/21 22:42:56] INFO	k = 21
[12/19/21 22:42:56] INFO	k = 24
[12/19/21 22:42:56] INFO	k = 27
[12/19/21 22:42:56] INFO	k = 30
[12/19/21 22:42:56] INFO	Clustering Feature Count : 10
[12/19/21 22:42:56] INFO	New Feature Count : 35
[12/19/21 22:42:56] INFO	Saving New Features in Model
[12/19/21 22:42:56] INFO	Creating Interactions
[12/19/21 22:42:56] INFO	Initial Feature Count  : 35
[12/19/21 22:42:56] INFO	Skipping Interactions
[12/19/21 22:42:56] INFO	Saving New Features in Model
[12/19/21 22:42:56] INFO	Removing Low-Variance Features
[12/19/21 22:42:56] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:42:56] INFO	Original Feature Count  : 35
[12/19/21 22:42:56] INFO	Reduced Feature Count   : 35
[12/19/21 22:42:56] INFO	Saving New Features in Model
[12/19/21 22:42:56] INFO	Skipping Shuffling
[12/19/21 22:42:56] INFO	Sampling Data
[12/19/21 22:42:56] INFO	Sampling Ratio for target Survived [1]: 1.000000
[12/19/21 22:42:56] INFO	Original Samples : 891
[12/19/21 22:42:56] INFO	New Samples      : 684
[12/19/21 22:42:56] INFO	Getting All Estimators
[12/19/21 22:42:56] INFO	Algorithm Configuration
[12/19/21 22:42:57] INFO	Selecting Models
[12/19/21 22:42:57] INFO	Algorithm: CATB
[12/19/21 22:42:57] INFO	Fitting Initial Model
[12/19/21 22:42:57] INFO	Cross-Validation
[12/19/21 22:42:58] INFO	Cross-Validation Scores: [0.57825485 0.75865651 0.64439058]
[12/19/21 22:42:58] INFO	Recursive Feature Elimination with CV
[12/19/21 22:43:01] INFO	RFECV took 2.44 seconds for step 3 and 3 folds
[12/19/21 22:43:01] INFO	Algorithm: CATB, Selected Features: 1, Ranking: [ 2  5  1  3  9 11  5  3  7  6  4 11  5 12  8 12 12 13 13 13 10  4  7  6
  3  9  8 10  6  8 11  7  9 10  4]
[12/19/21 22:43:01] INFO	No grid is defined for grid search
[12/19/21 22:43:01] INFO	Final Model Predictions for CATB
[12/19/21 22:43:01] INFO	Skipping Calibration
[12/19/21 22:43:01] INFO	Making Predictions
[12/19/21 22:43:01] INFO	Predictions Complete
[12/19/21 22:43:01] INFO	Algorithm: LGB
[12/19/21 22:43:01] INFO	Fitting Initial Model
[12/19/21 22:43:01] INFO	Cross-Validation
[12/19/21 22:43:01] INFO	Cross-Validation Scores: [0.51100339 0.75761773 0.41859034]
[12/19/21 22:43:01] INFO	Recursive Feature Elimination with CV
[12/19/21 22:43:02] INFO	RFECV took 1.19 seconds for step 3 and 3 folds
[12/19/21 22:43:02] INFO	Algorithm: LGB, Selected Features: 29, Ranking: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 3 1 1 3 1 1 1 1 1 1 1 1 1 1 1 1]
[12/19/21 22:43:02] INFO	No grid is defined for grid search
[12/19/21 22:43:02] INFO	Final Model Predictions for LGB
[12/19/21 22:43:02] INFO	Skipping Calibration
[12/19/21 22:43:02] INFO	Making Predictions
[12/19/21 22:43:02] INFO	Predictions Complete
[12/19/21 22:43:02] INFO	Algorithm: XGB
[12/19/21 22:43:02] INFO	Fitting Initial Model
[12/19/21 22:43:03] INFO	Cross-Validation
[12/19/21 22:43:03] INFO	Cross-Validation Scores: [0.45998769 0.81051862 0.3180594 ]
[12/19/21 22:43:03] INFO	Recursive Feature Elimination with CV
[12/19/21 22:43:06] INFO	RFECV took 2.35 seconds for step 3 and 3 folds
[12/19/21 22:43:06] INFO	Algorithm: XGB, Selected Features: 1, Ranking: [ 2  7  1  6  3 10  5  4  3  7  3  9  6  5 11 12 12 13 12 13 13  6 10  4
 11  8 10  7  9  9  8  8  4 11  5]
[12/19/21 22:43:06] INFO	Randomized Grid Search
[12/19/21 22:43:25] INFO	Grid Search took 19.34 seconds for 50 candidate parameter settings.
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:43:25] INFO	Model with rank: 1
[12/19/21 22:43:25] INFO	Mean validation score: 0.765 (std: 0.017)
[12/19/21 22:43:25] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:43:25] INFO	Algorithm: XGB, Best Score: 0.7646, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:43:25] INFO	Final Model Predictions for XGB
[12/19/21 22:43:25] INFO	Skipping Calibration
[12/19/21 22:43:25] INFO	Making Predictions
[12/19/21 22:43:25] INFO	Predictions Complete
[12/19/21 22:43:25] INFO	Blending Models
[12/19/21 22:43:25] INFO	Blending Start: 2021-12-19 22:43:25.456319
[12/19/21 22:43:25] INFO	Blending Complete: 0:00:00.004158
[12/19/21 22:43:25] INFO	================================================================================
[12/19/21 22:43:25] INFO	Metrics for: Partition.train
[12/19/21 22:43:25] INFO	--------------------------------------------------------------------------------
[12/19/21 22:43:25] INFO	Algorithm: CATB
[12/19/21 22:43:25] INFO	accuracy: 0.7646198830409356
[12/19/21 22:43:25] INFO	average_precision: 0.716338360521186
[12/19/21 22:43:25] INFO	balanced_accuracy: 0.7646198830409356
[12/19/21 22:43:25] INFO	brier_score_loss: 0.1779757105739093
[12/19/21 22:43:25] INFO	cohen_kappa: 0.5292397660818713
[12/19/21 22:43:25] INFO	confusion_matrix: [[290  52]
 [109 233]]
[12/19/21 22:43:25] INFO	f1: 0.7432216905901117
[12/19/21 22:43:25] INFO	neg_log_loss: 0.5400236094645483
[12/19/21 22:43:25] INFO	precision: 0.8175438596491228
[12/19/21 22:43:25] INFO	recall: 0.6812865497076024
[12/19/21 22:43:25] INFO	roc_auc: 0.7646198830409358
[12/19/21 22:43:25] INFO	--------------------------------------------------------------------------------
[12/19/21 22:43:25] INFO	Algorithm: LGB
[12/19/21 22:43:25] INFO	accuracy: 0.9678362573099415
[12/19/21 22:43:25] INFO	average_precision: 0.9972385611555241
[12/19/21 22:43:25] INFO	balanced_accuracy: 0.9678362573099415
[12/19/21 22:43:25] INFO	brier_score_loss: 0.03511561156028543
[12/19/21 22:43:25] INFO	cohen_kappa: 0.935672514619883
[12/19/21 22:43:25] INFO	confusion_matrix: [[335   7]
 [ 15 327]]
[12/19/21 22:43:25] INFO	f1: 0.9674556213017752
[12/19/21 22:43:25] INFO	neg_log_loss: 0.15349913927809292
[12/19/21 22:43:25] INFO	precision: 0.9790419161676647
[12/19/21 22:43:25] INFO	recall: 0.956140350877193
[12/19/21 22:43:25] INFO	roc_auc: 0.9970674737526076
[12/19/21 22:43:25] INFO	--------------------------------------------------------------------------------
[12/19/21 22:43:25] INFO	Algorithm: XGB
[12/19/21 22:43:25] INFO	accuracy: 0.7646198830409356
[12/19/21 22:43:25] INFO	average_precision: 0.716338360521186
[12/19/21 22:43:25] INFO	balanced_accuracy: 0.7646198830409356
[12/19/21 22:43:25] INFO	brier_score_loss: 0.18783794787127472
[12/19/21 22:43:25] INFO	cohen_kappa: 0.5292397660818713
[12/19/21 22:43:25] INFO	confusion_matrix: [[290  52]
 [109 233]]
[12/19/21 22:43:25] INFO	f1: 0.7432216905901117
[12/19/21 22:43:25] INFO	neg_log_loss: 0.5644197047018168
[12/19/21 22:43:25] INFO	precision: 0.8175438596491228
[12/19/21 22:43:25] INFO	recall: 0.6812865497076024
[12/19/21 22:43:25] INFO	roc_auc: 0.7646198830409358
[12/19/21 22:43:25] INFO	================================================================================
[12/19/21 22:43:25] INFO	Metrics for: Partition.test
[12/19/21 22:43:25] INFO	No labels for generating Partition.test metrics
[12/19/21 22:43:25] INFO	================================================================================
[12/19/21 22:43:25] INFO	Selecting Best Model
[12/19/21 22:43:25] INFO	Scoring for: Partition.train
[12/19/21 22:43:25] INFO	Best Model Selection Start: 2021-12-19 22:43:25.480121
[12/19/21 22:43:25] INFO	Scoring CATB Model
[12/19/21 22:43:25] INFO	Scoring LGB Model
[12/19/21 22:43:25] INFO	Scoring XGB Model
[12/19/21 22:43:25] INFO	Scoring BLEND Model
[12/19/21 22:43:25] INFO	Best Model is BLEND with a roc_auc score of 0.9976
[12/19/21 22:43:25] INFO	Best Model Selection Complete: 0:00:00.000270
[12/19/21 22:43:25] INFO	================================================================================
[12/19/21 22:43:25] INFO	Generating Plots for partition: train
[12/19/21 22:43:25] INFO	Generating Calibration Plot
[12/19/21 22:43:25] INFO	Calibration for Algorithm: CATB
[12/19/21 22:43:25] INFO	Calibration for Algorithm: LGB
[12/19/21 22:43:25] INFO	Calibration for Algorithm: XGB
[12/19/21 22:43:25] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:43:25] INFO	Generating Confusion Matrices
[12/19/21 22:43:25] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:43:25] INFO	Confusion Matrix:
[12/19/21 22:43:25] INFO	[[290  52]
 [109 233]]
[12/19/21 22:43:25] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:43:25] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:43:25] INFO	Confusion Matrix:
[12/19/21 22:43:25] INFO	[[335   7]
 [ 15 327]]
[12/19/21 22:43:25] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:43:25] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:43:25] INFO	Confusion Matrix:
[12/19/21 22:43:25] INFO	[[290  52]
 [109 233]]
[12/19/21 22:43:25] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:43:25] INFO	Generating ROC Curves
[12/19/21 22:43:25] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:43:25] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:43:25] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:43:25] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:43:26] INFO	Generating Learning Curves
[12/19/21 22:43:26] INFO	Algorithm Configuration
[12/19/21 22:43:26] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:43:26] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:43:26] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:43:27] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:43:28] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:43:28] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:43:28] INFO	Generating Feature Importance Plots
[12/19/21 22:43:28] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:43:28] INFO	Feature Ranking:
[12/19/21 22:43:28] INFO	1. Sex_factor (100.000000)
[12/19/21 22:43:28] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:43:28] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:43:28] INFO	Feature Ranking:
[12/19/21 22:43:28] INFO	1. Age (181.000000)
[12/19/21 22:43:28] INFO	2. Fare (178.000000)
[12/19/21 22:43:28] INFO	3. sum (162.000000)
[12/19/21 22:43:28] INFO	4. Name_factor (153.000000)
[12/19/21 22:43:28] INFO	5. std (134.000000)
[12/19/21 22:43:28] INFO	6. Ticket_factor (105.000000)
[12/19/21 22:43:28] INFO	7. Sex_factor (41.000000)
[12/19/21 22:43:28] INFO	8. Pclass (39.000000)
[12/19/21 22:43:28] INFO	9. cluster_30 (33.000000)
[12/19/21 22:43:28] INFO	10. var (27.000000)
[12/19/21 22:43:28] INFO	11. cluster_15 (22.000000)
[12/19/21 22:43:28] INFO	12. cluster_24 (20.000000)
[12/19/21 22:43:28] INFO	13. cluster_27 (20.000000)
[12/19/21 22:43:28] INFO	14. Cabin_factor (19.000000)
[12/19/21 22:43:28] INFO	15. Embarked (15.000000)
[12/19/21 22:43:28] INFO	16. cluster_12 (15.000000)
[12/19/21 22:43:28] INFO	17. cluster_18 (13.000000)
[12/19/21 22:43:28] INFO	18. count_1 (13.000000)
[12/19/21 22:43:28] INFO	19. cluster_21 (10.000000)
[12/19/21 22:43:28] INFO	20. cluster_9 (10.000000)
[12/19/21 22:43:28] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:43:28] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:43:28] INFO	Feature Ranking:
[12/19/21 22:43:28] INFO	1. Sex_factor (1.000000)
[12/19/21 22:43:28] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:43:28] INFO	================================================================================
[12/19/21 22:43:28] INFO	Saving Model Predictor
[12/19/21 22:43:28] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:43:28] INFO	Saving Feature Map
[12/19/21 22:43:28] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:43:28] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:43:28] INFO	Saving Predictions
[12/19/21 22:43:28] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:43:28] INFO	Saving Probabilities
[12/19/21 22:43:28] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:43:28] INFO	Saving Ranked Predictions
[12/19/21 22:43:28] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:43:28] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:43:28] INFO	********************************************************************************
[12/19/21 22:43:28] INFO	AlphaPy End
[12/19/21 22:43:28] INFO	********************************************************************************
[12/19/21 22:45:22] INFO	********************************************************************************
[12/19/21 22:45:22] INFO	AlphaPy Start
[12/19/21 22:45:22] INFO	********************************************************************************
[12/19/21 22:45:22] INFO	Model Configuration
[12/19/21 22:45:22] INFO	No transforms Found
[12/19/21 22:45:22] INFO	MODEL PARAMETERS:
[12/19/21 22:45:22] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:45:22] INFO	calibration       = False
[12/19/21 22:45:22] INFO	cal_type          = sigmoid
[12/19/21 22:45:22] INFO	calibration_plot  = False
[12/19/21 22:45:22] INFO	clustering        = True
[12/19/21 22:45:22] INFO	cluster_inc       = 3
[12/19/21 22:45:22] INFO	cluster_max       = 30
[12/19/21 22:45:22] INFO	cluster_min       = 3
[12/19/21 22:45:22] INFO	confusion_matrix  = True
[12/19/21 22:45:22] INFO	counts            = True
[12/19/21 22:45:22] INFO	cv_folds          = 3
[12/19/21 22:45:22] INFO	directory         = .
[12/19/21 22:45:22] INFO	extension         = csv
[12/19/21 22:45:22] INFO	drop              = ['PassengerId']
[12/19/21 22:45:22] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:45:22] INFO	esr               = 20
[12/19/21 22:45:22] INFO	factors           = ['Embarked']
[12/19/21 22:45:22] INFO	features [X]      = *
[12/19/21 22:45:22] INFO	feature_selection = False
[12/19/21 22:45:22] INFO	fs_percentage     = 50
[12/19/21 22:45:22] INFO	fs_score_func     = <function f_classif at 0x7fbfb0c91dc0>
[12/19/21 22:45:22] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:45:22] INFO	grid_search       = True
[12/19/21 22:45:22] INFO	gs_iters          = 50
[12/19/21 22:45:22] INFO	gs_random         = True
[12/19/21 22:45:22] INFO	gs_sample         = False
[12/19/21 22:45:22] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:45:22] INFO	importances       = True
[12/19/21 22:45:22] INFO	interactions      = False
[12/19/21 22:45:22] INFO	isomap            = False
[12/19/21 22:45:22] INFO	iso_components    = 2
[12/19/21 22:45:22] INFO	iso_neighbors     = 5
[12/19/21 22:45:22] INFO	isample_pct       = 10
[12/19/21 22:45:22] INFO	leaders           = []
[12/19/21 22:45:22] INFO	learning_curve    = True
[12/19/21 22:45:22] INFO	logtransform      = False
[12/19/21 22:45:22] INFO	lv_remove         = True
[12/19/21 22:45:22] INFO	lv_threshold      = 0.100000
[12/19/21 22:45:22] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:45:22] INFO	n_estimators      = 51
[12/19/21 22:45:22] INFO	n_jobs            = -1
[12/19/21 22:45:22] INFO	ngrams_max        = 2
[12/19/21 22:45:22] INFO	numpy             = True
[12/19/21 22:45:22] INFO	pca               = False
[12/19/21 22:45:22] INFO	pca_inc           = 1
[12/19/21 22:45:22] INFO	pca_max           = 10
[12/19/21 22:45:22] INFO	pca_min           = 2
[12/19/21 22:45:22] INFO	pca_whiten        = False
[12/19/21 22:45:22] INFO	poly_degree       = 2
[12/19/21 22:45:22] INFO	pvalue_level      = 0.010000
[12/19/21 22:45:22] INFO	rfe               = True
[12/19/21 22:45:22] INFO	rfe_step          = 3
[12/19/21 22:45:22] INFO	roc_curve         = True
[12/19/21 22:45:22] INFO	rounding          = 2
[12/19/21 22:45:22] INFO	sampling          = True
[12/19/21 22:45:22] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:45:22] INFO	sampling_ratio    = 1.000000
[12/19/21 22:45:22] INFO	scaler_option     = True
[12/19/21 22:45:22] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:45:22] INFO	scipy             = False
[12/19/21 22:45:22] INFO	scorer            = roc_auc
[12/19/21 22:45:22] INFO	seed              = 42
[12/19/21 22:45:22] INFO	sentinel          = -1
[12/19/21 22:45:22] INFO	separator         = ,
[12/19/21 22:45:22] INFO	shuffle           = False
[12/19/21 22:45:22] INFO	split             = 0.400000
[12/19/21 22:45:22] INFO	submission_file   = gender_submission
[12/19/21 22:45:22] INFO	submit_probas     = False
[12/19/21 22:45:22] INFO	target [y]        = Survived
[12/19/21 22:45:22] INFO	target_value      = 1
[12/19/21 22:45:22] INFO	transforms        = None
[12/19/21 22:45:22] INFO	tsne              = False
[12/19/21 22:45:22] INFO	tsne_components   = 2
[12/19/21 22:45:22] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:45:22] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:45:22] INFO	vectorize         = False
[12/19/21 22:45:22] INFO	verbosity         = 0
[12/19/21 22:45:22] INFO	Creating Model
[12/19/21 22:45:22] INFO	Calling Pipeline
[12/19/21 22:45:22] INFO	Training Pipeline
[12/19/21 22:45:22] INFO	Loading Data
[12/19/21 22:45:22] INFO	Loading data from ./input/train.csv
[12/19/21 22:45:22] INFO	Found target Survived in data frame
[12/19/21 22:45:22] INFO	Labels (y) found for Partition.train
[12/19/21 22:45:22] INFO	Loading Data
[12/19/21 22:45:22] INFO	Loading data from ./input/test.csv
[12/19/21 22:45:22] INFO	Target Survived not found in Partition.test
[12/19/21 22:45:22] INFO	Saving New Features in Model
[12/19/21 22:45:22] INFO	Original Feature Statistics
[12/19/21 22:45:22] INFO	Number of Training Rows    : 891
[12/19/21 22:45:22] INFO	Number of Training Columns : 11
[12/19/21 22:45:22] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:45:22] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:45:22] INFO	Number of Testing Rows     : 418
[12/19/21 22:45:22] INFO	Number of Testing Columns  : 11
[12/19/21 22:45:22] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:45:22] INFO	Feature Count     : 11
[12/19/21 22:45:22] INFO	Applying transforms
[12/19/21 22:45:22] INFO	No transforms Specified
[12/19/21 22:45:22] INFO	New Feature Count : 11
[12/19/21 22:45:22] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:45:22] INFO	Original Feature Count : 11
[12/19/21 22:45:22] INFO	Reduced Feature Count  : 10
[12/19/21 22:45:22] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:45:22] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:45:22] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:45:22] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:45:22] INFO	Creating Cross-Tabulations
[12/19/21 22:45:22] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:45:22] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:45:22] INFO	Feature Count     : 10
[12/19/21 22:45:22] INFO	Creating Count Features
[12/19/21 22:45:22] INFO	NA Counts
[12/19/21 22:45:22] INFO	Number Counts
[12/19/21 22:45:22] INFO	New Feature Count : 21
[12/19/21 22:45:22] INFO	Creating Base Features
[12/19/21 22:45:22] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:45:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:22] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:45:22] INFO	Feature 2: Name => Factorization
[12/19/21 22:45:22] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:45:22] INFO	Feature 3: Sex => Factorization
[12/19/21 22:45:22] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:45:22] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:22] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:45:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:22] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:45:22] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:22] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:45:23] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:45:23] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:23] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:45:23] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:45:23] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:45:23] INFO	Encoding: Encoders.target
[12/19/21 22:45:23] INFO	Fitting training features for Embarked
[12/19/21 22:45:23] INFO	Transforming testing features for Embarked
[12/19/21 22:45:23] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:45:23] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:45:23] INFO	New Feature Count : 21
[12/19/21 22:45:23] INFO	Scaling Base Features
[12/19/21 22:45:23] INFO	Creating NumPy Features
[12/19/21 22:45:23] INFO	NumPy Feature: sum
[12/19/21 22:45:23] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:23] INFO	NumPy Feature: mean
[12/19/21 22:45:23] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:23] INFO	NumPy Feature: std
[12/19/21 22:45:23] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:23] INFO	NumPy Feature: var
[12/19/21 22:45:23] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:45:23] INFO	NumPy Feature Count : 4
[12/19/21 22:45:23] INFO	New Feature Count : 25
[12/19/21 22:45:23] INFO	Creating Clustering Features
[12/19/21 22:45:23] INFO	Cluster Minimum   : 3
[12/19/21 22:45:23] INFO	Cluster Maximum   : 30
[12/19/21 22:45:23] INFO	Cluster Increment : 3
[12/19/21 22:45:23] INFO	k = 3
[12/19/21 22:45:24] INFO	k = 6
[12/19/21 22:45:24] INFO	k = 9
[12/19/21 22:45:24] INFO	k = 12
[12/19/21 22:45:24] INFO	k = 15
[12/19/21 22:45:24] INFO	k = 18
[12/19/21 22:45:24] INFO	k = 21
[12/19/21 22:45:24] INFO	k = 24
[12/19/21 22:45:24] INFO	k = 27
[12/19/21 22:45:24] INFO	k = 30
[12/19/21 22:45:24] INFO	Clustering Feature Count : 10
[12/19/21 22:45:24] INFO	New Feature Count : 35
[12/19/21 22:45:24] INFO	Saving New Features in Model
[12/19/21 22:45:24] INFO	Creating Interactions
[12/19/21 22:45:24] INFO	Initial Feature Count  : 35
[12/19/21 22:45:24] INFO	Skipping Interactions
[12/19/21 22:45:24] INFO	Saving New Features in Model
[12/19/21 22:45:24] INFO	Removing Low-Variance Features
[12/19/21 22:45:24] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:45:24] INFO	Original Feature Count  : 35
[12/19/21 22:45:24] INFO	Reduced Feature Count   : 35
[12/19/21 22:45:24] INFO	Saving New Features in Model
[12/19/21 22:45:24] INFO	Skipping Shuffling
[12/19/21 22:45:24] INFO	Sampling Data
[12/19/21 22:45:24] INFO	Sampling Ratio for target Survived [1]: 1.000000
[12/19/21 22:45:24] INFO	Original Samples : 891
[12/19/21 22:45:24] INFO	New Samples      : 684
[12/19/21 22:45:24] INFO	Getting All Estimators
[12/19/21 22:45:24] INFO	Algorithm Configuration
[12/19/21 22:45:25] INFO	Selecting Models
[12/19/21 22:45:25] INFO	Algorithm: CATB
[12/19/21 22:45:25] INFO	Fitting Initial Model
[12/19/21 22:45:25] INFO	Cross-Validation
[12/19/21 22:45:26] INFO	Cross-Validation Scores: [0.56621268 0.76623576 0.62072946]
[12/19/21 22:45:26] INFO	Recursive Feature Elimination with CV
[12/19/21 22:45:29] INFO	RFECV took 2.46 seconds for step 3 and 3 folds
[12/19/21 22:45:29] INFO	Algorithm: CATB, Selected Features: 1, Ranking: [ 2  5  1  3 10 11  5  3  7  7  6  7  4  8 11 12 13 13 13 12 12  6  6  4
  4  9  8 10  8  5  9 11  9 10  3]
[12/19/21 22:45:29] INFO	No grid is defined for grid search
[12/19/21 22:45:29] INFO	Final Model Predictions for CATB
[12/19/21 22:45:29] INFO	Skipping Calibration
[12/19/21 22:45:29] INFO	Making Predictions
[12/19/21 22:45:29] INFO	Predictions Complete
[12/19/21 22:45:29] INFO	Algorithm: LGB
[12/19/21 22:45:29] INFO	Fitting Initial Model
[12/19/21 22:45:29] INFO	Cross-Validation
[12/19/21 22:45:30] INFO	Cross-Validation Scores: [0.48888119 0.7286088  0.44398276]
[12/19/21 22:45:30] INFO	Recursive Feature Elimination with CV
[12/19/21 22:45:32] INFO	RFECV took 2.03 seconds for step 3 and 3 folds
[12/19/21 22:45:32] INFO	Algorithm: LGB, Selected Features: 26, Ranking: [1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 3 3 4 3 4 2 1 4 1 1 2 1 1 1 1 1 1 1 1 1]
[12/19/21 22:45:32] INFO	No grid is defined for grid search
[12/19/21 22:45:32] INFO	Final Model Predictions for LGB
[12/19/21 22:45:32] INFO	Skipping Calibration
[12/19/21 22:45:32] INFO	Making Predictions
[12/19/21 22:45:32] INFO	Predictions Complete
[12/19/21 22:45:32] INFO	Algorithm: XGB
[12/19/21 22:45:32] INFO	Fitting Initial Model
[12/19/21 22:45:32] INFO	Cross-Validation
[12/19/21 22:45:32] INFO	Cross-Validation Scores: [0.45363958 0.80182364 0.32725454]
[12/19/21 22:45:32] INFO	Recursive Feature Elimination with CV
[12/19/21 22:45:35] INFO	RFECV took 2.40 seconds for step 3 and 3 folds
[12/19/21 22:45:35] INFO	Algorithm: XGB, Selected Features: 1, Ranking: [ 2  6  1  3  4  9  7  4  3  3  8 10 10  7 11 12 10 13 11 11 12  4 13  5
  8 12 13  8  9  9  7  5  6  6  5]
[12/19/21 22:45:35] INFO	Randomized Grid Search
[12/19/21 22:45:49] INFO	Grid Search took 14.62 seconds for 50 candidate parameter settings.
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.6}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:45:49] INFO	Model with rank: 1
[12/19/21 22:45:49] INFO	Mean validation score: 0.768 (std: 0.042)
[12/19/21 22:45:49] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:45:49] INFO	Algorithm: XGB, Best Score: 0.7675, Best Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:45:49] INFO	Final Model Predictions for XGB
[12/19/21 22:45:49] INFO	Skipping Calibration
[12/19/21 22:45:49] INFO	Making Predictions
[12/19/21 22:45:49] INFO	Predictions Complete
[12/19/21 22:45:49] INFO	Blending Models
[12/19/21 22:45:49] INFO	Blending Start: 2021-12-19 22:45:49.741242
[12/19/21 22:45:49] INFO	Blending Complete: 0:00:00.003692
[12/19/21 22:45:49] INFO	================================================================================
[12/19/21 22:45:49] INFO	Metrics for: Partition.train
[12/19/21 22:45:49] INFO	--------------------------------------------------------------------------------
[12/19/21 22:45:49] INFO	Algorithm: CATB
[12/19/21 22:45:49] INFO	accuracy: 0.7675438596491229
[12/19/21 22:45:49] INFO	average_precision: 0.7202746264955675
[12/19/21 22:45:49] INFO	balanced_accuracy: 0.7675438596491229
[12/19/21 22:45:49] INFO	brier_score_loss: 0.1762247055486667
[12/19/21 22:45:49] INFO	cohen_kappa: 0.5350877192982456
[12/19/21 22:45:49] INFO	confusion_matrix: [[292  50]
 [109 233]]
[12/19/21 22:45:49] INFO	f1: 0.7456
[12/19/21 22:45:49] INFO	neg_log_loss: 0.5359327805487487
[12/19/21 22:45:49] INFO	precision: 0.823321554770318
[12/19/21 22:45:49] INFO	recall: 0.6812865497076024
[12/19/21 22:45:49] INFO	roc_auc: 0.7675438596491229
[12/19/21 22:45:49] INFO	--------------------------------------------------------------------------------
[12/19/21 22:45:49] INFO	Algorithm: LGB
[12/19/21 22:45:49] INFO	accuracy: 0.9692982456140351
[12/19/21 22:45:49] INFO	average_precision: 0.9977656507017594
[12/19/21 22:45:49] INFO	balanced_accuracy: 0.9692982456140351
[12/19/21 22:45:49] INFO	brier_score_loss: 0.034762135184714285
[12/19/21 22:45:49] INFO	cohen_kappa: 0.9385964912280702
[12/19/21 22:45:49] INFO	confusion_matrix: [[334   8]
 [ 13 329]]
[12/19/21 22:45:49] INFO	f1: 0.9690721649484536
[12/19/21 22:45:49] INFO	neg_log_loss: 0.15437187500904134
[12/19/21 22:45:49] INFO	precision: 0.9762611275964391
[12/19/21 22:45:49] INFO	recall: 0.9619883040935673
[12/19/21 22:45:49] INFO	roc_auc: 0.9976659484969734
[12/19/21 22:45:49] INFO	--------------------------------------------------------------------------------
[12/19/21 22:45:49] INFO	Algorithm: XGB
[12/19/21 22:45:49] INFO	accuracy: 0.7675438596491229
[12/19/21 22:45:49] INFO	average_precision: 0.7202746264955675
[12/19/21 22:45:49] INFO	balanced_accuracy: 0.7675438596491229
[12/19/21 22:45:49] INFO	brier_score_loss: 0.17622463299989452
[12/19/21 22:45:49] INFO	cohen_kappa: 0.5350877192982456
[12/19/21 22:45:49] INFO	confusion_matrix: [[292  50]
 [109 233]]
[12/19/21 22:45:49] INFO	f1: 0.7456
[12/19/21 22:45:49] INFO	neg_log_loss: 0.5359325727001268
[12/19/21 22:45:49] INFO	precision: 0.823321554770318
[12/19/21 22:45:49] INFO	recall: 0.6812865497076024
[12/19/21 22:45:49] INFO	roc_auc: 0.7675438596491229
[12/19/21 22:45:49] INFO	================================================================================
[12/19/21 22:45:49] INFO	Metrics for: Partition.test
[12/19/21 22:45:49] INFO	No labels for generating Partition.test metrics
[12/19/21 22:45:49] INFO	================================================================================
[12/19/21 22:45:49] INFO	Selecting Best Model
[12/19/21 22:45:49] INFO	Scoring for: Partition.train
[12/19/21 22:45:49] INFO	Best Model Selection Start: 2021-12-19 22:45:49.764174
[12/19/21 22:45:49] INFO	Scoring CATB Model
[12/19/21 22:45:49] INFO	Scoring LGB Model
[12/19/21 22:45:49] INFO	Scoring XGB Model
[12/19/21 22:45:49] INFO	Scoring BLEND Model
[12/19/21 22:45:49] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[12/19/21 22:45:49] INFO	Best Model Selection Complete: 0:00:00.000195
[12/19/21 22:45:49] INFO	================================================================================
[12/19/21 22:45:49] INFO	Generating Plots for partition: train
[12/19/21 22:45:49] INFO	Generating Calibration Plot
[12/19/21 22:45:49] INFO	Calibration for Algorithm: CATB
[12/19/21 22:45:49] INFO	Calibration for Algorithm: LGB
[12/19/21 22:45:49] INFO	Calibration for Algorithm: XGB
[12/19/21 22:45:49] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:45:49] INFO	Generating Confusion Matrices
[12/19/21 22:45:49] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:45:49] INFO	Confusion Matrix:
[12/19/21 22:45:49] INFO	[[292  50]
 [109 233]]
[12/19/21 22:45:49] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:45:50] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:45:50] INFO	Confusion Matrix:
[12/19/21 22:45:50] INFO	[[334   8]
 [ 13 329]]
[12/19/21 22:45:50] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:45:50] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:45:50] INFO	Confusion Matrix:
[12/19/21 22:45:50] INFO	[[292  50]
 [109 233]]
[12/19/21 22:45:50] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:45:50] INFO	Generating ROC Curves
[12/19/21 22:45:50] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:45:50] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:45:50] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:45:50] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:45:50] INFO	Generating Learning Curves
[12/19/21 22:45:50] INFO	Algorithm Configuration
[12/19/21 22:45:50] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:45:50] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:45:50] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:45:52] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:45:52] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:45:52] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:45:52] INFO	Generating Feature Importance Plots
[12/19/21 22:45:52] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:45:52] INFO	Feature Ranking:
[12/19/21 22:45:52] INFO	1. Sex_factor (100.000000)
[12/19/21 22:45:52] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:45:52] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:45:52] INFO	Feature Ranking:
[12/19/21 22:45:52] INFO	1. Fare (173.000000)
[12/19/21 22:45:52] INFO	2. std (163.000000)
[12/19/21 22:45:52] INFO	3. Name_factor (159.000000)
[12/19/21 22:45:52] INFO	4. Age (159.000000)
[12/19/21 22:45:52] INFO	5. sum (138.000000)
[12/19/21 22:45:52] INFO	6. Ticket_factor (134.000000)
[12/19/21 22:45:52] INFO	7. Sex_factor (39.000000)
[12/19/21 22:45:52] INFO	8. Pclass (38.000000)
[12/19/21 22:45:52] INFO	9. cluster_18 (38.000000)
[12/19/21 22:45:52] INFO	10. cluster_27 (38.000000)
[12/19/21 22:45:52] INFO	11. cluster_30 (35.000000)
[12/19/21 22:45:52] INFO	12. Cabin_factor (31.000000)
[12/19/21 22:45:52] INFO	13. count_2 (29.000000)
[12/19/21 22:45:52] INFO	14. var (28.000000)
[12/19/21 22:45:52] INFO	15. cluster_24 (25.000000)
[12/19/21 22:45:52] INFO	16. cluster_9 (20.000000)
[12/19/21 22:45:52] INFO	17. SibSp (19.000000)
[12/19/21 22:45:52] INFO	18. Embarked (17.000000)
[12/19/21 22:45:52] INFO	19. cluster_21 (15.000000)
[12/19/21 22:45:52] INFO	20. count_1 (14.000000)
[12/19/21 22:45:52] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:45:52] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:45:52] INFO	Feature Ranking:
[12/19/21 22:45:52] INFO	1. Sex_factor (1.000000)
[12/19/21 22:45:52] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:45:52] INFO	================================================================================
[12/19/21 22:45:52] INFO	Saving Model Predictor
[12/19/21 22:45:52] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:45:52] INFO	Saving Feature Map
[12/19/21 22:45:52] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:45:52] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:45:52] INFO	Saving Predictions
[12/19/21 22:45:52] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:45:52] INFO	Saving Probabilities
[12/19/21 22:45:52] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:45:52] INFO	Saving Ranked Predictions
[12/19/21 22:45:52] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:45:52] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:45:53] INFO	********************************************************************************
[12/19/21 22:45:53] INFO	AlphaPy End
[12/19/21 22:45:53] INFO	********************************************************************************
[12/19/21 22:49:29] INFO	********************************************************************************
[12/19/21 22:49:29] INFO	AlphaPy Start
[12/19/21 22:49:29] INFO	********************************************************************************
[12/19/21 22:49:29] INFO	Model Configuration
[12/19/21 22:49:29] INFO	No transforms Found
[12/19/21 22:49:29] INFO	MODEL PARAMETERS:
[12/19/21 22:49:29] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:49:29] INFO	calibration       = False
[12/19/21 22:49:29] INFO	cal_type          = sigmoid
[12/19/21 22:49:29] INFO	calibration_plot  = False
[12/19/21 22:49:29] INFO	clustering        = True
[12/19/21 22:49:29] INFO	cluster_inc       = 3
[12/19/21 22:49:29] INFO	cluster_max       = 30
[12/19/21 22:49:29] INFO	cluster_min       = 3
[12/19/21 22:49:29] INFO	confusion_matrix  = True
[12/19/21 22:49:29] INFO	counts            = True
[12/19/21 22:49:29] INFO	cv_folds          = 3
[12/19/21 22:49:29] INFO	directory         = .
[12/19/21 22:49:29] INFO	extension         = csv
[12/19/21 22:49:29] INFO	drop              = ['PassengerId']
[12/19/21 22:49:29] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:49:29] INFO	esr               = 20
[12/19/21 22:49:29] INFO	factors           = ['Embarked']
[12/19/21 22:49:29] INFO	features [X]      = *
[12/19/21 22:49:29] INFO	feature_selection = False
[12/19/21 22:49:29] INFO	fs_percentage     = 50
[12/19/21 22:49:29] INFO	fs_score_func     = <function f_classif at 0x7fcf92652e50>
[12/19/21 22:49:29] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:49:29] INFO	grid_search       = True
[12/19/21 22:49:29] INFO	gs_iters          = 50
[12/19/21 22:49:29] INFO	gs_random         = True
[12/19/21 22:49:29] INFO	gs_sample         = False
[12/19/21 22:49:29] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:49:29] INFO	importances       = True
[12/19/21 22:49:29] INFO	interactions      = False
[12/19/21 22:49:29] INFO	isomap            = False
[12/19/21 22:49:29] INFO	iso_components    = 2
[12/19/21 22:49:29] INFO	iso_neighbors     = 5
[12/19/21 22:49:29] INFO	isample_pct       = 10
[12/19/21 22:49:29] INFO	leaders           = []
[12/19/21 22:49:29] INFO	learning_curve    = True
[12/19/21 22:49:29] INFO	logtransform      = False
[12/19/21 22:49:29] INFO	lv_remove         = True
[12/19/21 22:49:29] INFO	lv_threshold      = 0.100000
[12/19/21 22:49:29] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:49:29] INFO	n_estimators      = 51
[12/19/21 22:49:29] INFO	n_jobs            = -1
[12/19/21 22:49:29] INFO	ngrams_max        = 2
[12/19/21 22:49:29] INFO	numpy             = True
[12/19/21 22:49:29] INFO	pca               = False
[12/19/21 22:49:29] INFO	pca_inc           = 1
[12/19/21 22:49:29] INFO	pca_max           = 10
[12/19/21 22:49:29] INFO	pca_min           = 2
[12/19/21 22:49:29] INFO	pca_whiten        = False
[12/19/21 22:49:29] INFO	poly_degree       = 2
[12/19/21 22:49:29] INFO	pvalue_level      = 0.010000
[12/19/21 22:49:29] INFO	rfe               = True
[12/19/21 22:49:29] INFO	rfe_step          = 3
[12/19/21 22:49:29] INFO	roc_curve         = True
[12/19/21 22:49:29] INFO	rounding          = 2
[12/19/21 22:49:29] INFO	sampling          = True
[12/19/21 22:49:29] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:49:29] INFO	sampling_ratio    = 1.000000
[12/19/21 22:49:29] INFO	scaler_option     = True
[12/19/21 22:49:29] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:49:29] INFO	scipy             = False
[12/19/21 22:49:29] INFO	scorer            = roc_auc
[12/19/21 22:49:29] INFO	seed              = 42
[12/19/21 22:49:29] INFO	sentinel          = -1
[12/19/21 22:49:29] INFO	separator         = ,
[12/19/21 22:49:29] INFO	shuffle           = False
[12/19/21 22:49:29] INFO	split             = 0.400000
[12/19/21 22:49:29] INFO	submission_file   = gender_submission
[12/19/21 22:49:29] INFO	submit_probas     = False
[12/19/21 22:49:29] INFO	target [y]        = Survived
[12/19/21 22:49:29] INFO	target_value      = 1
[12/19/21 22:49:29] INFO	transforms        = None
[12/19/21 22:49:29] INFO	tsne              = False
[12/19/21 22:49:29] INFO	tsne_components   = 2
[12/19/21 22:49:29] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:49:29] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:49:29] INFO	vectorize         = False
[12/19/21 22:49:29] INFO	verbosity         = 0
[12/19/21 22:49:29] INFO	Creating Model
[12/19/21 22:49:29] INFO	Calling Pipeline
[12/19/21 22:49:29] INFO	Training Pipeline
[12/19/21 22:49:29] INFO	Loading Data
[12/19/21 22:49:29] INFO	Loading data from ./input/train.csv
[12/19/21 22:49:29] INFO	Found target Survived in data frame
[12/19/21 22:49:29] INFO	Labels (y) found for Partition.train
[12/19/21 22:49:29] INFO	Loading Data
[12/19/21 22:49:29] INFO	Loading data from ./input/test.csv
[12/19/21 22:49:29] INFO	Target Survived not found in Partition.test
[12/19/21 22:49:29] INFO	Saving New Features in Model
[12/19/21 22:49:29] INFO	Original Feature Statistics
[12/19/21 22:49:29] INFO	Number of Training Rows    : 891
[12/19/21 22:49:29] INFO	Number of Training Columns : 11
[12/19/21 22:49:29] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:49:29] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:49:29] INFO	Number of Testing Rows     : 418
[12/19/21 22:49:29] INFO	Number of Testing Columns  : 11
[12/19/21 22:49:29] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:49:29] INFO	Feature Count     : 11
[12/19/21 22:49:29] INFO	Applying transforms
[12/19/21 22:49:29] INFO	No transforms Specified
[12/19/21 22:49:29] INFO	New Feature Count : 11
[12/19/21 22:49:29] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:49:29] INFO	Original Feature Count : 11
[12/19/21 22:49:29] INFO	Reduced Feature Count  : 10
[12/19/21 22:49:29] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:49:29] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:49:29] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:49:29] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:49:29] INFO	Creating Cross-Tabulations
[12/19/21 22:49:29] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:49:29] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:49:29] INFO	Feature Count     : 10
[12/19/21 22:49:29] INFO	Creating Count Features
[12/19/21 22:49:29] INFO	NA Counts
[12/19/21 22:49:29] INFO	Number Counts
[12/19/21 22:49:29] INFO	New Feature Count : 21
[12/19/21 22:49:29] INFO	Creating Base Features
[12/19/21 22:49:29] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:49:29] INFO	Feature 2: Name => Factorization
[12/19/21 22:49:29] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:49:29] INFO	Feature 3: Sex => Factorization
[12/19/21 22:49:29] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:49:29] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:49:29] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:49:29] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:49:29] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:49:29] INFO	Encoding: Encoders.target
[12/19/21 22:49:29] INFO	Fitting training features for Embarked
[12/19/21 22:49:29] INFO	Transforming testing features for Embarked
[12/19/21 22:49:29] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:49:29] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:49:29] INFO	New Feature Count : 21
[12/19/21 22:49:29] INFO	Scaling Base Features
[12/19/21 22:49:29] INFO	Creating NumPy Features
[12/19/21 22:49:29] INFO	NumPy Feature: sum
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	NumPy Feature: mean
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	NumPy Feature: std
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	NumPy Feature: var
[12/19/21 22:49:29] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:49:29] INFO	NumPy Feature Count : 4
[12/19/21 22:49:29] INFO	New Feature Count : 25
[12/19/21 22:49:29] INFO	Creating Clustering Features
[12/19/21 22:49:29] INFO	Cluster Minimum   : 3
[12/19/21 22:49:29] INFO	Cluster Maximum   : 30
[12/19/21 22:49:29] INFO	Cluster Increment : 3
[12/19/21 22:49:29] INFO	k = 3
[12/19/21 22:49:31] INFO	k = 6
[12/19/21 22:49:31] INFO	k = 9
[12/19/21 22:49:31] INFO	k = 12
[12/19/21 22:49:31] INFO	k = 15
[12/19/21 22:49:31] INFO	k = 18
[12/19/21 22:49:31] INFO	k = 21
[12/19/21 22:49:31] INFO	k = 24
[12/19/21 22:49:31] INFO	k = 27
[12/19/21 22:49:31] INFO	k = 30
[12/19/21 22:49:31] INFO	Clustering Feature Count : 10
[12/19/21 22:49:31] INFO	New Feature Count : 35
[12/19/21 22:49:31] INFO	Saving New Features in Model
[12/19/21 22:49:31] INFO	Creating Interactions
[12/19/21 22:49:31] INFO	Initial Feature Count  : 35
[12/19/21 22:49:31] INFO	Skipping Interactions
[12/19/21 22:49:31] INFO	Saving New Features in Model
[12/19/21 22:49:31] INFO	Removing Low-Variance Features
[12/19/21 22:49:31] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:49:31] INFO	Original Feature Count  : 35
[12/19/21 22:49:31] INFO	Reduced Feature Count   : 35
[12/19/21 22:49:31] INFO	Saving New Features in Model
[12/19/21 22:49:31] INFO	Skipping Shuffling
[12/19/21 22:49:31] INFO	Sampling Data
[12/19/21 22:49:31] INFO	Sampling Ratio for target Survived [1]: 0.62 => 1.00
[12/19/21 22:50:59] INFO	********************************************************************************
[12/19/21 22:50:59] INFO	AlphaPy Start
[12/19/21 22:50:59] INFO	********************************************************************************
[12/19/21 22:50:59] INFO	Model Configuration
[12/19/21 22:50:59] INFO	No transforms Found
[12/19/21 22:50:59] INFO	MODEL PARAMETERS:
[12/19/21 22:50:59] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:50:59] INFO	calibration       = False
[12/19/21 22:50:59] INFO	cal_type          = sigmoid
[12/19/21 22:50:59] INFO	calibration_plot  = False
[12/19/21 22:50:59] INFO	clustering        = True
[12/19/21 22:50:59] INFO	cluster_inc       = 3
[12/19/21 22:50:59] INFO	cluster_max       = 30
[12/19/21 22:50:59] INFO	cluster_min       = 3
[12/19/21 22:50:59] INFO	confusion_matrix  = True
[12/19/21 22:50:59] INFO	counts            = True
[12/19/21 22:50:59] INFO	cv_folds          = 3
[12/19/21 22:50:59] INFO	directory         = .
[12/19/21 22:50:59] INFO	extension         = csv
[12/19/21 22:50:59] INFO	drop              = ['PassengerId']
[12/19/21 22:50:59] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:50:59] INFO	esr               = 20
[12/19/21 22:50:59] INFO	factors           = ['Embarked']
[12/19/21 22:50:59] INFO	features [X]      = *
[12/19/21 22:50:59] INFO	feature_selection = False
[12/19/21 22:50:59] INFO	fs_percentage     = 50
[12/19/21 22:50:59] INFO	fs_score_func     = <function f_classif at 0x7f8159d9ce50>
[12/19/21 22:50:59] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:50:59] INFO	grid_search       = True
[12/19/21 22:50:59] INFO	gs_iters          = 50
[12/19/21 22:50:59] INFO	gs_random         = True
[12/19/21 22:50:59] INFO	gs_sample         = False
[12/19/21 22:50:59] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:50:59] INFO	importances       = True
[12/19/21 22:50:59] INFO	interactions      = False
[12/19/21 22:50:59] INFO	isomap            = False
[12/19/21 22:50:59] INFO	iso_components    = 2
[12/19/21 22:50:59] INFO	iso_neighbors     = 5
[12/19/21 22:50:59] INFO	isample_pct       = 10
[12/19/21 22:50:59] INFO	leaders           = []
[12/19/21 22:50:59] INFO	learning_curve    = True
[12/19/21 22:50:59] INFO	logtransform      = False
[12/19/21 22:50:59] INFO	lv_remove         = True
[12/19/21 22:50:59] INFO	lv_threshold      = 0.100000
[12/19/21 22:50:59] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:50:59] INFO	n_estimators      = 51
[12/19/21 22:50:59] INFO	n_jobs            = -1
[12/19/21 22:50:59] INFO	ngrams_max        = 2
[12/19/21 22:50:59] INFO	numpy             = True
[12/19/21 22:50:59] INFO	pca               = False
[12/19/21 22:50:59] INFO	pca_inc           = 1
[12/19/21 22:50:59] INFO	pca_max           = 10
[12/19/21 22:50:59] INFO	pca_min           = 2
[12/19/21 22:50:59] INFO	pca_whiten        = False
[12/19/21 22:50:59] INFO	poly_degree       = 2
[12/19/21 22:50:59] INFO	pvalue_level      = 0.010000
[12/19/21 22:50:59] INFO	rfe               = True
[12/19/21 22:50:59] INFO	rfe_step          = 3
[12/19/21 22:50:59] INFO	roc_curve         = True
[12/19/21 22:50:59] INFO	rounding          = 2
[12/19/21 22:50:59] INFO	sampling          = True
[12/19/21 22:50:59] INFO	sampling_method   = <SamplingMethod.under_random: 12>
[12/19/21 22:50:59] INFO	sampling_ratio    = 1.000000
[12/19/21 22:50:59] INFO	scaler_option     = True
[12/19/21 22:50:59] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:50:59] INFO	scipy             = False
[12/19/21 22:50:59] INFO	scorer            = roc_auc
[12/19/21 22:50:59] INFO	seed              = 42
[12/19/21 22:50:59] INFO	sentinel          = -1
[12/19/21 22:50:59] INFO	separator         = ,
[12/19/21 22:50:59] INFO	shuffle           = False
[12/19/21 22:50:59] INFO	split             = 0.400000
[12/19/21 22:50:59] INFO	submission_file   = gender_submission
[12/19/21 22:50:59] INFO	submit_probas     = False
[12/19/21 22:50:59] INFO	target [y]        = Survived
[12/19/21 22:50:59] INFO	target_value      = 1
[12/19/21 22:50:59] INFO	transforms        = None
[12/19/21 22:50:59] INFO	tsne              = False
[12/19/21 22:50:59] INFO	tsne_components   = 2
[12/19/21 22:50:59] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:50:59] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:50:59] INFO	vectorize         = False
[12/19/21 22:50:59] INFO	verbosity         = 0
[12/19/21 22:50:59] INFO	Creating Model
[12/19/21 22:50:59] INFO	Calling Pipeline
[12/19/21 22:50:59] INFO	Training Pipeline
[12/19/21 22:50:59] INFO	Loading Data
[12/19/21 22:50:59] INFO	Loading data from ./input/train.csv
[12/19/21 22:50:59] INFO	Found target Survived in data frame
[12/19/21 22:50:59] INFO	Labels (y) found for Partition.train
[12/19/21 22:50:59] INFO	Loading Data
[12/19/21 22:50:59] INFO	Loading data from ./input/test.csv
[12/19/21 22:50:59] INFO	Target Survived not found in Partition.test
[12/19/21 22:50:59] INFO	Saving New Features in Model
[12/19/21 22:50:59] INFO	Original Feature Statistics
[12/19/21 22:50:59] INFO	Number of Training Rows    : 891
[12/19/21 22:50:59] INFO	Number of Training Columns : 11
[12/19/21 22:50:59] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:50:59] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:50:59] INFO	Number of Testing Rows     : 418
[12/19/21 22:50:59] INFO	Number of Testing Columns  : 11
[12/19/21 22:50:59] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:50:59] INFO	Feature Count     : 11
[12/19/21 22:50:59] INFO	Applying transforms
[12/19/21 22:50:59] INFO	No transforms Specified
[12/19/21 22:50:59] INFO	New Feature Count : 11
[12/19/21 22:50:59] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:50:59] INFO	Original Feature Count : 11
[12/19/21 22:50:59] INFO	Reduced Feature Count  : 10
[12/19/21 22:50:59] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:50:59] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:50:59] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:50:59] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:50:59] INFO	Creating Cross-Tabulations
[12/19/21 22:50:59] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:50:59] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:50:59] INFO	Feature Count     : 10
[12/19/21 22:50:59] INFO	Creating Count Features
[12/19/21 22:50:59] INFO	NA Counts
[12/19/21 22:50:59] INFO	Number Counts
[12/19/21 22:50:59] INFO	New Feature Count : 21
[12/19/21 22:50:59] INFO	Creating Base Features
[12/19/21 22:50:59] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:50:59] INFO	Feature 2: Name => Factorization
[12/19/21 22:50:59] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:50:59] INFO	Feature 3: Sex => Factorization
[12/19/21 22:50:59] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:50:59] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:50:59] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:50:59] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:50:59] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:50:59] INFO	Encoding: Encoders.target
[12/19/21 22:50:59] INFO	Fitting training features for Embarked
[12/19/21 22:50:59] INFO	Transforming testing features for Embarked
[12/19/21 22:50:59] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:50:59] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:50:59] INFO	New Feature Count : 21
[12/19/21 22:50:59] INFO	Scaling Base Features
[12/19/21 22:50:59] INFO	Creating NumPy Features
[12/19/21 22:50:59] INFO	NumPy Feature: sum
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	NumPy Feature: mean
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	NumPy Feature: std
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	NumPy Feature: var
[12/19/21 22:50:59] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:50:59] INFO	NumPy Feature Count : 4
[12/19/21 22:50:59] INFO	New Feature Count : 25
[12/19/21 22:50:59] INFO	Creating Clustering Features
[12/19/21 22:50:59] INFO	Cluster Minimum   : 3
[12/19/21 22:50:59] INFO	Cluster Maximum   : 30
[12/19/21 22:50:59] INFO	Cluster Increment : 3
[12/19/21 22:50:59] INFO	k = 3
[12/19/21 22:51:01] INFO	k = 6
[12/19/21 22:51:01] INFO	k = 9
[12/19/21 22:51:01] INFO	k = 12
[12/19/21 22:51:01] INFO	k = 15
[12/19/21 22:51:01] INFO	k = 18
[12/19/21 22:51:01] INFO	k = 21
[12/19/21 22:51:01] INFO	k = 24
[12/19/21 22:51:01] INFO	k = 27
[12/19/21 22:51:01] INFO	k = 30
[12/19/21 22:51:01] INFO	Clustering Feature Count : 10
[12/19/21 22:51:01] INFO	New Feature Count : 35
[12/19/21 22:51:01] INFO	Saving New Features in Model
[12/19/21 22:51:01] INFO	Creating Interactions
[12/19/21 22:51:01] INFO	Initial Feature Count  : 35
[12/19/21 22:51:01] INFO	Skipping Interactions
[12/19/21 22:51:01] INFO	Saving New Features in Model
[12/19/21 22:51:01] INFO	Removing Low-Variance Features
[12/19/21 22:51:01] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:51:01] INFO	Original Feature Count  : 35
[12/19/21 22:51:01] INFO	Reduced Feature Count   : 35
[12/19/21 22:51:01] INFO	Saving New Features in Model
[12/19/21 22:51:01] INFO	Skipping Shuffling
[12/19/21 22:51:01] INFO	Sampling Data
[12/19/21 22:51:01] INFO	Sampling Ratio for target Survived [1]: 0.62 => 1.00
[12/19/21 22:51:01] INFO	Original Samples : 891
[12/19/21 22:51:01] INFO	New Samples      : 684
[12/19/21 22:51:01] INFO	Getting All Estimators
[12/19/21 22:51:01] INFO	Algorithm Configuration
[12/19/21 22:51:02] INFO	Selecting Models
[12/19/21 22:51:02] INFO	Algorithm: CATB
[12/19/21 22:51:02] INFO	Fitting Initial Model
[12/19/21 22:51:02] INFO	Cross-Validation
[12/19/21 22:51:03] INFO	Cross-Validation Scores: [0.53424131 0.75261619 0.57325331]
[12/19/21 22:51:03] INFO	Recursive Feature Elimination with CV
[12/19/21 22:51:05] INFO	RFECV took 2.26 seconds for step 3 and 3 folds
[12/19/21 22:51:05] INFO	Algorithm: CATB, Selected Features: 1, Ranking: [ 2  6  1  3  7 12  6  3  6  8  9 11  5  8  9 12 13 13 13 12 11  3  7  4
  4  8  7 11  5  5 10  9 10 10  4]
[12/19/21 22:51:05] INFO	No grid is defined for grid search
[12/19/21 22:51:05] INFO	Final Model Predictions for CATB
[12/19/21 22:51:05] INFO	Skipping Calibration
[12/19/21 22:51:05] INFO	Making Predictions
[12/19/21 22:51:05] INFO	Predictions Complete
[12/19/21 22:51:05] INFO	Algorithm: LGB
[12/19/21 22:51:05] INFO	Fitting Initial Model
[12/19/21 22:51:05] INFO	Cross-Validation
[12/19/21 22:51:06] INFO	Cross-Validation Scores: [0.45287011 0.71114189 0.41666667]
[12/19/21 22:51:06] INFO	Recursive Feature Elimination with CV
[12/19/21 22:51:09] INFO	RFECV took 2.53 seconds for step 3 and 3 folds
[12/19/21 22:51:09] INFO	Algorithm: LGB, Selected Features: 14, Ranking: [1 1 1 1 4 4 1 1 1 4 6 5 3 3 6 8 8 8 7 7 5 1 7 1 1 6 3 2 2 1 1 5 2 1 1]
[12/19/21 22:51:09] INFO	No grid is defined for grid search
[12/19/21 22:51:09] INFO	Final Model Predictions for LGB
[12/19/21 22:51:09] INFO	Skipping Calibration
[12/19/21 22:51:09] INFO	Making Predictions
[12/19/21 22:51:09] INFO	Predictions Complete
[12/19/21 22:51:09] INFO	Algorithm: XGB
[12/19/21 22:51:09] INFO	Fitting Initial Model
[12/19/21 22:51:09] INFO	Cross-Validation
[12/19/21 22:51:09] INFO	Cross-Validation Scores: [0.37596183 0.75126962 0.31398122]
[12/19/21 22:51:09] INFO	Recursive Feature Elimination with CV
[12/19/21 22:51:12] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[12/19/21 22:51:12] INFO	Algorithm: XGB, Selected Features: 1, Ranking: [ 2  6  1  4  3  8  7  4  3  4  9 10  3 10 11 12 11 13 11 12 12  6 13  5
 13  9  8  7 10  9  8  7  5  6  5]
[12/19/21 22:51:12] INFO	Randomized Grid Search
[12/19/21 22:51:28] INFO	Grid Search took 16.20 seconds for 50 candidate parameter settings.
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Model with rank: 1
[12/19/21 22:51:28] INFO	Mean validation score: 0.760 (std: 0.018)
[12/19/21 22:51:28] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/19/21 22:51:28] INFO	Algorithm: XGB, Best Score: 0.7602, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:51:28] INFO	Final Model Predictions for XGB
[12/19/21 22:51:28] INFO	Skipping Calibration
[12/19/21 22:51:28] INFO	Making Predictions
[12/19/21 22:51:28] INFO	Predictions Complete
[12/19/21 22:51:28] INFO	Blending Models
[12/19/21 22:51:28] INFO	Blending Start: 2021-12-19 22:51:28.252236
[12/19/21 22:51:28] INFO	Blending Complete: 0:00:00.004509
[12/19/21 22:51:28] INFO	================================================================================
[12/19/21 22:51:28] INFO	Metrics for: Partition.train
[12/19/21 22:51:28] INFO	--------------------------------------------------------------------------------
[12/19/21 22:51:28] INFO	Algorithm: CATB
[12/19/21 22:51:28] INFO	accuracy: 0.7602339181286549
[12/19/21 22:51:28] INFO	average_precision: 0.7105364684860299
[12/19/21 22:51:28] INFO	balanced_accuracy: 0.760233918128655
[12/19/21 22:51:28] INFO	brier_score_loss: 0.18054685282207472
[12/19/21 22:51:28] INFO	cohen_kappa: 0.52046783625731
[12/19/21 22:51:28] INFO	confusion_matrix: [[287  55]
 [109 233]]
[12/19/21 22:51:28] INFO	f1: 0.7396825396825396
[12/19/21 22:51:28] INFO	neg_log_loss: 0.5459783333940484
[12/19/21 22:51:28] INFO	precision: 0.8090277777777778
[12/19/21 22:51:28] INFO	recall: 0.6812865497076024
[12/19/21 22:51:28] INFO	roc_auc: 0.760233918128655
[12/19/21 22:51:28] INFO	--------------------------------------------------------------------------------
[12/19/21 22:51:28] INFO	Algorithm: LGB
[12/19/21 22:51:28] INFO	accuracy: 0.9576023391812866
[12/19/21 22:51:28] INFO	average_precision: 0.9966070568903658
[12/19/21 22:51:28] INFO	balanced_accuracy: 0.9576023391812865
[12/19/21 22:51:28] INFO	brier_score_loss: 0.038264826328387826
[12/19/21 22:51:28] INFO	cohen_kappa: 0.9152046783625731
[12/19/21 22:51:28] INFO	confusion_matrix: [[332  10]
 [ 19 323]]
[12/19/21 22:51:28] INFO	f1: 0.957037037037037
[12/19/21 22:51:28] INFO	neg_log_loss: 0.1667582525794935
[12/19/21 22:51:28] INFO	precision: 0.96996996996997
[12/19/21 22:51:28] INFO	recall: 0.9444444444444444
[12/19/21 22:51:28] INFO	roc_auc: 0.9964604493690367
[12/19/21 22:51:28] INFO	--------------------------------------------------------------------------------
[12/19/21 22:51:28] INFO	Algorithm: XGB
[12/19/21 22:51:28] INFO	accuracy: 0.7602339181286549
[12/19/21 22:51:28] INFO	average_precision: 0.7105364684860299
[12/19/21 22:51:28] INFO	balanced_accuracy: 0.760233918128655
[12/19/21 22:51:28] INFO	brier_score_loss: 0.22687963402493433
[12/19/21 22:51:28] INFO	cohen_kappa: 0.52046783625731
[12/19/21 22:51:28] INFO	confusion_matrix: [[287  55]
 [109 233]]
[12/19/21 22:51:28] INFO	f1: 0.7396825396825396
[12/19/21 22:51:28] INFO	neg_log_loss: 0.6467518632174932
[12/19/21 22:51:28] INFO	precision: 0.8090277777777778
[12/19/21 22:51:28] INFO	recall: 0.6812865497076024
[12/19/21 22:51:28] INFO	roc_auc: 0.760233918128655
[12/19/21 22:51:28] INFO	================================================================================
[12/19/21 22:51:28] INFO	Metrics for: Partition.test
[12/19/21 22:51:28] INFO	No labels for generating Partition.test metrics
[12/19/21 22:51:28] INFO	================================================================================
[12/19/21 22:51:28] INFO	Selecting Best Model
[12/19/21 22:51:28] INFO	Scoring for: Partition.train
[12/19/21 22:51:28] INFO	Best Model Selection Start: 2021-12-19 22:51:28.275554
[12/19/21 22:51:28] INFO	Scoring CATB Model
[12/19/21 22:51:28] INFO	Scoring LGB Model
[12/19/21 22:51:28] INFO	Scoring XGB Model
[12/19/21 22:51:28] INFO	Scoring BLEND Model
[12/19/21 22:51:28] INFO	Best Model is BLEND with a roc_auc score of 0.9970
[12/19/21 22:51:28] INFO	Best Model Selection Complete: 0:00:00.000192
[12/19/21 22:51:28] INFO	================================================================================
[12/19/21 22:51:28] INFO	Generating Plots for partition: train
[12/19/21 22:51:28] INFO	Generating Calibration Plot
[12/19/21 22:51:28] INFO	Calibration for Algorithm: CATB
[12/19/21 22:51:28] INFO	Calibration for Algorithm: LGB
[12/19/21 22:51:28] INFO	Calibration for Algorithm: XGB
[12/19/21 22:51:28] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:51:28] INFO	Generating Confusion Matrices
[12/19/21 22:51:28] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:51:28] INFO	Confusion Matrix:
[12/19/21 22:51:28] INFO	[[287  55]
 [109 233]]
[12/19/21 22:51:28] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:51:28] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:51:28] INFO	Confusion Matrix:
[12/19/21 22:51:28] INFO	[[332  10]
 [ 19 323]]
[12/19/21 22:51:28] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:51:28] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:51:28] INFO	Confusion Matrix:
[12/19/21 22:51:28] INFO	[[287  55]
 [109 233]]
[12/19/21 22:51:28] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:51:28] INFO	Generating ROC Curves
[12/19/21 22:51:28] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:51:28] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:51:28] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:51:28] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:51:28] INFO	Generating Learning Curves
[12/19/21 22:51:28] INFO	Algorithm Configuration
[12/19/21 22:51:28] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:51:29] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:51:29] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:51:30] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:51:30] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:51:31] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:51:31] INFO	Generating Feature Importance Plots
[12/19/21 22:51:31] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:51:31] INFO	Feature Ranking:
[12/19/21 22:51:31] INFO	1. Sex_factor (100.000000)
[12/19/21 22:51:31] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:51:31] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:51:31] INFO	Feature Ranking:
[12/19/21 22:51:31] INFO	1. Fare (218.000000)
[12/19/21 22:51:31] INFO	2. sum (196.000000)
[12/19/21 22:51:31] INFO	3. std (194.000000)
[12/19/21 22:51:31] INFO	4. Name_factor (184.000000)
[12/19/21 22:51:31] INFO	5. Age (180.000000)
[12/19/21 22:51:31] INFO	6. Ticket_factor (128.000000)
[12/19/21 22:51:31] INFO	7. cluster_30 (52.000000)
[12/19/21 22:51:31] INFO	8. Sex_factor (42.000000)
[12/19/21 22:51:31] INFO	9. cluster_27 (37.000000)
[12/19/21 22:51:31] INFO	10. Pclass (36.000000)
[12/19/21 22:51:31] INFO	11. cluster_15 (31.000000)
[12/19/21 22:51:31] INFO	12. cluster_18 (28.000000)
[12/19/21 22:51:31] INFO	13. var (22.000000)
[12/19/21 22:51:31] INFO	14. Cabin_factor (22.000000)
[12/19/21 22:51:31] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:51:31] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:51:31] INFO	Feature Ranking:
[12/19/21 22:51:31] INFO	1. Sex_factor (1.000000)
[12/19/21 22:51:31] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:51:31] INFO	================================================================================
[12/19/21 22:51:31] INFO	Saving Model Predictor
[12/19/21 22:51:31] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:51:31] INFO	Saving Feature Map
[12/19/21 22:51:31] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:51:31] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:51:31] INFO	Saving Predictions
[12/19/21 22:51:31] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:51:31] INFO	Saving Probabilities
[12/19/21 22:51:31] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:51:31] INFO	Saving Ranked Predictions
[12/19/21 22:51:31] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:51:31] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:51:31] INFO	********************************************************************************
[12/19/21 22:51:31] INFO	AlphaPy End
[12/19/21 22:51:31] INFO	********************************************************************************
[12/19/21 22:52:35] INFO	********************************************************************************
[12/19/21 22:52:35] INFO	AlphaPy Start
[12/19/21 22:52:35] INFO	********************************************************************************
[12/19/21 22:52:35] INFO	Model Configuration
[12/19/21 22:52:35] INFO	No transforms Found
[12/19/21 22:52:35] INFO	MODEL PARAMETERS:
[12/19/21 22:52:35] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:52:35] INFO	calibration       = False
[12/19/21 22:52:35] INFO	cal_type          = sigmoid
[12/19/21 22:52:35] INFO	calibration_plot  = False
[12/19/21 22:52:35] INFO	clustering        = True
[12/19/21 22:52:35] INFO	cluster_inc       = 3
[12/19/21 22:52:35] INFO	cluster_max       = 30
[12/19/21 22:52:35] INFO	cluster_min       = 3
[12/19/21 22:52:35] INFO	confusion_matrix  = True
[12/19/21 22:52:35] INFO	counts            = True
[12/19/21 22:52:35] INFO	cv_folds          = 3
[12/19/21 22:52:35] INFO	directory         = .
[12/19/21 22:52:35] INFO	extension         = csv
[12/19/21 22:52:35] INFO	drop              = ['PassengerId']
[12/19/21 22:52:35] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:52:35] INFO	esr               = 20
[12/19/21 22:52:35] INFO	factors           = ['Embarked']
[12/19/21 22:52:35] INFO	features [X]      = *
[12/19/21 22:52:35] INFO	feature_selection = False
[12/19/21 22:52:35] INFO	fs_percentage     = 50
[12/19/21 22:52:35] INFO	fs_score_func     = <function f_classif at 0x7f7acaab1ee0>
[12/19/21 22:52:35] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:52:35] INFO	grid_search       = True
[12/19/21 22:52:35] INFO	gs_iters          = 50
[12/19/21 22:52:35] INFO	gs_random         = True
[12/19/21 22:52:35] INFO	gs_sample         = False
[12/19/21 22:52:35] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:52:35] INFO	importances       = True
[12/19/21 22:52:35] INFO	interactions      = False
[12/19/21 22:52:35] INFO	isomap            = False
[12/19/21 22:52:35] INFO	iso_components    = 2
[12/19/21 22:52:35] INFO	iso_neighbors     = 5
[12/19/21 22:52:35] INFO	isample_pct       = 10
[12/19/21 22:52:35] INFO	leaders           = []
[12/19/21 22:52:35] INFO	learning_curve    = True
[12/19/21 22:52:35] INFO	logtransform      = False
[12/19/21 22:52:35] INFO	lv_remove         = True
[12/19/21 22:52:35] INFO	lv_threshold      = 0.100000
[12/19/21 22:52:35] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:52:35] INFO	n_estimators      = 51
[12/19/21 22:52:35] INFO	n_jobs            = -1
[12/19/21 22:52:35] INFO	ngrams_max        = 2
[12/19/21 22:52:35] INFO	numpy             = True
[12/19/21 22:52:35] INFO	pca               = False
[12/19/21 22:52:35] INFO	pca_inc           = 1
[12/19/21 22:52:35] INFO	pca_max           = 10
[12/19/21 22:52:35] INFO	pca_min           = 2
[12/19/21 22:52:35] INFO	pca_whiten        = False
[12/19/21 22:52:35] INFO	poly_degree       = 2
[12/19/21 22:52:35] INFO	pvalue_level      = 0.010000
[12/19/21 22:52:35] INFO	rfe               = True
[12/19/21 22:52:35] INFO	rfe_step          = 3
[12/19/21 22:52:35] INFO	roc_curve         = True
[12/19/21 22:52:35] INFO	rounding          = 2
[12/19/21 22:52:35] INFO	sampling          = True
[12/19/21 22:52:35] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/19/21 22:52:35] INFO	sampling_ratio    = 1.000000
[12/19/21 22:52:35] INFO	scaler_option     = True
[12/19/21 22:52:35] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:52:35] INFO	scipy             = False
[12/19/21 22:52:35] INFO	scorer            = roc_auc
[12/19/21 22:52:35] INFO	seed              = 42
[12/19/21 22:52:35] INFO	sentinel          = -1
[12/19/21 22:52:35] INFO	separator         = ,
[12/19/21 22:52:35] INFO	shuffle           = False
[12/19/21 22:52:35] INFO	split             = 0.400000
[12/19/21 22:52:35] INFO	submission_file   = gender_submission
[12/19/21 22:52:35] INFO	submit_probas     = False
[12/19/21 22:52:35] INFO	target [y]        = Survived
[12/19/21 22:52:35] INFO	target_value      = 1
[12/19/21 22:52:35] INFO	transforms        = None
[12/19/21 22:52:35] INFO	tsne              = False
[12/19/21 22:52:35] INFO	tsne_components   = 2
[12/19/21 22:52:35] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:52:35] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:52:35] INFO	vectorize         = False
[12/19/21 22:52:35] INFO	verbosity         = 0
[12/19/21 22:52:35] INFO	Creating Model
[12/19/21 22:52:35] INFO	Calling Pipeline
[12/19/21 22:52:35] INFO	Training Pipeline
[12/19/21 22:52:35] INFO	Loading Data
[12/19/21 22:52:35] INFO	Loading data from ./input/train.csv
[12/19/21 22:52:35] INFO	Found target Survived in data frame
[12/19/21 22:52:35] INFO	Labels (y) found for Partition.train
[12/19/21 22:52:35] INFO	Loading Data
[12/19/21 22:52:35] INFO	Loading data from ./input/test.csv
[12/19/21 22:52:35] INFO	Target Survived not found in Partition.test
[12/19/21 22:52:35] INFO	Saving New Features in Model
[12/19/21 22:52:35] INFO	Original Feature Statistics
[12/19/21 22:52:35] INFO	Number of Training Rows    : 891
[12/19/21 22:52:35] INFO	Number of Training Columns : 11
[12/19/21 22:52:35] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:52:35] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:52:35] INFO	Number of Testing Rows     : 418
[12/19/21 22:52:35] INFO	Number of Testing Columns  : 11
[12/19/21 22:52:35] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:52:35] INFO	Feature Count     : 11
[12/19/21 22:52:35] INFO	Applying transforms
[12/19/21 22:52:35] INFO	No transforms Specified
[12/19/21 22:52:35] INFO	New Feature Count : 11
[12/19/21 22:52:35] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:52:35] INFO	Original Feature Count : 11
[12/19/21 22:52:35] INFO	Reduced Feature Count  : 10
[12/19/21 22:52:35] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:52:35] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:52:35] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:52:35] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:52:35] INFO	Creating Cross-Tabulations
[12/19/21 22:52:35] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:52:35] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:52:35] INFO	Feature Count     : 10
[12/19/21 22:52:35] INFO	Creating Count Features
[12/19/21 22:52:35] INFO	NA Counts
[12/19/21 22:52:35] INFO	Number Counts
[12/19/21 22:52:35] INFO	New Feature Count : 21
[12/19/21 22:52:35] INFO	Creating Base Features
[12/19/21 22:52:35] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:52:35] INFO	Feature 2: Name => Factorization
[12/19/21 22:52:35] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:52:35] INFO	Feature 3: Sex => Factorization
[12/19/21 22:52:35] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:52:35] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:52:35] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:52:35] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:52:35] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:52:35] INFO	Encoding: Encoders.target
[12/19/21 22:52:35] INFO	Fitting training features for Embarked
[12/19/21 22:52:35] INFO	Transforming testing features for Embarked
[12/19/21 22:52:35] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:52:35] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:52:35] INFO	New Feature Count : 21
[12/19/21 22:52:35] INFO	Scaling Base Features
[12/19/21 22:52:35] INFO	Creating NumPy Features
[12/19/21 22:52:35] INFO	NumPy Feature: sum
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	NumPy Feature: mean
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	NumPy Feature: std
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	NumPy Feature: var
[12/19/21 22:52:35] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:52:35] INFO	NumPy Feature Count : 4
[12/19/21 22:52:35] INFO	New Feature Count : 25
[12/19/21 22:52:35] INFO	Creating Clustering Features
[12/19/21 22:52:35] INFO	Cluster Minimum   : 3
[12/19/21 22:52:35] INFO	Cluster Maximum   : 30
[12/19/21 22:52:35] INFO	Cluster Increment : 3
[12/19/21 22:52:35] INFO	k = 3
[12/19/21 22:52:37] INFO	k = 6
[12/19/21 22:52:37] INFO	k = 9
[12/19/21 22:52:37] INFO	k = 12
[12/19/21 22:52:37] INFO	k = 15
[12/19/21 22:52:37] INFO	k = 18
[12/19/21 22:52:37] INFO	k = 21
[12/19/21 22:52:37] INFO	k = 24
[12/19/21 22:52:37] INFO	k = 27
[12/19/21 22:52:37] INFO	k = 30
[12/19/21 22:52:37] INFO	Clustering Feature Count : 10
[12/19/21 22:52:37] INFO	New Feature Count : 35
[12/19/21 22:52:37] INFO	Saving New Features in Model
[12/19/21 22:52:37] INFO	Creating Interactions
[12/19/21 22:52:37] INFO	Initial Feature Count  : 35
[12/19/21 22:52:37] INFO	Skipping Interactions
[12/19/21 22:52:37] INFO	Saving New Features in Model
[12/19/21 22:52:37] INFO	Removing Low-Variance Features
[12/19/21 22:52:37] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:52:37] INFO	Original Feature Count  : 35
[12/19/21 22:52:37] INFO	Reduced Feature Count   : 35
[12/19/21 22:52:37] INFO	Saving New Features in Model
[12/19/21 22:52:37] INFO	Skipping Shuffling
[12/19/21 22:52:37] INFO	Sampling Data
[12/19/21 22:52:37] INFO	Sampling Ratio for target Survived [1]: 0.62 => 1.00
[12/19/21 22:52:37] INFO	Original Samples : 891
[12/19/21 22:52:37] INFO	New Samples      : 1098
[12/19/21 22:52:37] INFO	Getting All Estimators
[12/19/21 22:52:37] INFO	Algorithm Configuration
[12/19/21 22:52:38] INFO	Selecting Models
[12/19/21 22:52:38] INFO	Algorithm: CATB
[12/19/21 22:52:38] INFO	Fitting Initial Model
[12/19/21 22:52:38] INFO	Cross-Validation
[12/19/21 22:52:39] INFO	Cross-Validation Scores: [0.59319478 0.61339544 0.5029114 ]
[12/19/21 22:52:39] INFO	Recursive Feature Elimination with CV
[12/19/21 22:52:41] INFO	RFECV took 2.19 seconds for step 3 and 3 folds
[12/19/21 22:52:41] INFO	Algorithm: CATB, Selected Features: 23, Ranking: [1 1 1 1 1 4 1 1 1 1 1 3 1 1 3 4 5 5 5 4 2 1 1 1 1 3 1 1 1 1 2 1 1 2 1]
[12/19/21 22:52:41] INFO	No grid is defined for grid search
[12/19/21 22:52:41] INFO	Final Model Predictions for CATB
[12/19/21 22:52:41] INFO	Skipping Calibration
[12/19/21 22:52:41] INFO	Making Predictions
[12/19/21 22:52:41] INFO	Predictions Complete
[12/19/21 22:52:41] INFO	Algorithm: LGB
[12/19/21 22:52:41] INFO	Fitting Initial Model
[12/19/21 22:52:42] INFO	Cross-Validation
[12/19/21 22:52:43] INFO	Cross-Validation Scores: [0.47848547 0.48947416 0.27694168]
[12/19/21 22:52:43] INFO	Recursive Feature Elimination with CV
[12/19/21 22:52:46] INFO	RFECV took 3.51 seconds for step 3 and 3 folds
[12/19/21 22:52:46] INFO	Algorithm: LGB, Selected Features: 14, Ranking: [1 1 1 1 2 6 1 1 1 1 4 6 2 5 5 7 7 8 8 8 6 1 7 1 4 5 3 3 4 1 1 2 3 1 1]
[12/19/21 22:52:46] INFO	No grid is defined for grid search
[12/19/21 22:52:46] INFO	Final Model Predictions for LGB
[12/19/21 22:52:46] INFO	Skipping Calibration
[12/19/21 22:52:46] INFO	Making Predictions
[12/19/21 22:52:46] INFO	Predictions Complete
[12/19/21 22:52:46] INFO	Algorithm: XGB
[12/19/21 22:52:46] INFO	Fitting Initial Model
[12/19/21 22:52:46] INFO	Cross-Validation
[12/19/21 22:52:47] INFO	Cross-Validation Scores: [0.57559199 0.5370868  0.12654902]
[12/19/21 22:52:47] INFO	Recursive Feature Elimination with CV
[12/19/21 22:52:50] INFO	RFECV took 3.06 seconds for step 3 and 3 folds
[12/19/21 22:52:50] INFO	Algorithm: XGB, Selected Features: 1, Ranking: [ 2  7  1  4  3  9  8  5  3  5  3 11  4  8 11 12 11 13 12 12 13  5 13  6
 10 10  7 10  6  9  9  8  7  6  4]
[12/19/21 22:52:50] INFO	Randomized Grid Search
[12/19/21 22:53:08] INFO	Grid Search took 18.81 seconds for 50 candidate parameter settings.
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.2, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 1.0, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.7}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 501, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Model with rank: 1
[12/19/21 22:53:08] INFO	Mean validation score: 0.770 (std: 0.023)
[12/19/21 22:53:08] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/19/21 22:53:08] INFO	Algorithm: XGB, Best Score: 0.7696, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 1.0}
[12/19/21 22:53:08] INFO	Final Model Predictions for XGB
[12/19/21 22:53:08] INFO	Skipping Calibration
[12/19/21 22:53:08] INFO	Making Predictions
[12/19/21 22:53:08] INFO	Predictions Complete
[12/19/21 22:53:08] INFO	Blending Models
[12/19/21 22:53:08] INFO	Blending Start: 2021-12-19 22:53:08.948234
[12/19/21 22:53:08] INFO	Blending Complete: 0:00:00.004305
[12/19/21 22:53:08] INFO	================================================================================
[12/19/21 22:53:08] INFO	Metrics for: Partition.train
[12/19/21 22:53:08] INFO	--------------------------------------------------------------------------------
[12/19/21 22:53:08] INFO	Algorithm: CATB
[12/19/21 22:53:08] INFO	accuracy: 0.9316939890710383
[12/19/21 22:53:08] INFO	average_precision: 0.9792982910195944
[12/19/21 22:53:08] INFO	balanced_accuracy: 0.9316939890710383
[12/19/21 22:53:08] INFO	brier_score_loss: 0.06356433363536128
[12/19/21 22:53:08] INFO	cohen_kappa: 0.8633879781420765
[12/19/21 22:53:08] INFO	confusion_matrix: [[518  31]
 [ 44 505]]
[12/19/21 22:53:08] INFO	f1: 0.9308755760368662
[12/19/21 22:53:08] INFO	neg_log_loss: 0.23449340499765348
[12/19/21 22:53:08] INFO	precision: 0.9421641791044776
[12/19/21 22:53:08] INFO	recall: 0.9198542805100182
[12/19/21 22:53:08] INFO	roc_auc: 0.9783494414418
[12/19/21 22:53:08] INFO	--------------------------------------------------------------------------------
[12/19/21 22:53:08] INFO	Algorithm: LGB
[12/19/21 22:53:08] INFO	accuracy: 0.9735883424408015
[12/19/21 22:53:08] INFO	average_precision: 0.9974411720533732
[12/19/21 22:53:08] INFO	balanced_accuracy: 0.9735883424408015
[12/19/21 22:53:08] INFO	brier_score_loss: 0.028999485434470663
[12/19/21 22:53:08] INFO	cohen_kappa: 0.9471766848816029
[12/19/21 22:53:08] INFO	confusion_matrix: [[536  13]
 [ 16 533]]
[12/19/21 22:53:08] INFO	f1: 0.9735159817351599
[12/19/21 22:53:08] INFO	neg_log_loss: 0.13522021850821248
[12/19/21 22:53:08] INFO	precision: 0.9761904761904762
[12/19/21 22:53:08] INFO	recall: 0.970856102003643
[12/19/21 22:53:08] INFO	roc_auc: 0.9974734655823969
[12/19/21 22:53:08] INFO	--------------------------------------------------------------------------------
[12/19/21 22:53:08] INFO	Algorithm: XGB
[12/19/21 22:53:08] INFO	accuracy: 0.7695810564663024
[12/19/21 22:53:08] INFO	average_precision: 0.7219040573969344
[12/19/21 22:53:08] INFO	balanced_accuracy: 0.7695810564663024
[12/19/21 22:53:08] INFO	brier_score_loss: 0.20239324151078592
[12/19/21 22:53:08] INFO	cohen_kappa: 0.5391621129326047
[12/19/21 22:53:08] INFO	confusion_matrix: [[468  81]
 [172 377]]
[12/19/21 22:53:08] INFO	f1: 0.7487586891757695
[12/19/21 22:53:08] INFO	neg_log_loss: 0.5964207485833889
[12/19/21 22:53:08] INFO	precision: 0.8231441048034934
[12/19/21 22:53:08] INFO	recall: 0.6867030965391621
[12/19/21 22:53:08] INFO	roc_auc: 0.7695810564663024
[12/19/21 22:53:08] INFO	================================================================================
[12/19/21 22:53:08] INFO	Metrics for: Partition.test
[12/19/21 22:53:08] INFO	No labels for generating Partition.test metrics
[12/19/21 22:53:08] INFO	================================================================================
[12/19/21 22:53:08] INFO	Selecting Best Model
[12/19/21 22:53:08] INFO	Scoring for: Partition.train
[12/19/21 22:53:08] INFO	Best Model Selection Start: 2021-12-19 22:53:08.974883
[12/19/21 22:53:08] INFO	Scoring CATB Model
[12/19/21 22:53:08] INFO	Scoring LGB Model
[12/19/21 22:53:08] INFO	Scoring XGB Model
[12/19/21 22:53:08] INFO	Scoring BLEND Model
[12/19/21 22:53:08] INFO	Best Model is LGB with a roc_auc score of 0.9975
[12/19/21 22:53:08] INFO	Best Model Selection Complete: 0:00:00.000197
[12/19/21 22:53:08] INFO	================================================================================
[12/19/21 22:53:08] INFO	Generating Plots for partition: train
[12/19/21 22:53:08] INFO	Generating Calibration Plot
[12/19/21 22:53:08] INFO	Calibration for Algorithm: CATB
[12/19/21 22:53:08] INFO	Calibration for Algorithm: LGB
[12/19/21 22:53:08] INFO	Calibration for Algorithm: XGB
[12/19/21 22:53:09] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:53:09] INFO	Generating Confusion Matrices
[12/19/21 22:53:09] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:53:09] INFO	Confusion Matrix:
[12/19/21 22:53:09] INFO	[[518  31]
 [ 44 505]]
[12/19/21 22:53:09] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:53:09] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:53:09] INFO	Confusion Matrix:
[12/19/21 22:53:09] INFO	[[536  13]
 [ 16 533]]
[12/19/21 22:53:09] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:53:09] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:53:09] INFO	Confusion Matrix:
[12/19/21 22:53:09] INFO	[[468  81]
 [172 377]]
[12/19/21 22:53:09] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:53:09] INFO	Generating ROC Curves
[12/19/21 22:53:09] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:53:09] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:53:09] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:53:09] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:53:09] INFO	Generating Learning Curves
[12/19/21 22:53:09] INFO	Algorithm Configuration
[12/19/21 22:53:09] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:53:10] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:53:10] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:53:12] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:53:12] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:53:12] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:53:12] INFO	Generating Feature Importance Plots
[12/19/21 22:53:12] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:53:12] INFO	Feature Ranking:
[12/19/21 22:53:12] INFO	1. Sex_factor (27.435810)
[12/19/21 22:53:12] INFO	2. Pclass (8.633795)
[12/19/21 22:53:12] INFO	3. Age (8.288626)
[12/19/21 22:53:12] INFO	4. Fare (5.656212)
[12/19/21 22:53:12] INFO	5. Ticket_factor (5.390971)
[12/19/21 22:53:12] INFO	6. sum (5.276090)
[12/19/21 22:53:12] INFO	7. std (5.157690)
[12/19/21 22:53:12] INFO	8. mean (4.185610)
[12/19/21 22:53:12] INFO	9. count_2 (3.243407)
[12/19/21 22:53:12] INFO	10. Name_factor (3.196354)
[12/19/21 22:53:12] INFO	11. var (3.052507)
[12/19/21 22:53:12] INFO	12. Embarked (2.600707)
[12/19/21 22:53:12] INFO	13. count_1 (2.373077)
[12/19/21 22:53:12] INFO	14. cluster_21 (2.181554)
[12/19/21 22:53:12] INFO	15. cluster_30 (2.048390)
[12/19/21 22:53:12] INFO	16. cluster_12 (1.945388)
[12/19/21 22:53:12] INFO	17. cluster_9 (1.747934)
[12/19/21 22:53:12] INFO	18. nan_count (1.645297)
[12/19/21 22:53:12] INFO	19. cluster_6 (1.572467)
[12/19/21 22:53:12] INFO	20. Cabin_factor (1.432113)
[12/19/21 22:53:12] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:53:12] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:53:12] INFO	Feature Ranking:
[12/19/21 22:53:12] INFO	1. Fare (258.000000)
[12/19/21 22:53:12] INFO	2. sum (219.000000)
[12/19/21 22:53:12] INFO	3. std (218.000000)
[12/19/21 22:53:12] INFO	4. Age (202.000000)
[12/19/21 22:53:12] INFO	5. Ticket_factor (184.000000)
[12/19/21 22:53:12] INFO	6. Name_factor (172.000000)
[12/19/21 22:53:12] INFO	7. Cabin_factor (45.000000)
[12/19/21 22:53:12] INFO	8. Sex_factor (39.000000)
[12/19/21 22:53:12] INFO	9. Pclass (37.000000)
[12/19/21 22:53:12] INFO	10. cluster_18 (35.000000)
[12/19/21 22:53:12] INFO	11. cluster_30 (33.000000)
[12/19/21 22:53:12] INFO	12. cluster_27 (33.000000)
[12/19/21 22:53:12] INFO	13. Embarked (28.000000)
[12/19/21 22:53:12] INFO	14. cluster_15 (27.000000)
[12/19/21 22:53:12] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:53:13] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:53:13] INFO	Feature Ranking:
[12/19/21 22:53:13] INFO	1. Sex_factor (1.000000)
[12/19/21 22:53:13] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:53:13] INFO	================================================================================
[12/19/21 22:53:13] INFO	Saving Model Predictor
[12/19/21 22:53:13] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:53:13] INFO	Saving Feature Map
[12/19/21 22:53:13] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:53:13] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:53:13] INFO	Saving Predictions
[12/19/21 22:53:13] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:53:13] INFO	Saving Probabilities
[12/19/21 22:53:13] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:53:13] INFO	Saving Ranked Predictions
[12/19/21 22:53:13] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:53:13] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:53:13] INFO	********************************************************************************
[12/19/21 22:53:13] INFO	AlphaPy End
[12/19/21 22:53:13] INFO	********************************************************************************
[12/19/21 22:54:03] INFO	********************************************************************************
[12/19/21 22:54:03] INFO	AlphaPy Start
[12/19/21 22:54:03] INFO	********************************************************************************
[12/19/21 22:54:03] INFO	Model Configuration
[12/19/21 22:54:03] INFO	No transforms Found
[12/19/21 22:54:03] INFO	MODEL PARAMETERS:
[12/19/21 22:54:03] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/19/21 22:54:03] INFO	calibration       = False
[12/19/21 22:54:03] INFO	cal_type          = sigmoid
[12/19/21 22:54:03] INFO	calibration_plot  = False
[12/19/21 22:54:03] INFO	clustering        = True
[12/19/21 22:54:03] INFO	cluster_inc       = 3
[12/19/21 22:54:03] INFO	cluster_max       = 30
[12/19/21 22:54:03] INFO	cluster_min       = 3
[12/19/21 22:54:03] INFO	confusion_matrix  = True
[12/19/21 22:54:03] INFO	counts            = True
[12/19/21 22:54:03] INFO	cv_folds          = 3
[12/19/21 22:54:03] INFO	directory         = .
[12/19/21 22:54:03] INFO	extension         = csv
[12/19/21 22:54:03] INFO	drop              = ['PassengerId']
[12/19/21 22:54:03] INFO	encoder           = <Encoders.target: 14>
[12/19/21 22:54:03] INFO	esr               = 20
[12/19/21 22:54:03] INFO	factors           = ['Embarked']
[12/19/21 22:54:03] INFO	features [X]      = *
[12/19/21 22:54:03] INFO	feature_selection = False
[12/19/21 22:54:03] INFO	fs_percentage     = 50
[12/19/21 22:54:03] INFO	fs_score_func     = <function f_classif at 0x7fa2d26abee0>
[12/19/21 22:54:03] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/19/21 22:54:03] INFO	grid_search       = True
[12/19/21 22:54:03] INFO	gs_iters          = 50
[12/19/21 22:54:03] INFO	gs_random         = True
[12/19/21 22:54:03] INFO	gs_sample         = False
[12/19/21 22:54:03] INFO	gs_sample_pct     = 0.200000
[12/19/21 22:54:03] INFO	importances       = True
[12/19/21 22:54:03] INFO	interactions      = False
[12/19/21 22:54:03] INFO	isomap            = False
[12/19/21 22:54:03] INFO	iso_components    = 2
[12/19/21 22:54:03] INFO	iso_neighbors     = 5
[12/19/21 22:54:03] INFO	isample_pct       = 10
[12/19/21 22:54:03] INFO	leaders           = []
[12/19/21 22:54:03] INFO	learning_curve    = True
[12/19/21 22:54:03] INFO	logtransform      = False
[12/19/21 22:54:03] INFO	lv_remove         = True
[12/19/21 22:54:03] INFO	lv_threshold      = 0.100000
[12/19/21 22:54:03] INFO	model_type        = <ModelType.classification: 1>
[12/19/21 22:54:03] INFO	n_estimators      = 51
[12/19/21 22:54:03] INFO	n_jobs            = -1
[12/19/21 22:54:03] INFO	ngrams_max        = 2
[12/19/21 22:54:03] INFO	numpy             = True
[12/19/21 22:54:03] INFO	pca               = False
[12/19/21 22:54:03] INFO	pca_inc           = 1
[12/19/21 22:54:03] INFO	pca_max           = 10
[12/19/21 22:54:03] INFO	pca_min           = 2
[12/19/21 22:54:03] INFO	pca_whiten        = False
[12/19/21 22:54:03] INFO	poly_degree       = 2
[12/19/21 22:54:03] INFO	pvalue_level      = 0.010000
[12/19/21 22:54:03] INFO	rfe               = True
[12/19/21 22:54:03] INFO	rfe_step          = 3
[12/19/21 22:54:03] INFO	roc_curve         = True
[12/19/21 22:54:03] INFO	rounding          = 2
[12/19/21 22:54:03] INFO	sampling          = False
[12/19/21 22:54:03] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/19/21 22:54:03] INFO	sampling_ratio    = 1.000000
[12/19/21 22:54:03] INFO	scaler_option     = True
[12/19/21 22:54:03] INFO	scaler_type       = <Scalers.standard: 2>
[12/19/21 22:54:03] INFO	scipy             = False
[12/19/21 22:54:03] INFO	scorer            = roc_auc
[12/19/21 22:54:03] INFO	seed              = 42
[12/19/21 22:54:03] INFO	sentinel          = -1
[12/19/21 22:54:03] INFO	separator         = ,
[12/19/21 22:54:03] INFO	shuffle           = False
[12/19/21 22:54:03] INFO	split             = 0.400000
[12/19/21 22:54:03] INFO	submission_file   = gender_submission
[12/19/21 22:54:03] INFO	submit_probas     = False
[12/19/21 22:54:03] INFO	target [y]        = Survived
[12/19/21 22:54:03] INFO	target_value      = 1
[12/19/21 22:54:03] INFO	transforms        = None
[12/19/21 22:54:03] INFO	tsne              = False
[12/19/21 22:54:03] INFO	tsne_components   = 2
[12/19/21 22:54:03] INFO	tsne_learn_rate   = 1000.000000
[12/19/21 22:54:03] INFO	tsne_perplexity   = 30.000000
[12/19/21 22:54:03] INFO	vectorize         = False
[12/19/21 22:54:03] INFO	verbosity         = 0
[12/19/21 22:54:03] INFO	Creating Model
[12/19/21 22:54:03] INFO	Calling Pipeline
[12/19/21 22:54:03] INFO	Training Pipeline
[12/19/21 22:54:03] INFO	Loading Data
[12/19/21 22:54:03] INFO	Loading data from ./input/train.csv
[12/19/21 22:54:03] INFO	Found target Survived in data frame
[12/19/21 22:54:03] INFO	Labels (y) found for Partition.train
[12/19/21 22:54:03] INFO	Loading Data
[12/19/21 22:54:03] INFO	Loading data from ./input/test.csv
[12/19/21 22:54:03] INFO	Target Survived not found in Partition.test
[12/19/21 22:54:03] INFO	Saving New Features in Model
[12/19/21 22:54:03] INFO	Original Feature Statistics
[12/19/21 22:54:03] INFO	Number of Training Rows    : 891
[12/19/21 22:54:03] INFO	Number of Training Columns : 11
[12/19/21 22:54:03] INFO	Unique Training Values for Survived : [0 1]
[12/19/21 22:54:03] INFO	Unique Training Counts for Survived : [549 342]
[12/19/21 22:54:03] INFO	Number of Testing Rows     : 418
[12/19/21 22:54:03] INFO	Number of Testing Columns  : 11
[12/19/21 22:54:03] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:54:03] INFO	Feature Count     : 11
[12/19/21 22:54:03] INFO	Applying transforms
[12/19/21 22:54:03] INFO	No transforms Specified
[12/19/21 22:54:03] INFO	New Feature Count : 11
[12/19/21 22:54:03] INFO	Dropping Features: ['PassengerId']
[12/19/21 22:54:03] INFO	Original Feature Count : 11
[12/19/21 22:54:03] INFO	Reduced Feature Count  : 10
[12/19/21 22:54:03] INFO	Writing data frame to ./input/train_20211219.csv
[12/19/21 22:54:03] INFO	Writing data frame to ./input/dropped_train_20211219.csv
[12/19/21 22:54:03] INFO	Writing data frame to ./input/test_20211219.csv
[12/19/21 22:54:03] INFO	Writing data frame to ./input/dropped_test_20211219.csv
[12/19/21 22:54:03] INFO	Creating Cross-Tabulations
[12/19/21 22:54:03] INFO	Creating crosstabs for feature Embarked
[12/19/21 22:54:03] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/19/21 22:54:03] INFO	Feature Count     : 10
[12/19/21 22:54:03] INFO	Creating Count Features
[12/19/21 22:54:03] INFO	NA Counts
[12/19/21 22:54:03] INFO	Number Counts
[12/19/21 22:54:03] INFO	New Feature Count : 21
[12/19/21 22:54:03] INFO	Creating Base Features
[12/19/21 22:54:03] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/19/21 22:54:03] INFO	Feature 2: Name => Factorization
[12/19/21 22:54:03] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/19/21 22:54:03] INFO	Feature 3: Sex => Factorization
[12/19/21 22:54:03] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/19/21 22:54:03] INFO	Feature 7: Ticket => Factorization
[12/19/21 22:54:03] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/19/21 22:54:03] INFO	Feature 9: Cabin => Factorization
[12/19/21 22:54:03] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/19/21 22:54:03] INFO	Encoding: Encoders.target
[12/19/21 22:54:03] INFO	Fitting training features for Embarked
[12/19/21 22:54:03] INFO	Transforming testing features for Embarked
[12/19/21 22:54:03] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/19/21 22:54:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/19/21 22:54:03] INFO	New Feature Count : 21
[12/19/21 22:54:03] INFO	Scaling Base Features
[12/19/21 22:54:03] INFO	Creating NumPy Features
[12/19/21 22:54:03] INFO	NumPy Feature: sum
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	NumPy Feature: mean
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	NumPy Feature: std
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	NumPy Feature: var
[12/19/21 22:54:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/19/21 22:54:03] INFO	NumPy Feature Count : 4
[12/19/21 22:54:03] INFO	New Feature Count : 25
[12/19/21 22:54:03] INFO	Creating Clustering Features
[12/19/21 22:54:03] INFO	Cluster Minimum   : 3
[12/19/21 22:54:03] INFO	Cluster Maximum   : 30
[12/19/21 22:54:03] INFO	Cluster Increment : 3
[12/19/21 22:54:03] INFO	k = 3
[12/19/21 22:54:05] INFO	k = 6
[12/19/21 22:54:05] INFO	k = 9
[12/19/21 22:54:05] INFO	k = 12
[12/19/21 22:54:05] INFO	k = 15
[12/19/21 22:54:05] INFO	k = 18
[12/19/21 22:54:05] INFO	k = 21
[12/19/21 22:54:05] INFO	k = 24
[12/19/21 22:54:05] INFO	k = 27
[12/19/21 22:54:05] INFO	k = 30
[12/19/21 22:54:05] INFO	Clustering Feature Count : 10
[12/19/21 22:54:05] INFO	New Feature Count : 35
[12/19/21 22:54:05] INFO	Saving New Features in Model
[12/19/21 22:54:05] INFO	Creating Interactions
[12/19/21 22:54:05] INFO	Initial Feature Count  : 35
[12/19/21 22:54:05] INFO	Skipping Interactions
[12/19/21 22:54:05] INFO	Saving New Features in Model
[12/19/21 22:54:05] INFO	Removing Low-Variance Features
[12/19/21 22:54:05] INFO	Low-Variance Threshold  : 0.10
[12/19/21 22:54:05] INFO	Original Feature Count  : 35
[12/19/21 22:54:05] INFO	Reduced Feature Count   : 35
[12/19/21 22:54:05] INFO	Saving New Features in Model
[12/19/21 22:54:05] INFO	Skipping Shuffling
[12/19/21 22:54:05] INFO	Skipping Sampling
[12/19/21 22:54:05] INFO	Getting All Estimators
[12/19/21 22:54:05] INFO	Algorithm Configuration
[12/19/21 22:54:05] INFO	Selecting Models
[12/19/21 22:54:05] INFO	Algorithm: CATB
[12/19/21 22:54:05] INFO	Fitting Initial Model
[12/19/21 22:54:05] INFO	Cross-Validation
[12/19/21 22:54:07] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/19/21 22:54:07] INFO	Recursive Feature Elimination with CV
[12/19/21 22:54:09] INFO	RFECV took 2.34 seconds for step 3 and 3 folds
[12/19/21 22:54:09] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/19/21 22:54:09] INFO	No grid is defined for grid search
[12/19/21 22:54:09] INFO	Final Model Predictions for CATB
[12/19/21 22:54:09] INFO	Skipping Calibration
[12/19/21 22:54:09] INFO	Making Predictions
[12/19/21 22:54:09] INFO	Predictions Complete
[12/19/21 22:54:09] INFO	Algorithm: LGB
[12/19/21 22:54:09] INFO	Fitting Initial Model
[12/19/21 22:54:09] INFO	Cross-Validation
[12/19/21 22:54:09] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/19/21 22:54:09] INFO	Recursive Feature Elimination with CV
[12/19/21 22:54:12] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[12/19/21 22:54:12] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/19/21 22:54:12] INFO	No grid is defined for grid search
[12/19/21 22:54:12] INFO	Final Model Predictions for LGB
[12/19/21 22:54:12] INFO	Skipping Calibration
[12/19/21 22:54:12] INFO	Making Predictions
[12/19/21 22:54:12] INFO	Predictions Complete
[12/19/21 22:54:12] INFO	Algorithm: XGB
[12/19/21 22:54:12] INFO	Fitting Initial Model
[12/19/21 22:54:12] INFO	Cross-Validation
[12/19/21 22:54:12] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/19/21 22:54:12] INFO	Recursive Feature Elimination with CV
[12/19/21 22:54:15] INFO	RFECV took 2.41 seconds for step 3 and 3 folds
[12/19/21 22:54:15] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/19/21 22:54:15] INFO	Randomized Grid Search
[12/19/21 22:55:26] INFO	Grid Search took 70.99 seconds for 50 candidate parameter settings.
[12/19/21 22:55:26] INFO	Model with rank: 1
[12/19/21 22:55:26] INFO	Mean validation score: 0.872 (std: 0.025)
[12/19/21 22:55:26] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:55:26] INFO	Model with rank: 2
[12/19/21 22:55:26] INFO	Mean validation score: 0.871 (std: 0.024)
[12/19/21 22:55:26] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/19/21 22:55:26] INFO	Model with rank: 3
[12/19/21 22:55:26] INFO	Mean validation score: 0.870 (std: 0.022)
[12/19/21 22:55:26] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/19/21 22:55:26] INFO	Algorithm: XGB, Best Score: 0.8722, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/19/21 22:55:26] INFO	Final Model Predictions for XGB
[12/19/21 22:55:26] INFO	Skipping Calibration
[12/19/21 22:55:26] INFO	Making Predictions
[12/19/21 22:55:26] INFO	Predictions Complete
[12/19/21 22:55:26] INFO	Blending Models
[12/19/21 22:55:26] INFO	Blending Start: 2021-12-19 22:55:26.089947
[12/19/21 22:55:26] INFO	Blending Complete: 0:00:00.005056
[12/19/21 22:55:26] INFO	================================================================================
[12/19/21 22:55:26] INFO	Metrics for: Partition.train
[12/19/21 22:55:26] INFO	--------------------------------------------------------------------------------
[12/19/21 22:55:26] INFO	Algorithm: CATB
[12/19/21 22:55:26] INFO	accuracy: 0.8585858585858586
[12/19/21 22:55:26] INFO	average_precision: 0.9113351686222868
[12/19/21 22:55:26] INFO	balanced_accuracy: 0.8378391333525069
[12/19/21 22:55:26] INFO	brier_score_loss: 0.10043404518351136
[12/19/21 22:55:26] INFO	cohen_kappa: 0.6932572665125658
[12/19/21 22:55:26] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/19/21 22:55:26] INFO	f1: 0.8025078369905956
[12/19/21 22:55:26] INFO	neg_log_loss: 0.3371948718196211
[12/19/21 22:55:26] INFO	precision: 0.8648648648648649
[12/19/21 22:55:26] INFO	recall: 0.7485380116959064
[12/19/21 22:55:26] INFO	roc_auc: 0.9297979313797549
[12/19/21 22:55:26] INFO	--------------------------------------------------------------------------------
[12/19/21 22:55:26] INFO	Algorithm: LGB
[12/19/21 22:55:26] INFO	accuracy: 0.9730639730639731
[12/19/21 22:55:26] INFO	average_precision: 0.9961113207491221
[12/19/21 22:55:26] INFO	balanced_accuracy: 0.9687709711437062
[12/19/21 22:55:26] INFO	brier_score_loss: 0.032809498448974184
[12/19/21 22:55:26] INFO	cohen_kappa: 0.9427387092109702
[12/19/21 22:55:26] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/19/21 22:55:26] INFO	f1: 0.9643916913946586
[12/19/21 22:55:26] INFO	neg_log_loss: 0.1458307566281259
[12/19/21 22:55:26] INFO	precision: 0.9789156626506024
[12/19/21 22:55:26] INFO	recall: 0.9502923976608187
[12/19/21 22:55:26] INFO	roc_auc: 0.9974861257576241
[12/19/21 22:55:26] INFO	--------------------------------------------------------------------------------
[12/19/21 22:55:26] INFO	Algorithm: XGB
[12/19/21 22:55:26] INFO	accuracy: 0.9180695847362514
[12/19/21 22:55:26] INFO	average_precision: 0.9525254872404899
[12/19/21 22:55:26] INFO	balanced_accuracy: 0.9042996836353179
[12/19/21 22:55:26] INFO	brier_score_loss: 0.203858067446208
[12/19/21 22:55:26] INFO	cohen_kappa: 0.8235811058220432
[12/19/21 22:55:26] INFO	confusion_matrix: [[529  20]
 [ 53 289]]
[12/19/21 22:55:26] INFO	f1: 0.8878648233486943
[12/19/21 22:55:26] INFO	neg_log_loss: 0.600339225044957
[12/19/21 22:55:26] INFO	precision: 0.9352750809061489
[12/19/21 22:55:26] INFO	recall: 0.8450292397660819
[12/19/21 22:55:26] INFO	roc_auc: 0.9590350344592506
[12/19/21 22:55:26] INFO	================================================================================
[12/19/21 22:55:26] INFO	Metrics for: Partition.test
[12/19/21 22:55:26] INFO	No labels for generating Partition.test metrics
[12/19/21 22:55:26] INFO	================================================================================
[12/19/21 22:55:26] INFO	Selecting Best Model
[12/19/21 22:55:26] INFO	Scoring for: Partition.train
[12/19/21 22:55:26] INFO	Best Model Selection Start: 2021-12-19 22:55:26.115632
[12/19/21 22:55:26] INFO	Scoring CATB Model
[12/19/21 22:55:26] INFO	Scoring LGB Model
[12/19/21 22:55:26] INFO	Scoring XGB Model
[12/19/21 22:55:26] INFO	Scoring BLEND Model
[12/19/21 22:55:26] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[12/19/21 22:55:26] INFO	Best Model Selection Complete: 0:00:00.000232
[12/19/21 22:55:26] INFO	================================================================================
[12/19/21 22:55:26] INFO	Generating Plots for partition: train
[12/19/21 22:55:26] INFO	Generating Calibration Plot
[12/19/21 22:55:26] INFO	Calibration for Algorithm: CATB
[12/19/21 22:55:26] INFO	Calibration for Algorithm: LGB
[12/19/21 22:55:26] INFO	Calibration for Algorithm: XGB
[12/19/21 22:55:26] INFO	Writing plot to ./plots/calibration_train.png
[12/19/21 22:55:26] INFO	Generating Confusion Matrices
[12/19/21 22:55:26] INFO	Confusion Matrix for Algorithm: CATB
[12/19/21 22:55:26] INFO	Confusion Matrix:
[12/19/21 22:55:26] INFO	[[509  40]
 [ 86 256]]
[12/19/21 22:55:26] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/19/21 22:55:26] INFO	Confusion Matrix for Algorithm: LGB
[12/19/21 22:55:26] INFO	Confusion Matrix:
[12/19/21 22:55:26] INFO	[[542   7]
 [ 17 325]]
[12/19/21 22:55:26] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/19/21 22:55:26] INFO	Confusion Matrix for Algorithm: XGB
[12/19/21 22:55:26] INFO	Confusion Matrix:
[12/19/21 22:55:26] INFO	[[529  20]
 [ 53 289]]
[12/19/21 22:55:26] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/19/21 22:55:26] INFO	Generating ROC Curves
[12/19/21 22:55:26] INFO	ROC Curve for Algorithm: CATB
[12/19/21 22:55:26] INFO	ROC Curve for Algorithm: LGB
[12/19/21 22:55:26] INFO	ROC Curve for Algorithm: XGB
[12/19/21 22:55:26] INFO	Writing plot to ./plots/roc_curve_train.png
[12/19/21 22:55:26] INFO	Generating Learning Curves
[12/19/21 22:55:26] INFO	Algorithm Configuration
[12/19/21 22:55:26] INFO	Learning Curve for Algorithm: CATB
[12/19/21 22:55:27] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/19/21 22:55:27] INFO	Learning Curve for Algorithm: LGB
[12/19/21 22:55:28] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/19/21 22:55:29] INFO	Learning Curve for Algorithm: XGB
[12/19/21 22:55:29] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/19/21 22:55:29] INFO	Generating Feature Importance Plots
[12/19/21 22:55:29] INFO	Feature Importances for Algorithm: CATB
[12/19/21 22:55:29] INFO	Feature Ranking:
[12/19/21 22:55:29] INFO	1. Sex_factor (45.178104)
[12/19/21 22:55:29] INFO	2. Pclass (13.721171)
[12/19/21 22:55:29] INFO	3. Age (6.651788)
[12/19/21 22:55:29] INFO	4. Fare (4.529770)
[12/19/21 22:55:29] INFO	5. var (3.586590)
[12/19/21 22:55:29] INFO	6. std (3.492385)
[12/19/21 22:55:29] INFO	7. Ticket_factor (3.315046)
[12/19/21 22:55:29] INFO	8. cluster_30 (2.831587)
[12/19/21 22:55:29] INFO	9. mean (2.733389)
[12/19/21 22:55:29] INFO	10. Name_factor (2.586310)
[12/19/21 22:55:29] INFO	11. Cabin_factor (2.101764)
[12/19/21 22:55:29] INFO	12. Embarked (2.086410)
[12/19/21 22:55:29] INFO	13. SibSp (2.085405)
[12/19/21 22:55:29] INFO	14. cluster_12 (1.876782)
[12/19/21 22:55:29] INFO	15. cluster_24 (1.263144)
[12/19/21 22:55:29] INFO	16. count_2 (1.004409)
[12/19/21 22:55:29] INFO	17. sum (0.955946)
[12/19/21 22:55:29] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/19/21 22:55:29] INFO	Feature Importances for Algorithm: LGB
[12/19/21 22:55:29] INFO	Feature Ranking:
[12/19/21 22:55:29] INFO	1. Fare (256.000000)
[12/19/21 22:55:29] INFO	2. sum (241.000000)
[12/19/21 22:55:29] INFO	3. Age (232.000000)
[12/19/21 22:55:29] INFO	4. std (201.000000)
[12/19/21 22:55:29] INFO	5. Ticket_factor (199.000000)
[12/19/21 22:55:29] INFO	6. Name_factor (175.000000)
[12/19/21 22:55:29] INFO	7. cluster_30 (53.000000)
[12/19/21 22:55:29] INFO	8. cluster_27 (46.000000)
[12/19/21 22:55:29] INFO	9. Sex_factor (43.000000)
[12/19/21 22:55:29] INFO	10. Pclass (43.000000)
[12/19/21 22:55:29] INFO	11. Cabin_factor (41.000000)
[12/19/21 22:55:29] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/19/21 22:55:29] INFO	Feature Importances for Algorithm: XGB
[12/19/21 22:55:29] INFO	Feature Ranking:
[12/19/21 22:55:29] INFO	1. Sex_factor (0.424644)
[12/19/21 22:55:29] INFO	2. Pclass (0.127452)
[12/19/21 22:55:29] INFO	3. Cabin_factor (0.081307)
[12/19/21 22:55:29] INFO	4. Age (0.051007)
[12/19/21 22:55:29] INFO	5. SibSp (0.049620)
[12/19/21 22:55:29] INFO	6. count_1 (0.046373)
[12/19/21 22:55:29] INFO	7. Embarked (0.046225)
[12/19/21 22:55:29] INFO	8. std (0.036262)
[12/19/21 22:55:29] INFO	9. cluster_30 (0.036076)
[12/19/21 22:55:29] INFO	10. Fare (0.032410)
[12/19/21 22:55:29] INFO	11. cluster_24 (0.021187)
[12/19/21 22:55:29] INFO	12. Name_factor (0.019312)
[12/19/21 22:55:29] INFO	13. sum (0.017784)
[12/19/21 22:55:29] INFO	14. cluster_15 (0.010340)
[12/19/21 22:55:29] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/19/21 22:55:30] INFO	================================================================================
[12/19/21 22:55:30] INFO	Saving Model Predictor
[12/19/21 22:55:30] INFO	Writing model predictor to ./model/model_20211219.pkl
[12/19/21 22:55:30] INFO	Saving Feature Map
[12/19/21 22:55:30] INFO	Writing feature map to ./model/feature_map_20211219.pkl
[12/19/21 22:55:30] INFO	Loading data from ./input/test_20211219.csv
[12/19/21 22:55:30] INFO	Saving Predictions
[12/19/21 22:55:30] INFO	Writing data frame to ./output/predictions_20211219.csv
[12/19/21 22:55:30] INFO	Saving Probabilities
[12/19/21 22:55:30] INFO	Writing data frame to ./output/probabilities_20211219.csv
[12/19/21 22:55:30] INFO	Saving Ranked Predictions
[12/19/21 22:55:30] INFO	Writing data frame to ./output/rankings_20211219.csv
[12/19/21 22:55:30] INFO	Saving Submission to ./output/submission_20211219.csv
[12/19/21 22:55:30] INFO	********************************************************************************
[12/19/21 22:55:30] INFO	AlphaPy End
[12/19/21 22:55:30] INFO	********************************************************************************
[12/26/21 13:58:45] INFO	********************************************************************************
[12/26/21 13:58:45] INFO	AlphaPy Start
[12/26/21 13:58:45] INFO	********************************************************************************
[12/26/21 13:58:45] INFO	Model Configuration
[12/26/21 13:58:45] INFO	No transforms Found
[12/26/21 13:58:45] INFO	MODEL PARAMETERS:
[12/26/21 13:58:45] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 13:58:45] INFO	calibration       = False
[12/26/21 13:58:45] INFO	cal_type          = sigmoid
[12/26/21 13:58:45] INFO	calibration_plot  = False
[12/26/21 13:58:45] INFO	clustering        = True
[12/26/21 13:58:45] INFO	cluster_inc       = 3
[12/26/21 13:58:45] INFO	cluster_max       = 30
[12/26/21 13:58:45] INFO	cluster_min       = 3
[12/26/21 13:58:45] INFO	confusion_matrix  = True
[12/26/21 13:58:45] INFO	counts            = True
[12/26/21 13:58:45] INFO	cv_folds          = 3
[12/26/21 13:58:45] INFO	directory         = .
[12/26/21 13:58:45] INFO	extension         = csv
[12/26/21 13:58:45] INFO	drop              = ['PassengerId']
[12/26/21 13:58:45] INFO	encoder           = <Encoders.target: 14>
[12/26/21 13:58:45] INFO	esr               = 20
[12/26/21 13:58:45] INFO	factors           = ['Embarked']
[12/26/21 13:58:45] INFO	features [X]      = *
[12/26/21 13:58:45] INFO	feature_selection = False
[12/26/21 13:58:45] INFO	fs_percentage     = 50
[12/26/21 13:58:45] INFO	fs_score_func     = <function f_classif at 0x7f9921bebee0>
[12/26/21 13:58:45] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 13:58:45] INFO	grid_search       = True
[12/26/21 13:58:45] INFO	gs_iters          = 50
[12/26/21 13:58:45] INFO	gs_random         = True
[12/26/21 13:58:45] INFO	gs_sample         = False
[12/26/21 13:58:45] INFO	gs_sample_pct     = 0.200000
[12/26/21 13:58:45] INFO	importances       = True
[12/26/21 13:58:45] INFO	interactions      = False
[12/26/21 13:58:45] INFO	isomap            = False
[12/26/21 13:58:45] INFO	iso_components    = 2
[12/26/21 13:58:45] INFO	iso_neighbors     = 5
[12/26/21 13:58:45] INFO	isample_pct       = 10
[12/26/21 13:58:45] INFO	leaders           = []
[12/26/21 13:58:45] INFO	learning_curve    = True
[12/26/21 13:58:45] INFO	logtransform      = False
[12/26/21 13:58:45] INFO	lv_remove         = True
[12/26/21 13:58:45] INFO	lv_threshold      = 0.100000
[12/26/21 13:58:45] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 13:58:45] INFO	n_estimators      = 51
[12/26/21 13:58:45] INFO	n_jobs            = -1
[12/26/21 13:58:45] INFO	ngrams_max        = 2
[12/26/21 13:58:45] INFO	numpy             = True
[12/26/21 13:58:45] INFO	pca               = False
[12/26/21 13:58:45] INFO	pca_inc           = 1
[12/26/21 13:58:45] INFO	pca_max           = 10
[12/26/21 13:58:45] INFO	pca_min           = 2
[12/26/21 13:58:45] INFO	pca_whiten        = False
[12/26/21 13:58:45] INFO	poly_degree       = 2
[12/26/21 13:58:45] INFO	pvalue_level      = 0.010000
[12/26/21 13:58:45] INFO	rfe               = True
[12/26/21 13:58:45] INFO	rfe_step          = 3
[12/26/21 13:58:45] INFO	roc_curve         = True
[12/26/21 13:58:45] INFO	rounding          = 2
[12/26/21 13:58:45] INFO	sampling          = False
[12/26/21 13:58:45] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 13:58:45] INFO	sampling_ratio    = 1.000000
[12/26/21 13:58:45] INFO	scaler_option     = True
[12/26/21 13:58:45] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 13:58:45] INFO	scipy             = False
[12/26/21 13:58:45] INFO	scorer            = roc_auc
[12/26/21 13:58:45] INFO	seed              = 42
[12/26/21 13:58:45] INFO	sentinel          = -1
[12/26/21 13:58:45] INFO	separator         = ,
[12/26/21 13:58:45] INFO	shuffle           = False
[12/26/21 13:58:45] INFO	split             = 0.400000
[12/26/21 13:58:45] INFO	submission_file   = gender_submission
[12/26/21 13:58:45] INFO	submit_probas     = False
[12/26/21 13:58:45] INFO	target [y]        = Survived
[12/26/21 13:58:45] INFO	target_value      = 1
[12/26/21 13:58:45] INFO	transforms        = None
[12/26/21 13:58:45] INFO	tsne              = False
[12/26/21 13:58:45] INFO	tsne_components   = 2
[12/26/21 13:58:45] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 13:58:45] INFO	tsne_perplexity   = 30.000000
[12/26/21 13:58:45] INFO	vectorize         = False
[12/26/21 13:58:45] INFO	verbosity         = 0
[12/26/21 13:58:45] INFO	Creating Model
[12/26/21 13:58:45] INFO	Calling Pipeline
[12/26/21 13:58:45] INFO	Training Pipeline
[12/26/21 13:58:45] INFO	Loading Data
[12/26/21 13:58:45] INFO	Loading data from ./input/train.csv
[12/26/21 13:58:45] INFO	Found target Survived in data frame
[12/26/21 13:58:45] INFO	Labels (y) found for Partition.train
[12/26/21 13:58:45] INFO	Loading Data
[12/26/21 13:58:45] INFO	Loading data from ./input/test.csv
[12/26/21 13:58:45] INFO	Target Survived not found in Partition.test
[12/26/21 13:58:45] INFO	Saving New Features in Model
[12/26/21 13:58:45] INFO	Original Feature Statistics
[12/26/21 13:58:45] INFO	Number of Training Rows    : 891
[12/26/21 13:58:45] INFO	Number of Training Columns : 11
[12/26/21 13:58:45] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 13:58:45] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 13:58:45] INFO	Number of Testing Rows     : 418
[12/26/21 13:58:45] INFO	Number of Testing Columns  : 11
[12/26/21 13:58:45] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 13:58:45] INFO	Feature Count     : 11
[12/26/21 13:58:45] INFO	Applying transforms
[12/26/21 13:58:45] INFO	No transforms Specified
[12/26/21 13:58:45] INFO	New Feature Count : 11
[12/26/21 13:58:45] INFO	Dropping Features: ['PassengerId']
[12/26/21 13:58:45] INFO	Original Feature Count : 11
[12/26/21 13:58:45] INFO	Reduced Feature Count  : 10
[12/26/21 13:58:45] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 13:58:45] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 13:58:45] INFO	Creating Cross-Tabulations
[12/26/21 13:58:45] INFO	Creating crosstabs for feature Embarked
[12/26/21 13:58:45] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 13:58:45] INFO	Feature Count     : 10
[12/26/21 13:58:45] INFO	Creating Count Features
[12/26/21 13:58:45] INFO	NA Counts
[12/26/21 13:58:45] INFO	Number Counts
[12/26/21 13:58:45] INFO	New Feature Count : 21
[12/26/21 13:58:45] INFO	Creating Base Features
[12/26/21 13:58:45] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 13:58:45] INFO	Feature 2: Name => Factorization
[12/26/21 13:58:45] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 13:58:45] INFO	Feature 3: Sex => Factorization
[12/26/21 13:58:45] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 13:58:45] INFO	Feature 7: Ticket => Factorization
[12/26/21 13:58:45] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 13:58:45] INFO	Feature 9: Cabin => Factorization
[12/26/21 13:58:45] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 13:58:45] INFO	Encoding: Encoders.target
[12/26/21 13:58:45] INFO	Fitting training features for Embarked
[12/26/21 13:58:45] INFO	Transforming testing features for Embarked
[12/26/21 13:58:45] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 13:58:45] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 13:58:45] INFO	New Feature Count : 21
[12/26/21 13:58:45] INFO	Scaling Base Features
[12/26/21 13:58:45] INFO	Creating NumPy Features
[12/26/21 13:58:45] INFO	NumPy Feature: sum
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	NumPy Feature: mean
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	NumPy Feature: std
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	NumPy Feature: var
[12/26/21 13:58:45] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 13:58:45] INFO	NumPy Feature Count : 4
[12/26/21 13:58:45] INFO	New Feature Count : 25
[12/26/21 13:58:45] INFO	Creating Clustering Features
[12/26/21 13:58:45] INFO	Cluster Minimum   : 3
[12/26/21 13:58:45] INFO	Cluster Maximum   : 30
[12/26/21 13:58:45] INFO	Cluster Increment : 3
[12/26/21 13:58:45] INFO	k = 3
[12/26/21 13:58:47] INFO	k = 6
[12/26/21 13:58:47] INFO	k = 9
[12/26/21 13:58:47] INFO	k = 12
[12/26/21 13:58:47] INFO	k = 15
[12/26/21 13:58:47] INFO	k = 18
[12/26/21 13:58:47] INFO	k = 21
[12/26/21 13:58:47] INFO	k = 24
[12/26/21 13:58:47] INFO	k = 27
[12/26/21 13:58:47] INFO	k = 30
[12/26/21 13:58:47] INFO	Clustering Feature Count : 10
[12/26/21 13:58:47] INFO	New Feature Count : 35
[12/26/21 13:58:47] INFO	Saving New Features in Model
[12/26/21 13:58:47] INFO	Creating Interactions
[12/26/21 13:58:47] INFO	Initial Feature Count  : 35
[12/26/21 13:58:47] INFO	Skipping Interactions
[12/26/21 13:58:47] INFO	Saving New Features in Model
[12/26/21 13:58:47] INFO	Removing Low-Variance Features
[12/26/21 13:58:47] INFO	Low-Variance Threshold  : 0.10
[12/26/21 13:58:47] INFO	Original Feature Count  : 35
[12/26/21 13:58:47] INFO	Reduced Feature Count   : 35
[12/26/21 13:58:47] INFO	Saving New Features in Model
[12/26/21 13:58:47] INFO	Skipping Shuffling
[12/26/21 13:58:47] INFO	Skipping Sampling
[12/26/21 13:58:47] INFO	Getting All Estimators
[12/26/21 13:58:47] INFO	Algorithm Configuration
[12/26/21 13:58:48] INFO	Selecting Models
[12/26/21 13:58:48] INFO	Algorithm: CATB
[12/26/21 13:58:48] INFO	Fitting Initial Model
[12/26/21 13:58:48] INFO	Cross-Validation
[12/26/21 13:58:50] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 13:58:50] INFO	Recursive Feature Elimination with CV
[12/26/21 13:58:52] INFO	RFECV took 2.58 seconds for step 3 and 3 folds
[12/26/21 13:58:52] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 13:58:52] INFO	No grid is defined for grid search
[12/26/21 13:58:52] INFO	Final Model Predictions for CATB
[12/26/21 13:58:52] INFO	Skipping Calibration
[12/26/21 13:58:52] INFO	Making Predictions
[12/26/21 13:58:52] INFO	Predictions Complete
[12/26/21 13:58:52] INFO	Algorithm: LGB
[12/26/21 13:58:52] INFO	Fitting Initial Model
[12/26/21 13:58:52] INFO	Cross-Validation
[12/26/21 13:58:53] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 13:58:53] INFO	Recursive Feature Elimination with CV
[12/26/21 13:58:56] INFO	RFECV took 3.00 seconds for step 3 and 3 folds
[12/26/21 13:58:56] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 13:58:56] INFO	No grid is defined for grid search
[12/26/21 13:58:56] INFO	Final Model Predictions for LGB
[12/26/21 13:58:56] INFO	Skipping Calibration
[12/26/21 13:58:56] INFO	Making Predictions
[12/26/21 13:58:56] INFO	Predictions Complete
[12/26/21 13:58:56] INFO	Algorithm: XGB
[12/26/21 13:58:56] INFO	Fitting Initial Model
[12/26/21 13:58:56] INFO	Cross-Validation
[12/26/21 13:58:57] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 13:58:57] INFO	Recursive Feature Elimination with CV
[12/26/21 13:58:59] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[12/26/21 13:58:59] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 13:58:59] INFO	Randomized Grid Search
[12/26/21 13:59:55] INFO	Grid Search took 56.27 seconds for 50 candidate parameter settings.
[12/26/21 13:59:55] INFO	Model with rank: 1
[12/26/21 13:59:55] INFO	Mean validation score: 0.870 (std: 0.028)
[12/26/21 13:59:55] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 13:59:55] INFO	Model with rank: 2
[12/26/21 13:59:55] INFO	Mean validation score: 0.870 (std: 0.023)
[12/26/21 13:59:55] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/26/21 13:59:55] INFO	Model with rank: 3
[12/26/21 13:59:55] INFO	Mean validation score: 0.870 (std: 0.020)
[12/26/21 13:59:55] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 13:59:55] INFO	Algorithm: XGB, Best Score: 0.8700, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 13:59:55] INFO	Final Model Predictions for XGB
[12/26/21 13:59:55] INFO	Skipping Calibration
[12/26/21 13:59:55] INFO	Making Predictions
[12/26/21 13:59:55] INFO	Predictions Complete
[12/26/21 13:59:55] INFO	Blending Models
[12/26/21 13:59:55] INFO	Blending Start: 2021-12-26 13:59:55.795435
[12/26/21 13:59:55] INFO	Blending Complete: 0:00:00.009003
[12/26/21 13:59:55] INFO	================================================================================
[12/26/21 13:59:55] INFO	Metrics for: Partition.train
[12/26/21 13:59:55] INFO	--------------------------------------------------------------------------------
[12/26/21 13:59:55] INFO	Algorithm: CATB
[12/26/21 13:59:55] INFO	accuracy: 0.8585858585858586
[12/26/21 13:59:55] INFO	average_precision: 0.9113351686222868
[12/26/21 13:59:55] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 13:59:55] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 13:59:55] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 13:59:55] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 13:59:55] INFO	f1: 0.8025078369905956
[12/26/21 13:59:55] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 13:59:55] INFO	precision: 0.8648648648648649
[12/26/21 13:59:55] INFO	recall: 0.7485380116959064
[12/26/21 13:59:55] INFO	roc_auc: 0.9297979313797549
[12/26/21 13:59:55] INFO	--------------------------------------------------------------------------------
[12/26/21 13:59:55] INFO	Algorithm: LGB
[12/26/21 13:59:55] INFO	accuracy: 0.9730639730639731
[12/26/21 13:59:55] INFO	average_precision: 0.9961113207491221
[12/26/21 13:59:55] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 13:59:55] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 13:59:55] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 13:59:55] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 13:59:55] INFO	f1: 0.9643916913946586
[12/26/21 13:59:55] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 13:59:55] INFO	precision: 0.9789156626506024
[12/26/21 13:59:55] INFO	recall: 0.9502923976608187
[12/26/21 13:59:55] INFO	roc_auc: 0.9974861257576241
[12/26/21 13:59:55] INFO	--------------------------------------------------------------------------------
[12/26/21 13:59:55] INFO	Algorithm: XGB
[12/26/21 13:59:55] INFO	accuracy: 0.9214365881032548
[12/26/21 13:59:55] INFO	average_precision: 0.9633384516933068
[12/26/21 13:59:55] INFO	balanced_accuracy: 0.9064806825807689
[12/26/21 13:59:55] INFO	brier_score_loss: 0.1183821131967162
[12/26/21 13:59:55] INFO	cohen_kappa: 0.8303549571603427
[12/26/21 13:59:55] INFO	confusion_matrix: [[533  16]
 [ 54 288]]
[12/26/21 13:59:55] INFO	f1: 0.8916408668730651
[12/26/21 13:59:55] INFO	neg_log_loss: 0.4121659088181593
[12/26/21 13:59:55] INFO	precision: 0.9473684210526315
[12/26/21 13:59:55] INFO	recall: 0.8421052631578947
[12/26/21 13:59:55] INFO	roc_auc: 0.9701157873432823
[12/26/21 13:59:55] INFO	================================================================================
[12/26/21 13:59:55] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 13:59:55] INFO	Best Model Selection Start: 2021-12-26 13:59:55.828081
[12/26/21 13:59:55] INFO	Scoring CATB Model
[12/26/21 13:59:55] INFO	Scoring LGB Model
[12/26/21 13:59:55] INFO	Scoring XGB Model
[12/26/21 13:59:55] INFO	Scoring BLEND Model
[12/26/21 13:59:55] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 13:59:55] INFO	Best Model Selection Complete: 0:00:00.000203
[12/26/21 13:59:55] INFO	================================================================================
[12/26/21 13:59:55] INFO	Generating Plots for partition: train
[12/26/21 13:59:55] INFO	Generating Calibration Plot
[12/26/21 13:59:55] INFO	Calibration for Algorithm: CATB
[12/26/21 13:59:55] INFO	Calibration for Algorithm: LGB
[12/26/21 13:59:55] INFO	Calibration for Algorithm: XGB
[12/26/21 13:59:55] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 13:59:56] INFO	Generating Confusion Matrices
[12/26/21 13:59:56] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 13:59:56] INFO	Confusion Matrix:
[12/26/21 13:59:56] INFO	[[509  40]
 [ 86 256]]
[12/26/21 13:59:56] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 13:59:56] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 13:59:56] INFO	Confusion Matrix:
[12/26/21 13:59:56] INFO	[[542   7]
 [ 17 325]]
[12/26/21 13:59:56] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 13:59:56] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 13:59:56] INFO	Confusion Matrix:
[12/26/21 13:59:56] INFO	[[533  16]
 [ 54 288]]
[12/26/21 13:59:56] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 13:59:56] INFO	Generating ROC Curves
[12/26/21 13:59:56] INFO	ROC Curve for Algorithm: CATB
[12/26/21 13:59:56] INFO	ROC Curve for Algorithm: LGB
[12/26/21 13:59:56] INFO	ROC Curve for Algorithm: XGB
[12/26/21 13:59:56] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 13:59:56] INFO	Generating Learning Curves
[12/26/21 13:59:56] INFO	Algorithm Configuration
[12/26/21 13:59:56] INFO	Learning Curve for Algorithm: CATB
[12/26/21 13:59:56] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 13:59:56] INFO	Learning Curve for Algorithm: LGB
[12/26/21 13:59:58] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 13:59:58] INFO	Learning Curve for Algorithm: XGB
[12/26/21 13:59:59] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 13:59:59] INFO	Generating Feature Importance Plots
[12/26/21 13:59:59] INFO	Feature Importances for Algorithm: CATB
[12/26/21 13:59:59] INFO	Feature Ranking:
[12/26/21 13:59:59] INFO	1. Sex_factor (45.178104)
[12/26/21 13:59:59] INFO	2. Pclass (13.721171)
[12/26/21 13:59:59] INFO	3. Age (6.651788)
[12/26/21 13:59:59] INFO	4. Fare (4.529770)
[12/26/21 13:59:59] INFO	5. var (3.586590)
[12/26/21 13:59:59] INFO	6. std (3.492385)
[12/26/21 13:59:59] INFO	7. Ticket_factor (3.315046)
[12/26/21 13:59:59] INFO	8. cluster_30 (2.831587)
[12/26/21 13:59:59] INFO	9. mean (2.733389)
[12/26/21 13:59:59] INFO	10. Name_factor (2.586310)
[12/26/21 13:59:59] INFO	11. Cabin_factor (2.101764)
[12/26/21 13:59:59] INFO	12. Embarked (2.086410)
[12/26/21 13:59:59] INFO	13. SibSp (2.085405)
[12/26/21 13:59:59] INFO	14. cluster_12 (1.876782)
[12/26/21 13:59:59] INFO	15. cluster_24 (1.263144)
[12/26/21 13:59:59] INFO	16. count_2 (1.004409)
[12/26/21 13:59:59] INFO	17. sum (0.955946)
[12/26/21 13:59:59] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 13:59:59] INFO	Feature Importances for Algorithm: LGB
[12/26/21 13:59:59] INFO	Feature Ranking:
[12/26/21 13:59:59] INFO	1. Fare (256.000000)
[12/26/21 13:59:59] INFO	2. sum (241.000000)
[12/26/21 13:59:59] INFO	3. Age (232.000000)
[12/26/21 13:59:59] INFO	4. std (201.000000)
[12/26/21 13:59:59] INFO	5. Ticket_factor (199.000000)
[12/26/21 13:59:59] INFO	6. Name_factor (175.000000)
[12/26/21 13:59:59] INFO	7. cluster_30 (53.000000)
[12/26/21 13:59:59] INFO	8. cluster_27 (46.000000)
[12/26/21 13:59:59] INFO	9. Sex_factor (43.000000)
[12/26/21 13:59:59] INFO	10. Pclass (43.000000)
[12/26/21 13:59:59] INFO	11. Cabin_factor (41.000000)
[12/26/21 13:59:59] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 13:59:59] INFO	Feature Importances for Algorithm: XGB
[12/26/21 13:59:59] INFO	Feature Ranking:
[12/26/21 13:59:59] INFO	1. Sex_factor (0.424644)
[12/26/21 13:59:59] INFO	2. Pclass (0.127452)
[12/26/21 13:59:59] INFO	3. Cabin_factor (0.081307)
[12/26/21 13:59:59] INFO	4. Age (0.051007)
[12/26/21 13:59:59] INFO	5. SibSp (0.049620)
[12/26/21 13:59:59] INFO	6. count_1 (0.046373)
[12/26/21 13:59:59] INFO	7. Embarked (0.046225)
[12/26/21 13:59:59] INFO	8. std (0.036262)
[12/26/21 13:59:59] INFO	9. cluster_30 (0.036076)
[12/26/21 13:59:59] INFO	10. Fare (0.032410)
[12/26/21 13:59:59] INFO	11. cluster_24 (0.021187)
[12/26/21 13:59:59] INFO	12. Name_factor (0.019312)
[12/26/21 13:59:59] INFO	13. sum (0.017784)
[12/26/21 13:59:59] INFO	14. cluster_15 (0.010340)
[12/26/21 13:59:59] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 13:59:59] INFO	================================================================================
[12/26/21 13:59:59] INFO	Saving Model Predictor
[12/26/21 13:59:59] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 13:59:59] INFO	Saving Feature Map
[12/26/21 13:59:59] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 13:59:59] INFO	Loading data from ./input/train_20211226.csv
[12/26/21 13:59:59] INFO	Saving Predictions
[12/26/21 13:59:59] INFO	Saving Probabilities
[12/26/21 13:59:59] INFO	Saving Ranked Predictions
[12/26/21 14:02:06] INFO	********************************************************************************
[12/26/21 14:02:06] INFO	AlphaPy Start
[12/26/21 14:02:06] INFO	********************************************************************************
[12/26/21 14:02:06] INFO	Model Configuration
[12/26/21 14:02:06] INFO	No transforms Found
[12/26/21 14:02:06] INFO	MODEL PARAMETERS:
[12/26/21 14:02:06] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 14:02:06] INFO	calibration       = False
[12/26/21 14:02:06] INFO	cal_type          = sigmoid
[12/26/21 14:02:06] INFO	calibration_plot  = False
[12/26/21 14:02:06] INFO	clustering        = True
[12/26/21 14:02:06] INFO	cluster_inc       = 3
[12/26/21 14:02:06] INFO	cluster_max       = 30
[12/26/21 14:02:06] INFO	cluster_min       = 3
[12/26/21 14:02:06] INFO	confusion_matrix  = True
[12/26/21 14:02:06] INFO	counts            = True
[12/26/21 14:02:06] INFO	cv_folds          = 3
[12/26/21 14:02:06] INFO	directory         = .
[12/26/21 14:02:06] INFO	extension         = csv
[12/26/21 14:02:06] INFO	drop              = ['PassengerId']
[12/26/21 14:02:06] INFO	encoder           = <Encoders.target: 14>
[12/26/21 14:02:06] INFO	esr               = 20
[12/26/21 14:02:06] INFO	factors           = ['Embarked']
[12/26/21 14:02:06] INFO	features [X]      = *
[12/26/21 14:02:06] INFO	feature_selection = False
[12/26/21 14:02:06] INFO	fs_percentage     = 50
[12/26/21 14:02:06] INFO	fs_score_func     = <function f_classif at 0x7fc2895ccee0>
[12/26/21 14:02:06] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 14:02:06] INFO	grid_search       = True
[12/26/21 14:02:06] INFO	gs_iters          = 50
[12/26/21 14:02:06] INFO	gs_random         = True
[12/26/21 14:02:06] INFO	gs_sample         = False
[12/26/21 14:02:06] INFO	gs_sample_pct     = 0.200000
[12/26/21 14:02:06] INFO	importances       = True
[12/26/21 14:02:06] INFO	interactions      = False
[12/26/21 14:02:06] INFO	isomap            = False
[12/26/21 14:02:06] INFO	iso_components    = 2
[12/26/21 14:02:06] INFO	iso_neighbors     = 5
[12/26/21 14:02:06] INFO	isample_pct       = 10
[12/26/21 14:02:06] INFO	leaders           = []
[12/26/21 14:02:06] INFO	learning_curve    = True
[12/26/21 14:02:06] INFO	logtransform      = False
[12/26/21 14:02:06] INFO	lv_remove         = True
[12/26/21 14:02:06] INFO	lv_threshold      = 0.100000
[12/26/21 14:02:06] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 14:02:06] INFO	n_estimators      = 51
[12/26/21 14:02:06] INFO	n_jobs            = -1
[12/26/21 14:02:06] INFO	ngrams_max        = 2
[12/26/21 14:02:06] INFO	numpy             = True
[12/26/21 14:02:06] INFO	pca               = False
[12/26/21 14:02:06] INFO	pca_inc           = 1
[12/26/21 14:02:06] INFO	pca_max           = 10
[12/26/21 14:02:06] INFO	pca_min           = 2
[12/26/21 14:02:06] INFO	pca_whiten        = False
[12/26/21 14:02:06] INFO	poly_degree       = 2
[12/26/21 14:02:06] INFO	pvalue_level      = 0.010000
[12/26/21 14:02:06] INFO	rfe               = True
[12/26/21 14:02:06] INFO	rfe_step          = 3
[12/26/21 14:02:06] INFO	roc_curve         = True
[12/26/21 14:02:06] INFO	rounding          = 2
[12/26/21 14:02:06] INFO	sampling          = False
[12/26/21 14:02:06] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 14:02:06] INFO	sampling_ratio    = 1.000000
[12/26/21 14:02:06] INFO	scaler_option     = True
[12/26/21 14:02:06] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 14:02:06] INFO	scipy             = False
[12/26/21 14:02:06] INFO	scorer            = roc_auc
[12/26/21 14:02:06] INFO	seed              = 42
[12/26/21 14:02:06] INFO	sentinel          = -1
[12/26/21 14:02:06] INFO	separator         = ,
[12/26/21 14:02:06] INFO	shuffle           = False
[12/26/21 14:02:06] INFO	split             = 0.400000
[12/26/21 14:02:06] INFO	submission_file   = gender_submission
[12/26/21 14:02:06] INFO	submit_probas     = False
[12/26/21 14:02:06] INFO	target [y]        = Survived
[12/26/21 14:02:06] INFO	target_value      = 1
[12/26/21 14:02:06] INFO	transforms        = None
[12/26/21 14:02:06] INFO	tsne              = False
[12/26/21 14:02:06] INFO	tsne_components   = 2
[12/26/21 14:02:06] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 14:02:06] INFO	tsne_perplexity   = 30.000000
[12/26/21 14:02:06] INFO	vectorize         = False
[12/26/21 14:02:06] INFO	verbosity         = 0
[12/26/21 14:02:06] INFO	Creating Model
[12/26/21 14:02:06] INFO	Calling Pipeline
[12/26/21 14:02:06] INFO	Training Pipeline
[12/26/21 14:02:06] INFO	Loading Data
[12/26/21 14:02:06] INFO	Loading data from ./input/train.csv
[12/26/21 14:02:06] INFO	Found target Survived in data frame
[12/26/21 14:02:06] INFO	Labels (y) found for Partition.train
[12/26/21 14:02:06] INFO	Loading Data
[12/26/21 14:02:06] INFO	Loading data from ./input/test.csv
[12/26/21 14:02:06] INFO	Target Survived not found in Partition.test
[12/26/21 14:02:06] INFO	Saving New Features in Model
[12/26/21 14:02:06] INFO	Original Feature Statistics
[12/26/21 14:02:06] INFO	Number of Training Rows    : 891
[12/26/21 14:02:06] INFO	Number of Training Columns : 11
[12/26/21 14:02:06] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 14:02:06] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 14:02:06] INFO	Number of Testing Rows     : 418
[12/26/21 14:02:06] INFO	Number of Testing Columns  : 11
[12/26/21 14:02:06] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:02:06] INFO	Feature Count     : 11
[12/26/21 14:02:06] INFO	Applying transforms
[12/26/21 14:02:06] INFO	No transforms Specified
[12/26/21 14:02:06] INFO	New Feature Count : 11
[12/26/21 14:02:06] INFO	Dropping Features: ['PassengerId']
[12/26/21 14:02:06] INFO	Original Feature Count : 11
[12/26/21 14:02:06] INFO	Reduced Feature Count  : 10
[12/26/21 14:02:06] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 14:02:06] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 14:02:06] INFO	Creating Cross-Tabulations
[12/26/21 14:02:06] INFO	Creating crosstabs for feature Embarked
[12/26/21 14:02:06] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:02:06] INFO	Feature Count     : 10
[12/26/21 14:02:06] INFO	Creating Count Features
[12/26/21 14:02:06] INFO	NA Counts
[12/26/21 14:02:06] INFO	Number Counts
[12/26/21 14:02:06] INFO	New Feature Count : 21
[12/26/21 14:02:06] INFO	Creating Base Features
[12/26/21 14:02:06] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 14:02:06] INFO	Feature 2: Name => Factorization
[12/26/21 14:02:06] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 14:02:06] INFO	Feature 3: Sex => Factorization
[12/26/21 14:02:06] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 14:02:06] INFO	Feature 7: Ticket => Factorization
[12/26/21 14:02:06] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 14:02:06] INFO	Feature 9: Cabin => Factorization
[12/26/21 14:02:06] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 14:02:06] INFO	Encoding: Encoders.target
[12/26/21 14:02:06] INFO	Fitting training features for Embarked
[12/26/21 14:02:06] INFO	Transforming testing features for Embarked
[12/26/21 14:02:06] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:02:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:02:06] INFO	New Feature Count : 21
[12/26/21 14:02:06] INFO	Scaling Base Features
[12/26/21 14:02:06] INFO	Creating NumPy Features
[12/26/21 14:02:06] INFO	NumPy Feature: sum
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	NumPy Feature: mean
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	NumPy Feature: std
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	NumPy Feature: var
[12/26/21 14:02:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:02:06] INFO	NumPy Feature Count : 4
[12/26/21 14:02:06] INFO	New Feature Count : 25
[12/26/21 14:02:06] INFO	Creating Clustering Features
[12/26/21 14:02:06] INFO	Cluster Minimum   : 3
[12/26/21 14:02:06] INFO	Cluster Maximum   : 30
[12/26/21 14:02:06] INFO	Cluster Increment : 3
[12/26/21 14:02:06] INFO	k = 3
[12/26/21 14:02:08] INFO	k = 6
[12/26/21 14:02:08] INFO	k = 9
[12/26/21 14:02:08] INFO	k = 12
[12/26/21 14:02:08] INFO	k = 15
[12/26/21 14:02:08] INFO	k = 18
[12/26/21 14:02:08] INFO	k = 21
[12/26/21 14:02:08] INFO	k = 24
[12/26/21 14:02:08] INFO	k = 27
[12/26/21 14:02:08] INFO	k = 30
[12/26/21 14:02:08] INFO	Clustering Feature Count : 10
[12/26/21 14:02:08] INFO	New Feature Count : 35
[12/26/21 14:02:08] INFO	Saving New Features in Model
[12/26/21 14:02:08] INFO	Creating Interactions
[12/26/21 14:02:08] INFO	Initial Feature Count  : 35
[12/26/21 14:02:08] INFO	Skipping Interactions
[12/26/21 14:02:08] INFO	Saving New Features in Model
[12/26/21 14:02:08] INFO	Removing Low-Variance Features
[12/26/21 14:02:08] INFO	Low-Variance Threshold  : 0.10
[12/26/21 14:02:08] INFO	Original Feature Count  : 35
[12/26/21 14:02:08] INFO	Reduced Feature Count   : 35
[12/26/21 14:02:08] INFO	Saving New Features in Model
[12/26/21 14:02:08] INFO	Skipping Shuffling
[12/26/21 14:02:08] INFO	Skipping Sampling
[12/26/21 14:02:08] INFO	Getting All Estimators
[12/26/21 14:02:08] INFO	Algorithm Configuration
[12/26/21 14:02:08] INFO	Selecting Models
[12/26/21 14:02:08] INFO	Algorithm: CATB
[12/26/21 14:02:08] INFO	Fitting Initial Model
[12/26/21 14:02:09] INFO	Cross-Validation
[12/26/21 14:02:10] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 14:02:10] INFO	Recursive Feature Elimination with CV
[12/26/21 14:02:12] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[12/26/21 14:02:12] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 14:02:12] INFO	No grid is defined for grid search
[12/26/21 14:02:12] INFO	Final Model Predictions for CATB
[12/26/21 14:02:12] INFO	Skipping Calibration
[12/26/21 14:02:12] INFO	Making Predictions
[12/26/21 14:02:12] INFO	Predictions Complete
[12/26/21 14:02:12] INFO	Algorithm: LGB
[12/26/21 14:02:12] INFO	Fitting Initial Model
[12/26/21 14:02:13] INFO	Cross-Validation
[12/26/21 14:02:13] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 14:02:13] INFO	Recursive Feature Elimination with CV
[12/26/21 14:02:15] INFO	RFECV took 2.37 seconds for step 3 and 3 folds
[12/26/21 14:02:15] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 14:02:15] INFO	No grid is defined for grid search
[12/26/21 14:02:15] INFO	Final Model Predictions for LGB
[12/26/21 14:02:15] INFO	Skipping Calibration
[12/26/21 14:02:15] INFO	Making Predictions
[12/26/21 14:02:15] INFO	Predictions Complete
[12/26/21 14:02:15] INFO	Algorithm: XGB
[12/26/21 14:02:15] INFO	Fitting Initial Model
[12/26/21 14:02:15] INFO	Cross-Validation
[12/26/21 14:02:16] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 14:02:16] INFO	Recursive Feature Elimination with CV
[12/26/21 14:02:18] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[12/26/21 14:02:18] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 14:02:18] INFO	Randomized Grid Search
[12/26/21 14:03:22] INFO	Grid Search took 63.32 seconds for 50 candidate parameter settings.
[12/26/21 14:03:22] INFO	Model with rank: 1
[12/26/21 14:03:22] INFO	Mean validation score: 0.871 (std: 0.018)
[12/26/21 14:03:22] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/26/21 14:03:22] INFO	Model with rank: 2
[12/26/21 14:03:22] INFO	Mean validation score: 0.871 (std: 0.022)
[12/26/21 14:03:22] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.7}
[12/26/21 14:03:22] INFO	Model with rank: 3
[12/26/21 14:03:22] INFO	Mean validation score: 0.870 (std: 0.019)
[12/26/21 14:03:22] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 14:03:22] INFO	Algorithm: XGB, Best Score: 0.8710, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.8}
[12/26/21 14:03:22] INFO	Final Model Predictions for XGB
[12/26/21 14:03:22] INFO	Skipping Calibration
[12/26/21 14:03:22] INFO	Making Predictions
[12/26/21 14:03:22] INFO	Predictions Complete
[12/26/21 14:03:22] INFO	Blending Models
[12/26/21 14:03:22] INFO	Blending Start: 2021-12-26 14:03:22.285866
[12/26/21 14:03:22] INFO	Blending Complete: 0:00:00.004602
[12/26/21 14:03:22] INFO	================================================================================
[12/26/21 14:03:22] INFO	Metrics for: Partition.train
[12/26/21 14:03:22] INFO	--------------------------------------------------------------------------------
[12/26/21 14:03:22] INFO	Algorithm: CATB
[12/26/21 14:03:22] INFO	accuracy: 0.8585858585858586
[12/26/21 14:03:22] INFO	average_precision: 0.9113351686222868
[12/26/21 14:03:22] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 14:03:22] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 14:03:22] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 14:03:22] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 14:03:22] INFO	f1: 0.8025078369905956
[12/26/21 14:03:22] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 14:03:22] INFO	precision: 0.8648648648648649
[12/26/21 14:03:22] INFO	recall: 0.7485380116959064
[12/26/21 14:03:22] INFO	roc_auc: 0.9297979313797549
[12/26/21 14:03:22] INFO	--------------------------------------------------------------------------------
[12/26/21 14:03:22] INFO	Algorithm: LGB
[12/26/21 14:03:22] INFO	accuracy: 0.9730639730639731
[12/26/21 14:03:22] INFO	average_precision: 0.9961113207491221
[12/26/21 14:03:22] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 14:03:22] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 14:03:22] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 14:03:22] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 14:03:22] INFO	f1: 0.9643916913946586
[12/26/21 14:03:22] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 14:03:22] INFO	precision: 0.9789156626506024
[12/26/21 14:03:22] INFO	recall: 0.9502923976608187
[12/26/21 14:03:22] INFO	roc_auc: 0.9974861257576241
[12/26/21 14:03:22] INFO	--------------------------------------------------------------------------------
[12/26/21 14:03:22] INFO	Algorithm: XGB
[12/26/21 14:03:22] INFO	accuracy: 0.9057239057239057
[12/26/21 14:03:22] INFO	average_precision: 0.9551038846880793
[12/26/21 14:03:22] INFO	balanced_accuracy: 0.8893202952737034
[12/26/21 14:03:22] INFO	brier_score_loss: 0.08607076254129718
[12/26/21 14:03:22] INFO	cohen_kappa: 0.7961964513283011
[12/26/21 14:03:22] INFO	confusion_matrix: [[527  22]
 [ 62 280]]
[12/26/21 14:03:22] INFO	f1: 0.8695652173913042
[12/26/21 14:03:22] INFO	neg_log_loss: 0.3147918056240922
[12/26/21 14:03:22] INFO	precision: 0.9271523178807947
[12/26/21 14:03:22] INFO	recall: 0.8187134502923976
[12/26/21 14:03:22] INFO	roc_auc: 0.9661958478466963
[12/26/21 14:03:22] INFO	================================================================================
[12/26/21 14:03:22] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 14:03:22] INFO	Best Model Selection Start: 2021-12-26 14:03:22.311550
[12/26/21 14:03:22] INFO	Scoring CATB Model
[12/26/21 14:03:22] INFO	Scoring LGB Model
[12/26/21 14:03:22] INFO	Scoring XGB Model
[12/26/21 14:03:22] INFO	Scoring BLEND Model
[12/26/21 14:03:22] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 14:03:22] INFO	Best Model Selection Complete: 0:00:00.000219
[12/26/21 14:03:22] INFO	================================================================================
[12/26/21 14:03:22] INFO	Generating Plots for partition: train
[12/26/21 14:03:22] INFO	Generating Calibration Plot
[12/26/21 14:03:22] INFO	Calibration for Algorithm: CATB
[12/26/21 14:03:22] INFO	Calibration for Algorithm: LGB
[12/26/21 14:03:22] INFO	Calibration for Algorithm: XGB
[12/26/21 14:03:22] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 14:03:22] INFO	Generating Confusion Matrices
[12/26/21 14:03:22] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 14:03:22] INFO	Confusion Matrix:
[12/26/21 14:03:22] INFO	[[509  40]
 [ 86 256]]
[12/26/21 14:03:22] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 14:03:22] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 14:03:22] INFO	Confusion Matrix:
[12/26/21 14:03:22] INFO	[[542   7]
 [ 17 325]]
[12/26/21 14:03:22] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 14:03:22] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 14:03:22] INFO	Confusion Matrix:
[12/26/21 14:03:22] INFO	[[527  22]
 [ 62 280]]
[12/26/21 14:03:22] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 14:03:22] INFO	Generating ROC Curves
[12/26/21 14:03:22] INFO	ROC Curve for Algorithm: CATB
[12/26/21 14:03:22] INFO	ROC Curve for Algorithm: LGB
[12/26/21 14:03:22] INFO	ROC Curve for Algorithm: XGB
[12/26/21 14:03:22] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 14:03:22] INFO	Generating Learning Curves
[12/26/21 14:03:22] INFO	Algorithm Configuration
[12/26/21 14:03:22] INFO	Learning Curve for Algorithm: CATB
[12/26/21 14:03:23] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 14:03:23] INFO	Learning Curve for Algorithm: LGB
[12/26/21 14:03:25] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 14:03:25] INFO	Learning Curve for Algorithm: XGB
[12/26/21 14:03:25] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 14:03:26] INFO	Generating Feature Importance Plots
[12/26/21 14:03:26] INFO	Feature Importances for Algorithm: CATB
[12/26/21 14:03:26] INFO	Feature Ranking:
[12/26/21 14:03:26] INFO	1. Sex_factor (45.178104)
[12/26/21 14:03:26] INFO	2. Pclass (13.721171)
[12/26/21 14:03:26] INFO	3. Age (6.651788)
[12/26/21 14:03:26] INFO	4. Fare (4.529770)
[12/26/21 14:03:26] INFO	5. var (3.586590)
[12/26/21 14:03:26] INFO	6. std (3.492385)
[12/26/21 14:03:26] INFO	7. Ticket_factor (3.315046)
[12/26/21 14:03:26] INFO	8. cluster_30 (2.831587)
[12/26/21 14:03:26] INFO	9. mean (2.733389)
[12/26/21 14:03:26] INFO	10. Name_factor (2.586310)
[12/26/21 14:03:26] INFO	11. Cabin_factor (2.101764)
[12/26/21 14:03:26] INFO	12. Embarked (2.086410)
[12/26/21 14:03:26] INFO	13. SibSp (2.085405)
[12/26/21 14:03:26] INFO	14. cluster_12 (1.876782)
[12/26/21 14:03:26] INFO	15. cluster_24 (1.263144)
[12/26/21 14:03:26] INFO	16. count_2 (1.004409)
[12/26/21 14:03:26] INFO	17. sum (0.955946)
[12/26/21 14:03:26] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 14:03:26] INFO	Feature Importances for Algorithm: LGB
[12/26/21 14:03:26] INFO	Feature Ranking:
[12/26/21 14:03:26] INFO	1. Fare (256.000000)
[12/26/21 14:03:26] INFO	2. sum (241.000000)
[12/26/21 14:03:26] INFO	3. Age (232.000000)
[12/26/21 14:03:26] INFO	4. std (201.000000)
[12/26/21 14:03:26] INFO	5. Ticket_factor (199.000000)
[12/26/21 14:03:26] INFO	6. Name_factor (175.000000)
[12/26/21 14:03:26] INFO	7. cluster_30 (53.000000)
[12/26/21 14:03:26] INFO	8. cluster_27 (46.000000)
[12/26/21 14:03:26] INFO	9. Sex_factor (43.000000)
[12/26/21 14:03:26] INFO	10. Pclass (43.000000)
[12/26/21 14:03:26] INFO	11. Cabin_factor (41.000000)
[12/26/21 14:03:26] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 14:03:26] INFO	Feature Importances for Algorithm: XGB
[12/26/21 14:03:26] INFO	Feature Ranking:
[12/26/21 14:03:26] INFO	1. Sex_factor (0.424644)
[12/26/21 14:03:26] INFO	2. Pclass (0.127452)
[12/26/21 14:03:26] INFO	3. Cabin_factor (0.081307)
[12/26/21 14:03:26] INFO	4. Age (0.051007)
[12/26/21 14:03:26] INFO	5. SibSp (0.049620)
[12/26/21 14:03:26] INFO	6. count_1 (0.046373)
[12/26/21 14:03:26] INFO	7. Embarked (0.046225)
[12/26/21 14:03:26] INFO	8. std (0.036262)
[12/26/21 14:03:26] INFO	9. cluster_30 (0.036076)
[12/26/21 14:03:26] INFO	10. Fare (0.032410)
[12/26/21 14:03:26] INFO	11. cluster_24 (0.021187)
[12/26/21 14:03:26] INFO	12. Name_factor (0.019312)
[12/26/21 14:03:26] INFO	13. sum (0.017784)
[12/26/21 14:03:26] INFO	14. cluster_15 (0.010340)
[12/26/21 14:03:26] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 14:03:26] INFO	================================================================================
[12/26/21 14:03:26] INFO	Saving Model Predictor
[12/26/21 14:03:26] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 14:03:26] INFO	Saving Feature Map
[12/26/21 14:03:26] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 14:03:26] INFO	Loading data from ./input/train_20211226.csv
[12/26/21 14:03:26] INFO	Saving Predictions
[12/26/21 14:03:26] INFO	Saving Probabilities
[12/26/21 14:03:26] INFO	Saving Ranked Predictions
[12/26/21 14:03:26] INFO	Writing data frame to ./output/ranked_Partition.train_20211226.csv
[12/26/21 14:07:33] INFO	********************************************************************************
[12/26/21 14:07:33] INFO	AlphaPy Start
[12/26/21 14:07:33] INFO	********************************************************************************
[12/26/21 14:07:33] INFO	Model Configuration
[12/26/21 14:07:33] INFO	No transforms Found
[12/26/21 14:07:33] INFO	MODEL PARAMETERS:
[12/26/21 14:07:33] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 14:07:33] INFO	calibration       = False
[12/26/21 14:07:33] INFO	cal_type          = sigmoid
[12/26/21 14:07:33] INFO	calibration_plot  = False
[12/26/21 14:07:33] INFO	clustering        = True
[12/26/21 14:07:33] INFO	cluster_inc       = 3
[12/26/21 14:07:33] INFO	cluster_max       = 30
[12/26/21 14:07:33] INFO	cluster_min       = 3
[12/26/21 14:07:33] INFO	confusion_matrix  = True
[12/26/21 14:07:33] INFO	counts            = True
[12/26/21 14:07:33] INFO	cv_folds          = 3
[12/26/21 14:07:33] INFO	directory         = .
[12/26/21 14:07:33] INFO	extension         = csv
[12/26/21 14:07:33] INFO	drop              = ['PassengerId']
[12/26/21 14:07:33] INFO	encoder           = <Encoders.target: 14>
[12/26/21 14:07:33] INFO	esr               = 20
[12/26/21 14:07:33] INFO	factors           = ['Embarked']
[12/26/21 14:07:33] INFO	features [X]      = *
[12/26/21 14:07:33] INFO	feature_selection = False
[12/26/21 14:07:33] INFO	fs_percentage     = 50
[12/26/21 14:07:33] INFO	fs_score_func     = <function f_classif at 0x7fb819b83ee0>
[12/26/21 14:07:33] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 14:07:33] INFO	grid_search       = True
[12/26/21 14:07:33] INFO	gs_iters          = 50
[12/26/21 14:07:33] INFO	gs_random         = True
[12/26/21 14:07:33] INFO	gs_sample         = False
[12/26/21 14:07:33] INFO	gs_sample_pct     = 0.200000
[12/26/21 14:07:33] INFO	importances       = True
[12/26/21 14:07:33] INFO	interactions      = False
[12/26/21 14:07:33] INFO	isomap            = False
[12/26/21 14:07:33] INFO	iso_components    = 2
[12/26/21 14:07:33] INFO	iso_neighbors     = 5
[12/26/21 14:07:33] INFO	isample_pct       = 10
[12/26/21 14:07:33] INFO	leaders           = []
[12/26/21 14:07:33] INFO	learning_curve    = True
[12/26/21 14:07:33] INFO	logtransform      = False
[12/26/21 14:07:33] INFO	lv_remove         = True
[12/26/21 14:07:33] INFO	lv_threshold      = 0.100000
[12/26/21 14:07:33] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 14:07:33] INFO	n_estimators      = 51
[12/26/21 14:07:33] INFO	n_jobs            = -1
[12/26/21 14:07:33] INFO	ngrams_max        = 2
[12/26/21 14:07:33] INFO	numpy             = True
[12/26/21 14:07:33] INFO	pca               = False
[12/26/21 14:07:33] INFO	pca_inc           = 1
[12/26/21 14:07:33] INFO	pca_max           = 10
[12/26/21 14:07:33] INFO	pca_min           = 2
[12/26/21 14:07:33] INFO	pca_whiten        = False
[12/26/21 14:07:33] INFO	poly_degree       = 2
[12/26/21 14:07:33] INFO	pvalue_level      = 0.010000
[12/26/21 14:07:33] INFO	rfe               = True
[12/26/21 14:07:33] INFO	rfe_step          = 3
[12/26/21 14:07:33] INFO	roc_curve         = True
[12/26/21 14:07:33] INFO	rounding          = 2
[12/26/21 14:07:33] INFO	sampling          = False
[12/26/21 14:07:33] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 14:07:33] INFO	sampling_ratio    = 1.000000
[12/26/21 14:07:33] INFO	scaler_option     = True
[12/26/21 14:07:33] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 14:07:33] INFO	scipy             = False
[12/26/21 14:07:33] INFO	scorer            = roc_auc
[12/26/21 14:07:33] INFO	seed              = 42
[12/26/21 14:07:33] INFO	sentinel          = -1
[12/26/21 14:07:33] INFO	separator         = ,
[12/26/21 14:07:33] INFO	shuffle           = False
[12/26/21 14:07:33] INFO	split             = 0.400000
[12/26/21 14:07:33] INFO	submission_file   = gender_submission
[12/26/21 14:07:33] INFO	submit_probas     = False
[12/26/21 14:07:33] INFO	target [y]        = Survived
[12/26/21 14:07:33] INFO	target_value      = 1
[12/26/21 14:07:33] INFO	transforms        = None
[12/26/21 14:07:33] INFO	tsne              = False
[12/26/21 14:07:33] INFO	tsne_components   = 2
[12/26/21 14:07:33] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 14:07:33] INFO	tsne_perplexity   = 30.000000
[12/26/21 14:07:33] INFO	vectorize         = False
[12/26/21 14:07:33] INFO	verbosity         = 0
[12/26/21 14:07:33] INFO	Creating Model
[12/26/21 14:07:33] INFO	Calling Pipeline
[12/26/21 14:07:33] INFO	Training Pipeline
[12/26/21 14:07:33] INFO	Loading Data
[12/26/21 14:07:33] INFO	Loading data from ./input/train.csv
[12/26/21 14:07:33] INFO	Found target Survived in data frame
[12/26/21 14:07:33] INFO	Labels (y) found for Partition.train
[12/26/21 14:07:33] INFO	Loading Data
[12/26/21 14:07:33] INFO	Loading data from ./input/test.csv
[12/26/21 14:07:33] INFO	Target Survived not found in Partition.test
[12/26/21 14:07:33] INFO	Saving New Features in Model
[12/26/21 14:07:33] INFO	Original Feature Statistics
[12/26/21 14:07:33] INFO	Number of Training Rows    : 891
[12/26/21 14:07:33] INFO	Number of Training Columns : 11
[12/26/21 14:07:33] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 14:07:33] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 14:07:33] INFO	Number of Testing Rows     : 418
[12/26/21 14:07:33] INFO	Number of Testing Columns  : 11
[12/26/21 14:07:33] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:07:33] INFO	Feature Count     : 11
[12/26/21 14:07:33] INFO	Applying transforms
[12/26/21 14:07:33] INFO	No transforms Specified
[12/26/21 14:07:33] INFO	New Feature Count : 11
[12/26/21 14:07:33] INFO	Dropping Features: ['PassengerId']
[12/26/21 14:07:33] INFO	Original Feature Count : 11
[12/26/21 14:07:33] INFO	Reduced Feature Count  : 10
[12/26/21 14:07:33] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 14:07:33] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 14:07:33] INFO	Creating Cross-Tabulations
[12/26/21 14:07:33] INFO	Creating crosstabs for feature Embarked
[12/26/21 14:07:33] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:07:33] INFO	Feature Count     : 10
[12/26/21 14:07:33] INFO	Creating Count Features
[12/26/21 14:07:33] INFO	NA Counts
[12/26/21 14:07:33] INFO	Number Counts
[12/26/21 14:07:33] INFO	New Feature Count : 21
[12/26/21 14:07:33] INFO	Creating Base Features
[12/26/21 14:07:33] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 14:07:33] INFO	Feature 2: Name => Factorization
[12/26/21 14:07:33] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 14:07:33] INFO	Feature 3: Sex => Factorization
[12/26/21 14:07:33] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 14:07:33] INFO	Feature 7: Ticket => Factorization
[12/26/21 14:07:33] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 14:07:33] INFO	Feature 9: Cabin => Factorization
[12/26/21 14:07:33] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 14:07:33] INFO	Encoding: Encoders.target
[12/26/21 14:07:33] INFO	Fitting training features for Embarked
[12/26/21 14:07:33] INFO	Transforming testing features for Embarked
[12/26/21 14:07:33] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:07:33] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:07:33] INFO	New Feature Count : 21
[12/26/21 14:07:33] INFO	Scaling Base Features
[12/26/21 14:07:33] INFO	Creating NumPy Features
[12/26/21 14:07:33] INFO	NumPy Feature: sum
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	NumPy Feature: mean
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	NumPy Feature: std
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	NumPy Feature: var
[12/26/21 14:07:33] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:07:33] INFO	NumPy Feature Count : 4
[12/26/21 14:07:33] INFO	New Feature Count : 25
[12/26/21 14:07:33] INFO	Creating Clustering Features
[12/26/21 14:07:33] INFO	Cluster Minimum   : 3
[12/26/21 14:07:33] INFO	Cluster Maximum   : 30
[12/26/21 14:07:33] INFO	Cluster Increment : 3
[12/26/21 14:07:33] INFO	k = 3
[12/26/21 14:07:35] INFO	k = 6
[12/26/21 14:07:35] INFO	k = 9
[12/26/21 14:07:35] INFO	k = 12
[12/26/21 14:07:35] INFO	k = 15
[12/26/21 14:07:35] INFO	k = 18
[12/26/21 14:07:35] INFO	k = 21
[12/26/21 14:07:35] INFO	k = 24
[12/26/21 14:07:35] INFO	k = 27
[12/26/21 14:07:35] INFO	k = 30
[12/26/21 14:07:35] INFO	Clustering Feature Count : 10
[12/26/21 14:07:35] INFO	New Feature Count : 35
[12/26/21 14:07:35] INFO	Saving New Features in Model
[12/26/21 14:07:35] INFO	Creating Interactions
[12/26/21 14:07:35] INFO	Initial Feature Count  : 35
[12/26/21 14:07:35] INFO	Skipping Interactions
[12/26/21 14:07:35] INFO	Saving New Features in Model
[12/26/21 14:07:35] INFO	Removing Low-Variance Features
[12/26/21 14:07:35] INFO	Low-Variance Threshold  : 0.10
[12/26/21 14:07:35] INFO	Original Feature Count  : 35
[12/26/21 14:07:35] INFO	Reduced Feature Count   : 35
[12/26/21 14:07:35] INFO	Saving New Features in Model
[12/26/21 14:07:35] INFO	Skipping Shuffling
[12/26/21 14:07:35] INFO	Skipping Sampling
[12/26/21 14:07:35] INFO	Getting All Estimators
[12/26/21 14:07:35] INFO	Algorithm Configuration
[12/26/21 14:07:35] INFO	Selecting Models
[12/26/21 14:07:35] INFO	Algorithm: CATB
[12/26/21 14:07:35] INFO	Fitting Initial Model
[12/26/21 14:07:36] INFO	Cross-Validation
[12/26/21 14:07:37] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 14:07:37] INFO	Recursive Feature Elimination with CV
[12/26/21 14:07:39] INFO	RFECV took 2.37 seconds for step 3 and 3 folds
[12/26/21 14:07:39] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 14:07:39] INFO	No grid is defined for grid search
[12/26/21 14:07:39] INFO	Final Model Predictions for CATB
[12/26/21 14:07:39] INFO	Skipping Calibration
[12/26/21 14:07:39] INFO	Making Predictions
[12/26/21 14:07:39] INFO	Predictions Complete
[12/26/21 14:07:39] INFO	Algorithm: LGB
[12/26/21 14:07:39] INFO	Fitting Initial Model
[12/26/21 14:07:39] INFO	Cross-Validation
[12/26/21 14:07:40] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 14:07:40] INFO	Recursive Feature Elimination with CV
[12/26/21 14:07:43] INFO	RFECV took 3.08 seconds for step 3 and 3 folds
[12/26/21 14:07:43] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 14:07:43] INFO	No grid is defined for grid search
[12/26/21 14:07:43] INFO	Final Model Predictions for LGB
[12/26/21 14:07:43] INFO	Skipping Calibration
[12/26/21 14:07:43] INFO	Making Predictions
[12/26/21 14:07:43] INFO	Predictions Complete
[12/26/21 14:07:43] INFO	Algorithm: XGB
[12/26/21 14:07:43] INFO	Fitting Initial Model
[12/26/21 14:07:43] INFO	Cross-Validation
[12/26/21 14:07:44] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 14:07:44] INFO	Recursive Feature Elimination with CV
[12/26/21 14:07:46] INFO	RFECV took 2.35 seconds for step 3 and 3 folds
[12/26/21 14:07:46] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 14:07:46] INFO	Randomized Grid Search
[12/26/21 14:08:39] INFO	Grid Search took 52.69 seconds for 50 candidate parameter settings.
[12/26/21 14:08:39] INFO	Model with rank: 1
[12/26/21 14:08:39] INFO	Mean validation score: 0.870 (std: 0.022)
[12/26/21 14:08:39] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/26/21 14:08:39] INFO	Model with rank: 2
[12/26/21 14:08:39] INFO	Mean validation score: 0.869 (std: 0.021)
[12/26/21 14:08:39] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 5, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.8}
[12/26/21 14:08:39] INFO	Model with rank: 3
[12/26/21 14:08:39] INFO	Mean validation score: 0.869 (std: 0.021)
[12/26/21 14:08:39] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 14:08:39] INFO	Algorithm: XGB, Best Score: 0.8700, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/26/21 14:08:39] INFO	Final Model Predictions for XGB
[12/26/21 14:08:39] INFO	Skipping Calibration
[12/26/21 14:08:39] INFO	Making Predictions
[12/26/21 14:08:39] INFO	Predictions Complete
[12/26/21 14:08:39] INFO	Blending Models
[12/26/21 14:08:39] INFO	Blending Start: 2021-12-26 14:08:39.270865
[12/26/21 14:08:39] INFO	Blending Complete: 0:00:00.004285
[12/26/21 14:08:39] INFO	================================================================================
[12/26/21 14:08:39] INFO	Metrics for: Partition.train
[12/26/21 14:08:39] INFO	--------------------------------------------------------------------------------
[12/26/21 14:08:39] INFO	Algorithm: CATB
[12/26/21 14:08:39] INFO	accuracy: 0.8585858585858586
[12/26/21 14:08:39] INFO	average_precision: 0.9113351686222868
[12/26/21 14:08:39] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 14:08:39] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 14:08:39] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 14:08:39] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 14:08:39] INFO	f1: 0.8025078369905956
[12/26/21 14:08:39] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 14:08:39] INFO	precision: 0.8648648648648649
[12/26/21 14:08:39] INFO	recall: 0.7485380116959064
[12/26/21 14:08:39] INFO	roc_auc: 0.9297979313797549
[12/26/21 14:08:39] INFO	--------------------------------------------------------------------------------
[12/26/21 14:08:39] INFO	Algorithm: LGB
[12/26/21 14:08:39] INFO	accuracy: 0.9730639730639731
[12/26/21 14:08:39] INFO	average_precision: 0.9961113207491221
[12/26/21 14:08:39] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 14:08:39] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 14:08:39] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 14:08:39] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 14:08:39] INFO	f1: 0.9643916913946586
[12/26/21 14:08:39] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 14:08:39] INFO	precision: 0.9789156626506024
[12/26/21 14:08:39] INFO	recall: 0.9502923976608187
[12/26/21 14:08:39] INFO	roc_auc: 0.9974861257576241
[12/26/21 14:08:39] INFO	--------------------------------------------------------------------------------
[12/26/21 14:08:39] INFO	Algorithm: XGB
[12/26/21 14:08:39] INFO	accuracy: 0.9169472502805837
[12/26/21 14:08:39] INFO	average_precision: 0.9640426119100974
[12/26/21 14:08:39] INFO	balanced_accuracy: 0.9022864538395168
[12/26/21 14:08:39] INFO	brier_score_loss: 0.07937433056260092
[12/26/21 14:08:39] INFO	cohen_kappa: 0.820862676056338
[12/26/21 14:08:39] INFO	confusion_matrix: [[530  19]
 [ 55 287]]
[12/26/21 14:08:39] INFO	f1: 0.8858024691358024
[12/26/21 14:08:39] INFO	neg_log_loss: 0.30071018758312484
[12/26/21 14:08:39] INFO	precision: 0.9379084967320261
[12/26/21 14:08:39] INFO	recall: 0.8391812865497076
[12/26/21 14:08:39] INFO	roc_auc: 0.9717561968065276
[12/26/21 14:08:39] INFO	================================================================================
[12/26/21 14:08:39] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 14:08:39] INFO	Best Model Selection Start: 2021-12-26 14:08:39.295321
[12/26/21 14:08:39] INFO	Scoring CATB Model
[12/26/21 14:08:39] INFO	Scoring LGB Model
[12/26/21 14:08:39] INFO	Scoring XGB Model
[12/26/21 14:08:39] INFO	Scoring BLEND Model
[12/26/21 14:08:39] INFO	Best Model is BLEND with a roc_auc score of 0.9978
[12/26/21 14:08:39] INFO	Best Model Selection Complete: 0:00:00.000239
[12/26/21 14:08:39] INFO	================================================================================
[12/26/21 14:08:39] INFO	Generating Plots for partition: train
[12/26/21 14:08:39] INFO	Generating Calibration Plot
[12/26/21 14:08:39] INFO	Calibration for Algorithm: CATB
[12/26/21 14:08:39] INFO	Calibration for Algorithm: LGB
[12/26/21 14:08:39] INFO	Calibration for Algorithm: XGB
[12/26/21 14:08:39] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 14:08:39] INFO	Generating Confusion Matrices
[12/26/21 14:08:39] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 14:08:39] INFO	Confusion Matrix:
[12/26/21 14:08:39] INFO	[[509  40]
 [ 86 256]]
[12/26/21 14:08:39] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 14:08:39] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 14:08:39] INFO	Confusion Matrix:
[12/26/21 14:08:39] INFO	[[542   7]
 [ 17 325]]
[12/26/21 14:08:39] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 14:08:39] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 14:08:39] INFO	Confusion Matrix:
[12/26/21 14:08:39] INFO	[[530  19]
 [ 55 287]]
[12/26/21 14:08:39] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 14:08:39] INFO	Generating ROC Curves
[12/26/21 14:08:39] INFO	ROC Curve for Algorithm: CATB
[12/26/21 14:08:39] INFO	ROC Curve for Algorithm: LGB
[12/26/21 14:08:39] INFO	ROC Curve for Algorithm: XGB
[12/26/21 14:08:39] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 14:08:39] INFO	Generating Learning Curves
[12/26/21 14:08:39] INFO	Algorithm Configuration
[12/26/21 14:08:39] INFO	Learning Curve for Algorithm: CATB
[12/26/21 14:08:40] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 14:08:40] INFO	Learning Curve for Algorithm: LGB
[12/26/21 14:08:42] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 14:08:42] INFO	Learning Curve for Algorithm: XGB
[12/26/21 14:08:42] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 14:08:42] INFO	Generating Feature Importance Plots
[12/26/21 14:08:42] INFO	Feature Importances for Algorithm: CATB
[12/26/21 14:08:42] INFO	Feature Ranking:
[12/26/21 14:08:42] INFO	1. Sex_factor (45.178104)
[12/26/21 14:08:42] INFO	2. Pclass (13.721171)
[12/26/21 14:08:42] INFO	3. Age (6.651788)
[12/26/21 14:08:42] INFO	4. Fare (4.529770)
[12/26/21 14:08:42] INFO	5. var (3.586590)
[12/26/21 14:08:42] INFO	6. std (3.492385)
[12/26/21 14:08:42] INFO	7. Ticket_factor (3.315046)
[12/26/21 14:08:42] INFO	8. cluster_30 (2.831587)
[12/26/21 14:08:42] INFO	9. mean (2.733389)
[12/26/21 14:08:42] INFO	10. Name_factor (2.586310)
[12/26/21 14:08:42] INFO	11. Cabin_factor (2.101764)
[12/26/21 14:08:42] INFO	12. Embarked (2.086410)
[12/26/21 14:08:42] INFO	13. SibSp (2.085405)
[12/26/21 14:08:42] INFO	14. cluster_12 (1.876782)
[12/26/21 14:08:42] INFO	15. cluster_24 (1.263144)
[12/26/21 14:08:42] INFO	16. count_2 (1.004409)
[12/26/21 14:08:42] INFO	17. sum (0.955946)
[12/26/21 14:08:42] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 14:08:42] INFO	Feature Importances for Algorithm: LGB
[12/26/21 14:08:42] INFO	Feature Ranking:
[12/26/21 14:08:42] INFO	1. Fare (256.000000)
[12/26/21 14:08:42] INFO	2. sum (241.000000)
[12/26/21 14:08:42] INFO	3. Age (232.000000)
[12/26/21 14:08:42] INFO	4. std (201.000000)
[12/26/21 14:08:42] INFO	5. Ticket_factor (199.000000)
[12/26/21 14:08:42] INFO	6. Name_factor (175.000000)
[12/26/21 14:08:42] INFO	7. cluster_30 (53.000000)
[12/26/21 14:08:42] INFO	8. cluster_27 (46.000000)
[12/26/21 14:08:42] INFO	9. Sex_factor (43.000000)
[12/26/21 14:08:42] INFO	10. Pclass (43.000000)
[12/26/21 14:08:42] INFO	11. Cabin_factor (41.000000)
[12/26/21 14:08:43] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 14:08:43] INFO	Feature Importances for Algorithm: XGB
[12/26/21 14:08:43] INFO	Feature Ranking:
[12/26/21 14:08:43] INFO	1. Sex_factor (0.424644)
[12/26/21 14:08:43] INFO	2. Pclass (0.127452)
[12/26/21 14:08:43] INFO	3. Cabin_factor (0.081307)
[12/26/21 14:08:43] INFO	4. Age (0.051007)
[12/26/21 14:08:43] INFO	5. SibSp (0.049620)
[12/26/21 14:08:43] INFO	6. count_1 (0.046373)
[12/26/21 14:08:43] INFO	7. Embarked (0.046225)
[12/26/21 14:08:43] INFO	8. std (0.036262)
[12/26/21 14:08:43] INFO	9. cluster_30 (0.036076)
[12/26/21 14:08:43] INFO	10. Fare (0.032410)
[12/26/21 14:08:43] INFO	11. cluster_24 (0.021187)
[12/26/21 14:08:43] INFO	12. Name_factor (0.019312)
[12/26/21 14:08:43] INFO	13. sum (0.017784)
[12/26/21 14:08:43] INFO	14. cluster_15 (0.010340)
[12/26/21 14:08:43] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 14:08:43] INFO	================================================================================
[12/26/21 14:08:43] INFO	Saving Model Predictor
[12/26/21 14:08:43] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 14:08:43] INFO	Saving Feature Map
[12/26/21 14:08:43] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 14:08:43] INFO	Loading data from ./input/train_20211226.csv
[12/26/21 14:08:43] INFO	Saving Predictions
[12/26/21 14:08:43] INFO	Saving Probabilities
[12/26/21 14:08:43] INFO	Saving Ranked Predictions
[12/26/21 14:08:43] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 14:08:43] INFO	********************************************************************************
[12/26/21 14:08:43] INFO	AlphaPy End
[12/26/21 14:08:43] INFO	********************************************************************************
[12/26/21 14:16:24] INFO	********************************************************************************
[12/26/21 14:16:24] INFO	AlphaPy Start
[12/26/21 14:16:24] INFO	********************************************************************************
[12/26/21 14:16:24] INFO	Model Configuration
[12/26/21 14:16:24] INFO	No transforms Found
[12/26/21 14:16:24] INFO	MODEL PARAMETERS:
[12/26/21 14:16:24] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 14:16:24] INFO	calibration       = False
[12/26/21 14:16:24] INFO	cal_type          = sigmoid
[12/26/21 14:16:24] INFO	calibration_plot  = False
[12/26/21 14:16:24] INFO	clustering        = True
[12/26/21 14:16:24] INFO	cluster_inc       = 3
[12/26/21 14:16:24] INFO	cluster_max       = 30
[12/26/21 14:16:24] INFO	cluster_min       = 3
[12/26/21 14:16:24] INFO	confusion_matrix  = True
[12/26/21 14:16:24] INFO	counts            = True
[12/26/21 14:16:24] INFO	cv_folds          = 3
[12/26/21 14:16:24] INFO	directory         = .
[12/26/21 14:16:24] INFO	extension         = csv
[12/26/21 14:16:24] INFO	drop              = ['PassengerId']
[12/26/21 14:16:24] INFO	encoder           = <Encoders.target: 14>
[12/26/21 14:16:24] INFO	esr               = 20
[12/26/21 14:16:24] INFO	factors           = ['Embarked']
[12/26/21 14:16:24] INFO	features [X]      = *
[12/26/21 14:16:24] INFO	feature_selection = False
[12/26/21 14:16:24] INFO	fs_percentage     = 50
[12/26/21 14:16:24] INFO	fs_score_func     = <function f_classif at 0x7fefe1b42ee0>
[12/26/21 14:16:24] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 14:16:24] INFO	grid_search       = True
[12/26/21 14:16:24] INFO	gs_iters          = 50
[12/26/21 14:16:24] INFO	gs_random         = True
[12/26/21 14:16:24] INFO	gs_sample         = False
[12/26/21 14:16:24] INFO	gs_sample_pct     = 0.200000
[12/26/21 14:16:24] INFO	importances       = True
[12/26/21 14:16:24] INFO	interactions      = False
[12/26/21 14:16:24] INFO	isomap            = False
[12/26/21 14:16:24] INFO	iso_components    = 2
[12/26/21 14:16:24] INFO	iso_neighbors     = 5
[12/26/21 14:16:24] INFO	isample_pct       = 10
[12/26/21 14:16:24] INFO	leaders           = []
[12/26/21 14:16:24] INFO	learning_curve    = True
[12/26/21 14:16:24] INFO	logtransform      = False
[12/26/21 14:16:24] INFO	lv_remove         = True
[12/26/21 14:16:24] INFO	lv_threshold      = 0.100000
[12/26/21 14:16:24] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 14:16:24] INFO	n_estimators      = 51
[12/26/21 14:16:24] INFO	n_jobs            = -1
[12/26/21 14:16:24] INFO	ngrams_max        = 2
[12/26/21 14:16:24] INFO	numpy             = True
[12/26/21 14:16:24] INFO	pca               = False
[12/26/21 14:16:24] INFO	pca_inc           = 1
[12/26/21 14:16:24] INFO	pca_max           = 10
[12/26/21 14:16:24] INFO	pca_min           = 2
[12/26/21 14:16:24] INFO	pca_whiten        = False
[12/26/21 14:16:24] INFO	poly_degree       = 2
[12/26/21 14:16:24] INFO	pvalue_level      = 0.010000
[12/26/21 14:16:24] INFO	rfe               = True
[12/26/21 14:16:24] INFO	rfe_step          = 3
[12/26/21 14:16:24] INFO	roc_curve         = True
[12/26/21 14:16:24] INFO	rounding          = 2
[12/26/21 14:16:24] INFO	sampling          = False
[12/26/21 14:16:24] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 14:16:24] INFO	sampling_ratio    = 1.000000
[12/26/21 14:16:24] INFO	scaler_option     = True
[12/26/21 14:16:24] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 14:16:24] INFO	scipy             = False
[12/26/21 14:16:24] INFO	scorer            = roc_auc
[12/26/21 14:16:24] INFO	seed              = 42
[12/26/21 14:16:24] INFO	sentinel          = -1
[12/26/21 14:16:24] INFO	separator         = ,
[12/26/21 14:16:24] INFO	shuffle           = False
[12/26/21 14:16:24] INFO	split             = 0.400000
[12/26/21 14:16:24] INFO	submission_file   = gender_submission
[12/26/21 14:16:24] INFO	submit_probas     = False
[12/26/21 14:16:24] INFO	target [y]        = Survived
[12/26/21 14:16:24] INFO	target_value      = 1
[12/26/21 14:16:24] INFO	transforms        = None
[12/26/21 14:16:24] INFO	tsne              = False
[12/26/21 14:16:24] INFO	tsne_components   = 2
[12/26/21 14:16:24] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 14:16:24] INFO	tsne_perplexity   = 30.000000
[12/26/21 14:16:24] INFO	vectorize         = False
[12/26/21 14:16:24] INFO	verbosity         = 0
[12/26/21 14:16:24] INFO	Creating Model
[12/26/21 14:16:24] INFO	Calling Pipeline
[12/26/21 14:16:24] INFO	Training Pipeline
[12/26/21 14:16:24] INFO	Loading Data
[12/26/21 14:16:24] INFO	Loading data from ./input/train.csv
[12/26/21 14:16:24] INFO	Found target Survived in data frame
[12/26/21 14:16:24] INFO	Labels (y) found for Partition.train
[12/26/21 14:16:24] INFO	Loading Data
[12/26/21 14:16:24] INFO	Loading data from ./input/test.csv
[12/26/21 14:16:24] INFO	Target Survived not found in Partition.test
[12/26/21 14:16:24] INFO	Saving New Features in Model
[12/26/21 14:16:24] INFO	Original Feature Statistics
[12/26/21 14:16:24] INFO	Number of Training Rows    : 891
[12/26/21 14:16:24] INFO	Number of Training Columns : 11
[12/26/21 14:16:24] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 14:16:24] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 14:16:24] INFO	Number of Testing Rows     : 418
[12/26/21 14:16:24] INFO	Number of Testing Columns  : 11
[12/26/21 14:16:24] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:16:24] INFO	Feature Count     : 11
[12/26/21 14:16:24] INFO	Applying transforms
[12/26/21 14:16:24] INFO	No transforms Specified
[12/26/21 14:16:24] INFO	New Feature Count : 11
[12/26/21 14:16:24] INFO	Dropping Features: ['PassengerId']
[12/26/21 14:16:24] INFO	Original Feature Count : 11
[12/26/21 14:16:24] INFO	Reduced Feature Count  : 10
[12/26/21 14:16:24] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 14:16:24] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 14:16:24] INFO	Creating Cross-Tabulations
[12/26/21 14:16:24] INFO	Creating crosstabs for feature Embarked
[12/26/21 14:16:24] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 14:16:24] INFO	Feature Count     : 10
[12/26/21 14:16:24] INFO	Creating Count Features
[12/26/21 14:16:24] INFO	NA Counts
[12/26/21 14:16:24] INFO	Number Counts
[12/26/21 14:16:24] INFO	New Feature Count : 21
[12/26/21 14:16:24] INFO	Creating Base Features
[12/26/21 14:16:24] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 14:16:24] INFO	Feature 2: Name => Factorization
[12/26/21 14:16:24] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 14:16:24] INFO	Feature 3: Sex => Factorization
[12/26/21 14:16:24] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 14:16:24] INFO	Feature 7: Ticket => Factorization
[12/26/21 14:16:24] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 14:16:24] INFO	Feature 9: Cabin => Factorization
[12/26/21 14:16:24] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 14:16:24] INFO	Encoding: Encoders.target
[12/26/21 14:16:24] INFO	Fitting training features for Embarked
[12/26/21 14:16:24] INFO	Transforming testing features for Embarked
[12/26/21 14:16:24] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 14:16:24] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 14:16:24] INFO	New Feature Count : 21
[12/26/21 14:16:24] INFO	Scaling Base Features
[12/26/21 14:16:24] INFO	Creating NumPy Features
[12/26/21 14:16:24] INFO	NumPy Feature: sum
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	NumPy Feature: mean
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	NumPy Feature: std
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	NumPy Feature: var
[12/26/21 14:16:24] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 14:16:24] INFO	NumPy Feature Count : 4
[12/26/21 14:16:24] INFO	New Feature Count : 25
[12/26/21 14:16:24] INFO	Creating Clustering Features
[12/26/21 14:16:24] INFO	Cluster Minimum   : 3
[12/26/21 14:16:24] INFO	Cluster Maximum   : 30
[12/26/21 14:16:24] INFO	Cluster Increment : 3
[12/26/21 14:16:24] INFO	k = 3
[12/26/21 14:16:25] INFO	k = 6
[12/26/21 14:16:25] INFO	k = 9
[12/26/21 14:16:25] INFO	k = 12
[12/26/21 14:16:25] INFO	k = 15
[12/26/21 14:16:26] INFO	k = 18
[12/26/21 14:16:26] INFO	k = 21
[12/26/21 14:16:26] INFO	k = 24
[12/26/21 14:16:26] INFO	k = 27
[12/26/21 14:16:26] INFO	k = 30
[12/26/21 14:16:26] INFO	Clustering Feature Count : 10
[12/26/21 14:16:26] INFO	New Feature Count : 35
[12/26/21 14:16:26] INFO	Saving New Features in Model
[12/26/21 14:16:26] INFO	Creating Interactions
[12/26/21 14:16:26] INFO	Initial Feature Count  : 35
[12/26/21 14:16:26] INFO	Skipping Interactions
[12/26/21 14:16:26] INFO	Saving New Features in Model
[12/26/21 14:16:26] INFO	Removing Low-Variance Features
[12/26/21 14:16:26] INFO	Low-Variance Threshold  : 0.10
[12/26/21 14:16:26] INFO	Original Feature Count  : 35
[12/26/21 14:16:26] INFO	Reduced Feature Count   : 35
[12/26/21 14:16:26] INFO	Saving New Features in Model
[12/26/21 14:16:26] INFO	Skipping Shuffling
[12/26/21 14:16:26] INFO	Skipping Sampling
[12/26/21 14:16:26] INFO	Getting All Estimators
[12/26/21 14:16:26] INFO	Algorithm Configuration
[12/26/21 14:16:26] INFO	Selecting Models
[12/26/21 14:16:26] INFO	Algorithm: CATB
[12/26/21 14:16:26] INFO	Fitting Initial Model
[12/26/21 14:16:26] INFO	Cross-Validation
[12/26/21 14:16:28] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 14:16:28] INFO	Recursive Feature Elimination with CV
[12/26/21 14:16:30] INFO	RFECV took 2.49 seconds for step 3 and 3 folds
[12/26/21 14:16:30] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 14:16:30] INFO	No grid is defined for grid search
[12/26/21 14:16:30] INFO	Final Model Predictions for CATB
[12/26/21 14:16:30] INFO	Skipping Calibration
[12/26/21 14:16:30] INFO	Making Predictions
[12/26/21 14:16:30] INFO	Predictions Complete
[12/26/21 14:16:30] INFO	Algorithm: LGB
[12/26/21 14:16:30] INFO	Fitting Initial Model
[12/26/21 14:16:30] INFO	Cross-Validation
[12/26/21 14:16:31] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 14:16:31] INFO	Recursive Feature Elimination with CV
[12/26/21 14:16:34] INFO	RFECV took 2.50 seconds for step 3 and 3 folds
[12/26/21 14:16:34] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 14:16:34] INFO	No grid is defined for grid search
[12/26/21 14:16:34] INFO	Final Model Predictions for LGB
[12/26/21 14:16:34] INFO	Skipping Calibration
[12/26/21 14:16:34] INFO	Making Predictions
[12/26/21 14:16:34] INFO	Predictions Complete
[12/26/21 14:16:34] INFO	Algorithm: XGB
[12/26/21 14:16:34] INFO	Fitting Initial Model
[12/26/21 14:16:34] INFO	Cross-Validation
[12/26/21 14:16:35] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 14:16:35] INFO	Recursive Feature Elimination with CV
[12/26/21 14:16:37] INFO	RFECV took 2.40 seconds for step 3 and 3 folds
[12/26/21 14:16:37] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 14:16:37] INFO	Randomized Grid Search
[12/26/21 14:17:37] INFO	Grid Search took 59.37 seconds for 50 candidate parameter settings.
[12/26/21 14:17:37] INFO	Model with rank: 1
[12/26/21 14:17:37] INFO	Mean validation score: 0.871 (std: 0.024)
[12/26/21 14:17:37] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/26/21 14:17:37] INFO	Model with rank: 2
[12/26/21 14:17:37] INFO	Mean validation score: 0.871 (std: 0.022)
[12/26/21 14:17:37] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/26/21 14:17:37] INFO	Model with rank: 3
[12/26/21 14:17:37] INFO	Mean validation score: 0.870 (std: 0.024)
[12/26/21 14:17:37] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 6, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 14:17:37] INFO	Algorithm: XGB, Best Score: 0.8708, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/26/21 14:17:37] INFO	Final Model Predictions for XGB
[12/26/21 14:17:37] INFO	Skipping Calibration
[12/26/21 14:17:37] INFO	Making Predictions
[12/26/21 14:17:37] INFO	Predictions Complete
[12/26/21 14:17:37] INFO	Blending Models
[12/26/21 14:17:37] INFO	Blending Start: 2021-12-26 14:17:37.022450
[12/26/21 14:17:37] INFO	Blending Complete: 0:00:00.007407
[12/26/21 14:17:37] INFO	================================================================================
[12/26/21 14:17:37] INFO	Metrics for: Partition.train
[12/26/21 14:17:37] INFO	--------------------------------------------------------------------------------
[12/26/21 14:17:37] INFO	Algorithm: CATB
[12/26/21 14:17:37] INFO	accuracy: 0.8585858585858586
[12/26/21 14:17:37] INFO	average_precision: 0.9113351686222868
[12/26/21 14:17:37] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 14:17:37] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 14:17:37] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 14:17:37] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 14:17:37] INFO	f1: 0.8025078369905956
[12/26/21 14:17:37] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 14:17:37] INFO	precision: 0.8648648648648649
[12/26/21 14:17:37] INFO	recall: 0.7485380116959064
[12/26/21 14:17:37] INFO	roc_auc: 0.9297979313797549
[12/26/21 14:17:37] INFO	--------------------------------------------------------------------------------
[12/26/21 14:17:37] INFO	Algorithm: LGB
[12/26/21 14:17:37] INFO	accuracy: 0.9730639730639731
[12/26/21 14:17:37] INFO	average_precision: 0.9961113207491221
[12/26/21 14:17:37] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 14:17:37] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 14:17:37] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 14:17:37] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 14:17:37] INFO	f1: 0.9643916913946586
[12/26/21 14:17:37] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 14:17:37] INFO	precision: 0.9789156626506024
[12/26/21 14:17:37] INFO	recall: 0.9502923976608187
[12/26/21 14:17:37] INFO	roc_auc: 0.9974861257576241
[12/26/21 14:17:37] INFO	--------------------------------------------------------------------------------
[12/26/21 14:17:37] INFO	Algorithm: XGB
[12/26/21 14:17:37] INFO	accuracy: 0.9124579124579124
[12/26/21 14:17:37] INFO	average_precision: 0.9562758123721045
[12/26/21 14:17:37] INFO	balanced_accuracy: 0.8975409836065573
[12/26/21 14:17:37] INFO	brier_score_loss: 0.08768424226918453
[12/26/21 14:17:37] INFO	cohen_kappa: 0.8111795774647887
[12/26/21 14:17:37] INFO	confusion_matrix: [[528  21]
 [ 57 285]]
[12/26/21 14:17:37] INFO	f1: 0.8796296296296297
[12/26/21 14:17:37] INFO	neg_log_loss: 0.32354125784402743
[12/26/21 14:17:37] INFO	precision: 0.9313725490196079
[12/26/21 14:17:37] INFO	recall: 0.8333333333333334
[12/26/21 14:17:37] INFO	roc_auc: 0.9673196348491143
[12/26/21 14:17:37] INFO	================================================================================
[12/26/21 14:17:37] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 14:17:37] INFO	Best Model Selection Start: 2021-12-26 14:17:37.050043
[12/26/21 14:17:37] INFO	Scoring CATB Model
[12/26/21 14:17:37] INFO	Scoring LGB Model
[12/26/21 14:17:37] INFO	Scoring XGB Model
[12/26/21 14:17:37] INFO	Scoring BLEND Model
[12/26/21 14:17:37] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 14:17:37] INFO	Best Model Selection Complete: 0:00:00.000215
[12/26/21 14:17:37] INFO	================================================================================
[12/26/21 14:17:37] INFO	Generating Plots for partition: train
[12/26/21 14:17:37] INFO	Generating Calibration Plot
[12/26/21 14:17:37] INFO	Calibration for Algorithm: CATB
[12/26/21 14:17:37] INFO	Calibration for Algorithm: LGB
[12/26/21 14:17:37] INFO	Calibration for Algorithm: XGB
[12/26/21 14:17:37] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 14:17:37] INFO	Generating Confusion Matrices
[12/26/21 14:17:37] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 14:17:37] INFO	Confusion Matrix:
[12/26/21 14:17:37] INFO	[[509  40]
 [ 86 256]]
[12/26/21 14:17:37] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 14:17:37] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 14:17:37] INFO	Confusion Matrix:
[12/26/21 14:17:37] INFO	[[542   7]
 [ 17 325]]
[12/26/21 14:17:37] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 14:17:37] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 14:17:37] INFO	Confusion Matrix:
[12/26/21 14:17:37] INFO	[[528  21]
 [ 57 285]]
[12/26/21 14:17:37] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 14:17:37] INFO	Generating ROC Curves
[12/26/21 14:17:37] INFO	ROC Curve for Algorithm: CATB
[12/26/21 14:17:37] INFO	ROC Curve for Algorithm: LGB
[12/26/21 14:17:37] INFO	ROC Curve for Algorithm: XGB
[12/26/21 14:17:37] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 14:17:37] INFO	Generating Learning Curves
[12/26/21 14:17:37] INFO	Algorithm Configuration
[12/26/21 14:17:37] INFO	Learning Curve for Algorithm: CATB
[12/26/21 14:17:38] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 14:17:38] INFO	Learning Curve for Algorithm: LGB
[12/26/21 14:17:39] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 14:17:39] INFO	Learning Curve for Algorithm: XGB
[12/26/21 14:17:40] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 14:17:40] INFO	Generating Feature Importance Plots
[12/26/21 14:17:40] INFO	Feature Importances for Algorithm: CATB
[12/26/21 14:17:40] INFO	Feature Ranking:
[12/26/21 14:17:40] INFO	1. Sex_factor (45.178104)
[12/26/21 14:17:40] INFO	2. Pclass (13.721171)
[12/26/21 14:17:40] INFO	3. Age (6.651788)
[12/26/21 14:17:40] INFO	4. Fare (4.529770)
[12/26/21 14:17:40] INFO	5. var (3.586590)
[12/26/21 14:17:40] INFO	6. std (3.492385)
[12/26/21 14:17:40] INFO	7. Ticket_factor (3.315046)
[12/26/21 14:17:40] INFO	8. cluster_30 (2.831587)
[12/26/21 14:17:40] INFO	9. mean (2.733389)
[12/26/21 14:17:40] INFO	10. Name_factor (2.586310)
[12/26/21 14:17:40] INFO	11. Cabin_factor (2.101764)
[12/26/21 14:17:40] INFO	12. Embarked (2.086410)
[12/26/21 14:17:40] INFO	13. SibSp (2.085405)
[12/26/21 14:17:40] INFO	14. cluster_12 (1.876782)
[12/26/21 14:17:40] INFO	15. cluster_24 (1.263144)
[12/26/21 14:17:40] INFO	16. count_2 (1.004409)
[12/26/21 14:17:40] INFO	17. sum (0.955946)
[12/26/21 14:17:40] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 14:17:40] INFO	Feature Importances for Algorithm: LGB
[12/26/21 14:17:40] INFO	Feature Ranking:
[12/26/21 14:17:40] INFO	1. Fare (256.000000)
[12/26/21 14:17:40] INFO	2. sum (241.000000)
[12/26/21 14:17:40] INFO	3. Age (232.000000)
[12/26/21 14:17:40] INFO	4. std (201.000000)
[12/26/21 14:17:40] INFO	5. Ticket_factor (199.000000)
[12/26/21 14:17:40] INFO	6. Name_factor (175.000000)
[12/26/21 14:17:40] INFO	7. cluster_30 (53.000000)
[12/26/21 14:17:40] INFO	8. cluster_27 (46.000000)
[12/26/21 14:17:40] INFO	9. Sex_factor (43.000000)
[12/26/21 14:17:40] INFO	10. Pclass (43.000000)
[12/26/21 14:17:40] INFO	11. Cabin_factor (41.000000)
[12/26/21 14:17:40] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 14:17:40] INFO	Feature Importances for Algorithm: XGB
[12/26/21 14:17:40] INFO	Feature Ranking:
[12/26/21 14:17:40] INFO	1. Sex_factor (0.424644)
[12/26/21 14:17:40] INFO	2. Pclass (0.127452)
[12/26/21 14:17:40] INFO	3. Cabin_factor (0.081307)
[12/26/21 14:17:40] INFO	4. Age (0.051007)
[12/26/21 14:17:40] INFO	5. SibSp (0.049620)
[12/26/21 14:17:40] INFO	6. count_1 (0.046373)
[12/26/21 14:17:40] INFO	7. Embarked (0.046225)
[12/26/21 14:17:40] INFO	8. std (0.036262)
[12/26/21 14:17:40] INFO	9. cluster_30 (0.036076)
[12/26/21 14:17:40] INFO	10. Fare (0.032410)
[12/26/21 14:17:40] INFO	11. cluster_24 (0.021187)
[12/26/21 14:17:40] INFO	12. Name_factor (0.019312)
[12/26/21 14:17:40] INFO	13. sum (0.017784)
[12/26/21 14:17:40] INFO	14. cluster_15 (0.010340)
[12/26/21 14:17:40] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 14:17:41] INFO	================================================================================
[12/26/21 14:17:41] INFO	Saving Model Predictor
[12/26/21 14:17:41] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 14:17:41] INFO	Saving Feature Map
[12/26/21 14:17:41] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 14:17:41] INFO	Loading data from ./input/train_20211226.csv
[12/26/21 14:17:41] INFO	Saving Predictions
[12/26/21 14:17:41] INFO	Saving Probabilities
[12/26/21 14:17:41] INFO	Saving Ranked Predictions
[12/26/21 14:17:41] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 16:02:37] INFO	********************************************************************************
[12/26/21 16:02:37] INFO	AlphaPy Start
[12/26/21 16:02:37] INFO	********************************************************************************
[12/26/21 16:02:37] INFO	Model Configuration
[12/26/21 16:02:37] INFO	No transforms Found
[12/26/21 16:02:37] INFO	MODEL PARAMETERS:
[12/26/21 16:02:37] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 16:02:37] INFO	calibration       = False
[12/26/21 16:02:37] INFO	cal_type          = sigmoid
[12/26/21 16:02:37] INFO	calibration_plot  = False
[12/26/21 16:02:37] INFO	clustering        = True
[12/26/21 16:02:37] INFO	cluster_inc       = 3
[12/26/21 16:02:37] INFO	cluster_max       = 30
[12/26/21 16:02:37] INFO	cluster_min       = 3
[12/26/21 16:02:37] INFO	confusion_matrix  = True
[12/26/21 16:02:37] INFO	counts            = True
[12/26/21 16:02:37] INFO	cv_folds          = 3
[12/26/21 16:02:37] INFO	directory         = .
[12/26/21 16:02:37] INFO	extension         = csv
[12/26/21 16:02:37] INFO	drop              = ['PassengerId']
[12/26/21 16:02:37] INFO	encoder           = <Encoders.target: 14>
[12/26/21 16:02:37] INFO	esr               = 20
[12/26/21 16:02:37] INFO	factors           = ['Embarked']
[12/26/21 16:02:37] INFO	features [X]      = *
[12/26/21 16:02:37] INFO	feature_selection = False
[12/26/21 16:02:37] INFO	fs_percentage     = 50
[12/26/21 16:02:37] INFO	fs_score_func     = <function f_classif at 0x7f8602b90e50>
[12/26/21 16:02:37] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 16:02:37] INFO	grid_search       = True
[12/26/21 16:02:37] INFO	gs_iters          = 50
[12/26/21 16:02:37] INFO	gs_random         = True
[12/26/21 16:02:37] INFO	gs_sample         = False
[12/26/21 16:02:37] INFO	gs_sample_pct     = 0.200000
[12/26/21 16:02:37] INFO	importances       = True
[12/26/21 16:02:37] INFO	interactions      = False
[12/26/21 16:02:37] INFO	isomap            = False
[12/26/21 16:02:37] INFO	iso_components    = 2
[12/26/21 16:02:37] INFO	iso_neighbors     = 5
[12/26/21 16:02:37] INFO	isample_pct       = 10
[12/26/21 16:02:37] INFO	leaders           = []
[12/26/21 16:02:37] INFO	learning_curve    = True
[12/26/21 16:02:37] INFO	logtransform      = False
[12/26/21 16:02:37] INFO	lv_remove         = True
[12/26/21 16:02:37] INFO	lv_threshold      = 0.100000
[12/26/21 16:02:37] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 16:02:37] INFO	n_estimators      = 51
[12/26/21 16:02:37] INFO	n_jobs            = -1
[12/26/21 16:02:37] INFO	ngrams_max        = 2
[12/26/21 16:02:37] INFO	numpy             = True
[12/26/21 16:02:37] INFO	pca               = False
[12/26/21 16:02:37] INFO	pca_inc           = 1
[12/26/21 16:02:37] INFO	pca_max           = 10
[12/26/21 16:02:37] INFO	pca_min           = 2
[12/26/21 16:02:37] INFO	pca_whiten        = False
[12/26/21 16:02:37] INFO	poly_degree       = 2
[12/26/21 16:02:37] INFO	pvalue_level      = 0.010000
[12/26/21 16:02:37] INFO	rfe               = True
[12/26/21 16:02:37] INFO	rfe_step          = 3
[12/26/21 16:02:37] INFO	roc_curve         = True
[12/26/21 16:02:37] INFO	rounding          = 2
[12/26/21 16:02:37] INFO	sampling          = False
[12/26/21 16:02:37] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 16:02:37] INFO	sampling_ratio    = 1.000000
[12/26/21 16:02:37] INFO	scaler_option     = True
[12/26/21 16:02:37] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 16:02:37] INFO	scipy             = False
[12/26/21 16:02:37] INFO	scorer            = roc_auc
[12/26/21 16:02:37] INFO	seed              = 42
[12/26/21 16:02:37] INFO	sentinel          = -1
[12/26/21 16:02:37] INFO	separator         = ,
[12/26/21 16:02:37] INFO	shuffle           = False
[12/26/21 16:02:37] INFO	split             = 0.400000
[12/26/21 16:02:37] INFO	submission_file   = gender_submission
[12/26/21 16:02:37] INFO	submit_probas     = False
[12/26/21 16:02:37] INFO	target [y]        = Survived
[12/26/21 16:02:37] INFO	target_value      = 1
[12/26/21 16:02:37] INFO	transforms        = None
[12/26/21 16:02:37] INFO	tsne              = False
[12/26/21 16:02:37] INFO	tsne_components   = 2
[12/26/21 16:02:37] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 16:02:37] INFO	tsne_perplexity   = 30.000000
[12/26/21 16:02:37] INFO	vectorize         = False
[12/26/21 16:02:37] INFO	verbosity         = 0
[12/26/21 16:02:37] INFO	Creating Model
[12/26/21 16:02:37] INFO	Calling Pipeline
[12/26/21 16:02:37] INFO	Training Pipeline
[12/26/21 16:02:37] INFO	Loading Data
[12/26/21 16:02:37] INFO	Loading data from ./input/train.csv
[12/26/21 16:02:37] INFO	Found target Survived in data frame
[12/26/21 16:02:37] INFO	Labels (y) found for Partition.train
[12/26/21 16:02:37] INFO	Loading Data
[12/26/21 16:02:37] INFO	Loading data from ./input/test.csv
[12/26/21 16:02:37] INFO	Target Survived not found in Partition.test
[12/26/21 16:02:37] INFO	Saving New Features in Model
[12/26/21 16:02:37] INFO	Original Feature Statistics
[12/26/21 16:02:37] INFO	Number of Training Rows    : 891
[12/26/21 16:02:37] INFO	Number of Training Columns : 11
[12/26/21 16:02:37] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 16:02:37] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 16:02:37] INFO	Number of Testing Rows     : 418
[12/26/21 16:02:37] INFO	Number of Testing Columns  : 11
[12/26/21 16:02:37] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 16:02:37] INFO	Feature Count     : 11
[12/26/21 16:02:37] INFO	Applying transforms
[12/26/21 16:02:37] INFO	No transforms Specified
[12/26/21 16:02:37] INFO	New Feature Count : 11
[12/26/21 16:02:37] INFO	Dropping Features: ['PassengerId']
[12/26/21 16:02:37] INFO	Original Feature Count : 11
[12/26/21 16:02:37] INFO	Reduced Feature Count  : 10
[12/26/21 16:02:37] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 16:02:37] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 16:02:37] INFO	Creating Cross-Tabulations
[12/26/21 16:02:37] INFO	Creating crosstabs for feature Embarked
[12/26/21 16:02:37] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 16:02:37] INFO	Feature Count     : 10
[12/26/21 16:02:37] INFO	Creating Count Features
[12/26/21 16:02:37] INFO	NA Counts
[12/26/21 16:02:37] INFO	Number Counts
[12/26/21 16:02:37] INFO	New Feature Count : 21
[12/26/21 16:02:37] INFO	Creating Base Features
[12/26/21 16:02:37] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 16:02:37] INFO	Feature 2: Name => Factorization
[12/26/21 16:02:37] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 16:02:37] INFO	Feature 3: Sex => Factorization
[12/26/21 16:02:37] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 16:02:37] INFO	Feature 7: Ticket => Factorization
[12/26/21 16:02:37] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 16:02:37] INFO	Feature 9: Cabin => Factorization
[12/26/21 16:02:37] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 16:02:37] INFO	Encoding: Encoders.target
[12/26/21 16:02:37] INFO	Fitting training features for Embarked
[12/26/21 16:02:37] INFO	Transforming testing features for Embarked
[12/26/21 16:02:37] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:02:37] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:02:37] INFO	New Feature Count : 21
[12/26/21 16:02:37] INFO	Scaling Base Features
[12/26/21 16:02:37] INFO	Creating NumPy Features
[12/26/21 16:02:37] INFO	NumPy Feature: sum
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	NumPy Feature: mean
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	NumPy Feature: std
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	NumPy Feature: var
[12/26/21 16:02:37] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:02:37] INFO	NumPy Feature Count : 4
[12/26/21 16:02:37] INFO	New Feature Count : 25
[12/26/21 16:02:37] INFO	Creating Clustering Features
[12/26/21 16:02:37] INFO	Cluster Minimum   : 3
[12/26/21 16:02:37] INFO	Cluster Maximum   : 30
[12/26/21 16:02:37] INFO	Cluster Increment : 3
[12/26/21 16:02:37] INFO	k = 3
[12/26/21 16:02:39] INFO	k = 6
[12/26/21 16:02:39] INFO	k = 9
[12/26/21 16:02:39] INFO	k = 12
[12/26/21 16:02:39] INFO	k = 15
[12/26/21 16:02:39] INFO	k = 18
[12/26/21 16:02:39] INFO	k = 21
[12/26/21 16:02:39] INFO	k = 24
[12/26/21 16:02:39] INFO	k = 27
[12/26/21 16:02:39] INFO	k = 30
[12/26/21 16:02:39] INFO	Clustering Feature Count : 10
[12/26/21 16:02:39] INFO	New Feature Count : 35
[12/26/21 16:02:39] INFO	Saving New Features in Model
[12/26/21 16:02:39] INFO	Creating Interactions
[12/26/21 16:02:39] INFO	Initial Feature Count  : 35
[12/26/21 16:02:39] INFO	Skipping Interactions
[12/26/21 16:02:39] INFO	Saving New Features in Model
[12/26/21 16:02:39] INFO	Removing Low-Variance Features
[12/26/21 16:02:39] INFO	Low-Variance Threshold  : 0.10
[12/26/21 16:02:39] INFO	Original Feature Count  : 35
[12/26/21 16:02:39] INFO	Reduced Feature Count   : 35
[12/26/21 16:02:39] INFO	Saving New Features in Model
[12/26/21 16:02:39] INFO	Skipping Shuffling
[12/26/21 16:02:39] INFO	Skipping Sampling
[12/26/21 16:02:39] INFO	Getting All Estimators
[12/26/21 16:02:39] INFO	Algorithm Configuration
[12/26/21 16:02:40] INFO	Selecting Models
[12/26/21 16:02:40] INFO	Algorithm: CATB
[12/26/21 16:02:40] INFO	Fitting Initial Model
[12/26/21 16:02:40] INFO	Cross-Validation
[12/26/21 16:02:42] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 16:02:42] INFO	Recursive Feature Elimination with CV
[12/26/21 16:02:44] INFO	RFECV took 2.37 seconds for step 3 and 3 folds
[12/26/21 16:02:44] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 16:02:44] INFO	No grid is defined for grid search
[12/26/21 16:02:44] INFO	Final Model Predictions for CATB
[12/26/21 16:02:44] INFO	Skipping Calibration
[12/26/21 16:02:44] INFO	Making Predictions
[12/26/21 16:02:44] INFO	Predictions Complete
[12/26/21 16:02:44] INFO	Algorithm: LGB
[12/26/21 16:02:44] INFO	Fitting Initial Model
[12/26/21 16:02:44] INFO	Cross-Validation
[12/26/21 16:02:45] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 16:02:45] INFO	Recursive Feature Elimination with CV
[12/26/21 16:02:48] INFO	RFECV took 2.45 seconds for step 3 and 3 folds
[12/26/21 16:02:48] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 16:02:48] INFO	No grid is defined for grid search
[12/26/21 16:02:48] INFO	Final Model Predictions for LGB
[12/26/21 16:02:48] INFO	Skipping Calibration
[12/26/21 16:02:48] INFO	Making Predictions
[12/26/21 16:02:48] INFO	Predictions Complete
[12/26/21 16:02:48] INFO	Algorithm: XGB
[12/26/21 16:02:48] INFO	Fitting Initial Model
[12/26/21 16:02:48] INFO	Cross-Validation
[12/26/21 16:02:48] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 16:02:48] INFO	Recursive Feature Elimination with CV
[12/26/21 16:02:50] INFO	RFECV took 2.31 seconds for step 3 and 3 folds
[12/26/21 16:02:50] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 16:02:50] INFO	Randomized Grid Search
[12/26/21 16:03:45] INFO	Grid Search took 54.65 seconds for 50 candidate parameter settings.
[12/26/21 16:03:45] INFO	Model with rank: 1
[12/26/21 16:03:45] INFO	Mean validation score: 0.871 (std: 0.023)
[12/26/21 16:03:45] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/26/21 16:03:45] INFO	Model with rank: 2
[12/26/21 16:03:45] INFO	Mean validation score: 0.870 (std: 0.020)
[12/26/21 16:03:45] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/26/21 16:03:45] INFO	Model with rank: 3
[12/26/21 16:03:45] INFO	Mean validation score: 0.869 (std: 0.028)
[12/26/21 16:03:45] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/26/21 16:03:45] INFO	Algorithm: XGB, Best Score: 0.8710, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 1.0}
[12/26/21 16:03:45] INFO	Final Model Predictions for XGB
[12/26/21 16:03:45] INFO	Skipping Calibration
[12/26/21 16:03:45] INFO	Making Predictions
[12/26/21 16:03:45] INFO	Predictions Complete
[12/26/21 16:03:45] INFO	Blending Models
[12/26/21 16:03:45] INFO	Blending Start: 2021-12-26 16:03:45.299829
[12/26/21 16:03:45] INFO	Blending Complete: 0:00:00.007329
[12/26/21 16:03:45] INFO	Saving Model Predictor
[12/26/21 16:46:47] INFO	********************************************************************************
[12/26/21 16:46:47] INFO	AlphaPy Start
[12/26/21 16:46:47] INFO	********************************************************************************
[12/26/21 16:46:47] INFO	Model Configuration
[12/26/21 16:46:47] INFO	No transforms Found
[12/26/21 16:46:47] INFO	MODEL PARAMETERS:
[12/26/21 16:46:47] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 16:46:47] INFO	calibration       = False
[12/26/21 16:46:47] INFO	cal_type          = sigmoid
[12/26/21 16:46:47] INFO	calibration_plot  = False
[12/26/21 16:46:47] INFO	clustering        = True
[12/26/21 16:46:47] INFO	cluster_inc       = 3
[12/26/21 16:46:47] INFO	cluster_max       = 30
[12/26/21 16:46:47] INFO	cluster_min       = 3
[12/26/21 16:46:47] INFO	confusion_matrix  = True
[12/26/21 16:46:47] INFO	counts            = True
[12/26/21 16:46:47] INFO	cv_folds          = 3
[12/26/21 16:46:47] INFO	directory         = .
[12/26/21 16:46:47] INFO	extension         = csv
[12/26/21 16:46:47] INFO	drop              = ['PassengerId']
[12/26/21 16:46:47] INFO	encoder           = <Encoders.target: 14>
[12/26/21 16:46:47] INFO	esr               = 20
[12/26/21 16:46:47] INFO	factors           = ['Embarked']
[12/26/21 16:46:47] INFO	features [X]      = *
[12/26/21 16:46:47] INFO	feature_selection = False
[12/26/21 16:46:47] INFO	fs_percentage     = 50
[12/26/21 16:46:47] INFO	fs_score_func     = <function f_classif at 0x7ff40aa40e50>
[12/26/21 16:46:47] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 16:46:47] INFO	grid_search       = True
[12/26/21 16:46:47] INFO	gs_iters          = 50
[12/26/21 16:46:47] INFO	gs_random         = True
[12/26/21 16:46:47] INFO	gs_sample         = False
[12/26/21 16:46:47] INFO	gs_sample_pct     = 0.200000
[12/26/21 16:46:47] INFO	importances       = True
[12/26/21 16:46:47] INFO	interactions      = False
[12/26/21 16:46:47] INFO	isomap            = False
[12/26/21 16:46:47] INFO	iso_components    = 2
[12/26/21 16:46:47] INFO	iso_neighbors     = 5
[12/26/21 16:46:47] INFO	isample_pct       = 10
[12/26/21 16:46:47] INFO	leaders           = []
[12/26/21 16:46:47] INFO	learning_curve    = True
[12/26/21 16:46:47] INFO	logtransform      = False
[12/26/21 16:46:47] INFO	lv_remove         = True
[12/26/21 16:46:47] INFO	lv_threshold      = 0.100000
[12/26/21 16:46:47] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 16:46:47] INFO	n_estimators      = 51
[12/26/21 16:46:47] INFO	n_jobs            = -1
[12/26/21 16:46:47] INFO	ngrams_max        = 2
[12/26/21 16:46:47] INFO	numpy             = True
[12/26/21 16:46:47] INFO	pca               = False
[12/26/21 16:46:47] INFO	pca_inc           = 1
[12/26/21 16:46:47] INFO	pca_max           = 10
[12/26/21 16:46:47] INFO	pca_min           = 2
[12/26/21 16:46:47] INFO	pca_whiten        = False
[12/26/21 16:46:47] INFO	poly_degree       = 2
[12/26/21 16:46:47] INFO	pvalue_level      = 0.010000
[12/26/21 16:46:47] INFO	rfe               = True
[12/26/21 16:46:47] INFO	rfe_step          = 3
[12/26/21 16:46:47] INFO	roc_curve         = True
[12/26/21 16:46:47] INFO	rounding          = 2
[12/26/21 16:46:47] INFO	sampling          = False
[12/26/21 16:46:47] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 16:46:47] INFO	sampling_ratio    = 1.000000
[12/26/21 16:46:47] INFO	scaler_option     = True
[12/26/21 16:46:47] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 16:46:47] INFO	scipy             = False
[12/26/21 16:46:47] INFO	scorer            = roc_auc
[12/26/21 16:46:47] INFO	seed              = 42
[12/26/21 16:46:47] INFO	sentinel          = -1
[12/26/21 16:46:47] INFO	separator         = ,
[12/26/21 16:46:47] INFO	shuffle           = False
[12/26/21 16:46:47] INFO	split             = 0.400000
[12/26/21 16:46:47] INFO	submission_file   = gender_submission
[12/26/21 16:46:47] INFO	submit_probas     = False
[12/26/21 16:46:47] INFO	target [y]        = Survived
[12/26/21 16:46:47] INFO	target_value      = 1
[12/26/21 16:46:47] INFO	transforms        = None
[12/26/21 16:46:47] INFO	tsne              = False
[12/26/21 16:46:47] INFO	tsne_components   = 2
[12/26/21 16:46:47] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 16:46:47] INFO	tsne_perplexity   = 30.000000
[12/26/21 16:46:47] INFO	vectorize         = False
[12/26/21 16:46:47] INFO	verbosity         = 0
[12/26/21 16:46:47] INFO	Creating Model
[12/26/21 16:46:47] INFO	Calling Pipeline
[12/26/21 16:46:47] INFO	Training Pipeline
[12/26/21 16:46:47] INFO	Loading Data
[12/26/21 16:46:47] INFO	Loading data from ./input/train.csv
[12/26/21 16:46:47] INFO	Found target Survived in data frame
[12/26/21 16:46:47] INFO	Labels (y) found for Partition.train
[12/26/21 16:46:47] INFO	Loading Data
[12/26/21 16:46:47] INFO	Loading data from ./input/test.csv
[12/26/21 16:46:47] INFO	Target Survived not found in Partition.test
[12/26/21 16:46:47] INFO	Saving New Features in Model
[12/26/21 16:46:47] INFO	Original Feature Statistics
[12/26/21 16:46:47] INFO	Number of Training Rows    : 891
[12/26/21 16:46:47] INFO	Number of Training Columns : 11
[12/26/21 16:46:47] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 16:46:47] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 16:46:47] INFO	Number of Testing Rows     : 418
[12/26/21 16:46:47] INFO	Number of Testing Columns  : 11
[12/26/21 16:46:47] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 16:46:47] INFO	Feature Count     : 11
[12/26/21 16:46:47] INFO	Applying transforms
[12/26/21 16:46:47] INFO	No transforms Specified
[12/26/21 16:46:47] INFO	New Feature Count : 11
[12/26/21 16:46:47] INFO	Dropping Features: ['PassengerId']
[12/26/21 16:46:47] INFO	Original Feature Count : 11
[12/26/21 16:46:47] INFO	Reduced Feature Count  : 10
[12/26/21 16:46:47] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 16:46:47] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 16:46:47] INFO	Creating Cross-Tabulations
[12/26/21 16:46:47] INFO	Creating crosstabs for feature Embarked
[12/26/21 16:46:47] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 16:46:47] INFO	Feature Count     : 10
[12/26/21 16:46:47] INFO	Creating Count Features
[12/26/21 16:46:47] INFO	NA Counts
[12/26/21 16:46:47] INFO	Number Counts
[12/26/21 16:46:47] INFO	New Feature Count : 21
[12/26/21 16:46:47] INFO	Creating Base Features
[12/26/21 16:46:47] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 16:46:47] INFO	Feature 2: Name => Factorization
[12/26/21 16:46:47] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 16:46:47] INFO	Feature 3: Sex => Factorization
[12/26/21 16:46:47] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 16:46:47] INFO	Feature 7: Ticket => Factorization
[12/26/21 16:46:47] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 16:46:47] INFO	Feature 9: Cabin => Factorization
[12/26/21 16:46:47] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 16:46:47] INFO	Encoding: Encoders.target
[12/26/21 16:46:47] INFO	Fitting training features for Embarked
[12/26/21 16:46:47] INFO	Transforming testing features for Embarked
[12/26/21 16:46:47] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 16:46:47] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 16:46:47] INFO	New Feature Count : 21
[12/26/21 16:46:47] INFO	Scaling Base Features
[12/26/21 16:46:47] INFO	Creating NumPy Features
[12/26/21 16:46:47] INFO	NumPy Feature: sum
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	NumPy Feature: mean
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	NumPy Feature: std
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	NumPy Feature: var
[12/26/21 16:46:47] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 16:46:47] INFO	NumPy Feature Count : 4
[12/26/21 16:46:47] INFO	New Feature Count : 25
[12/26/21 16:46:47] INFO	Creating Clustering Features
[12/26/21 16:46:47] INFO	Cluster Minimum   : 3
[12/26/21 16:46:47] INFO	Cluster Maximum   : 30
[12/26/21 16:46:47] INFO	Cluster Increment : 3
[12/26/21 16:46:47] INFO	k = 3
[12/26/21 16:46:49] INFO	k = 6
[12/26/21 16:46:49] INFO	k = 9
[12/26/21 16:46:49] INFO	k = 12
[12/26/21 16:46:49] INFO	k = 15
[12/26/21 16:46:49] INFO	k = 18
[12/26/21 16:46:49] INFO	k = 21
[12/26/21 16:46:49] INFO	k = 24
[12/26/21 16:46:49] INFO	k = 27
[12/26/21 16:46:49] INFO	k = 30
[12/26/21 16:46:49] INFO	Clustering Feature Count : 10
[12/26/21 16:46:49] INFO	New Feature Count : 35
[12/26/21 16:46:49] INFO	Saving New Features in Model
[12/26/21 16:46:49] INFO	Creating Interactions
[12/26/21 16:46:49] INFO	Initial Feature Count  : 35
[12/26/21 16:46:49] INFO	Skipping Interactions
[12/26/21 16:46:49] INFO	Saving New Features in Model
[12/26/21 16:46:49] INFO	Removing Low-Variance Features
[12/26/21 16:46:49] INFO	Low-Variance Threshold  : 0.10
[12/26/21 16:46:49] INFO	Original Feature Count  : 35
[12/26/21 16:46:49] INFO	Reduced Feature Count   : 35
[12/26/21 16:46:49] INFO	Saving New Features in Model
[12/26/21 16:46:49] INFO	Skipping Shuffling
[12/26/21 16:46:49] INFO	Skipping Sampling
[12/26/21 16:46:49] INFO	Getting All Estimators
[12/26/21 16:46:49] INFO	Algorithm Configuration
[12/26/21 16:46:50] INFO	Selecting Models
[12/26/21 16:46:50] INFO	Algorithm: CATB
[12/26/21 16:46:50] INFO	Fitting Initial Model
[12/26/21 16:46:50] INFO	Cross-Validation
[12/26/21 16:46:51] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 16:46:51] INFO	Recursive Feature Elimination with CV
[12/26/21 16:46:54] INFO	RFECV took 2.41 seconds for step 3 and 3 folds
[12/26/21 16:46:54] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 16:46:54] INFO	No grid is defined for grid search
[12/26/21 16:46:54] INFO	Final Model Predictions for CATB
[12/26/21 16:46:54] INFO	Skipping Calibration
[12/26/21 16:46:54] INFO	Making Predictions
[12/26/21 16:46:54] INFO	Predictions Complete
[12/26/21 16:46:54] INFO	Algorithm: LGB
[12/26/21 16:46:54] INFO	Fitting Initial Model
[12/26/21 16:46:54] INFO	Cross-Validation
[12/26/21 16:46:55] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 16:46:55] INFO	Recursive Feature Elimination with CV
[12/26/21 16:46:57] INFO	RFECV took 2.40 seconds for step 3 and 3 folds
[12/26/21 16:46:57] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 16:46:57] INFO	No grid is defined for grid search
[12/26/21 16:46:57] INFO	Final Model Predictions for LGB
[12/26/21 16:46:57] INFO	Skipping Calibration
[12/26/21 16:46:57] INFO	Making Predictions
[12/26/21 16:46:57] INFO	Predictions Complete
[12/26/21 16:46:57] INFO	Algorithm: XGB
[12/26/21 16:46:57] INFO	Fitting Initial Model
[12/26/21 16:46:57] INFO	Cross-Validation
[12/26/21 16:46:57] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 16:46:57] INFO	Recursive Feature Elimination with CV
[12/26/21 16:47:00] INFO	RFECV took 2.40 seconds for step 3 and 3 folds
[12/26/21 16:47:00] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 16:47:00] INFO	Randomized Grid Search
[12/26/21 16:47:55] INFO	Grid Search took 55.34 seconds for 50 candidate parameter settings.
[12/26/21 16:47:55] INFO	Model with rank: 1
[12/26/21 16:47:55] INFO	Mean validation score: 0.870 (std: 0.025)
[12/26/21 16:47:55] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 16:47:55] INFO	Model with rank: 2
[12/26/21 16:47:55] INFO	Mean validation score: 0.870 (std: 0.015)
[12/26/21 16:47:55] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.9}
[12/26/21 16:47:55] INFO	Model with rank: 3
[12/26/21 16:47:55] INFO	Mean validation score: 0.869 (std: 0.025)
[12/26/21 16:47:55] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/26/21 16:47:55] INFO	Algorithm: XGB, Best Score: 0.8699, Best Parameters: {'est__subsample': 0.9, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 16:47:55] INFO	Final Model Predictions for XGB
[12/26/21 16:47:55] INFO	Skipping Calibration
[12/26/21 16:47:55] INFO	Making Predictions
[12/26/21 16:47:55] INFO	Predictions Complete
[12/26/21 16:47:55] INFO	Blending Models
[12/26/21 16:47:55] INFO	Blending Start: 2021-12-26 16:47:55.721012
[12/26/21 16:47:55] INFO	Blending Complete: 0:00:00.007218
[12/26/21 16:47:55] INFO	================================================================================
[12/26/21 16:47:55] INFO	Metrics for: Partition.train
[12/26/21 16:47:55] INFO	--------------------------------------------------------------------------------
[12/26/21 16:47:55] INFO	Algorithm: CATB
[12/26/21 16:47:55] INFO	accuracy: 0.8585858585858586
[12/26/21 16:47:55] INFO	average_precision: 0.9113351686222868
[12/26/21 16:47:55] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 16:47:55] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 16:47:55] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 16:47:55] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 16:47:55] INFO	f1: 0.8025078369905956
[12/26/21 16:47:55] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 16:47:55] INFO	precision: 0.8648648648648649
[12/26/21 16:47:55] INFO	recall: 0.7485380116959064
[12/26/21 16:47:55] INFO	roc_auc: 0.9297979313797549
[12/26/21 16:47:55] INFO	--------------------------------------------------------------------------------
[12/26/21 16:47:55] INFO	Algorithm: LGB
[12/26/21 16:47:55] INFO	accuracy: 0.9730639730639731
[12/26/21 16:47:55] INFO	average_precision: 0.9961113207491221
[12/26/21 16:47:55] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 16:47:55] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 16:47:55] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 16:47:55] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 16:47:55] INFO	f1: 0.9643916913946586
[12/26/21 16:47:55] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 16:47:55] INFO	precision: 0.9789156626506024
[12/26/21 16:47:55] INFO	recall: 0.9502923976608187
[12/26/21 16:47:55] INFO	roc_auc: 0.9974861257576241
[12/26/21 16:47:55] INFO	--------------------------------------------------------------------------------
[12/26/21 16:47:55] INFO	Algorithm: XGB
[12/26/21 16:47:55] INFO	accuracy: 0.9304152637485971
[12/26/21 16:47:55] INFO	average_precision: 0.9737961321899262
[12/26/21 16:47:55] INFO	balanced_accuracy: 0.9165228645383952
[12/26/21 16:47:55] INFO	brier_score_loss: 0.07718214162033406
[12/26/21 16:47:55] INFO	cohen_kappa: 0.8499119718309859
[12/26/21 16:47:55] INFO	confusion_matrix: [[536  13]
 [ 49 293]]
[12/26/21 16:47:55] INFO	f1: 0.904320987654321
[12/26/21 16:47:55] INFO	neg_log_loss: 0.30038781373789814
[12/26/21 16:47:55] INFO	precision: 0.9575163398692811
[12/26/21 16:47:55] INFO	recall: 0.8567251461988304
[12/26/21 16:47:55] INFO	roc_auc: 0.9796440098424567
[12/26/21 16:47:55] INFO	================================================================================
[12/26/21 16:47:55] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 16:47:55] INFO	Best Model Selection Start: 2021-12-26 16:47:55.748257
[12/26/21 16:47:55] INFO	Scoring CATB Model
[12/26/21 16:47:55] INFO	Scoring LGB Model
[12/26/21 16:47:55] INFO	Scoring XGB Model
[12/26/21 16:47:55] INFO	Scoring BLEND Model
[12/26/21 16:47:55] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 16:47:55] INFO	Best Model Selection Complete: 0:00:00.000210
[12/26/21 16:47:55] INFO	================================================================================
[12/26/21 16:47:55] INFO	Generating Plots for partition: train
[12/26/21 16:47:55] INFO	Generating Calibration Plot
[12/26/21 16:47:55] INFO	Calibration for Algorithm: CATB
[12/26/21 16:47:55] INFO	Calibration for Algorithm: LGB
[12/26/21 16:47:55] INFO	Calibration for Algorithm: XGB
[12/26/21 16:47:55] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 16:47:55] INFO	Generating Confusion Matrices
[12/26/21 16:47:55] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 16:47:55] INFO	Confusion Matrix:
[12/26/21 16:47:55] INFO	[[509  40]
 [ 86 256]]
[12/26/21 16:47:55] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 16:47:56] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 16:47:56] INFO	Confusion Matrix:
[12/26/21 16:47:56] INFO	[[542   7]
 [ 17 325]]
[12/26/21 16:47:56] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 16:47:56] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 16:47:56] INFO	Confusion Matrix:
[12/26/21 16:47:56] INFO	[[536  13]
 [ 49 293]]
[12/26/21 16:47:56] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 16:47:56] INFO	Generating ROC Curves
[12/26/21 16:47:56] INFO	ROC Curve for Algorithm: CATB
[12/26/21 16:47:56] INFO	ROC Curve for Algorithm: LGB
[12/26/21 16:47:56] INFO	ROC Curve for Algorithm: XGB
[12/26/21 16:47:56] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 16:47:56] INFO	Generating Learning Curves
[12/26/21 16:47:56] INFO	Algorithm Configuration
[12/26/21 16:47:56] INFO	Learning Curve for Algorithm: CATB
[12/26/21 16:47:56] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 16:47:56] INFO	Learning Curve for Algorithm: LGB
[12/26/21 16:47:58] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 16:47:58] INFO	Learning Curve for Algorithm: XGB
[12/26/21 16:47:59] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 16:47:59] INFO	Generating Feature Importance Plots
[12/26/21 16:47:59] INFO	Feature Importances for Algorithm: CATB
[12/26/21 16:47:59] INFO	Feature Ranking:
[12/26/21 16:47:59] INFO	1. Sex_factor (45.178104)
[12/26/21 16:47:59] INFO	2. Pclass (13.721171)
[12/26/21 16:47:59] INFO	3. Age (6.651788)
[12/26/21 16:47:59] INFO	4. Fare (4.529770)
[12/26/21 16:47:59] INFO	5. var (3.586590)
[12/26/21 16:47:59] INFO	6. std (3.492385)
[12/26/21 16:47:59] INFO	7. Ticket_factor (3.315046)
[12/26/21 16:47:59] INFO	8. cluster_30 (2.831587)
[12/26/21 16:47:59] INFO	9. mean (2.733389)
[12/26/21 16:47:59] INFO	10. Name_factor (2.586310)
[12/26/21 16:47:59] INFO	11. Cabin_factor (2.101764)
[12/26/21 16:47:59] INFO	12. Embarked (2.086410)
[12/26/21 16:47:59] INFO	13. SibSp (2.085405)
[12/26/21 16:47:59] INFO	14. cluster_12 (1.876782)
[12/26/21 16:47:59] INFO	15. cluster_24 (1.263144)
[12/26/21 16:47:59] INFO	16. count_2 (1.004409)
[12/26/21 16:47:59] INFO	17. sum (0.955946)
[12/26/21 16:47:59] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 16:47:59] INFO	Feature Importances for Algorithm: LGB
[12/26/21 16:47:59] INFO	Feature Ranking:
[12/26/21 16:47:59] INFO	1. Fare (256.000000)
[12/26/21 16:47:59] INFO	2. sum (241.000000)
[12/26/21 16:47:59] INFO	3. Age (232.000000)
[12/26/21 16:47:59] INFO	4. std (201.000000)
[12/26/21 16:47:59] INFO	5. Ticket_factor (199.000000)
[12/26/21 16:47:59] INFO	6. Name_factor (175.000000)
[12/26/21 16:47:59] INFO	7. cluster_30 (53.000000)
[12/26/21 16:47:59] INFO	8. cluster_27 (46.000000)
[12/26/21 16:47:59] INFO	9. Sex_factor (43.000000)
[12/26/21 16:47:59] INFO	10. Pclass (43.000000)
[12/26/21 16:47:59] INFO	11. Cabin_factor (41.000000)
[12/26/21 16:47:59] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 16:47:59] INFO	Feature Importances for Algorithm: XGB
[12/26/21 16:47:59] INFO	Feature Ranking:
[12/26/21 16:47:59] INFO	1. Sex_factor (0.424644)
[12/26/21 16:47:59] INFO	2. Pclass (0.127452)
[12/26/21 16:47:59] INFO	3. Cabin_factor (0.081307)
[12/26/21 16:47:59] INFO	4. Age (0.051007)
[12/26/21 16:47:59] INFO	5. SibSp (0.049620)
[12/26/21 16:47:59] INFO	6. count_1 (0.046373)
[12/26/21 16:47:59] INFO	7. Embarked (0.046225)
[12/26/21 16:47:59] INFO	8. std (0.036262)
[12/26/21 16:47:59] INFO	9. cluster_30 (0.036076)
[12/26/21 16:47:59] INFO	10. Fare (0.032410)
[12/26/21 16:47:59] INFO	11. cluster_24 (0.021187)
[12/26/21 16:47:59] INFO	12. Name_factor (0.019312)
[12/26/21 16:47:59] INFO	13. sum (0.017784)
[12/26/21 16:47:59] INFO	14. cluster_15 (0.010340)
[12/26/21 16:47:59] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 16:47:59] INFO	Loading data from ./input/train_20211226.csv
[12/26/21 16:47:59] INFO	Saving Predictions
[12/26/21 16:47:59] INFO	Saving Probabilities
[12/26/21 16:47:59] INFO	Saving Ranked Predictions
[12/26/21 16:47:59] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 16:47:59] INFO	Saving Submission to ./output/submission_20211226.csv
[12/26/21 16:47:59] INFO	Saving Model Predictor
[12/26/21 16:47:59] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 16:47:59] INFO	Saving Feature Map
[12/26/21 16:47:59] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 16:47:59] INFO	********************************************************************************
[12/26/21 16:47:59] INFO	AlphaPy End
[12/26/21 16:47:59] INFO	********************************************************************************
[12/26/21 18:27:50] INFO	********************************************************************************
[12/26/21 18:27:50] INFO	AlphaPy Start
[12/26/21 18:27:50] INFO	********************************************************************************
[12/26/21 18:27:50] INFO	Model Configuration
[12/26/21 18:27:50] INFO	No transforms Found
[12/26/21 18:27:50] INFO	MODEL PARAMETERS:
[12/26/21 18:27:50] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:27:50] INFO	calibration       = False
[12/26/21 18:27:50] INFO	cal_type          = sigmoid
[12/26/21 18:27:50] INFO	calibration_plot  = False
[12/26/21 18:27:50] INFO	clustering        = True
[12/26/21 18:27:50] INFO	cluster_inc       = 3
[12/26/21 18:27:50] INFO	cluster_max       = 30
[12/26/21 18:27:50] INFO	cluster_min       = 3
[12/26/21 18:27:50] INFO	confusion_matrix  = True
[12/26/21 18:27:50] INFO	counts            = True
[12/26/21 18:27:50] INFO	cv_folds          = 3
[12/26/21 18:27:50] INFO	directory         = .
[12/26/21 18:27:50] INFO	extension         = csv
[12/26/21 18:27:50] INFO	drop              = ['PassengerId']
[12/26/21 18:27:50] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:27:50] INFO	esr               = 20
[12/26/21 18:27:50] INFO	factors           = ['Embarked']
[12/26/21 18:27:50] INFO	features [X]      = *
[12/26/21 18:27:50] INFO	feature_selection = False
[12/26/21 18:27:50] INFO	fs_percentage     = 50
[12/26/21 18:27:50] INFO	fs_score_func     = <function f_classif at 0x7fe81a978e50>
[12/26/21 18:27:50] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:27:50] INFO	grid_search       = True
[12/26/21 18:27:50] INFO	gs_iters          = 50
[12/26/21 18:27:50] INFO	gs_random         = True
[12/26/21 18:27:50] INFO	gs_sample         = False
[12/26/21 18:27:50] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:27:50] INFO	importances       = True
[12/26/21 18:27:50] INFO	interactions      = False
[12/26/21 18:27:50] INFO	isomap            = False
[12/26/21 18:27:50] INFO	iso_components    = 2
[12/26/21 18:27:50] INFO	iso_neighbors     = 5
[12/26/21 18:27:50] INFO	isample_pct       = 10
[12/26/21 18:27:50] INFO	leaders           = []
[12/26/21 18:27:50] INFO	learning_curve    = True
[12/26/21 18:27:50] INFO	logtransform      = False
[12/26/21 18:27:50] INFO	lv_remove         = True
[12/26/21 18:27:50] INFO	lv_threshold      = 0.100000
[12/26/21 18:27:50] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:27:50] INFO	n_estimators      = 51
[12/26/21 18:27:50] INFO	n_jobs            = -1
[12/26/21 18:27:50] INFO	ngrams_max        = 2
[12/26/21 18:27:50] INFO	numpy             = True
[12/26/21 18:27:50] INFO	pca               = False
[12/26/21 18:27:50] INFO	pca_inc           = 1
[12/26/21 18:27:50] INFO	pca_max           = 10
[12/26/21 18:27:50] INFO	pca_min           = 2
[12/26/21 18:27:50] INFO	pca_whiten        = False
[12/26/21 18:27:50] INFO	poly_degree       = 2
[12/26/21 18:27:50] INFO	pvalue_level      = 0.010000
[12/26/21 18:27:50] INFO	rfe               = True
[12/26/21 18:27:50] INFO	rfe_step          = 3
[12/26/21 18:27:50] INFO	roc_curve         = True
[12/26/21 18:27:50] INFO	rounding          = 2
[12/26/21 18:27:50] INFO	sampling          = False
[12/26/21 18:27:50] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:27:50] INFO	sampling_ratio    = 1.000000
[12/26/21 18:27:50] INFO	scaler_option     = True
[12/26/21 18:27:50] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:27:50] INFO	scipy             = False
[12/26/21 18:27:50] INFO	scorer            = roc_auc
[12/26/21 18:27:50] INFO	seed              = 42
[12/26/21 18:27:50] INFO	sentinel          = -1
[12/26/21 18:27:50] INFO	separator         = ,
[12/26/21 18:27:50] INFO	shuffle           = False
[12/26/21 18:27:50] INFO	split             = 0.400000
[12/26/21 18:27:50] INFO	submission_file   = gender_submission
[12/26/21 18:27:50] INFO	submit_probas     = False
[12/26/21 18:27:50] INFO	target [y]        = Survived
[12/26/21 18:27:50] INFO	target_value      = 1
[12/26/21 18:27:50] INFO	transforms        = None
[12/26/21 18:27:50] INFO	tsne              = False
[12/26/21 18:27:50] INFO	tsne_components   = 2
[12/26/21 18:27:50] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:27:50] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:27:50] INFO	vectorize         = False
[12/26/21 18:27:50] INFO	verbosity         = 0
[12/26/21 18:27:50] INFO	Creating Model
[12/26/21 18:29:00] INFO	********************************************************************************
[12/26/21 18:29:00] INFO	AlphaPy Start
[12/26/21 18:29:00] INFO	********************************************************************************
[12/26/21 18:29:00] INFO	Model Configuration
[12/26/21 18:29:00] INFO	No transforms Found
[12/26/21 18:29:00] INFO	MODEL PARAMETERS:
[12/26/21 18:29:00] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:29:00] INFO	calibration       = False
[12/26/21 18:29:00] INFO	cal_type          = sigmoid
[12/26/21 18:29:00] INFO	calibration_plot  = False
[12/26/21 18:29:00] INFO	clustering        = True
[12/26/21 18:29:00] INFO	cluster_inc       = 3
[12/26/21 18:29:00] INFO	cluster_max       = 30
[12/26/21 18:29:00] INFO	cluster_min       = 3
[12/26/21 18:29:00] INFO	confusion_matrix  = True
[12/26/21 18:29:00] INFO	counts            = True
[12/26/21 18:29:00] INFO	cv_folds          = 3
[12/26/21 18:29:00] INFO	directory         = .
[12/26/21 18:29:00] INFO	extension         = csv
[12/26/21 18:29:00] INFO	drop              = ['PassengerId']
[12/26/21 18:29:00] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:29:00] INFO	esr               = 20
[12/26/21 18:29:00] INFO	factors           = ['Embarked']
[12/26/21 18:29:00] INFO	features [X]      = *
[12/26/21 18:29:00] INFO	feature_selection = False
[12/26/21 18:29:00] INFO	fs_percentage     = 50
[12/26/21 18:29:00] INFO	fs_score_func     = <function f_classif at 0x7fe22a9bbee0>
[12/26/21 18:29:00] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:29:00] INFO	grid_search       = True
[12/26/21 18:29:00] INFO	gs_iters          = 50
[12/26/21 18:29:00] INFO	gs_random         = True
[12/26/21 18:29:00] INFO	gs_sample         = False
[12/26/21 18:29:00] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:29:00] INFO	importances       = True
[12/26/21 18:29:00] INFO	interactions      = False
[12/26/21 18:29:00] INFO	isomap            = False
[12/26/21 18:29:00] INFO	iso_components    = 2
[12/26/21 18:29:00] INFO	iso_neighbors     = 5
[12/26/21 18:29:00] INFO	isample_pct       = 10
[12/26/21 18:29:00] INFO	leaders           = []
[12/26/21 18:29:00] INFO	learning_curve    = True
[12/26/21 18:29:00] INFO	logtransform      = False
[12/26/21 18:29:00] INFO	lv_remove         = True
[12/26/21 18:29:00] INFO	lv_threshold      = 0.100000
[12/26/21 18:29:00] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:29:00] INFO	n_estimators      = 51
[12/26/21 18:29:00] INFO	n_jobs            = -1
[12/26/21 18:29:00] INFO	ngrams_max        = 2
[12/26/21 18:29:00] INFO	numpy             = True
[12/26/21 18:29:00] INFO	pca               = False
[12/26/21 18:29:00] INFO	pca_inc           = 1
[12/26/21 18:29:00] INFO	pca_max           = 10
[12/26/21 18:29:00] INFO	pca_min           = 2
[12/26/21 18:29:00] INFO	pca_whiten        = False
[12/26/21 18:29:00] INFO	poly_degree       = 2
[12/26/21 18:29:00] INFO	pvalue_level      = 0.010000
[12/26/21 18:29:00] INFO	rfe               = True
[12/26/21 18:29:00] INFO	rfe_step          = 3
[12/26/21 18:29:00] INFO	roc_curve         = True
[12/26/21 18:29:00] INFO	rounding          = 2
[12/26/21 18:29:00] INFO	sampling          = False
[12/26/21 18:29:00] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:29:00] INFO	sampling_ratio    = 1.000000
[12/26/21 18:29:00] INFO	scaler_option     = True
[12/26/21 18:29:00] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:29:00] INFO	scipy             = False
[12/26/21 18:29:00] INFO	scorer            = roc_auc
[12/26/21 18:29:00] INFO	seed              = 42
[12/26/21 18:29:00] INFO	sentinel          = -1
[12/26/21 18:29:00] INFO	separator         = ,
[12/26/21 18:29:00] INFO	shuffle           = False
[12/26/21 18:29:00] INFO	split             = 0.400000
[12/26/21 18:29:00] INFO	submission_file   = gender_submission
[12/26/21 18:29:00] INFO	submit_probas     = False
[12/26/21 18:29:00] INFO	target [y]        = Survived
[12/26/21 18:29:00] INFO	target_value      = 1
[12/26/21 18:29:00] INFO	transforms        = None
[12/26/21 18:29:00] INFO	tsne              = False
[12/26/21 18:29:00] INFO	tsne_components   = 2
[12/26/21 18:29:00] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:29:00] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:29:00] INFO	vectorize         = False
[12/26/21 18:29:00] INFO	verbosity         = 0
[12/26/21 18:29:00] INFO	Creating Model
[12/26/21 18:29:00] INFO	Calling Pipeline
[12/26/21 18:29:00] INFO	Training Pipeline
[12/26/21 18:29:00] INFO	Loading Data
[12/26/21 18:29:00] INFO	Loading data from ./input/train.csv
[12/26/21 18:29:00] INFO	Found target Survived in data frame
[12/26/21 18:29:00] INFO	Labels (y) found for Partition.train
[12/26/21 18:29:00] INFO	Loading Data
[12/26/21 18:29:00] INFO	Loading data from ./input/test.csv
[12/26/21 18:29:00] INFO	Target Survived not found in Partition.test
[12/26/21 18:29:00] INFO	Saving New Features in Model
[12/26/21 18:29:00] INFO	Original Feature Statistics
[12/26/21 18:29:00] INFO	Number of Training Rows    : 891
[12/26/21 18:29:00] INFO	Number of Training Columns : 11
[12/26/21 18:29:00] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:29:00] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:29:00] INFO	Number of Testing Rows     : 418
[12/26/21 18:29:00] INFO	Number of Testing Columns  : 11
[12/26/21 18:29:00] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:29:00] INFO	Feature Count     : 11
[12/26/21 18:29:00] INFO	Applying transforms
[12/26/21 18:29:00] INFO	No transforms Specified
[12/26/21 18:29:00] INFO	New Feature Count : 11
[12/26/21 18:29:00] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:29:00] INFO	Original Feature Count : 11
[12/26/21 18:29:00] INFO	Reduced Feature Count  : 10
[12/26/21 18:29:00] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:29:00] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:29:00] INFO	Creating Cross-Tabulations
[12/26/21 18:29:00] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:29:00] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:29:00] INFO	Feature Count     : 10
[12/26/21 18:29:00] INFO	Creating Count Features
[12/26/21 18:29:00] INFO	NA Counts
[12/26/21 18:29:00] INFO	Number Counts
[12/26/21 18:29:00] INFO	New Feature Count : 21
[12/26/21 18:29:00] INFO	Creating Base Features
[12/26/21 18:29:00] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:29:00] INFO	Feature 2: Name => Factorization
[12/26/21 18:29:00] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:29:00] INFO	Feature 3: Sex => Factorization
[12/26/21 18:29:00] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:29:00] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:29:00] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:29:00] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:29:00] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:29:00] INFO	Encoding: Encoders.target
[12/26/21 18:29:00] INFO	Fitting training features for Embarked
[12/26/21 18:29:00] INFO	Transforming testing features for Embarked
[12/26/21 18:29:00] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:29:00] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:29:00] INFO	New Feature Count : 21
[12/26/21 18:29:00] INFO	Scaling Base Features
[12/26/21 18:29:00] INFO	Creating NumPy Features
[12/26/21 18:29:00] INFO	NumPy Feature: sum
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	NumPy Feature: mean
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	NumPy Feature: std
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	NumPy Feature: var
[12/26/21 18:29:00] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:29:00] INFO	NumPy Feature Count : 4
[12/26/21 18:29:00] INFO	New Feature Count : 25
[12/26/21 18:29:00] INFO	Creating Clustering Features
[12/26/21 18:29:00] INFO	Cluster Minimum   : 3
[12/26/21 18:29:00] INFO	Cluster Maximum   : 30
[12/26/21 18:29:00] INFO	Cluster Increment : 3
[12/26/21 18:29:00] INFO	k = 3
[12/26/21 18:29:02] INFO	k = 6
[12/26/21 18:29:02] INFO	k = 9
[12/26/21 18:29:02] INFO	k = 12
[12/26/21 18:29:02] INFO	k = 15
[12/26/21 18:29:02] INFO	k = 18
[12/26/21 18:29:02] INFO	k = 21
[12/26/21 18:29:02] INFO	k = 24
[12/26/21 18:29:02] INFO	k = 27
[12/26/21 18:29:02] INFO	k = 30
[12/26/21 18:29:02] INFO	Clustering Feature Count : 10
[12/26/21 18:29:02] INFO	New Feature Count : 35
[12/26/21 18:29:02] INFO	Saving New Features in Model
[12/26/21 18:29:02] INFO	Creating Interactions
[12/26/21 18:29:02] INFO	Initial Feature Count  : 35
[12/26/21 18:29:02] INFO	Skipping Interactions
[12/26/21 18:29:02] INFO	Saving New Features in Model
[12/26/21 18:29:02] INFO	Removing Low-Variance Features
[12/26/21 18:29:02] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:29:02] INFO	Original Feature Count  : 35
[12/26/21 18:29:02] INFO	Reduced Feature Count   : 35
[12/26/21 18:29:02] INFO	Saving New Features in Model
[12/26/21 18:29:02] INFO	Skipping Shuffling
[12/26/21 18:29:02] INFO	Skipping Sampling
[12/26/21 18:29:02] INFO	Getting All Estimators
[12/26/21 18:29:02] INFO	Algorithm Configuration
[12/26/21 18:29:03] INFO	Selecting Models
[12/26/21 18:29:03] INFO	Algorithm: CATB
[12/26/21 18:29:03] INFO	Fitting Initial Model
[12/26/21 18:29:03] INFO	Cross-Validation
[12/26/21 18:29:04] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:29:04] INFO	Recursive Feature Elimination with CV
[12/26/21 18:29:07] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[12/26/21 18:29:07] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:29:07] INFO	No grid is defined for grid search
[12/26/21 18:29:07] INFO	Final Model Predictions for CATB
[12/26/21 18:29:07] INFO	Skipping Calibration
[12/26/21 18:29:07] INFO	Making Predictions
[12/26/21 18:29:07] INFO	Predictions Complete
[12/26/21 18:29:07] INFO	Algorithm: LGB
[12/26/21 18:29:07] INFO	Fitting Initial Model
[12/26/21 18:29:07] INFO	Cross-Validation
[12/26/21 18:29:08] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:29:08] INFO	Recursive Feature Elimination with CV
[12/26/21 18:29:11] INFO	RFECV took 2.48 seconds for step 3 and 3 folds
[12/26/21 18:29:11] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:29:11] INFO	No grid is defined for grid search
[12/26/21 18:29:11] INFO	Final Model Predictions for LGB
[12/26/21 18:29:11] INFO	Skipping Calibration
[12/26/21 18:29:11] INFO	Making Predictions
[12/26/21 18:29:11] INFO	Predictions Complete
[12/26/21 18:29:11] INFO	Algorithm: XGB
[12/26/21 18:29:11] INFO	Fitting Initial Model
[12/26/21 18:29:11] INFO	Cross-Validation
[12/26/21 18:29:11] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:29:11] INFO	Recursive Feature Elimination with CV
[12/26/21 18:29:14] INFO	RFECV took 2.33 seconds for step 3 and 3 folds
[12/26/21 18:29:14] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:29:14] INFO	Randomized Grid Search
[12/26/21 18:30:08] INFO	Grid Search took 54.45 seconds for 50 candidate parameter settings.
[12/26/21 18:30:08] INFO	Model with rank: 1
[12/26/21 18:30:08] INFO	Mean validation score: 0.872 (std: 0.024)
[12/26/21 18:30:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/26/21 18:30:08] INFO	Model with rank: 2
[12/26/21 18:30:08] INFO	Mean validation score: 0.871 (std: 0.031)
[12/26/21 18:30:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 18:30:08] INFO	Model with rank: 3
[12/26/21 18:30:08] INFO	Mean validation score: 0.870 (std: 0.022)
[12/26/21 18:30:08] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 18:30:08] INFO	Algorithm: XGB, Best Score: 0.8716, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/26/21 18:30:08] INFO	Final Model Predictions for XGB
[12/26/21 18:30:08] INFO	Skipping Calibration
[12/26/21 18:30:08] INFO	Making Predictions
[12/26/21 18:30:08] INFO	Predictions Complete
[12/26/21 18:30:08] INFO	Blending Models
[12/26/21 18:30:08] INFO	Blending Start: 2021-12-26 18:30:08.737033
[12/26/21 18:30:08] INFO	Blending Complete: 0:00:00.007588
[12/26/21 18:30:08] INFO	================================================================================
[12/26/21 18:30:08] INFO	Metrics for: Partition.train
[12/26/21 18:30:08] INFO	--------------------------------------------------------------------------------
[12/26/21 18:30:08] INFO	Algorithm: CATB
[12/26/21 18:30:08] INFO	accuracy: 0.8585858585858586
[12/26/21 18:30:08] INFO	average_precision: 0.9113351686222868
[12/26/21 18:30:08] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:30:08] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:30:08] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:30:08] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:30:08] INFO	f1: 0.8025078369905956
[12/26/21 18:30:08] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:30:08] INFO	precision: 0.8648648648648649
[12/26/21 18:30:08] INFO	recall: 0.7485380116959064
[12/26/21 18:30:08] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:30:08] INFO	--------------------------------------------------------------------------------
[12/26/21 18:30:08] INFO	Algorithm: LGB
[12/26/21 18:30:08] INFO	accuracy: 0.9730639730639731
[12/26/21 18:30:08] INFO	average_precision: 0.9961113207491221
[12/26/21 18:30:08] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:30:08] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:30:08] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:30:08] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:30:08] INFO	f1: 0.9643916913946586
[12/26/21 18:30:08] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:30:08] INFO	precision: 0.9789156626506024
[12/26/21 18:30:08] INFO	recall: 0.9502923976608187
[12/26/21 18:30:08] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:30:08] INFO	--------------------------------------------------------------------------------
[12/26/21 18:30:08] INFO	Algorithm: XGB
[12/26/21 18:30:08] INFO	accuracy: 0.8911335578002245
[12/26/21 18:30:08] INFO	average_precision: 0.9341195593208514
[12/26/21 18:30:08] INFO	balanced_accuracy: 0.8714169303039019
[12/26/21 18:30:08] INFO	brier_score_loss: 0.17819410720682557
[12/26/21 18:30:08] INFO	cohen_kappa: 0.7634554277409661
[12/26/21 18:30:08] INFO	confusion_matrix: [[525  24]
 [ 73 269]]
[12/26/21 18:30:08] INFO	f1: 0.847244094488189
[12/26/21 18:30:08] INFO	neg_log_loss: 0.5470199107655505
[12/26/21 18:30:08] INFO	precision: 0.9180887372013652
[12/26/21 18:30:08] INFO	recall: 0.7865497076023392
[12/26/21 18:30:08] INFO	roc_auc: 0.9453844842829598
[12/26/21 18:30:08] INFO	================================================================================
[12/26/21 18:30:08] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:30:08] INFO	Best Model Selection Start: 2021-12-26 18:30:08.765274
[12/26/21 18:30:08] INFO	Scoring CATB Model
[12/26/21 18:30:08] INFO	Scoring LGB Model
[12/26/21 18:30:08] INFO	Scoring XGB Model
[12/26/21 18:30:08] INFO	Scoring BLEND Model
[12/26/21 18:30:08] INFO	Best Model is BLEND with a roc_auc score of 0.9980
[12/26/21 18:30:08] INFO	Best Model Selection Complete: 0:00:00.000243
[12/26/21 18:30:08] INFO	================================================================================
[12/26/21 18:30:08] INFO	Generating Plots for partition: train
[12/26/21 18:30:08] INFO	Generating Calibration Plot
[12/26/21 18:30:08] INFO	Calibration for Algorithm: CATB
[12/26/21 18:30:08] INFO	Calibration for Algorithm: LGB
[12/26/21 18:30:08] INFO	Calibration for Algorithm: XGB
[12/26/21 18:30:08] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:30:08] INFO	Generating Confusion Matrices
[12/26/21 18:30:08] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:30:08] INFO	Confusion Matrix:
[12/26/21 18:30:08] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:30:08] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:30:09] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:30:09] INFO	Confusion Matrix:
[12/26/21 18:30:09] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:30:09] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:30:09] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:30:09] INFO	Confusion Matrix:
[12/26/21 18:30:09] INFO	[[525  24]
 [ 73 269]]
[12/26/21 18:30:09] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:30:09] INFO	Generating ROC Curves
[12/26/21 18:30:09] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:30:09] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:30:09] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:30:09] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:30:09] INFO	Generating Learning Curves
[12/26/21 18:30:09] INFO	Algorithm Configuration
[12/26/21 18:30:09] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:30:09] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:30:09] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:30:11] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:30:11] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:30:12] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:30:12] INFO	Generating Feature Importance Plots
[12/26/21 18:30:12] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:30:12] INFO	Feature Ranking:
[12/26/21 18:30:12] INFO	1. Sex_factor (45.178104)
[12/26/21 18:30:12] INFO	2. Pclass (13.721171)
[12/26/21 18:30:12] INFO	3. Age (6.651788)
[12/26/21 18:30:12] INFO	4. Fare (4.529770)
[12/26/21 18:30:12] INFO	5. var (3.586590)
[12/26/21 18:30:12] INFO	6. std (3.492385)
[12/26/21 18:30:12] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:30:12] INFO	8. cluster_30 (2.831587)
[12/26/21 18:30:12] INFO	9. mean (2.733389)
[12/26/21 18:30:12] INFO	10. Name_factor (2.586310)
[12/26/21 18:30:12] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:30:12] INFO	12. Embarked (2.086410)
[12/26/21 18:30:12] INFO	13. SibSp (2.085405)
[12/26/21 18:30:12] INFO	14. cluster_12 (1.876782)
[12/26/21 18:30:12] INFO	15. cluster_24 (1.263144)
[12/26/21 18:30:12] INFO	16. count_2 (1.004409)
[12/26/21 18:30:12] INFO	17. sum (0.955946)
[12/26/21 18:30:12] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:30:12] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:30:12] INFO	Feature Ranking:
[12/26/21 18:30:12] INFO	1. Fare (256.000000)
[12/26/21 18:30:12] INFO	2. sum (241.000000)
[12/26/21 18:30:12] INFO	3. Age (232.000000)
[12/26/21 18:30:12] INFO	4. std (201.000000)
[12/26/21 18:30:12] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:30:12] INFO	6. Name_factor (175.000000)
[12/26/21 18:30:12] INFO	7. cluster_30 (53.000000)
[12/26/21 18:30:12] INFO	8. cluster_27 (46.000000)
[12/26/21 18:30:12] INFO	9. Sex_factor (43.000000)
[12/26/21 18:30:12] INFO	10. Pclass (43.000000)
[12/26/21 18:30:12] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:30:12] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:30:12] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:30:12] INFO	Feature Ranking:
[12/26/21 18:30:12] INFO	1. Sex_factor (0.424644)
[12/26/21 18:30:12] INFO	2. Pclass (0.127452)
[12/26/21 18:30:12] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:30:12] INFO	4. Age (0.051007)
[12/26/21 18:30:12] INFO	5. SibSp (0.049620)
[12/26/21 18:30:12] INFO	6. count_1 (0.046373)
[12/26/21 18:30:12] INFO	7. Embarked (0.046225)
[12/26/21 18:30:12] INFO	8. std (0.036262)
[12/26/21 18:30:12] INFO	9. cluster_30 (0.036076)
[12/26/21 18:30:12] INFO	10. Fare (0.032410)
[12/26/21 18:30:12] INFO	11. cluster_24 (0.021187)
[12/26/21 18:30:12] INFO	12. Name_factor (0.019312)
[12/26/21 18:30:12] INFO	13. sum (0.017784)
[12/26/21 18:30:12] INFO	14. cluster_15 (0.010340)
[12/26/21 18:30:12] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:31:40] INFO	********************************************************************************
[12/26/21 18:31:40] INFO	AlphaPy Start
[12/26/21 18:31:40] INFO	********************************************************************************
[12/26/21 18:31:40] INFO	Model Configuration
[12/26/21 18:31:40] INFO	No transforms Found
[12/26/21 18:31:40] INFO	MODEL PARAMETERS:
[12/26/21 18:31:40] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:31:40] INFO	calibration       = False
[12/26/21 18:31:40] INFO	cal_type          = sigmoid
[12/26/21 18:31:40] INFO	calibration_plot  = False
[12/26/21 18:31:40] INFO	clustering        = True
[12/26/21 18:31:40] INFO	cluster_inc       = 3
[12/26/21 18:31:40] INFO	cluster_max       = 30
[12/26/21 18:31:40] INFO	cluster_min       = 3
[12/26/21 18:31:40] INFO	confusion_matrix  = True
[12/26/21 18:31:40] INFO	counts            = True
[12/26/21 18:31:40] INFO	cv_folds          = 3
[12/26/21 18:31:40] INFO	directory         = .
[12/26/21 18:31:40] INFO	extension         = csv
[12/26/21 18:31:40] INFO	drop              = ['PassengerId']
[12/26/21 18:31:40] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:31:40] INFO	esr               = 20
[12/26/21 18:31:40] INFO	factors           = ['Embarked']
[12/26/21 18:31:40] INFO	features [X]      = *
[12/26/21 18:31:40] INFO	feature_selection = False
[12/26/21 18:31:40] INFO	fs_percentage     = 50
[12/26/21 18:31:40] INFO	fs_score_func     = <function f_classif at 0x7fd772bb3ee0>
[12/26/21 18:31:40] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:31:40] INFO	grid_search       = True
[12/26/21 18:31:40] INFO	gs_iters          = 50
[12/26/21 18:31:40] INFO	gs_random         = True
[12/26/21 18:31:40] INFO	gs_sample         = False
[12/26/21 18:31:40] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:31:40] INFO	importances       = True
[12/26/21 18:31:40] INFO	interactions      = False
[12/26/21 18:31:40] INFO	isomap            = False
[12/26/21 18:31:40] INFO	iso_components    = 2
[12/26/21 18:31:40] INFO	iso_neighbors     = 5
[12/26/21 18:31:40] INFO	isample_pct       = 10
[12/26/21 18:31:40] INFO	leaders           = []
[12/26/21 18:31:40] INFO	learning_curve    = True
[12/26/21 18:31:40] INFO	logtransform      = False
[12/26/21 18:31:40] INFO	lv_remove         = True
[12/26/21 18:31:40] INFO	lv_threshold      = 0.100000
[12/26/21 18:31:40] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:31:40] INFO	n_estimators      = 51
[12/26/21 18:31:40] INFO	n_jobs            = -1
[12/26/21 18:31:40] INFO	ngrams_max        = 2
[12/26/21 18:31:40] INFO	numpy             = True
[12/26/21 18:31:40] INFO	pca               = False
[12/26/21 18:31:40] INFO	pca_inc           = 1
[12/26/21 18:31:40] INFO	pca_max           = 10
[12/26/21 18:31:40] INFO	pca_min           = 2
[12/26/21 18:31:40] INFO	pca_whiten        = False
[12/26/21 18:31:40] INFO	poly_degree       = 2
[12/26/21 18:31:40] INFO	pvalue_level      = 0.010000
[12/26/21 18:31:40] INFO	rfe               = True
[12/26/21 18:31:40] INFO	rfe_step          = 3
[12/26/21 18:31:40] INFO	roc_curve         = True
[12/26/21 18:31:40] INFO	rounding          = 2
[12/26/21 18:31:40] INFO	sampling          = False
[12/26/21 18:31:40] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:31:40] INFO	sampling_ratio    = 1.000000
[12/26/21 18:31:40] INFO	scaler_option     = True
[12/26/21 18:31:40] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:31:40] INFO	scipy             = False
[12/26/21 18:31:40] INFO	scorer            = roc_auc
[12/26/21 18:31:40] INFO	seed              = 42
[12/26/21 18:31:40] INFO	sentinel          = -1
[12/26/21 18:31:40] INFO	separator         = ,
[12/26/21 18:31:40] INFO	shuffle           = False
[12/26/21 18:31:40] INFO	split             = 0.400000
[12/26/21 18:31:40] INFO	submission_file   = gender_submission
[12/26/21 18:31:40] INFO	submit_probas     = False
[12/26/21 18:31:40] INFO	target [y]        = Survived
[12/26/21 18:31:40] INFO	target_value      = 1
[12/26/21 18:31:40] INFO	transforms        = None
[12/26/21 18:31:40] INFO	tsne              = False
[12/26/21 18:31:40] INFO	tsne_components   = 2
[12/26/21 18:31:40] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:31:40] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:31:40] INFO	vectorize         = False
[12/26/21 18:31:40] INFO	verbosity         = 0
[12/26/21 18:31:40] INFO	Creating Model
[12/26/21 18:31:40] INFO	Calling Pipeline
[12/26/21 18:31:40] INFO	Training Pipeline
[12/26/21 18:31:40] INFO	Loading Data
[12/26/21 18:31:40] INFO	Loading data from ./input/train.csv
[12/26/21 18:31:40] INFO	Found target Survived in data frame
[12/26/21 18:31:40] INFO	Labels (y) found for Partition.train
[12/26/21 18:31:40] INFO	Loading Data
[12/26/21 18:31:40] INFO	Loading data from ./input/test.csv
[12/26/21 18:31:40] INFO	Target Survived not found in Partition.test
[12/26/21 18:31:40] INFO	Saving New Features in Model
[12/26/21 18:31:40] INFO	Original Feature Statistics
[12/26/21 18:31:40] INFO	Number of Training Rows    : 891
[12/26/21 18:31:40] INFO	Number of Training Columns : 11
[12/26/21 18:31:40] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:31:40] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:31:40] INFO	Number of Testing Rows     : 418
[12/26/21 18:31:40] INFO	Number of Testing Columns  : 11
[12/26/21 18:31:40] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:31:40] INFO	Feature Count     : 11
[12/26/21 18:31:40] INFO	Applying transforms
[12/26/21 18:31:40] INFO	No transforms Specified
[12/26/21 18:31:40] INFO	New Feature Count : 11
[12/26/21 18:31:40] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:31:40] INFO	Original Feature Count : 11
[12/26/21 18:31:40] INFO	Reduced Feature Count  : 10
[12/26/21 18:31:40] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:31:40] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:31:40] INFO	Creating Cross-Tabulations
[12/26/21 18:31:40] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:31:40] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:31:40] INFO	Feature Count     : 10
[12/26/21 18:31:40] INFO	Creating Count Features
[12/26/21 18:31:40] INFO	NA Counts
[12/26/21 18:31:40] INFO	Number Counts
[12/26/21 18:31:40] INFO	New Feature Count : 21
[12/26/21 18:31:40] INFO	Creating Base Features
[12/26/21 18:31:40] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:31:40] INFO	Feature 2: Name => Factorization
[12/26/21 18:31:40] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:31:40] INFO	Feature 3: Sex => Factorization
[12/26/21 18:31:40] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:31:40] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:31:40] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:31:40] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:31:40] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:31:40] INFO	Encoding: Encoders.target
[12/26/21 18:31:40] INFO	Fitting training features for Embarked
[12/26/21 18:31:40] INFO	Transforming testing features for Embarked
[12/26/21 18:31:40] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:31:40] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:31:40] INFO	New Feature Count : 21
[12/26/21 18:31:40] INFO	Scaling Base Features
[12/26/21 18:31:40] INFO	Creating NumPy Features
[12/26/21 18:31:40] INFO	NumPy Feature: sum
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	NumPy Feature: mean
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	NumPy Feature: std
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	NumPy Feature: var
[12/26/21 18:31:40] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:31:40] INFO	NumPy Feature Count : 4
[12/26/21 18:31:40] INFO	New Feature Count : 25
[12/26/21 18:31:40] INFO	Creating Clustering Features
[12/26/21 18:31:40] INFO	Cluster Minimum   : 3
[12/26/21 18:31:40] INFO	Cluster Maximum   : 30
[12/26/21 18:31:40] INFO	Cluster Increment : 3
[12/26/21 18:31:40] INFO	k = 3
[12/26/21 18:31:42] INFO	k = 6
[12/26/21 18:31:42] INFO	k = 9
[12/26/21 18:31:42] INFO	k = 12
[12/26/21 18:31:42] INFO	k = 15
[12/26/21 18:31:42] INFO	k = 18
[12/26/21 18:31:42] INFO	k = 21
[12/26/21 18:31:42] INFO	k = 24
[12/26/21 18:31:42] INFO	k = 27
[12/26/21 18:31:42] INFO	k = 30
[12/26/21 18:31:42] INFO	Clustering Feature Count : 10
[12/26/21 18:31:42] INFO	New Feature Count : 35
[12/26/21 18:31:42] INFO	Saving New Features in Model
[12/26/21 18:31:42] INFO	Creating Interactions
[12/26/21 18:31:42] INFO	Initial Feature Count  : 35
[12/26/21 18:31:42] INFO	Skipping Interactions
[12/26/21 18:31:42] INFO	Saving New Features in Model
[12/26/21 18:31:42] INFO	Removing Low-Variance Features
[12/26/21 18:31:42] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:31:42] INFO	Original Feature Count  : 35
[12/26/21 18:31:42] INFO	Reduced Feature Count   : 35
[12/26/21 18:31:42] INFO	Saving New Features in Model
[12/26/21 18:31:42] INFO	Skipping Shuffling
[12/26/21 18:31:42] INFO	Skipping Sampling
[12/26/21 18:31:42] INFO	Getting All Estimators
[12/26/21 18:31:42] INFO	Algorithm Configuration
[12/26/21 18:31:43] INFO	Selecting Models
[12/26/21 18:31:43] INFO	Algorithm: CATB
[12/26/21 18:31:43] INFO	Fitting Initial Model
[12/26/21 18:31:43] INFO	Cross-Validation
[12/26/21 18:31:44] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:31:44] INFO	Recursive Feature Elimination with CV
[12/26/21 18:31:47] INFO	RFECV took 2.52 seconds for step 3 and 3 folds
[12/26/21 18:31:47] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:31:47] INFO	No grid is defined for grid search
[12/26/21 18:31:47] INFO	Final Model Predictions for CATB
[12/26/21 18:31:47] INFO	Skipping Calibration
[12/26/21 18:31:47] INFO	Making Predictions
[12/26/21 18:31:47] INFO	Predictions Complete
[12/26/21 18:31:47] INFO	Algorithm: LGB
[12/26/21 18:31:47] INFO	Fitting Initial Model
[12/26/21 18:31:47] INFO	Cross-Validation
[12/26/21 18:31:48] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:31:48] INFO	Recursive Feature Elimination with CV
[12/26/21 18:31:51] INFO	RFECV took 3.16 seconds for step 3 and 3 folds
[12/26/21 18:31:51] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:31:51] INFO	No grid is defined for grid search
[12/26/21 18:31:51] INFO	Final Model Predictions for LGB
[12/26/21 18:31:51] INFO	Skipping Calibration
[12/26/21 18:31:51] INFO	Making Predictions
[12/26/21 18:31:51] INFO	Predictions Complete
[12/26/21 18:31:51] INFO	Algorithm: XGB
[12/26/21 18:31:51] INFO	Fitting Initial Model
[12/26/21 18:31:51] INFO	Cross-Validation
[12/26/21 18:31:51] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:31:51] INFO	Recursive Feature Elimination with CV
[12/26/21 18:31:54] INFO	RFECV took 2.49 seconds for step 3 and 3 folds
[12/26/21 18:31:54] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:31:54] INFO	Randomized Grid Search
[12/26/21 18:32:44] INFO	Grid Search took 49.56 seconds for 50 candidate parameter settings.
[12/26/21 18:32:44] INFO	Model with rank: 1
[12/26/21 18:32:44] INFO	Mean validation score: 0.873 (std: 0.021)
[12/26/21 18:32:44] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/26/21 18:32:44] INFO	Model with rank: 2
[12/26/21 18:32:44] INFO	Mean validation score: 0.873 (std: 0.023)
[12/26/21 18:32:44] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/26/21 18:32:44] INFO	Model with rank: 3
[12/26/21 18:32:44] INFO	Mean validation score: 0.872 (std: 0.021)
[12/26/21 18:32:44] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/26/21 18:32:44] INFO	Algorithm: XGB, Best Score: 0.8735, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.9}
[12/26/21 18:32:44] INFO	Final Model Predictions for XGB
[12/26/21 18:32:44] INFO	Skipping Calibration
[12/26/21 18:32:44] INFO	Making Predictions
[12/26/21 18:32:44] INFO	Predictions Complete
[12/26/21 18:32:44] INFO	Blending Models
[12/26/21 18:32:44] INFO	Blending Start: 2021-12-26 18:32:44.009730
[12/26/21 18:32:44] INFO	Blending Complete: 0:00:00.004669
[12/26/21 18:32:44] INFO	================================================================================
[12/26/21 18:32:44] INFO	Metrics for: Partition.train
[12/26/21 18:32:44] INFO	--------------------------------------------------------------------------------
[12/26/21 18:32:44] INFO	Algorithm: CATB
[12/26/21 18:32:44] INFO	accuracy: 0.8585858585858586
[12/26/21 18:32:44] INFO	average_precision: 0.9113351686222868
[12/26/21 18:32:44] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:32:44] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:32:44] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:32:44] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:32:44] INFO	f1: 0.8025078369905956
[12/26/21 18:32:44] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:32:44] INFO	precision: 0.8648648648648649
[12/26/21 18:32:44] INFO	recall: 0.7485380116959064
[12/26/21 18:32:44] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:32:44] INFO	--------------------------------------------------------------------------------
[12/26/21 18:32:44] INFO	Algorithm: LGB
[12/26/21 18:32:44] INFO	accuracy: 0.9730639730639731
[12/26/21 18:32:44] INFO	average_precision: 0.9961113207491221
[12/26/21 18:32:44] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:32:44] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:32:44] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:32:44] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:32:44] INFO	f1: 0.9643916913946586
[12/26/21 18:32:44] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:32:44] INFO	precision: 0.9789156626506024
[12/26/21 18:32:44] INFO	recall: 0.9502923976608187
[12/26/21 18:32:44] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:32:44] INFO	--------------------------------------------------------------------------------
[12/26/21 18:32:44] INFO	Algorithm: XGB
[12/26/21 18:32:44] INFO	accuracy: 0.920314253647587
[12/26/21 18:32:44] INFO	average_precision: 0.9659022641603615
[12/26/21 18:32:44] INFO	balanced_accuracy: 0.9072236602435049
[12/26/21 18:32:44] INFO	brier_score_loss: 0.06510288619708102
[12/26/21 18:32:44] INFO	cohen_kappa: 0.8286069591085319
[12/26/21 18:32:44] INFO	confusion_matrix: [[529  20]
 [ 51 291]]
[12/26/21 18:32:44] INFO	f1: 0.891271056661562
[12/26/21 18:32:44] INFO	neg_log_loss: 0.24123892048007978
[12/26/21 18:32:44] INFO	precision: 0.9356913183279743
[12/26/21 18:32:44] INFO	recall: 0.8508771929824561
[12/26/21 18:32:44] INFO	roc_auc: 0.9731622620607379
[12/26/21 18:32:44] INFO	================================================================================
[12/26/21 18:32:44] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:32:44] INFO	Best Model Selection Start: 2021-12-26 18:32:44.034677
[12/26/21 18:32:44] INFO	Scoring CATB Model
[12/26/21 18:32:44] INFO	Scoring LGB Model
[12/26/21 18:32:44] INFO	Scoring XGB Model
[12/26/21 18:32:44] INFO	Scoring BLEND Model
[12/26/21 18:32:44] INFO	Best Model is BLEND with a roc_auc score of 0.9977
[12/26/21 18:32:44] INFO	Best Model Selection Complete: 0:00:00.000204
[12/26/21 18:32:44] INFO	================================================================================
[12/26/21 18:32:44] INFO	Generating Plots for partition: train
[12/26/21 18:32:44] INFO	Generating Calibration Plot
[12/26/21 18:32:44] INFO	Calibration for Algorithm: CATB
[12/26/21 18:32:44] INFO	Calibration for Algorithm: LGB
[12/26/21 18:32:44] INFO	Calibration for Algorithm: XGB
[12/26/21 18:32:44] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:32:44] INFO	Generating Confusion Matrices
[12/26/21 18:32:44] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:32:44] INFO	Confusion Matrix:
[12/26/21 18:32:44] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:32:44] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:32:44] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:32:44] INFO	Confusion Matrix:
[12/26/21 18:32:44] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:32:44] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:32:44] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:32:44] INFO	Confusion Matrix:
[12/26/21 18:32:44] INFO	[[529  20]
 [ 51 291]]
[12/26/21 18:32:44] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:32:44] INFO	Generating ROC Curves
[12/26/21 18:32:44] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:32:44] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:32:44] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:32:44] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:32:44] INFO	Generating Learning Curves
[12/26/21 18:32:44] INFO	Algorithm Configuration
[12/26/21 18:32:44] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:32:45] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:32:45] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:32:46] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:32:47] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:32:47] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:32:47] INFO	Generating Feature Importance Plots
[12/26/21 18:32:47] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:32:47] INFO	Feature Ranking:
[12/26/21 18:32:47] INFO	1. Sex_factor (45.178104)
[12/26/21 18:32:47] INFO	2. Pclass (13.721171)
[12/26/21 18:32:47] INFO	3. Age (6.651788)
[12/26/21 18:32:47] INFO	4. Fare (4.529770)
[12/26/21 18:32:47] INFO	5. var (3.586590)
[12/26/21 18:32:47] INFO	6. std (3.492385)
[12/26/21 18:32:47] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:32:47] INFO	8. cluster_30 (2.831587)
[12/26/21 18:32:47] INFO	9. mean (2.733389)
[12/26/21 18:32:47] INFO	10. Name_factor (2.586310)
[12/26/21 18:32:47] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:32:47] INFO	12. Embarked (2.086410)
[12/26/21 18:32:47] INFO	13. SibSp (2.085405)
[12/26/21 18:32:47] INFO	14. cluster_12 (1.876782)
[12/26/21 18:32:47] INFO	15. cluster_24 (1.263144)
[12/26/21 18:32:47] INFO	16. count_2 (1.004409)
[12/26/21 18:32:47] INFO	17. sum (0.955946)
[12/26/21 18:32:47] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:32:47] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:32:47] INFO	Feature Ranking:
[12/26/21 18:32:47] INFO	1. Fare (256.000000)
[12/26/21 18:32:47] INFO	2. sum (241.000000)
[12/26/21 18:32:47] INFO	3. Age (232.000000)
[12/26/21 18:32:47] INFO	4. std (201.000000)
[12/26/21 18:32:47] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:32:47] INFO	6. Name_factor (175.000000)
[12/26/21 18:32:47] INFO	7. cluster_30 (53.000000)
[12/26/21 18:32:47] INFO	8. cluster_27 (46.000000)
[12/26/21 18:32:47] INFO	9. Sex_factor (43.000000)
[12/26/21 18:32:47] INFO	10. Pclass (43.000000)
[12/26/21 18:32:47] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:32:47] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:32:48] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:32:48] INFO	Feature Ranking:
[12/26/21 18:32:48] INFO	1. Sex_factor (0.424644)
[12/26/21 18:32:48] INFO	2. Pclass (0.127452)
[12/26/21 18:32:48] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:32:48] INFO	4. Age (0.051007)
[12/26/21 18:32:48] INFO	5. SibSp (0.049620)
[12/26/21 18:32:48] INFO	6. count_1 (0.046373)
[12/26/21 18:32:48] INFO	7. Embarked (0.046225)
[12/26/21 18:32:48] INFO	8. std (0.036262)
[12/26/21 18:32:48] INFO	9. cluster_30 (0.036076)
[12/26/21 18:32:48] INFO	10. Fare (0.032410)
[12/26/21 18:32:48] INFO	11. cluster_24 (0.021187)
[12/26/21 18:32:48] INFO	12. Name_factor (0.019312)
[12/26/21 18:32:48] INFO	13. sum (0.017784)
[12/26/21 18:32:48] INFO	14. cluster_15 (0.010340)
[12/26/21 18:32:48] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:37:08] INFO	********************************************************************************
[12/26/21 18:37:08] INFO	AlphaPy Start
[12/26/21 18:37:08] INFO	********************************************************************************
[12/26/21 18:37:08] INFO	Model Configuration
[12/26/21 18:37:08] INFO	No transforms Found
[12/26/21 18:37:08] INFO	MODEL PARAMETERS:
[12/26/21 18:37:08] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:37:08] INFO	calibration       = False
[12/26/21 18:37:08] INFO	cal_type          = sigmoid
[12/26/21 18:37:08] INFO	calibration_plot  = False
[12/26/21 18:37:08] INFO	clustering        = True
[12/26/21 18:37:08] INFO	cluster_inc       = 3
[12/26/21 18:37:08] INFO	cluster_max       = 30
[12/26/21 18:37:08] INFO	cluster_min       = 3
[12/26/21 18:37:08] INFO	confusion_matrix  = True
[12/26/21 18:37:08] INFO	counts            = True
[12/26/21 18:37:08] INFO	cv_folds          = 3
[12/26/21 18:37:08] INFO	directory         = .
[12/26/21 18:37:08] INFO	extension         = csv
[12/26/21 18:37:08] INFO	drop              = ['PassengerId']
[12/26/21 18:37:08] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:37:08] INFO	esr               = 20
[12/26/21 18:37:08] INFO	factors           = ['Embarked']
[12/26/21 18:37:08] INFO	features [X]      = *
[12/26/21 18:37:08] INFO	feature_selection = False
[12/26/21 18:37:08] INFO	fs_percentage     = 50
[12/26/21 18:37:08] INFO	fs_score_func     = <function f_classif at 0x7fd2f9df9e50>
[12/26/21 18:37:08] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:37:08] INFO	grid_search       = True
[12/26/21 18:37:08] INFO	gs_iters          = 50
[12/26/21 18:37:08] INFO	gs_random         = True
[12/26/21 18:37:08] INFO	gs_sample         = False
[12/26/21 18:37:08] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:37:08] INFO	importances       = True
[12/26/21 18:37:08] INFO	interactions      = False
[12/26/21 18:37:08] INFO	isomap            = False
[12/26/21 18:37:08] INFO	iso_components    = 2
[12/26/21 18:37:08] INFO	iso_neighbors     = 5
[12/26/21 18:37:08] INFO	isample_pct       = 10
[12/26/21 18:37:08] INFO	leaders           = []
[12/26/21 18:37:08] INFO	learning_curve    = True
[12/26/21 18:37:08] INFO	logtransform      = False
[12/26/21 18:37:08] INFO	lv_remove         = True
[12/26/21 18:37:08] INFO	lv_threshold      = 0.100000
[12/26/21 18:37:08] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:37:08] INFO	n_estimators      = 51
[12/26/21 18:37:08] INFO	n_jobs            = -1
[12/26/21 18:37:08] INFO	ngrams_max        = 2
[12/26/21 18:37:08] INFO	numpy             = True
[12/26/21 18:37:08] INFO	pca               = False
[12/26/21 18:37:08] INFO	pca_inc           = 1
[12/26/21 18:37:08] INFO	pca_max           = 10
[12/26/21 18:37:08] INFO	pca_min           = 2
[12/26/21 18:37:08] INFO	pca_whiten        = False
[12/26/21 18:37:08] INFO	poly_degree       = 2
[12/26/21 18:37:08] INFO	pvalue_level      = 0.010000
[12/26/21 18:37:08] INFO	rfe               = True
[12/26/21 18:37:08] INFO	rfe_step          = 3
[12/26/21 18:37:08] INFO	roc_curve         = True
[12/26/21 18:37:08] INFO	rounding          = 2
[12/26/21 18:37:08] INFO	sampling          = False
[12/26/21 18:37:08] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:37:08] INFO	sampling_ratio    = 1.000000
[12/26/21 18:37:08] INFO	scaler_option     = True
[12/26/21 18:37:08] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:37:08] INFO	scipy             = False
[12/26/21 18:37:08] INFO	scorer            = roc_auc
[12/26/21 18:37:08] INFO	seed              = 42
[12/26/21 18:37:08] INFO	sentinel          = -1
[12/26/21 18:37:08] INFO	separator         = ,
[12/26/21 18:37:08] INFO	shuffle           = False
[12/26/21 18:37:08] INFO	split             = 0.400000
[12/26/21 18:37:08] INFO	submission_file   = gender_submission
[12/26/21 18:37:08] INFO	submit_probas     = False
[12/26/21 18:37:08] INFO	target [y]        = Survived
[12/26/21 18:37:08] INFO	target_value      = 1
[12/26/21 18:37:08] INFO	transforms        = None
[12/26/21 18:37:08] INFO	tsne              = False
[12/26/21 18:37:08] INFO	tsne_components   = 2
[12/26/21 18:37:08] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:37:08] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:37:08] INFO	vectorize         = False
[12/26/21 18:37:08] INFO	verbosity         = 0
[12/26/21 18:37:08] INFO	Creating Model
[12/26/21 18:37:08] INFO	Calling Pipeline
[12/26/21 18:37:08] INFO	Training Pipeline
[12/26/21 18:37:08] INFO	Loading Data
[12/26/21 18:37:08] INFO	Loading data from ./input/train.csv
[12/26/21 18:37:08] INFO	Found target Survived in data frame
[12/26/21 18:37:08] INFO	Labels (y) found for Partition.train
[12/26/21 18:37:08] INFO	Loading Data
[12/26/21 18:37:08] INFO	Loading data from ./input/test.csv
[12/26/21 18:37:08] INFO	Target Survived not found in Partition.test
[12/26/21 18:37:08] INFO	Saving New Features in Model
[12/26/21 18:37:08] INFO	Original Feature Statistics
[12/26/21 18:37:08] INFO	Number of Training Rows    : 891
[12/26/21 18:37:08] INFO	Number of Training Columns : 11
[12/26/21 18:37:08] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:37:08] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:37:08] INFO	Number of Testing Rows     : 418
[12/26/21 18:37:08] INFO	Number of Testing Columns  : 11
[12/26/21 18:37:08] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:37:08] INFO	Feature Count     : 11
[12/26/21 18:37:08] INFO	Applying transforms
[12/26/21 18:37:08] INFO	No transforms Specified
[12/26/21 18:37:08] INFO	New Feature Count : 11
[12/26/21 18:37:08] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:37:08] INFO	Original Feature Count : 11
[12/26/21 18:37:08] INFO	Reduced Feature Count  : 10
[12/26/21 18:37:08] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:37:08] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:37:08] INFO	Creating Cross-Tabulations
[12/26/21 18:37:08] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:37:08] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:37:08] INFO	Feature Count     : 10
[12/26/21 18:37:08] INFO	Creating Count Features
[12/26/21 18:37:08] INFO	NA Counts
[12/26/21 18:37:08] INFO	Number Counts
[12/26/21 18:37:08] INFO	New Feature Count : 21
[12/26/21 18:37:08] INFO	Creating Base Features
[12/26/21 18:37:08] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:37:08] INFO	Feature 2: Name => Factorization
[12/26/21 18:37:08] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:37:08] INFO	Feature 3: Sex => Factorization
[12/26/21 18:37:08] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:37:08] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:37:08] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:37:08] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:37:08] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:37:08] INFO	Encoding: Encoders.target
[12/26/21 18:37:08] INFO	Fitting training features for Embarked
[12/26/21 18:37:08] INFO	Transforming testing features for Embarked
[12/26/21 18:37:08] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:37:08] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:37:08] INFO	New Feature Count : 21
[12/26/21 18:37:08] INFO	Scaling Base Features
[12/26/21 18:37:08] INFO	Creating NumPy Features
[12/26/21 18:37:08] INFO	NumPy Feature: sum
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	NumPy Feature: mean
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	NumPy Feature: std
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	NumPy Feature: var
[12/26/21 18:37:08] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:37:08] INFO	NumPy Feature Count : 4
[12/26/21 18:37:08] INFO	New Feature Count : 25
[12/26/21 18:37:08] INFO	Creating Clustering Features
[12/26/21 18:37:08] INFO	Cluster Minimum   : 3
[12/26/21 18:37:08] INFO	Cluster Maximum   : 30
[12/26/21 18:37:08] INFO	Cluster Increment : 3
[12/26/21 18:37:08] INFO	k = 3
[12/26/21 18:37:10] INFO	k = 6
[12/26/21 18:37:10] INFO	k = 9
[12/26/21 18:37:10] INFO	k = 12
[12/26/21 18:37:10] INFO	k = 15
[12/26/21 18:37:10] INFO	k = 18
[12/26/21 18:37:10] INFO	k = 21
[12/26/21 18:37:10] INFO	k = 24
[12/26/21 18:37:10] INFO	k = 27
[12/26/21 18:37:10] INFO	k = 30
[12/26/21 18:37:10] INFO	Clustering Feature Count : 10
[12/26/21 18:37:10] INFO	New Feature Count : 35
[12/26/21 18:37:10] INFO	Saving New Features in Model
[12/26/21 18:37:10] INFO	Creating Interactions
[12/26/21 18:37:10] INFO	Initial Feature Count  : 35
[12/26/21 18:37:10] INFO	Skipping Interactions
[12/26/21 18:37:10] INFO	Saving New Features in Model
[12/26/21 18:37:10] INFO	Removing Low-Variance Features
[12/26/21 18:37:10] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:37:10] INFO	Original Feature Count  : 35
[12/26/21 18:37:10] INFO	Reduced Feature Count   : 35
[12/26/21 18:37:10] INFO	Saving New Features in Model
[12/26/21 18:37:10] INFO	Skipping Shuffling
[12/26/21 18:37:10] INFO	Skipping Sampling
[12/26/21 18:37:10] INFO	Getting All Estimators
[12/26/21 18:37:10] INFO	Algorithm Configuration
[12/26/21 18:37:10] INFO	Selecting Models
[12/26/21 18:37:10] INFO	Algorithm: CATB
[12/26/21 18:37:10] INFO	Fitting Initial Model
[12/26/21 18:37:11] INFO	Cross-Validation
[12/26/21 18:37:12] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:37:12] INFO	Recursive Feature Elimination with CV
[12/26/21 18:37:15] INFO	RFECV took 2.38 seconds for step 3 and 3 folds
[12/26/21 18:37:15] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:37:15] INFO	No grid is defined for grid search
[12/26/21 18:37:15] INFO	Final Model Predictions for CATB
[12/26/21 18:37:15] INFO	Skipping Calibration
[12/26/21 18:37:15] INFO	Making Predictions
[12/26/21 18:37:15] INFO	Predictions Complete
[12/26/21 18:37:15] INFO	Algorithm: LGB
[12/26/21 18:37:15] INFO	Fitting Initial Model
[12/26/21 18:37:15] INFO	Cross-Validation
[12/26/21 18:37:15] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:37:15] INFO	Recursive Feature Elimination with CV
[12/26/21 18:37:17] INFO	RFECV took 2.46 seconds for step 3 and 3 folds
[12/26/21 18:37:17] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:37:17] INFO	No grid is defined for grid search
[12/26/21 18:37:17] INFO	Final Model Predictions for LGB
[12/26/21 18:37:17] INFO	Skipping Calibration
[12/26/21 18:37:17] INFO	Making Predictions
[12/26/21 18:37:17] INFO	Predictions Complete
[12/26/21 18:37:17] INFO	Algorithm: XGB
[12/26/21 18:37:17] INFO	Fitting Initial Model
[12/26/21 18:37:18] INFO	Cross-Validation
[12/26/21 18:37:18] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:37:18] INFO	Recursive Feature Elimination with CV
[12/26/21 18:37:20] INFO	RFECV took 2.38 seconds for step 3 and 3 folds
[12/26/21 18:37:20] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:37:20] INFO	Randomized Grid Search
[12/26/21 18:38:15] INFO	Grid Search took 55.12 seconds for 50 candidate parameter settings.
[12/26/21 18:38:15] INFO	Model with rank: 1
[12/26/21 18:38:15] INFO	Mean validation score: 0.871 (std: 0.027)
[12/26/21 18:38:15] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 18:38:15] INFO	Model with rank: 2
[12/26/21 18:38:15] INFO	Mean validation score: 0.871 (std: 0.022)
[12/26/21 18:38:15] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/26/21 18:38:15] INFO	Model with rank: 3
[12/26/21 18:38:15] INFO	Mean validation score: 0.870 (std: 0.019)
[12/26/21 18:38:15] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 18:38:15] INFO	Algorithm: XGB, Best Score: 0.8706, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 18:38:15] INFO	Final Model Predictions for XGB
[12/26/21 18:38:15] INFO	Skipping Calibration
[12/26/21 18:38:15] INFO	Making Predictions
[12/26/21 18:38:15] INFO	Predictions Complete
[12/26/21 18:38:15] INFO	Blending Models
[12/26/21 18:38:15] INFO	Blending Start: 2021-12-26 18:38:15.784485
[12/26/21 18:38:15] INFO	Blending Complete: 0:00:00.007530
[12/26/21 18:38:15] INFO	================================================================================
[12/26/21 18:38:15] INFO	Metrics for: Partition.train
[12/26/21 18:38:15] INFO	--------------------------------------------------------------------------------
[12/26/21 18:38:15] INFO	Algorithm: CATB
[12/26/21 18:38:15] INFO	accuracy: 0.8585858585858586
[12/26/21 18:38:15] INFO	average_precision: 0.9113351686222868
[12/26/21 18:38:15] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:38:15] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:38:15] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:38:15] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:38:15] INFO	f1: 0.8025078369905956
[12/26/21 18:38:15] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:38:15] INFO	precision: 0.8648648648648649
[12/26/21 18:38:15] INFO	recall: 0.7485380116959064
[12/26/21 18:38:15] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:38:15] INFO	--------------------------------------------------------------------------------
[12/26/21 18:38:15] INFO	Algorithm: LGB
[12/26/21 18:38:15] INFO	accuracy: 0.9730639730639731
[12/26/21 18:38:15] INFO	average_precision: 0.9961113207491221
[12/26/21 18:38:15] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:38:15] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:38:15] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:38:15] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:38:15] INFO	f1: 0.9643916913946586
[12/26/21 18:38:15] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:38:15] INFO	precision: 0.9789156626506024
[12/26/21 18:38:15] INFO	recall: 0.9502923976608187
[12/26/21 18:38:15] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:38:15] INFO	--------------------------------------------------------------------------------
[12/26/21 18:38:15] INFO	Algorithm: XGB
[12/26/21 18:38:15] INFO	accuracy: 0.9382716049382716
[12/26/21 18:38:15] INFO	average_precision: 0.9785906956187513
[12/26/21 18:38:15] INFO	balanced_accuracy: 0.9267567826670502
[12/26/21 18:38:15] INFO	brier_score_loss: 0.06782450877247986
[12/26/21 18:38:15] INFO	cohen_kappa: 0.8673794967971357
[12/26/21 18:38:15] INFO	confusion_matrix: [[536  13]
 [ 42 300]]
[12/26/21 18:38:15] INFO	f1: 0.9160305343511449
[12/26/21 18:38:15] INFO	neg_log_loss: 0.2686193541202414
[12/26/21 18:38:15] INFO	precision: 0.9584664536741214
[12/26/21 18:38:15] INFO	recall: 0.8771929824561403
[12/26/21 18:38:15] INFO	roc_auc: 0.9836864474483111
[12/26/21 18:38:15] INFO	================================================================================
[12/26/21 18:38:15] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:38:15] INFO	Best Model Selection Start: 2021-12-26 18:38:15.812633
[12/26/21 18:38:15] INFO	Scoring CATB Model
[12/26/21 18:38:15] INFO	Scoring LGB Model
[12/26/21 18:38:15] INFO	Scoring XGB Model
[12/26/21 18:38:15] INFO	Scoring BLEND Model
[12/26/21 18:38:15] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 18:38:15] INFO	Best Model Selection Complete: 0:00:00.000276
[12/26/21 18:38:15] INFO	================================================================================
[12/26/21 18:38:15] INFO	Generating Plots for partition: train
[12/26/21 18:38:15] INFO	Generating Calibration Plot
[12/26/21 18:38:15] INFO	Calibration for Algorithm: CATB
[12/26/21 18:38:15] INFO	Calibration for Algorithm: LGB
[12/26/21 18:38:15] INFO	Calibration for Algorithm: XGB
[12/26/21 18:38:15] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:38:15] INFO	Generating Confusion Matrices
[12/26/21 18:38:15] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:38:15] INFO	Confusion Matrix:
[12/26/21 18:38:15] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:38:16] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:38:16] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:38:16] INFO	Confusion Matrix:
[12/26/21 18:38:16] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:38:16] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:38:16] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:38:16] INFO	Confusion Matrix:
[12/26/21 18:38:16] INFO	[[536  13]
 [ 42 300]]
[12/26/21 18:38:16] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:38:16] INFO	Generating ROC Curves
[12/26/21 18:38:16] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:38:16] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:38:16] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:38:16] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:38:16] INFO	Generating Learning Curves
[12/26/21 18:38:16] INFO	Algorithm Configuration
[12/26/21 18:38:16] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:38:16] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:38:16] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:38:18] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:38:18] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:38:19] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:38:19] INFO	Generating Feature Importance Plots
[12/26/21 18:38:19] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:38:19] INFO	Feature Ranking:
[12/26/21 18:38:19] INFO	1. Sex_factor (45.178104)
[12/26/21 18:38:19] INFO	2. Pclass (13.721171)
[12/26/21 18:38:19] INFO	3. Age (6.651788)
[12/26/21 18:38:19] INFO	4. Fare (4.529770)
[12/26/21 18:38:19] INFO	5. var (3.586590)
[12/26/21 18:38:19] INFO	6. std (3.492385)
[12/26/21 18:38:19] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:38:19] INFO	8. cluster_30 (2.831587)
[12/26/21 18:38:19] INFO	9. mean (2.733389)
[12/26/21 18:38:19] INFO	10. Name_factor (2.586310)
[12/26/21 18:38:19] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:38:19] INFO	12. Embarked (2.086410)
[12/26/21 18:38:19] INFO	13. SibSp (2.085405)
[12/26/21 18:38:19] INFO	14. cluster_12 (1.876782)
[12/26/21 18:38:19] INFO	15. cluster_24 (1.263144)
[12/26/21 18:38:19] INFO	16. count_2 (1.004409)
[12/26/21 18:38:19] INFO	17. sum (0.955946)
[12/26/21 18:38:19] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:38:19] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:38:19] INFO	Feature Ranking:
[12/26/21 18:38:19] INFO	1. Fare (256.000000)
[12/26/21 18:38:19] INFO	2. sum (241.000000)
[12/26/21 18:38:19] INFO	3. Age (232.000000)
[12/26/21 18:38:19] INFO	4. std (201.000000)
[12/26/21 18:38:19] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:38:19] INFO	6. Name_factor (175.000000)
[12/26/21 18:38:19] INFO	7. cluster_30 (53.000000)
[12/26/21 18:38:19] INFO	8. cluster_27 (46.000000)
[12/26/21 18:38:19] INFO	9. Sex_factor (43.000000)
[12/26/21 18:38:19] INFO	10. Pclass (43.000000)
[12/26/21 18:38:19] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:38:19] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:38:19] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:38:19] INFO	Feature Ranking:
[12/26/21 18:38:19] INFO	1. Sex_factor (0.424644)
[12/26/21 18:38:19] INFO	2. Pclass (0.127452)
[12/26/21 18:38:19] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:38:19] INFO	4. Age (0.051007)
[12/26/21 18:38:19] INFO	5. SibSp (0.049620)
[12/26/21 18:38:19] INFO	6. count_1 (0.046373)
[12/26/21 18:38:19] INFO	7. Embarked (0.046225)
[12/26/21 18:38:19] INFO	8. std (0.036262)
[12/26/21 18:38:19] INFO	9. cluster_30 (0.036076)
[12/26/21 18:38:19] INFO	10. Fare (0.032410)
[12/26/21 18:38:19] INFO	11. cluster_24 (0.021187)
[12/26/21 18:38:19] INFO	12. Name_factor (0.019312)
[12/26/21 18:38:19] INFO	13. sum (0.017784)
[12/26/21 18:38:19] INFO	14. cluster_15 (0.010340)
[12/26/21 18:38:19] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:42:39] INFO	********************************************************************************
[12/26/21 18:42:39] INFO	AlphaPy Start
[12/26/21 18:42:39] INFO	********************************************************************************
[12/26/21 18:42:39] INFO	Model Configuration
[12/26/21 18:42:39] INFO	No transforms Found
[12/26/21 18:42:39] INFO	MODEL PARAMETERS:
[12/26/21 18:42:39] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:42:39] INFO	calibration       = False
[12/26/21 18:42:39] INFO	cal_type          = sigmoid
[12/26/21 18:42:39] INFO	calibration_plot  = False
[12/26/21 18:42:39] INFO	clustering        = True
[12/26/21 18:42:39] INFO	cluster_inc       = 3
[12/26/21 18:42:39] INFO	cluster_max       = 30
[12/26/21 18:42:39] INFO	cluster_min       = 3
[12/26/21 18:42:39] INFO	confusion_matrix  = True
[12/26/21 18:42:39] INFO	counts            = True
[12/26/21 18:42:39] INFO	cv_folds          = 3
[12/26/21 18:42:39] INFO	directory         = .
[12/26/21 18:42:39] INFO	extension         = csv
[12/26/21 18:42:39] INFO	drop              = ['PassengerId']
[12/26/21 18:42:39] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:42:39] INFO	esr               = 20
[12/26/21 18:42:39] INFO	factors           = ['Embarked']
[12/26/21 18:42:39] INFO	features [X]      = *
[12/26/21 18:42:39] INFO	feature_selection = False
[12/26/21 18:42:39] INFO	fs_percentage     = 50
[12/26/21 18:42:39] INFO	fs_score_func     = <function f_classif at 0x7f8a8aa69e50>
[12/26/21 18:42:39] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:42:39] INFO	grid_search       = True
[12/26/21 18:42:39] INFO	gs_iters          = 50
[12/26/21 18:42:39] INFO	gs_random         = True
[12/26/21 18:42:39] INFO	gs_sample         = False
[12/26/21 18:42:39] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:42:39] INFO	importances       = True
[12/26/21 18:42:39] INFO	interactions      = False
[12/26/21 18:42:39] INFO	isomap            = False
[12/26/21 18:42:39] INFO	iso_components    = 2
[12/26/21 18:42:39] INFO	iso_neighbors     = 5
[12/26/21 18:42:39] INFO	isample_pct       = 10
[12/26/21 18:42:39] INFO	leaders           = []
[12/26/21 18:42:39] INFO	learning_curve    = True
[12/26/21 18:42:39] INFO	logtransform      = False
[12/26/21 18:42:39] INFO	lv_remove         = True
[12/26/21 18:42:39] INFO	lv_threshold      = 0.100000
[12/26/21 18:42:39] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:42:39] INFO	n_estimators      = 51
[12/26/21 18:42:39] INFO	n_jobs            = -1
[12/26/21 18:42:39] INFO	ngrams_max        = 2
[12/26/21 18:42:39] INFO	numpy             = True
[12/26/21 18:42:39] INFO	pca               = False
[12/26/21 18:42:39] INFO	pca_inc           = 1
[12/26/21 18:42:39] INFO	pca_max           = 10
[12/26/21 18:42:39] INFO	pca_min           = 2
[12/26/21 18:42:39] INFO	pca_whiten        = False
[12/26/21 18:42:39] INFO	poly_degree       = 2
[12/26/21 18:42:39] INFO	pvalue_level      = 0.010000
[12/26/21 18:42:39] INFO	rfe               = True
[12/26/21 18:42:39] INFO	rfe_step          = 3
[12/26/21 18:42:39] INFO	roc_curve         = True
[12/26/21 18:42:39] INFO	rounding          = 2
[12/26/21 18:42:39] INFO	sampling          = False
[12/26/21 18:42:39] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:42:39] INFO	sampling_ratio    = 1.000000
[12/26/21 18:42:39] INFO	scaler_option     = True
[12/26/21 18:42:39] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:42:39] INFO	scipy             = False
[12/26/21 18:42:39] INFO	scorer            = roc_auc
[12/26/21 18:42:39] INFO	seed              = 42
[12/26/21 18:42:39] INFO	sentinel          = -1
[12/26/21 18:42:39] INFO	separator         = ,
[12/26/21 18:42:39] INFO	shuffle           = False
[12/26/21 18:42:39] INFO	split             = 0.400000
[12/26/21 18:42:39] INFO	submission_file   = gender_submission
[12/26/21 18:42:39] INFO	submit_probas     = False
[12/26/21 18:42:39] INFO	target [y]        = Survived
[12/26/21 18:42:39] INFO	target_value      = 1
[12/26/21 18:42:39] INFO	transforms        = None
[12/26/21 18:42:39] INFO	tsne              = False
[12/26/21 18:42:39] INFO	tsne_components   = 2
[12/26/21 18:42:39] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:42:39] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:42:39] INFO	vectorize         = False
[12/26/21 18:42:39] INFO	verbosity         = 0
[12/26/21 18:42:39] INFO	Creating Model
[12/26/21 18:42:39] INFO	Calling Pipeline
[12/26/21 18:42:39] INFO	Training Pipeline
[12/26/21 18:42:39] INFO	Loading Data
[12/26/21 18:42:39] INFO	Loading data from ./input/train.csv
[12/26/21 18:42:39] INFO	Found target Survived in data frame
[12/26/21 18:42:39] INFO	Labels (y) found for Partition.train
[12/26/21 18:42:39] INFO	Loading Data
[12/26/21 18:42:39] INFO	Loading data from ./input/test.csv
[12/26/21 18:42:39] INFO	Target Survived not found in Partition.test
[12/26/21 18:42:39] INFO	Saving New Features in Model
[12/26/21 18:42:39] INFO	Original Feature Statistics
[12/26/21 18:42:39] INFO	Number of Training Rows    : 891
[12/26/21 18:42:39] INFO	Number of Training Columns : 11
[12/26/21 18:42:39] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:42:39] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:42:39] INFO	Number of Testing Rows     : 418
[12/26/21 18:42:39] INFO	Number of Testing Columns  : 11
[12/26/21 18:42:39] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:42:39] INFO	Feature Count     : 11
[12/26/21 18:42:39] INFO	Applying transforms
[12/26/21 18:42:39] INFO	No transforms Specified
[12/26/21 18:42:39] INFO	New Feature Count : 11
[12/26/21 18:42:39] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:42:39] INFO	Original Feature Count : 11
[12/26/21 18:42:39] INFO	Reduced Feature Count  : 10
[12/26/21 18:42:39] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:42:39] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:42:39] INFO	Creating Cross-Tabulations
[12/26/21 18:42:39] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:42:39] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:42:39] INFO	Feature Count     : 10
[12/26/21 18:42:39] INFO	Creating Count Features
[12/26/21 18:42:39] INFO	NA Counts
[12/26/21 18:42:39] INFO	Number Counts
[12/26/21 18:42:39] INFO	New Feature Count : 21
[12/26/21 18:42:39] INFO	Creating Base Features
[12/26/21 18:42:39] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:42:39] INFO	Feature 2: Name => Factorization
[12/26/21 18:42:39] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:42:39] INFO	Feature 3: Sex => Factorization
[12/26/21 18:42:39] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:42:39] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:42:39] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:42:39] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:42:39] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:42:39] INFO	Encoding: Encoders.target
[12/26/21 18:42:39] INFO	Fitting training features for Embarked
[12/26/21 18:42:39] INFO	Transforming testing features for Embarked
[12/26/21 18:42:39] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:42:39] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:42:39] INFO	New Feature Count : 21
[12/26/21 18:42:39] INFO	Scaling Base Features
[12/26/21 18:42:39] INFO	Creating NumPy Features
[12/26/21 18:42:39] INFO	NumPy Feature: sum
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	NumPy Feature: mean
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	NumPy Feature: std
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	NumPy Feature: var
[12/26/21 18:42:39] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:42:39] INFO	NumPy Feature Count : 4
[12/26/21 18:42:39] INFO	New Feature Count : 25
[12/26/21 18:42:39] INFO	Creating Clustering Features
[12/26/21 18:42:39] INFO	Cluster Minimum   : 3
[12/26/21 18:42:39] INFO	Cluster Maximum   : 30
[12/26/21 18:42:39] INFO	Cluster Increment : 3
[12/26/21 18:42:39] INFO	k = 3
[12/26/21 18:42:41] INFO	k = 6
[12/26/21 18:42:41] INFO	k = 9
[12/26/21 18:42:41] INFO	k = 12
[12/26/21 18:42:41] INFO	k = 15
[12/26/21 18:42:41] INFO	k = 18
[12/26/21 18:42:41] INFO	k = 21
[12/26/21 18:42:41] INFO	k = 24
[12/26/21 18:42:41] INFO	k = 27
[12/26/21 18:42:41] INFO	k = 30
[12/26/21 18:42:41] INFO	Clustering Feature Count : 10
[12/26/21 18:42:41] INFO	New Feature Count : 35
[12/26/21 18:42:41] INFO	Saving New Features in Model
[12/26/21 18:42:41] INFO	Creating Interactions
[12/26/21 18:42:41] INFO	Initial Feature Count  : 35
[12/26/21 18:42:41] INFO	Skipping Interactions
[12/26/21 18:42:41] INFO	Saving New Features in Model
[12/26/21 18:42:41] INFO	Removing Low-Variance Features
[12/26/21 18:42:41] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:42:41] INFO	Original Feature Count  : 35
[12/26/21 18:42:41] INFO	Reduced Feature Count   : 35
[12/26/21 18:42:41] INFO	Saving New Features in Model
[12/26/21 18:42:41] INFO	Skipping Shuffling
[12/26/21 18:42:41] INFO	Skipping Sampling
[12/26/21 18:42:41] INFO	Getting All Estimators
[12/26/21 18:42:41] INFO	Algorithm Configuration
[12/26/21 18:42:41] INFO	Selecting Models
[12/26/21 18:42:41] INFO	Algorithm: CATB
[12/26/21 18:42:41] INFO	Fitting Initial Model
[12/26/21 18:42:41] INFO	Cross-Validation
[12/26/21 18:42:43] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:42:43] INFO	Recursive Feature Elimination with CV
[12/26/21 18:42:45] INFO	RFECV took 2.39 seconds for step 3 and 3 folds
[12/26/21 18:42:45] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:42:45] INFO	No grid is defined for grid search
[12/26/21 18:42:45] INFO	Final Model Predictions for CATB
[12/26/21 18:42:45] INFO	Skipping Calibration
[12/26/21 18:42:45] INFO	Making Predictions
[12/26/21 18:42:45] INFO	Predictions Complete
[12/26/21 18:42:45] INFO	Algorithm: LGB
[12/26/21 18:42:45] INFO	Fitting Initial Model
[12/26/21 18:42:45] INFO	Cross-Validation
[12/26/21 18:42:46] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:42:46] INFO	Recursive Feature Elimination with CV
[12/26/21 18:42:49] INFO	RFECV took 3.21 seconds for step 3 and 3 folds
[12/26/21 18:42:49] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:42:49] INFO	No grid is defined for grid search
[12/26/21 18:42:49] INFO	Final Model Predictions for LGB
[12/26/21 18:42:49] INFO	Skipping Calibration
[12/26/21 18:42:49] INFO	Making Predictions
[12/26/21 18:42:49] INFO	Predictions Complete
[12/26/21 18:42:49] INFO	Algorithm: XGB
[12/26/21 18:42:49] INFO	Fitting Initial Model
[12/26/21 18:42:49] INFO	Cross-Validation
[12/26/21 18:42:50] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:42:50] INFO	Recursive Feature Elimination with CV
[12/26/21 18:42:52] INFO	RFECV took 2.46 seconds for step 3 and 3 folds
[12/26/21 18:42:52] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:42:52] INFO	Randomized Grid Search
[12/26/21 18:43:54] INFO	Grid Search took 61.61 seconds for 50 candidate parameter settings.
[12/26/21 18:43:54] INFO	Model with rank: 1
[12/26/21 18:43:54] INFO	Mean validation score: 0.871 (std: 0.025)
[12/26/21 18:43:54] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/26/21 18:43:54] INFO	Model with rank: 2
[12/26/21 18:43:54] INFO	Mean validation score: 0.871 (std: 0.020)
[12/26/21 18:43:54] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 7, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 18:43:54] INFO	Model with rank: 3
[12/26/21 18:43:54] INFO	Mean validation score: 0.871 (std: 0.025)
[12/26/21 18:43:54] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 9, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/26/21 18:43:54] INFO	Algorithm: XGB, Best Score: 0.8708, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.1, 'est__colsample_bytree': 0.6}
[12/26/21 18:43:54] INFO	Final Model Predictions for XGB
[12/26/21 18:43:54] INFO	Skipping Calibration
[12/26/21 18:43:54] INFO	Making Predictions
[12/26/21 18:43:54] INFO	Predictions Complete
[12/26/21 18:43:54] INFO	Blending Models
[12/26/21 18:43:54] INFO	Blending Start: 2021-12-26 18:43:54.509956
[12/26/21 18:43:54] INFO	Blending Complete: 0:00:00.007561
[12/26/21 18:43:54] INFO	================================================================================
[12/26/21 18:43:54] INFO	Metrics for: Partition.train
[12/26/21 18:43:54] INFO	--------------------------------------------------------------------------------
[12/26/21 18:43:54] INFO	Algorithm: CATB
[12/26/21 18:43:54] INFO	accuracy: 0.8585858585858586
[12/26/21 18:43:54] INFO	average_precision: 0.9113351686222868
[12/26/21 18:43:54] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:43:54] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:43:54] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:43:54] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:43:54] INFO	f1: 0.8025078369905956
[12/26/21 18:43:54] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:43:54] INFO	precision: 0.8648648648648649
[12/26/21 18:43:54] INFO	recall: 0.7485380116959064
[12/26/21 18:43:54] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:43:54] INFO	--------------------------------------------------------------------------------
[12/26/21 18:43:54] INFO	Algorithm: LGB
[12/26/21 18:43:54] INFO	accuracy: 0.9730639730639731
[12/26/21 18:43:54] INFO	average_precision: 0.9961113207491221
[12/26/21 18:43:54] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:43:54] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:43:54] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:43:54] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:43:54] INFO	f1: 0.9643916913946586
[12/26/21 18:43:54] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:43:54] INFO	precision: 0.9789156626506024
[12/26/21 18:43:54] INFO	recall: 0.9502923976608187
[12/26/21 18:43:54] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:43:54] INFO	--------------------------------------------------------------------------------
[12/26/21 18:43:54] INFO	Algorithm: XGB
[12/26/21 18:43:54] INFO	accuracy: 0.9102132435465768
[12/26/21 18:43:54] INFO	average_precision: 0.9527961588015302
[12/26/21 18:43:54] INFO	balanced_accuracy: 0.8946170069983702
[12/26/21 18:43:54] INFO	brier_score_loss: 0.09217981868271352
[12/26/21 18:43:54] INFO	cohen_kappa: 0.8061199510403917
[12/26/21 18:43:54] INFO	confusion_matrix: [[528  21]
 [ 59 283]]
[12/26/21 18:43:54] INFO	f1: 0.8761609907120743
[12/26/21 18:43:54] INFO	neg_log_loss: 0.3340453980312872
[12/26/21 18:43:54] INFO	precision: 0.930921052631579
[12/26/21 18:43:54] INFO	recall: 0.827485380116959
[12/26/21 18:43:54] INFO	roc_auc: 0.9622625933382332
[12/26/21 18:43:54] INFO	================================================================================
[12/26/21 18:43:54] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:43:54] INFO	Best Model Selection Start: 2021-12-26 18:43:54.538354
[12/26/21 18:43:54] INFO	Scoring CATB Model
[12/26/21 18:43:54] INFO	Scoring LGB Model
[12/26/21 18:43:54] INFO	Scoring XGB Model
[12/26/21 18:43:54] INFO	Scoring BLEND Model
[12/26/21 18:43:54] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 18:43:54] INFO	Best Model Selection Complete: 0:00:00.000199
[12/26/21 18:43:54] INFO	================================================================================
[12/26/21 18:43:54] INFO	Generating Plots for partition: train
[12/26/21 18:43:54] INFO	Generating Calibration Plot
[12/26/21 18:43:54] INFO	Calibration for Algorithm: CATB
[12/26/21 18:43:54] INFO	Calibration for Algorithm: LGB
[12/26/21 18:43:54] INFO	Calibration for Algorithm: XGB
[12/26/21 18:43:54] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:43:54] INFO	Generating Confusion Matrices
[12/26/21 18:43:54] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:43:54] INFO	Confusion Matrix:
[12/26/21 18:43:54] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:43:54] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:43:54] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:43:54] INFO	Confusion Matrix:
[12/26/21 18:43:54] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:43:54] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:43:54] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:43:54] INFO	Confusion Matrix:
[12/26/21 18:43:54] INFO	[[528  21]
 [ 59 283]]
[12/26/21 18:43:54] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:43:55] INFO	Generating ROC Curves
[12/26/21 18:43:55] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:43:55] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:43:55] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:43:55] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:43:55] INFO	Generating Learning Curves
[12/26/21 18:43:55] INFO	Algorithm Configuration
[12/26/21 18:43:55] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:43:55] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:43:55] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:43:57] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:43:57] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:43:58] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:43:58] INFO	Generating Feature Importance Plots
[12/26/21 18:43:58] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:43:58] INFO	Feature Ranking:
[12/26/21 18:43:58] INFO	1. Sex_factor (45.178104)
[12/26/21 18:43:58] INFO	2. Pclass (13.721171)
[12/26/21 18:43:58] INFO	3. Age (6.651788)
[12/26/21 18:43:58] INFO	4. Fare (4.529770)
[12/26/21 18:43:58] INFO	5. var (3.586590)
[12/26/21 18:43:58] INFO	6. std (3.492385)
[12/26/21 18:43:58] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:43:58] INFO	8. cluster_30 (2.831587)
[12/26/21 18:43:58] INFO	9. mean (2.733389)
[12/26/21 18:43:58] INFO	10. Name_factor (2.586310)
[12/26/21 18:43:58] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:43:58] INFO	12. Embarked (2.086410)
[12/26/21 18:43:58] INFO	13. SibSp (2.085405)
[12/26/21 18:43:58] INFO	14. cluster_12 (1.876782)
[12/26/21 18:43:58] INFO	15. cluster_24 (1.263144)
[12/26/21 18:43:58] INFO	16. count_2 (1.004409)
[12/26/21 18:43:58] INFO	17. sum (0.955946)
[12/26/21 18:43:58] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:43:58] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:43:58] INFO	Feature Ranking:
[12/26/21 18:43:58] INFO	1. Fare (256.000000)
[12/26/21 18:43:58] INFO	2. sum (241.000000)
[12/26/21 18:43:58] INFO	3. Age (232.000000)
[12/26/21 18:43:58] INFO	4. std (201.000000)
[12/26/21 18:43:58] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:43:58] INFO	6. Name_factor (175.000000)
[12/26/21 18:43:58] INFO	7. cluster_30 (53.000000)
[12/26/21 18:43:58] INFO	8. cluster_27 (46.000000)
[12/26/21 18:43:58] INFO	9. Sex_factor (43.000000)
[12/26/21 18:43:58] INFO	10. Pclass (43.000000)
[12/26/21 18:43:58] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:43:58] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:43:58] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:43:58] INFO	Feature Ranking:
[12/26/21 18:43:58] INFO	1. Sex_factor (0.424644)
[12/26/21 18:43:58] INFO	2. Pclass (0.127452)
[12/26/21 18:43:58] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:43:58] INFO	4. Age (0.051007)
[12/26/21 18:43:58] INFO	5. SibSp (0.049620)
[12/26/21 18:43:58] INFO	6. count_1 (0.046373)
[12/26/21 18:43:58] INFO	7. Embarked (0.046225)
[12/26/21 18:43:58] INFO	8. std (0.036262)
[12/26/21 18:43:58] INFO	9. cluster_30 (0.036076)
[12/26/21 18:43:58] INFO	10. Fare (0.032410)
[12/26/21 18:43:58] INFO	11. cluster_24 (0.021187)
[12/26/21 18:43:58] INFO	12. Name_factor (0.019312)
[12/26/21 18:43:58] INFO	13. sum (0.017784)
[12/26/21 18:43:58] INFO	14. cluster_15 (0.010340)
[12/26/21 18:43:58] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:44:56] INFO	********************************************************************************
[12/26/21 18:44:56] INFO	AlphaPy Start
[12/26/21 18:44:56] INFO	********************************************************************************
[12/26/21 18:44:56] INFO	Model Configuration
[12/26/21 18:44:56] INFO	No transforms Found
[12/26/21 18:44:56] INFO	MODEL PARAMETERS:
[12/26/21 18:44:56] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:44:56] INFO	calibration       = False
[12/26/21 18:44:56] INFO	cal_type          = sigmoid
[12/26/21 18:44:56] INFO	calibration_plot  = False
[12/26/21 18:44:56] INFO	clustering        = True
[12/26/21 18:44:56] INFO	cluster_inc       = 3
[12/26/21 18:44:56] INFO	cluster_max       = 30
[12/26/21 18:44:56] INFO	cluster_min       = 3
[12/26/21 18:44:56] INFO	confusion_matrix  = True
[12/26/21 18:44:56] INFO	counts            = True
[12/26/21 18:44:56] INFO	cv_folds          = 3
[12/26/21 18:44:56] INFO	directory         = .
[12/26/21 18:44:56] INFO	extension         = csv
[12/26/21 18:44:56] INFO	drop              = ['PassengerId']
[12/26/21 18:44:56] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:44:56] INFO	esr               = 20
[12/26/21 18:44:56] INFO	factors           = ['Embarked']
[12/26/21 18:44:56] INFO	features [X]      = *
[12/26/21 18:44:56] INFO	feature_selection = False
[12/26/21 18:44:56] INFO	fs_percentage     = 50
[12/26/21 18:44:56] INFO	fs_score_func     = <function f_classif at 0x7fc120deaee0>
[12/26/21 18:44:56] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:44:56] INFO	grid_search       = True
[12/26/21 18:44:56] INFO	gs_iters          = 50
[12/26/21 18:44:56] INFO	gs_random         = True
[12/26/21 18:44:56] INFO	gs_sample         = False
[12/26/21 18:44:56] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:44:56] INFO	importances       = True
[12/26/21 18:44:56] INFO	interactions      = False
[12/26/21 18:44:56] INFO	isomap            = False
[12/26/21 18:44:56] INFO	iso_components    = 2
[12/26/21 18:44:56] INFO	iso_neighbors     = 5
[12/26/21 18:44:56] INFO	isample_pct       = 10
[12/26/21 18:44:56] INFO	leaders           = []
[12/26/21 18:44:56] INFO	learning_curve    = True
[12/26/21 18:44:56] INFO	logtransform      = False
[12/26/21 18:44:56] INFO	lv_remove         = True
[12/26/21 18:44:56] INFO	lv_threshold      = 0.100000
[12/26/21 18:44:56] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:44:56] INFO	n_estimators      = 51
[12/26/21 18:44:56] INFO	n_jobs            = -1
[12/26/21 18:44:56] INFO	ngrams_max        = 2
[12/26/21 18:44:56] INFO	numpy             = True
[12/26/21 18:44:56] INFO	pca               = False
[12/26/21 18:44:56] INFO	pca_inc           = 1
[12/26/21 18:44:56] INFO	pca_max           = 10
[12/26/21 18:44:56] INFO	pca_min           = 2
[12/26/21 18:44:56] INFO	pca_whiten        = False
[12/26/21 18:44:56] INFO	poly_degree       = 2
[12/26/21 18:44:56] INFO	pvalue_level      = 0.010000
[12/26/21 18:44:56] INFO	rfe               = True
[12/26/21 18:44:56] INFO	rfe_step          = 3
[12/26/21 18:44:56] INFO	roc_curve         = True
[12/26/21 18:44:56] INFO	rounding          = 2
[12/26/21 18:44:56] INFO	sampling          = False
[12/26/21 18:44:56] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:44:56] INFO	sampling_ratio    = 1.000000
[12/26/21 18:44:56] INFO	scaler_option     = True
[12/26/21 18:44:56] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:44:56] INFO	scipy             = False
[12/26/21 18:44:56] INFO	scorer            = roc_auc
[12/26/21 18:44:56] INFO	seed              = 42
[12/26/21 18:44:56] INFO	sentinel          = -1
[12/26/21 18:44:56] INFO	separator         = ,
[12/26/21 18:44:56] INFO	shuffle           = False
[12/26/21 18:44:56] INFO	split             = 0.400000
[12/26/21 18:44:56] INFO	submission_file   = gender_submission
[12/26/21 18:44:56] INFO	submit_probas     = False
[12/26/21 18:44:56] INFO	target [y]        = Survived
[12/26/21 18:44:56] INFO	target_value      = 1
[12/26/21 18:44:56] INFO	transforms        = None
[12/26/21 18:44:56] INFO	tsne              = False
[12/26/21 18:44:56] INFO	tsne_components   = 2
[12/26/21 18:44:56] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:44:56] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:44:56] INFO	vectorize         = False
[12/26/21 18:44:56] INFO	verbosity         = 0
[12/26/21 18:44:56] INFO	Creating Model
[12/26/21 18:44:56] INFO	Calling Pipeline
[12/26/21 18:44:56] INFO	Training Pipeline
[12/26/21 18:44:56] INFO	Loading Data
[12/26/21 18:44:56] INFO	Loading data from ./input/train.csv
[12/26/21 18:44:56] INFO	Found target Survived in data frame
[12/26/21 18:44:56] INFO	Labels (y) found for Partition.train
[12/26/21 18:44:56] INFO	Loading Data
[12/26/21 18:44:56] INFO	Loading data from ./input/test.csv
[12/26/21 18:44:56] INFO	Target Survived not found in Partition.test
[12/26/21 18:44:56] INFO	Saving New Features in Model
[12/26/21 18:44:56] INFO	Original Feature Statistics
[12/26/21 18:44:56] INFO	Number of Training Rows    : 891
[12/26/21 18:44:56] INFO	Number of Training Columns : 11
[12/26/21 18:44:56] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:44:56] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:44:56] INFO	Number of Testing Rows     : 418
[12/26/21 18:44:56] INFO	Number of Testing Columns  : 11
[12/26/21 18:44:56] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:44:56] INFO	Feature Count     : 11
[12/26/21 18:44:56] INFO	Applying transforms
[12/26/21 18:44:56] INFO	No transforms Specified
[12/26/21 18:44:56] INFO	New Feature Count : 11
[12/26/21 18:44:56] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:44:56] INFO	Original Feature Count : 11
[12/26/21 18:44:56] INFO	Reduced Feature Count  : 10
[12/26/21 18:44:56] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:44:56] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:44:56] INFO	Creating Cross-Tabulations
[12/26/21 18:44:56] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:44:56] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:44:56] INFO	Feature Count     : 10
[12/26/21 18:44:56] INFO	Creating Count Features
[12/26/21 18:44:56] INFO	NA Counts
[12/26/21 18:44:56] INFO	Number Counts
[12/26/21 18:44:56] INFO	New Feature Count : 21
[12/26/21 18:44:56] INFO	Creating Base Features
[12/26/21 18:44:56] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:44:56] INFO	Feature 2: Name => Factorization
[12/26/21 18:44:56] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:44:56] INFO	Feature 3: Sex => Factorization
[12/26/21 18:44:56] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:44:56] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:44:56] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:44:56] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:44:56] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:44:56] INFO	Encoding: Encoders.target
[12/26/21 18:44:56] INFO	Fitting training features for Embarked
[12/26/21 18:44:56] INFO	Transforming testing features for Embarked
[12/26/21 18:44:56] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:44:56] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:44:56] INFO	New Feature Count : 21
[12/26/21 18:44:56] INFO	Scaling Base Features
[12/26/21 18:44:56] INFO	Creating NumPy Features
[12/26/21 18:44:56] INFO	NumPy Feature: sum
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	NumPy Feature: mean
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	NumPy Feature: std
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	NumPy Feature: var
[12/26/21 18:44:56] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:44:56] INFO	NumPy Feature Count : 4
[12/26/21 18:44:56] INFO	New Feature Count : 25
[12/26/21 18:44:56] INFO	Creating Clustering Features
[12/26/21 18:44:56] INFO	Cluster Minimum   : 3
[12/26/21 18:44:56] INFO	Cluster Maximum   : 30
[12/26/21 18:44:56] INFO	Cluster Increment : 3
[12/26/21 18:44:56] INFO	k = 3
[12/26/21 18:44:58] INFO	k = 6
[12/26/21 18:44:58] INFO	k = 9
[12/26/21 18:44:58] INFO	k = 12
[12/26/21 18:44:58] INFO	k = 15
[12/26/21 18:44:58] INFO	k = 18
[12/26/21 18:44:58] INFO	k = 21
[12/26/21 18:44:58] INFO	k = 24
[12/26/21 18:44:58] INFO	k = 27
[12/26/21 18:44:58] INFO	k = 30
[12/26/21 18:44:58] INFO	Clustering Feature Count : 10
[12/26/21 18:44:58] INFO	New Feature Count : 35
[12/26/21 18:44:58] INFO	Saving New Features in Model
[12/26/21 18:44:58] INFO	Creating Interactions
[12/26/21 18:44:58] INFO	Initial Feature Count  : 35
[12/26/21 18:44:58] INFO	Skipping Interactions
[12/26/21 18:44:58] INFO	Saving New Features in Model
[12/26/21 18:44:58] INFO	Removing Low-Variance Features
[12/26/21 18:44:58] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:44:58] INFO	Original Feature Count  : 35
[12/26/21 18:44:58] INFO	Reduced Feature Count   : 35
[12/26/21 18:44:58] INFO	Saving New Features in Model
[12/26/21 18:44:58] INFO	Skipping Shuffling
[12/26/21 18:44:58] INFO	Skipping Sampling
[12/26/21 18:44:58] INFO	Getting All Estimators
[12/26/21 18:44:58] INFO	Algorithm Configuration
[12/26/21 18:44:58] INFO	Selecting Models
[12/26/21 18:44:58] INFO	Algorithm: CATB
[12/26/21 18:44:58] INFO	Fitting Initial Model
[12/26/21 18:44:58] INFO	Cross-Validation
[12/26/21 18:45:00] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:45:00] INFO	Recursive Feature Elimination with CV
[12/26/21 18:45:02] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[12/26/21 18:45:02] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:45:02] INFO	No grid is defined for grid search
[12/26/21 18:45:02] INFO	Final Model Predictions for CATB
[12/26/21 18:45:02] INFO	Skipping Calibration
[12/26/21 18:45:02] INFO	Making Predictions
[12/26/21 18:45:02] INFO	Predictions Complete
[12/26/21 18:45:02] INFO	Algorithm: LGB
[12/26/21 18:45:02] INFO	Fitting Initial Model
[12/26/21 18:45:02] INFO	Cross-Validation
[12/26/21 18:45:03] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:45:03] INFO	Recursive Feature Elimination with CV
[12/26/21 18:45:06] INFO	RFECV took 3.03 seconds for step 3 and 3 folds
[12/26/21 18:45:06] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:45:06] INFO	No grid is defined for grid search
[12/26/21 18:45:06] INFO	Final Model Predictions for LGB
[12/26/21 18:45:06] INFO	Skipping Calibration
[12/26/21 18:45:06] INFO	Making Predictions
[12/26/21 18:45:06] INFO	Predictions Complete
[12/26/21 18:45:06] INFO	Algorithm: XGB
[12/26/21 18:45:06] INFO	Fitting Initial Model
[12/26/21 18:45:06] INFO	Cross-Validation
[12/26/21 18:45:07] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:45:07] INFO	Recursive Feature Elimination with CV
[12/26/21 18:45:09] INFO	RFECV took 2.29 seconds for step 3 and 3 folds
[12/26/21 18:45:09] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:45:09] INFO	Randomized Grid Search
[12/26/21 18:46:16] INFO	Grid Search took 66.66 seconds for 50 candidate parameter settings.
[12/26/21 18:46:16] INFO	Model with rank: 1
[12/26/21 18:46:16] INFO	Mean validation score: 0.871 (std: 0.021)
[12/26/21 18:46:16] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/26/21 18:46:16] INFO	Model with rank: 2
[12/26/21 18:46:16] INFO	Mean validation score: 0.871 (std: 0.024)
[12/26/21 18:46:16] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/26/21 18:46:16] INFO	Model with rank: 3
[12/26/21 18:46:16] INFO	Mean validation score: 0.870 (std: 0.033)
[12/26/21 18:46:16] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 10, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/26/21 18:46:16] INFO	Algorithm: XGB, Best Score: 0.8713, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.8}
[12/26/21 18:46:16] INFO	Final Model Predictions for XGB
[12/26/21 18:46:16] INFO	Skipping Calibration
[12/26/21 18:46:16] INFO	Making Predictions
[12/26/21 18:46:16] INFO	Predictions Complete
[12/26/21 18:46:16] INFO	Blending Models
[12/26/21 18:46:16] INFO	Blending Start: 2021-12-26 18:46:16.059943
[12/26/21 18:46:16] INFO	Blending Complete: 0:00:00.010026
[12/26/21 18:46:16] INFO	================================================================================
[12/26/21 18:46:16] INFO	Metrics for: Partition.train
[12/26/21 18:46:16] INFO	--------------------------------------------------------------------------------
[12/26/21 18:46:16] INFO	Algorithm: CATB
[12/26/21 18:46:16] INFO	accuracy: 0.8585858585858586
[12/26/21 18:46:16] INFO	average_precision: 0.9113351686222868
[12/26/21 18:46:16] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:46:16] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:46:16] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:46:16] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:46:16] INFO	f1: 0.8025078369905956
[12/26/21 18:46:16] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:46:16] INFO	precision: 0.8648648648648649
[12/26/21 18:46:16] INFO	recall: 0.7485380116959064
[12/26/21 18:46:16] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:46:16] INFO	--------------------------------------------------------------------------------
[12/26/21 18:46:16] INFO	Algorithm: LGB
[12/26/21 18:46:16] INFO	accuracy: 0.9730639730639731
[12/26/21 18:46:16] INFO	average_precision: 0.9961113207491221
[12/26/21 18:46:16] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:46:16] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:46:16] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:46:16] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:46:16] INFO	f1: 0.9643916913946586
[12/26/21 18:46:16] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:46:16] INFO	precision: 0.9789156626506024
[12/26/21 18:46:16] INFO	recall: 0.9502923976608187
[12/26/21 18:46:16] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:46:16] INFO	--------------------------------------------------------------------------------
[12/26/21 18:46:16] INFO	Algorithm: XGB
[12/26/21 18:46:16] INFO	accuracy: 0.9113355780022446
[12/26/21 18:46:16] INFO	average_precision: 0.953495676667679
[12/26/21 18:46:16] INFO	balanced_accuracy: 0.894976512319049
[12/26/21 18:46:16] INFO	brier_score_loss: 0.11474009138721274
[12/26/21 18:46:16] INFO	cohen_kappa: 0.8082195139893578
[12/26/21 18:46:16] INFO	confusion_matrix: [[530  19]
 [ 60 282]]
[12/26/21 18:46:16] INFO	f1: 0.8771384136858477
[12/26/21 18:46:16] INFO	neg_log_loss: 0.4028418281363317
[12/26/21 18:46:16] INFO	precision: 0.9368770764119602
[12/26/21 18:46:16] INFO	recall: 0.8245614035087719
[12/26/21 18:46:16] INFO	roc_auc: 0.9628404648536947
[12/26/21 18:46:16] INFO	================================================================================
[12/26/21 18:46:16] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:46:16] INFO	Best Model Selection Start: 2021-12-26 18:46:16.090680
[12/26/21 18:46:16] INFO	Scoring CATB Model
[12/26/21 18:46:16] INFO	Scoring LGB Model
[12/26/21 18:46:16] INFO	Scoring XGB Model
[12/26/21 18:46:16] INFO	Scoring BLEND Model
[12/26/21 18:46:16] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 18:46:16] INFO	Best Model Selection Complete: 0:00:00.000208
[12/26/21 18:46:16] INFO	================================================================================
[12/26/21 18:46:16] INFO	Generating Plots for partition: train
[12/26/21 18:46:16] INFO	Generating Calibration Plot
[12/26/21 18:46:16] INFO	Calibration for Algorithm: CATB
[12/26/21 18:46:16] INFO	Calibration for Algorithm: LGB
[12/26/21 18:46:16] INFO	Calibration for Algorithm: XGB
[12/26/21 18:46:16] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:46:16] INFO	Generating Confusion Matrices
[12/26/21 18:46:16] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:46:16] INFO	Confusion Matrix:
[12/26/21 18:46:16] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:46:16] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:46:16] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:46:16] INFO	Confusion Matrix:
[12/26/21 18:46:16] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:46:16] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:46:16] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:46:16] INFO	Confusion Matrix:
[12/26/21 18:46:16] INFO	[[530  19]
 [ 60 282]]
[12/26/21 18:46:16] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:46:16] INFO	Generating ROC Curves
[12/26/21 18:46:16] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:46:16] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:46:16] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:46:16] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:46:16] INFO	Generating Learning Curves
[12/26/21 18:46:16] INFO	Algorithm Configuration
[12/26/21 18:46:16] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:46:17] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:46:17] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:46:18] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:46:19] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:46:19] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:46:19] INFO	Generating Feature Importance Plots
[12/26/21 18:46:19] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:46:19] INFO	Feature Ranking:
[12/26/21 18:46:19] INFO	1. Sex_factor (45.178104)
[12/26/21 18:46:19] INFO	2. Pclass (13.721171)
[12/26/21 18:46:19] INFO	3. Age (6.651788)
[12/26/21 18:46:19] INFO	4. Fare (4.529770)
[12/26/21 18:46:19] INFO	5. var (3.586590)
[12/26/21 18:46:19] INFO	6. std (3.492385)
[12/26/21 18:46:19] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:46:19] INFO	8. cluster_30 (2.831587)
[12/26/21 18:46:19] INFO	9. mean (2.733389)
[12/26/21 18:46:19] INFO	10. Name_factor (2.586310)
[12/26/21 18:46:19] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:46:19] INFO	12. Embarked (2.086410)
[12/26/21 18:46:19] INFO	13. SibSp (2.085405)
[12/26/21 18:46:19] INFO	14. cluster_12 (1.876782)
[12/26/21 18:46:19] INFO	15. cluster_24 (1.263144)
[12/26/21 18:46:19] INFO	16. count_2 (1.004409)
[12/26/21 18:46:19] INFO	17. sum (0.955946)
[12/26/21 18:46:19] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:46:20] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:46:20] INFO	Feature Ranking:
[12/26/21 18:46:20] INFO	1. Fare (256.000000)
[12/26/21 18:46:20] INFO	2. sum (241.000000)
[12/26/21 18:46:20] INFO	3. Age (232.000000)
[12/26/21 18:46:20] INFO	4. std (201.000000)
[12/26/21 18:46:20] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:46:20] INFO	6. Name_factor (175.000000)
[12/26/21 18:46:20] INFO	7. cluster_30 (53.000000)
[12/26/21 18:46:20] INFO	8. cluster_27 (46.000000)
[12/26/21 18:46:20] INFO	9. Sex_factor (43.000000)
[12/26/21 18:46:20] INFO	10. Pclass (43.000000)
[12/26/21 18:46:20] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:46:20] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:46:20] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:46:20] INFO	Feature Ranking:
[12/26/21 18:46:20] INFO	1. Sex_factor (0.424644)
[12/26/21 18:46:20] INFO	2. Pclass (0.127452)
[12/26/21 18:46:20] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:46:20] INFO	4. Age (0.051007)
[12/26/21 18:46:20] INFO	5. SibSp (0.049620)
[12/26/21 18:46:20] INFO	6. count_1 (0.046373)
[12/26/21 18:46:20] INFO	7. Embarked (0.046225)
[12/26/21 18:46:20] INFO	8. std (0.036262)
[12/26/21 18:46:20] INFO	9. cluster_30 (0.036076)
[12/26/21 18:46:20] INFO	10. Fare (0.032410)
[12/26/21 18:46:20] INFO	11. cluster_24 (0.021187)
[12/26/21 18:46:20] INFO	12. Name_factor (0.019312)
[12/26/21 18:46:20] INFO	13. sum (0.017784)
[12/26/21 18:46:20] INFO	14. cluster_15 (0.010340)
[12/26/21 18:46:20] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:47:03] INFO	********************************************************************************
[12/26/21 18:47:03] INFO	AlphaPy Start
[12/26/21 18:47:03] INFO	********************************************************************************
[12/26/21 18:47:03] INFO	Model Configuration
[12/26/21 18:47:03] INFO	No transforms Found
[12/26/21 18:47:03] INFO	MODEL PARAMETERS:
[12/26/21 18:47:03] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:47:03] INFO	calibration       = False
[12/26/21 18:47:03] INFO	cal_type          = sigmoid
[12/26/21 18:47:03] INFO	calibration_plot  = False
[12/26/21 18:47:03] INFO	clustering        = True
[12/26/21 18:47:03] INFO	cluster_inc       = 3
[12/26/21 18:47:03] INFO	cluster_max       = 30
[12/26/21 18:47:03] INFO	cluster_min       = 3
[12/26/21 18:47:03] INFO	confusion_matrix  = True
[12/26/21 18:47:03] INFO	counts            = True
[12/26/21 18:47:03] INFO	cv_folds          = 3
[12/26/21 18:47:03] INFO	directory         = .
[12/26/21 18:47:03] INFO	extension         = csv
[12/26/21 18:47:03] INFO	drop              = ['PassengerId']
[12/26/21 18:47:03] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:47:03] INFO	esr               = 20
[12/26/21 18:47:03] INFO	factors           = ['Embarked']
[12/26/21 18:47:03] INFO	features [X]      = *
[12/26/21 18:47:03] INFO	feature_selection = False
[12/26/21 18:47:03] INFO	fs_percentage     = 50
[12/26/21 18:47:03] INFO	fs_score_func     = <function f_classif at 0x7fa7d9b93ee0>
[12/26/21 18:47:03] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:47:03] INFO	grid_search       = True
[12/26/21 18:47:03] INFO	gs_iters          = 50
[12/26/21 18:47:03] INFO	gs_random         = True
[12/26/21 18:47:03] INFO	gs_sample         = False
[12/26/21 18:47:03] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:47:03] INFO	importances       = True
[12/26/21 18:47:03] INFO	interactions      = False
[12/26/21 18:47:03] INFO	isomap            = False
[12/26/21 18:47:03] INFO	iso_components    = 2
[12/26/21 18:47:03] INFO	iso_neighbors     = 5
[12/26/21 18:47:03] INFO	isample_pct       = 10
[12/26/21 18:47:03] INFO	leaders           = []
[12/26/21 18:47:03] INFO	learning_curve    = True
[12/26/21 18:47:03] INFO	logtransform      = False
[12/26/21 18:47:03] INFO	lv_remove         = True
[12/26/21 18:47:03] INFO	lv_threshold      = 0.100000
[12/26/21 18:47:03] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:47:03] INFO	n_estimators      = 51
[12/26/21 18:47:03] INFO	n_jobs            = -1
[12/26/21 18:47:03] INFO	ngrams_max        = 2
[12/26/21 18:47:03] INFO	numpy             = True
[12/26/21 18:47:03] INFO	pca               = False
[12/26/21 18:47:03] INFO	pca_inc           = 1
[12/26/21 18:47:03] INFO	pca_max           = 10
[12/26/21 18:47:03] INFO	pca_min           = 2
[12/26/21 18:47:03] INFO	pca_whiten        = False
[12/26/21 18:47:03] INFO	poly_degree       = 2
[12/26/21 18:47:03] INFO	pvalue_level      = 0.010000
[12/26/21 18:47:03] INFO	rfe               = True
[12/26/21 18:47:03] INFO	rfe_step          = 3
[12/26/21 18:47:03] INFO	roc_curve         = True
[12/26/21 18:47:03] INFO	rounding          = 2
[12/26/21 18:47:03] INFO	sampling          = False
[12/26/21 18:47:03] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:47:03] INFO	sampling_ratio    = 1.000000
[12/26/21 18:47:03] INFO	scaler_option     = True
[12/26/21 18:47:03] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:47:03] INFO	scipy             = False
[12/26/21 18:47:03] INFO	scorer            = roc_auc
[12/26/21 18:47:03] INFO	seed              = 42
[12/26/21 18:47:03] INFO	sentinel          = -1
[12/26/21 18:47:03] INFO	separator         = ,
[12/26/21 18:47:03] INFO	shuffle           = False
[12/26/21 18:47:03] INFO	split             = 0.400000
[12/26/21 18:47:03] INFO	submission_file   = gender_submission
[12/26/21 18:47:03] INFO	submit_probas     = False
[12/26/21 18:47:03] INFO	target [y]        = Survived
[12/26/21 18:47:03] INFO	target_value      = 1
[12/26/21 18:47:03] INFO	transforms        = None
[12/26/21 18:47:03] INFO	tsne              = False
[12/26/21 18:47:03] INFO	tsne_components   = 2
[12/26/21 18:47:03] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:47:03] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:47:03] INFO	vectorize         = False
[12/26/21 18:47:03] INFO	verbosity         = 0
[12/26/21 18:47:03] INFO	Creating Model
[12/26/21 18:47:03] INFO	Calling Pipeline
[12/26/21 18:47:03] INFO	Training Pipeline
[12/26/21 18:47:03] INFO	Loading Data
[12/26/21 18:47:03] INFO	Loading data from ./input/train.csv
[12/26/21 18:47:03] INFO	Found target Survived in data frame
[12/26/21 18:47:03] INFO	Labels (y) found for Partition.train
[12/26/21 18:47:03] INFO	Loading Data
[12/26/21 18:47:03] INFO	Loading data from ./input/test.csv
[12/26/21 18:47:03] INFO	Target Survived not found in Partition.test
[12/26/21 18:47:03] INFO	Saving New Features in Model
[12/26/21 18:47:03] INFO	Original Feature Statistics
[12/26/21 18:47:03] INFO	Number of Training Rows    : 891
[12/26/21 18:47:03] INFO	Number of Training Columns : 11
[12/26/21 18:47:03] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:47:03] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:47:03] INFO	Number of Testing Rows     : 418
[12/26/21 18:47:03] INFO	Number of Testing Columns  : 11
[12/26/21 18:47:03] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:47:03] INFO	Feature Count     : 11
[12/26/21 18:47:03] INFO	Applying transforms
[12/26/21 18:47:03] INFO	No transforms Specified
[12/26/21 18:47:03] INFO	New Feature Count : 11
[12/26/21 18:47:03] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:47:03] INFO	Original Feature Count : 11
[12/26/21 18:47:03] INFO	Reduced Feature Count  : 10
[12/26/21 18:47:03] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 18:47:03] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 18:47:03] INFO	Creating Cross-Tabulations
[12/26/21 18:47:03] INFO	Creating crosstabs for feature Embarked
[12/26/21 18:47:03] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:47:03] INFO	Feature Count     : 10
[12/26/21 18:47:03] INFO	Creating Count Features
[12/26/21 18:47:03] INFO	NA Counts
[12/26/21 18:47:03] INFO	Number Counts
[12/26/21 18:47:03] INFO	New Feature Count : 21
[12/26/21 18:47:03] INFO	Creating Base Features
[12/26/21 18:47:03] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 18:47:03] INFO	Feature 2: Name => Factorization
[12/26/21 18:47:03] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 18:47:03] INFO	Feature 3: Sex => Factorization
[12/26/21 18:47:03] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 18:47:03] INFO	Feature 7: Ticket => Factorization
[12/26/21 18:47:03] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 18:47:03] INFO	Feature 9: Cabin => Factorization
[12/26/21 18:47:03] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 18:47:03] INFO	Encoding: Encoders.target
[12/26/21 18:47:03] INFO	Fitting training features for Embarked
[12/26/21 18:47:03] INFO	Transforming testing features for Embarked
[12/26/21 18:47:03] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 18:47:03] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 18:47:03] INFO	New Feature Count : 21
[12/26/21 18:47:03] INFO	Scaling Base Features
[12/26/21 18:47:03] INFO	Creating NumPy Features
[12/26/21 18:47:03] INFO	NumPy Feature: sum
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	NumPy Feature: mean
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	NumPy Feature: std
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	NumPy Feature: var
[12/26/21 18:47:03] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 18:47:03] INFO	NumPy Feature Count : 4
[12/26/21 18:47:03] INFO	New Feature Count : 25
[12/26/21 18:47:03] INFO	Creating Clustering Features
[12/26/21 18:47:03] INFO	Cluster Minimum   : 3
[12/26/21 18:47:03] INFO	Cluster Maximum   : 30
[12/26/21 18:47:03] INFO	Cluster Increment : 3
[12/26/21 18:47:03] INFO	k = 3
[12/26/21 18:47:05] INFO	k = 6
[12/26/21 18:47:05] INFO	k = 9
[12/26/21 18:47:05] INFO	k = 12
[12/26/21 18:47:05] INFO	k = 15
[12/26/21 18:47:05] INFO	k = 18
[12/26/21 18:47:05] INFO	k = 21
[12/26/21 18:47:05] INFO	k = 24
[12/26/21 18:47:05] INFO	k = 27
[12/26/21 18:47:05] INFO	k = 30
[12/26/21 18:47:05] INFO	Clustering Feature Count : 10
[12/26/21 18:47:05] INFO	New Feature Count : 35
[12/26/21 18:47:05] INFO	Saving New Features in Model
[12/26/21 18:47:05] INFO	Creating Interactions
[12/26/21 18:47:05] INFO	Initial Feature Count  : 35
[12/26/21 18:47:05] INFO	Skipping Interactions
[12/26/21 18:47:05] INFO	Saving New Features in Model
[12/26/21 18:47:05] INFO	Removing Low-Variance Features
[12/26/21 18:47:05] INFO	Low-Variance Threshold  : 0.10
[12/26/21 18:47:05] INFO	Original Feature Count  : 35
[12/26/21 18:47:05] INFO	Reduced Feature Count   : 35
[12/26/21 18:47:05] INFO	Saving New Features in Model
[12/26/21 18:47:05] INFO	Skipping Shuffling
[12/26/21 18:47:05] INFO	Skipping Sampling
[12/26/21 18:47:05] INFO	Getting All Estimators
[12/26/21 18:47:05] INFO	Algorithm Configuration
[12/26/21 18:47:05] INFO	Selecting Models
[12/26/21 18:47:05] INFO	Algorithm: CATB
[12/26/21 18:47:05] INFO	Fitting Initial Model
[12/26/21 18:47:06] INFO	Cross-Validation
[12/26/21 18:47:07] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 18:47:07] INFO	Recursive Feature Elimination with CV
[12/26/21 18:47:09] INFO	RFECV took 2.38 seconds for step 3 and 3 folds
[12/26/21 18:47:09] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 18:47:09] INFO	No grid is defined for grid search
[12/26/21 18:47:09] INFO	Final Model Predictions for CATB
[12/26/21 18:47:09] INFO	Skipping Calibration
[12/26/21 18:47:09] INFO	Making Predictions
[12/26/21 18:47:09] INFO	Predictions Complete
[12/26/21 18:47:09] INFO	Algorithm: LGB
[12/26/21 18:47:09] INFO	Fitting Initial Model
[12/26/21 18:47:09] INFO	Cross-Validation
[12/26/21 18:47:10] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 18:47:10] INFO	Recursive Feature Elimination with CV
[12/26/21 18:47:12] INFO	RFECV took 2.44 seconds for step 3 and 3 folds
[12/26/21 18:47:12] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 18:47:12] INFO	No grid is defined for grid search
[12/26/21 18:47:12] INFO	Final Model Predictions for LGB
[12/26/21 18:47:12] INFO	Skipping Calibration
[12/26/21 18:47:12] INFO	Making Predictions
[12/26/21 18:47:12] INFO	Predictions Complete
[12/26/21 18:47:12] INFO	Algorithm: XGB
[12/26/21 18:47:12] INFO	Fitting Initial Model
[12/26/21 18:47:12] INFO	Cross-Validation
[12/26/21 18:47:13] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 18:47:13] INFO	Recursive Feature Elimination with CV
[12/26/21 18:47:15] INFO	RFECV took 2.37 seconds for step 3 and 3 folds
[12/26/21 18:47:15] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 18:47:15] INFO	Randomized Grid Search
[12/26/21 18:48:29] INFO	Grid Search took 74.46 seconds for 50 candidate parameter settings.
[12/26/21 18:48:29] INFO	Model with rank: 1
[12/26/21 18:48:29] INFO	Mean validation score: 0.871 (std: 0.021)
[12/26/21 18:48:29] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/26/21 18:48:29] INFO	Model with rank: 2
[12/26/21 18:48:29] INFO	Mean validation score: 0.871 (std: 0.026)
[12/26/21 18:48:29] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/26/21 18:48:29] INFO	Model with rank: 3
[12/26/21 18:48:29] INFO	Mean validation score: 0.870 (std: 0.028)
[12/26/21 18:48:29] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 18:48:29] INFO	Algorithm: XGB, Best Score: 0.8712, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.8}
[12/26/21 18:48:29] INFO	Final Model Predictions for XGB
[12/26/21 18:48:29] INFO	Skipping Calibration
[12/26/21 18:48:29] INFO	Making Predictions
[12/26/21 18:48:29] INFO	Predictions Complete
[12/26/21 18:48:29] INFO	Blending Models
[12/26/21 18:48:29] INFO	Blending Start: 2021-12-26 18:48:29.927778
[12/26/21 18:48:29] INFO	Blending Complete: 0:00:00.004191
[12/26/21 18:48:29] INFO	================================================================================
[12/26/21 18:48:29] INFO	Metrics for: Partition.train
[12/26/21 18:48:29] INFO	--------------------------------------------------------------------------------
[12/26/21 18:48:29] INFO	Algorithm: CATB
[12/26/21 18:48:29] INFO	accuracy: 0.8585858585858586
[12/26/21 18:48:29] INFO	average_precision: 0.9113351686222868
[12/26/21 18:48:29] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 18:48:29] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 18:48:29] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 18:48:29] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 18:48:29] INFO	f1: 0.8025078369905956
[12/26/21 18:48:29] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 18:48:29] INFO	precision: 0.8648648648648649
[12/26/21 18:48:29] INFO	recall: 0.7485380116959064
[12/26/21 18:48:29] INFO	roc_auc: 0.9297979313797549
[12/26/21 18:48:29] INFO	--------------------------------------------------------------------------------
[12/26/21 18:48:29] INFO	Algorithm: LGB
[12/26/21 18:48:29] INFO	accuracy: 0.9730639730639731
[12/26/21 18:48:29] INFO	average_precision: 0.9961113207491221
[12/26/21 18:48:29] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 18:48:29] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 18:48:29] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 18:48:29] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 18:48:29] INFO	f1: 0.9643916913946586
[12/26/21 18:48:29] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 18:48:29] INFO	precision: 0.9789156626506024
[12/26/21 18:48:29] INFO	recall: 0.9502923976608187
[12/26/21 18:48:29] INFO	roc_auc: 0.9974861257576241
[12/26/21 18:48:29] INFO	--------------------------------------------------------------------------------
[12/26/21 18:48:29] INFO	Algorithm: XGB
[12/26/21 18:48:29] INFO	accuracy: 0.9113355780022446
[12/26/21 18:48:29] INFO	average_precision: 0.9535675374278603
[12/26/21 18:48:29] INFO	balanced_accuracy: 0.894976512319049
[12/26/21 18:48:29] INFO	brier_score_loss: 0.08803899242044694
[12/26/21 18:48:29] INFO	cohen_kappa: 0.8082195139893578
[12/26/21 18:48:29] INFO	confusion_matrix: [[530  19]
 [ 60 282]]
[12/26/21 18:48:29] INFO	f1: 0.8771384136858477
[12/26/21 18:48:29] INFO	neg_log_loss: 0.3216807626513921
[12/26/21 18:48:29] INFO	precision: 0.9368770764119602
[12/26/21 18:48:29] INFO	recall: 0.8245614035087719
[12/26/21 18:48:29] INFO	roc_auc: 0.9659774816519137
[12/26/21 18:48:29] INFO	================================================================================
[12/26/21 18:48:29] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 18:48:29] INFO	Best Model Selection Start: 2021-12-26 18:48:29.952330
[12/26/21 18:48:29] INFO	Scoring CATB Model
[12/26/21 18:48:29] INFO	Scoring LGB Model
[12/26/21 18:48:29] INFO	Scoring XGB Model
[12/26/21 18:48:29] INFO	Scoring BLEND Model
[12/26/21 18:48:29] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 18:48:29] INFO	Best Model Selection Complete: 0:00:00.000204
[12/26/21 18:48:29] INFO	================================================================================
[12/26/21 18:48:29] INFO	Generating Plots for partition: train
[12/26/21 18:48:29] INFO	Generating Calibration Plot
[12/26/21 18:48:29] INFO	Calibration for Algorithm: CATB
[12/26/21 18:48:29] INFO	Calibration for Algorithm: LGB
[12/26/21 18:48:29] INFO	Calibration for Algorithm: XGB
[12/26/21 18:48:29] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 18:48:30] INFO	Generating Confusion Matrices
[12/26/21 18:48:30] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 18:48:30] INFO	Confusion Matrix:
[12/26/21 18:48:30] INFO	[[509  40]
 [ 86 256]]
[12/26/21 18:48:30] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 18:48:30] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 18:48:30] INFO	Confusion Matrix:
[12/26/21 18:48:30] INFO	[[542   7]
 [ 17 325]]
[12/26/21 18:48:30] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 18:48:30] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 18:48:30] INFO	Confusion Matrix:
[12/26/21 18:48:30] INFO	[[530  19]
 [ 60 282]]
[12/26/21 18:48:30] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 18:48:30] INFO	Generating ROC Curves
[12/26/21 18:48:30] INFO	ROC Curve for Algorithm: CATB
[12/26/21 18:48:30] INFO	ROC Curve for Algorithm: LGB
[12/26/21 18:48:30] INFO	ROC Curve for Algorithm: XGB
[12/26/21 18:48:30] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 18:48:30] INFO	Generating Learning Curves
[12/26/21 18:48:30] INFO	Algorithm Configuration
[12/26/21 18:48:30] INFO	Learning Curve for Algorithm: CATB
[12/26/21 18:48:31] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 18:48:31] INFO	Learning Curve for Algorithm: LGB
[12/26/21 18:48:32] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 18:48:32] INFO	Learning Curve for Algorithm: XGB
[12/26/21 18:48:33] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 18:48:33] INFO	Generating Feature Importance Plots
[12/26/21 18:48:33] INFO	Feature Importances for Algorithm: CATB
[12/26/21 18:48:33] INFO	Feature Ranking:
[12/26/21 18:48:33] INFO	1. Sex_factor (45.178104)
[12/26/21 18:48:33] INFO	2. Pclass (13.721171)
[12/26/21 18:48:33] INFO	3. Age (6.651788)
[12/26/21 18:48:33] INFO	4. Fare (4.529770)
[12/26/21 18:48:33] INFO	5. var (3.586590)
[12/26/21 18:48:33] INFO	6. std (3.492385)
[12/26/21 18:48:33] INFO	7. Ticket_factor (3.315046)
[12/26/21 18:48:33] INFO	8. cluster_30 (2.831587)
[12/26/21 18:48:33] INFO	9. mean (2.733389)
[12/26/21 18:48:33] INFO	10. Name_factor (2.586310)
[12/26/21 18:48:33] INFO	11. Cabin_factor (2.101764)
[12/26/21 18:48:33] INFO	12. Embarked (2.086410)
[12/26/21 18:48:33] INFO	13. SibSp (2.085405)
[12/26/21 18:48:33] INFO	14. cluster_12 (1.876782)
[12/26/21 18:48:33] INFO	15. cluster_24 (1.263144)
[12/26/21 18:48:33] INFO	16. count_2 (1.004409)
[12/26/21 18:48:33] INFO	17. sum (0.955946)
[12/26/21 18:48:33] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 18:48:33] INFO	Feature Importances for Algorithm: LGB
[12/26/21 18:48:33] INFO	Feature Ranking:
[12/26/21 18:48:33] INFO	1. Fare (256.000000)
[12/26/21 18:48:33] INFO	2. sum (241.000000)
[12/26/21 18:48:33] INFO	3. Age (232.000000)
[12/26/21 18:48:33] INFO	4. std (201.000000)
[12/26/21 18:48:33] INFO	5. Ticket_factor (199.000000)
[12/26/21 18:48:33] INFO	6. Name_factor (175.000000)
[12/26/21 18:48:33] INFO	7. cluster_30 (53.000000)
[12/26/21 18:48:33] INFO	8. cluster_27 (46.000000)
[12/26/21 18:48:33] INFO	9. Sex_factor (43.000000)
[12/26/21 18:48:33] INFO	10. Pclass (43.000000)
[12/26/21 18:48:33] INFO	11. Cabin_factor (41.000000)
[12/26/21 18:48:33] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 18:48:33] INFO	Feature Importances for Algorithm: XGB
[12/26/21 18:48:33] INFO	Feature Ranking:
[12/26/21 18:48:33] INFO	1. Sex_factor (0.424644)
[12/26/21 18:48:33] INFO	2. Pclass (0.127452)
[12/26/21 18:48:33] INFO	3. Cabin_factor (0.081307)
[12/26/21 18:48:33] INFO	4. Age (0.051007)
[12/26/21 18:48:33] INFO	5. SibSp (0.049620)
[12/26/21 18:48:33] INFO	6. count_1 (0.046373)
[12/26/21 18:48:33] INFO	7. Embarked (0.046225)
[12/26/21 18:48:33] INFO	8. std (0.036262)
[12/26/21 18:48:33] INFO	9. cluster_30 (0.036076)
[12/26/21 18:48:33] INFO	10. Fare (0.032410)
[12/26/21 18:48:33] INFO	11. cluster_24 (0.021187)
[12/26/21 18:48:33] INFO	12. Name_factor (0.019312)
[12/26/21 18:48:33] INFO	13. sum (0.017784)
[12/26/21 18:48:33] INFO	14. cluster_15 (0.010340)
[12/26/21 18:48:33] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 18:55:42] INFO	********************************************************************************
[12/26/21 18:55:42] INFO	AlphaPy Start
[12/26/21 18:55:42] INFO	********************************************************************************
[12/26/21 18:55:42] INFO	Model Configuration
[12/26/21 18:55:42] INFO	No transforms Found
[12/26/21 18:55:42] INFO	MODEL PARAMETERS:
[12/26/21 18:55:42] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:55:42] INFO	calibration       = False
[12/26/21 18:55:42] INFO	cal_type          = sigmoid
[12/26/21 18:55:42] INFO	calibration_plot  = False
[12/26/21 18:55:42] INFO	clustering        = True
[12/26/21 18:55:42] INFO	cluster_inc       = 3
[12/26/21 18:55:42] INFO	cluster_max       = 30
[12/26/21 18:55:42] INFO	cluster_min       = 3
[12/26/21 18:55:42] INFO	confusion_matrix  = True
[12/26/21 18:55:42] INFO	counts            = True
[12/26/21 18:55:42] INFO	cv_folds          = 3
[12/26/21 18:55:42] INFO	directory         = .
[12/26/21 18:55:42] INFO	extension         = csv
[12/26/21 18:55:42] INFO	drop              = ['PassengerId']
[12/26/21 18:55:42] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:55:42] INFO	esr               = 20
[12/26/21 18:55:42] INFO	factors           = ['Embarked']
[12/26/21 18:55:42] INFO	features [X]      = *
[12/26/21 18:55:42] INFO	feature_selection = False
[12/26/21 18:55:42] INFO	fs_percentage     = 50
[12/26/21 18:55:42] INFO	fs_score_func     = <function f_classif at 0x7fd5e2d70dc0>
[12/26/21 18:55:42] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:55:42] INFO	grid_search       = True
[12/26/21 18:55:42] INFO	gs_iters          = 50
[12/26/21 18:55:42] INFO	gs_random         = True
[12/26/21 18:55:42] INFO	gs_sample         = False
[12/26/21 18:55:42] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:55:42] INFO	importances       = True
[12/26/21 18:55:42] INFO	interactions      = False
[12/26/21 18:55:42] INFO	isomap            = False
[12/26/21 18:55:42] INFO	iso_components    = 2
[12/26/21 18:55:42] INFO	iso_neighbors     = 5
[12/26/21 18:55:42] INFO	isample_pct       = 10
[12/26/21 18:55:42] INFO	leaders           = []
[12/26/21 18:55:42] INFO	learning_curve    = True
[12/26/21 18:55:42] INFO	logtransform      = False
[12/26/21 18:55:42] INFO	lv_remove         = True
[12/26/21 18:55:42] INFO	lv_threshold      = 0.100000
[12/26/21 18:55:42] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:55:42] INFO	n_estimators      = 51
[12/26/21 18:55:42] INFO	n_jobs            = -1
[12/26/21 18:55:42] INFO	ngrams_max        = 2
[12/26/21 18:55:42] INFO	numpy             = True
[12/26/21 18:55:42] INFO	pca               = False
[12/26/21 18:55:42] INFO	pca_inc           = 1
[12/26/21 18:55:42] INFO	pca_max           = 10
[12/26/21 18:55:42] INFO	pca_min           = 2
[12/26/21 18:55:42] INFO	pca_whiten        = False
[12/26/21 18:55:42] INFO	poly_degree       = 2
[12/26/21 18:55:42] INFO	pvalue_level      = 0.010000
[12/26/21 18:55:42] INFO	rfe               = True
[12/26/21 18:55:42] INFO	rfe_step          = 3
[12/26/21 18:55:42] INFO	roc_curve         = True
[12/26/21 18:55:42] INFO	rounding          = 2
[12/26/21 18:55:42] INFO	sampling          = False
[12/26/21 18:55:42] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:55:42] INFO	sampling_ratio    = 1.000000
[12/26/21 18:55:42] INFO	scaler_option     = True
[12/26/21 18:55:42] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:55:42] INFO	scipy             = False
[12/26/21 18:55:42] INFO	scorer            = roc_auc
[12/26/21 18:55:42] INFO	seed              = 42
[12/26/21 18:55:42] INFO	sentinel          = -1
[12/26/21 18:55:42] INFO	separator         = ,
[12/26/21 18:55:42] INFO	shuffle           = False
[12/26/21 18:55:42] INFO	split             = 0.400000
[12/26/21 18:55:42] INFO	submission_file   = gender_submission
[12/26/21 18:55:42] INFO	submit_probas     = False
[12/26/21 18:55:42] INFO	target [y]        = Survived
[12/26/21 18:55:42] INFO	target_value      = 1
[12/26/21 18:55:42] INFO	transforms        = None
[12/26/21 18:55:42] INFO	tsne              = False
[12/26/21 18:55:42] INFO	tsne_components   = 2
[12/26/21 18:55:42] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:55:42] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:55:42] INFO	vectorize         = False
[12/26/21 18:55:42] INFO	verbosity         = 0
[12/26/21 18:55:42] INFO	Creating Model
[12/26/21 18:55:42] INFO	Calling Pipeline
[12/26/21 18:55:42] INFO	Training Pipeline
[12/26/21 18:55:42] INFO	Loading Data
[12/26/21 18:55:42] INFO	Loading data from ./input/train.csv
[12/26/21 18:55:42] INFO	Found target Survived in data frame
[12/26/21 18:57:05] INFO	********************************************************************************
[12/26/21 18:57:05] INFO	AlphaPy Start
[12/26/21 18:57:05] INFO	********************************************************************************
[12/26/21 18:57:05] INFO	Model Configuration
[12/26/21 18:57:05] INFO	No transforms Found
[12/26/21 18:57:05] INFO	MODEL PARAMETERS:
[12/26/21 18:57:05] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:57:05] INFO	calibration       = False
[12/26/21 18:57:05] INFO	cal_type          = sigmoid
[12/26/21 18:57:05] INFO	calibration_plot  = False
[12/26/21 18:57:05] INFO	clustering        = True
[12/26/21 18:57:05] INFO	cluster_inc       = 3
[12/26/21 18:57:05] INFO	cluster_max       = 30
[12/26/21 18:57:05] INFO	cluster_min       = 3
[12/26/21 18:57:05] INFO	confusion_matrix  = True
[12/26/21 18:57:05] INFO	counts            = True
[12/26/21 18:57:05] INFO	cv_folds          = 3
[12/26/21 18:57:05] INFO	directory         = .
[12/26/21 18:57:05] INFO	extension         = csv
[12/26/21 18:57:05] INFO	drop              = ['PassengerId']
[12/26/21 18:57:05] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:57:05] INFO	esr               = 20
[12/26/21 18:57:05] INFO	factors           = ['Embarked']
[12/26/21 18:57:05] INFO	features [X]      = *
[12/26/21 18:57:05] INFO	feature_selection = False
[12/26/21 18:57:05] INFO	fs_percentage     = 50
[12/26/21 18:57:05] INFO	fs_score_func     = <function f_classif at 0x7fa7729bae50>
[12/26/21 18:57:05] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:57:05] INFO	grid_search       = True
[12/26/21 18:57:05] INFO	gs_iters          = 50
[12/26/21 18:57:05] INFO	gs_random         = True
[12/26/21 18:57:05] INFO	gs_sample         = False
[12/26/21 18:57:05] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:57:05] INFO	importances       = True
[12/26/21 18:57:05] INFO	interactions      = False
[12/26/21 18:57:05] INFO	isomap            = False
[12/26/21 18:57:05] INFO	iso_components    = 2
[12/26/21 18:57:05] INFO	iso_neighbors     = 5
[12/26/21 18:57:05] INFO	isample_pct       = 10
[12/26/21 18:57:05] INFO	leaders           = []
[12/26/21 18:57:05] INFO	learning_curve    = True
[12/26/21 18:57:05] INFO	logtransform      = False
[12/26/21 18:57:05] INFO	lv_remove         = True
[12/26/21 18:57:05] INFO	lv_threshold      = 0.100000
[12/26/21 18:57:05] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:57:05] INFO	n_estimators      = 51
[12/26/21 18:57:05] INFO	n_jobs            = -1
[12/26/21 18:57:05] INFO	ngrams_max        = 2
[12/26/21 18:57:05] INFO	numpy             = True
[12/26/21 18:57:05] INFO	pca               = False
[12/26/21 18:57:05] INFO	pca_inc           = 1
[12/26/21 18:57:05] INFO	pca_max           = 10
[12/26/21 18:57:05] INFO	pca_min           = 2
[12/26/21 18:57:05] INFO	pca_whiten        = False
[12/26/21 18:57:05] INFO	poly_degree       = 2
[12/26/21 18:57:05] INFO	pvalue_level      = 0.010000
[12/26/21 18:57:05] INFO	rfe               = True
[12/26/21 18:57:05] INFO	rfe_step          = 3
[12/26/21 18:57:05] INFO	roc_curve         = True
[12/26/21 18:57:05] INFO	rounding          = 2
[12/26/21 18:57:05] INFO	sampling          = False
[12/26/21 18:57:05] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:57:05] INFO	sampling_ratio    = 1.000000
[12/26/21 18:57:05] INFO	scaler_option     = True
[12/26/21 18:57:05] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:57:05] INFO	scipy             = False
[12/26/21 18:57:05] INFO	scorer            = roc_auc
[12/26/21 18:57:05] INFO	seed              = 42
[12/26/21 18:57:05] INFO	sentinel          = -1
[12/26/21 18:57:05] INFO	separator         = ,
[12/26/21 18:57:05] INFO	shuffle           = False
[12/26/21 18:57:05] INFO	split             = 0.400000
[12/26/21 18:57:05] INFO	submission_file   = gender_submission
[12/26/21 18:57:05] INFO	submit_probas     = False
[12/26/21 18:57:05] INFO	target [y]        = Survived
[12/26/21 18:57:05] INFO	target_value      = 1
[12/26/21 18:57:05] INFO	transforms        = None
[12/26/21 18:57:05] INFO	tsne              = False
[12/26/21 18:57:05] INFO	tsne_components   = 2
[12/26/21 18:57:05] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:57:05] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:57:05] INFO	vectorize         = False
[12/26/21 18:57:05] INFO	verbosity         = 0
[12/26/21 18:57:05] INFO	Creating Model
[12/26/21 18:57:05] INFO	Calling Pipeline
[12/26/21 18:57:05] INFO	Training Pipeline
[12/26/21 18:57:05] INFO	Loading Data
[12/26/21 18:57:05] INFO	Loading data from ./input/train.csv
[12/26/21 18:57:05] INFO	Found target Survived in data frame
[12/26/21 18:57:05] INFO	Labels (y) found for Partition.train
[12/26/21 18:57:05] INFO	Loading Data
[12/26/21 18:57:05] INFO	Loading data from ./input/test.csv
[12/26/21 18:57:05] INFO	Target Survived not found in Partition.test
[12/26/21 18:58:18] INFO	********************************************************************************
[12/26/21 18:58:18] INFO	AlphaPy Start
[12/26/21 18:58:18] INFO	********************************************************************************
[12/26/21 18:58:18] INFO	Model Configuration
[12/26/21 18:58:18] INFO	No transforms Found
[12/26/21 18:58:18] INFO	MODEL PARAMETERS:
[12/26/21 18:58:18] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 18:58:18] INFO	calibration       = False
[12/26/21 18:58:18] INFO	cal_type          = sigmoid
[12/26/21 18:58:18] INFO	calibration_plot  = False
[12/26/21 18:58:18] INFO	clustering        = True
[12/26/21 18:58:18] INFO	cluster_inc       = 3
[12/26/21 18:58:18] INFO	cluster_max       = 30
[12/26/21 18:58:18] INFO	cluster_min       = 3
[12/26/21 18:58:18] INFO	confusion_matrix  = True
[12/26/21 18:58:18] INFO	counts            = True
[12/26/21 18:58:18] INFO	cv_folds          = 3
[12/26/21 18:58:18] INFO	directory         = .
[12/26/21 18:58:18] INFO	extension         = csv
[12/26/21 18:58:18] INFO	drop              = ['PassengerId']
[12/26/21 18:58:18] INFO	encoder           = <Encoders.target: 14>
[12/26/21 18:58:18] INFO	esr               = 20
[12/26/21 18:58:18] INFO	factors           = ['Embarked']
[12/26/21 18:58:18] INFO	features [X]      = *
[12/26/21 18:58:18] INFO	feature_selection = False
[12/26/21 18:58:18] INFO	fs_percentage     = 50
[12/26/21 18:58:18] INFO	fs_score_func     = <function f_classif at 0x7fdf18fa2e50>
[12/26/21 18:58:18] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 18:58:18] INFO	grid_search       = True
[12/26/21 18:58:18] INFO	gs_iters          = 50
[12/26/21 18:58:18] INFO	gs_random         = True
[12/26/21 18:58:18] INFO	gs_sample         = False
[12/26/21 18:58:18] INFO	gs_sample_pct     = 0.200000
[12/26/21 18:58:18] INFO	importances       = True
[12/26/21 18:58:18] INFO	interactions      = False
[12/26/21 18:58:18] INFO	isomap            = False
[12/26/21 18:58:18] INFO	iso_components    = 2
[12/26/21 18:58:18] INFO	iso_neighbors     = 5
[12/26/21 18:58:18] INFO	isample_pct       = 10
[12/26/21 18:58:18] INFO	leaders           = []
[12/26/21 18:58:18] INFO	learning_curve    = True
[12/26/21 18:58:18] INFO	logtransform      = False
[12/26/21 18:58:18] INFO	lv_remove         = True
[12/26/21 18:58:18] INFO	lv_threshold      = 0.100000
[12/26/21 18:58:18] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 18:58:18] INFO	n_estimators      = 51
[12/26/21 18:58:18] INFO	n_jobs            = -1
[12/26/21 18:58:18] INFO	ngrams_max        = 2
[12/26/21 18:58:18] INFO	numpy             = True
[12/26/21 18:58:18] INFO	pca               = False
[12/26/21 18:58:18] INFO	pca_inc           = 1
[12/26/21 18:58:18] INFO	pca_max           = 10
[12/26/21 18:58:18] INFO	pca_min           = 2
[12/26/21 18:58:18] INFO	pca_whiten        = False
[12/26/21 18:58:18] INFO	poly_degree       = 2
[12/26/21 18:58:18] INFO	pvalue_level      = 0.010000
[12/26/21 18:58:18] INFO	rfe               = True
[12/26/21 18:58:18] INFO	rfe_step          = 3
[12/26/21 18:58:18] INFO	roc_curve         = True
[12/26/21 18:58:18] INFO	rounding          = 2
[12/26/21 18:58:18] INFO	sampling          = False
[12/26/21 18:58:18] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 18:58:18] INFO	sampling_ratio    = 1.000000
[12/26/21 18:58:18] INFO	scaler_option     = True
[12/26/21 18:58:18] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 18:58:18] INFO	scipy             = False
[12/26/21 18:58:18] INFO	scorer            = roc_auc
[12/26/21 18:58:18] INFO	seed              = 42
[12/26/21 18:58:18] INFO	sentinel          = -1
[12/26/21 18:58:18] INFO	separator         = ,
[12/26/21 18:58:18] INFO	shuffle           = False
[12/26/21 18:58:18] INFO	split             = 0.400000
[12/26/21 18:58:18] INFO	submission_file   = gender_submission
[12/26/21 18:58:18] INFO	submit_probas     = False
[12/26/21 18:58:18] INFO	target [y]        = Survived
[12/26/21 18:58:18] INFO	target_value      = 1
[12/26/21 18:58:18] INFO	transforms        = None
[12/26/21 18:58:18] INFO	tsne              = False
[12/26/21 18:58:18] INFO	tsne_components   = 2
[12/26/21 18:58:18] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 18:58:18] INFO	tsne_perplexity   = 30.000000
[12/26/21 18:58:18] INFO	vectorize         = False
[12/26/21 18:58:18] INFO	verbosity         = 0
[12/26/21 18:58:18] INFO	Creating Model
[12/26/21 18:58:18] INFO	Calling Pipeline
[12/26/21 18:58:18] INFO	Training Pipeline
[12/26/21 18:58:18] INFO	Loading Data
[12/26/21 18:58:18] INFO	Loading data from ./input/train.csv
[12/26/21 18:58:18] INFO	Found target Survived in data frame
[12/26/21 18:58:18] INFO	Labels (y) found for Partition.train
[12/26/21 18:58:18] INFO	Loading Data
[12/26/21 18:58:18] INFO	Loading data from ./input/test.csv
[12/26/21 18:58:18] INFO	Target Survived not found in Partition.test
[12/26/21 18:58:18] INFO	Saving New Features in Model
[12/26/21 18:58:18] INFO	Original Feature Statistics
[12/26/21 18:58:18] INFO	Number of Training Rows    : 891
[12/26/21 18:58:18] INFO	Number of Training Columns : 11
[12/26/21 18:58:18] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 18:58:18] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 18:58:18] INFO	Number of Testing Rows     : 418
[12/26/21 18:58:18] INFO	Number of Testing Columns  : 11
[12/26/21 18:58:18] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 18:58:18] INFO	Feature Count     : 11
[12/26/21 18:58:18] INFO	Applying transforms
[12/26/21 18:58:18] INFO	No transforms Specified
[12/26/21 18:58:18] INFO	New Feature Count : 11
[12/26/21 18:58:18] INFO	Dropping Features: ['PassengerId']
[12/26/21 18:58:18] INFO	Original Feature Count : 11
[12/26/21 18:58:18] INFO	Reduced Feature Count  : 10
[12/26/21 18:58:18] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:01:11] INFO	********************************************************************************
[12/26/21 19:01:11] INFO	AlphaPy Start
[12/26/21 19:01:11] INFO	********************************************************************************
[12/26/21 19:01:11] INFO	Model Configuration
[12/26/21 19:01:11] INFO	No transforms Found
[12/26/21 19:01:11] INFO	MODEL PARAMETERS:
[12/26/21 19:01:11] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:01:11] INFO	calibration       = False
[12/26/21 19:01:11] INFO	cal_type          = sigmoid
[12/26/21 19:01:11] INFO	calibration_plot  = False
[12/26/21 19:01:11] INFO	clustering        = True
[12/26/21 19:01:11] INFO	cluster_inc       = 3
[12/26/21 19:01:11] INFO	cluster_max       = 30
[12/26/21 19:01:11] INFO	cluster_min       = 3
[12/26/21 19:01:11] INFO	confusion_matrix  = True
[12/26/21 19:01:11] INFO	counts            = True
[12/26/21 19:01:11] INFO	cv_folds          = 3
[12/26/21 19:01:11] INFO	directory         = .
[12/26/21 19:01:11] INFO	extension         = csv
[12/26/21 19:01:11] INFO	drop              = ['PassengerId']
[12/26/21 19:01:11] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:01:11] INFO	esr               = 20
[12/26/21 19:01:11] INFO	factors           = ['Embarked']
[12/26/21 19:01:11] INFO	features [X]      = *
[12/26/21 19:01:11] INFO	feature_selection = False
[12/26/21 19:01:11] INFO	fs_percentage     = 50
[12/26/21 19:01:11] INFO	fs_score_func     = <function f_classif at 0x7fd331480e50>
[12/26/21 19:01:11] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:01:11] INFO	grid_search       = True
[12/26/21 19:01:11] INFO	gs_iters          = 50
[12/26/21 19:01:11] INFO	gs_random         = True
[12/26/21 19:01:11] INFO	gs_sample         = False
[12/26/21 19:01:11] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:01:11] INFO	importances       = True
[12/26/21 19:01:11] INFO	interactions      = False
[12/26/21 19:01:11] INFO	isomap            = False
[12/26/21 19:01:11] INFO	iso_components    = 2
[12/26/21 19:01:11] INFO	iso_neighbors     = 5
[12/26/21 19:01:11] INFO	isample_pct       = 10
[12/26/21 19:01:11] INFO	leaders           = []
[12/26/21 19:01:11] INFO	learning_curve    = True
[12/26/21 19:01:11] INFO	logtransform      = False
[12/26/21 19:01:11] INFO	lv_remove         = True
[12/26/21 19:01:11] INFO	lv_threshold      = 0.100000
[12/26/21 19:01:11] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:01:11] INFO	n_estimators      = 51
[12/26/21 19:01:11] INFO	n_jobs            = -1
[12/26/21 19:01:11] INFO	ngrams_max        = 2
[12/26/21 19:01:11] INFO	numpy             = True
[12/26/21 19:01:11] INFO	pca               = False
[12/26/21 19:01:11] INFO	pca_inc           = 1
[12/26/21 19:01:11] INFO	pca_max           = 10
[12/26/21 19:01:11] INFO	pca_min           = 2
[12/26/21 19:01:11] INFO	pca_whiten        = False
[12/26/21 19:01:11] INFO	poly_degree       = 2
[12/26/21 19:01:11] INFO	pvalue_level      = 0.010000
[12/26/21 19:01:11] INFO	rfe               = True
[12/26/21 19:01:11] INFO	rfe_step          = 3
[12/26/21 19:01:11] INFO	roc_curve         = True
[12/26/21 19:01:11] INFO	rounding          = 2
[12/26/21 19:01:11] INFO	sampling          = False
[12/26/21 19:01:11] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:01:11] INFO	sampling_ratio    = 1.000000
[12/26/21 19:01:11] INFO	scaler_option     = True
[12/26/21 19:01:11] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:01:11] INFO	scipy             = False
[12/26/21 19:01:11] INFO	scorer            = roc_auc
[12/26/21 19:01:11] INFO	seed              = 42
[12/26/21 19:01:11] INFO	sentinel          = -1
[12/26/21 19:01:11] INFO	separator         = ,
[12/26/21 19:01:11] INFO	shuffle           = False
[12/26/21 19:01:11] INFO	split             = 0.400000
[12/26/21 19:01:11] INFO	submission_file   = gender_submission
[12/26/21 19:01:11] INFO	submit_probas     = False
[12/26/21 19:01:11] INFO	target [y]        = Survived
[12/26/21 19:01:11] INFO	target_value      = 1
[12/26/21 19:01:11] INFO	transforms        = None
[12/26/21 19:01:11] INFO	tsne              = False
[12/26/21 19:01:11] INFO	tsne_components   = 2
[12/26/21 19:01:11] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:01:11] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:01:11] INFO	vectorize         = False
[12/26/21 19:01:11] INFO	verbosity         = 0
[12/26/21 19:01:11] INFO	Creating Model
[12/26/21 19:01:11] INFO	Calling Pipeline
[12/26/21 19:01:11] INFO	Training Pipeline
[12/26/21 19:01:11] INFO	Loading Data
[12/26/21 19:01:11] INFO	Loading data from ./input/train.csv
[12/26/21 19:01:11] INFO	Found target Survived in data frame
[12/26/21 19:01:11] INFO	Labels (y) found for Partition.train
[12/26/21 19:01:11] INFO	Loading Data
[12/26/21 19:01:11] INFO	Loading data from ./input/test.csv
[12/26/21 19:01:11] INFO	Target Survived not found in Partition.test
[12/26/21 19:04:38] INFO	********************************************************************************
[12/26/21 19:04:38] INFO	AlphaPy Start
[12/26/21 19:04:38] INFO	********************************************************************************
[12/26/21 19:04:38] INFO	Model Configuration
[12/26/21 19:04:38] INFO	No transforms Found
[12/26/21 19:04:38] INFO	MODEL PARAMETERS:
[12/26/21 19:04:38] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:04:38] INFO	calibration       = False
[12/26/21 19:04:38] INFO	cal_type          = sigmoid
[12/26/21 19:04:38] INFO	calibration_plot  = False
[12/26/21 19:04:38] INFO	clustering        = True
[12/26/21 19:04:38] INFO	cluster_inc       = 3
[12/26/21 19:04:38] INFO	cluster_max       = 30
[12/26/21 19:04:38] INFO	cluster_min       = 3
[12/26/21 19:04:38] INFO	confusion_matrix  = True
[12/26/21 19:04:38] INFO	counts            = True
[12/26/21 19:04:38] INFO	cv_folds          = 3
[12/26/21 19:04:38] INFO	directory         = .
[12/26/21 19:04:38] INFO	extension         = csv
[12/26/21 19:04:38] INFO	drop              = ['PassengerId']
[12/26/21 19:04:38] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:04:38] INFO	esr               = 20
[12/26/21 19:04:38] INFO	factors           = ['Embarked']
[12/26/21 19:04:38] INFO	features [X]      = *
[12/26/21 19:04:38] INFO	feature_selection = False
[12/26/21 19:04:38] INFO	fs_percentage     = 50
[12/26/21 19:04:38] INFO	fs_score_func     = <function f_classif at 0x7fc5e1f68e50>
[12/26/21 19:04:38] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:04:38] INFO	grid_search       = True
[12/26/21 19:04:38] INFO	gs_iters          = 50
[12/26/21 19:04:38] INFO	gs_random         = True
[12/26/21 19:04:38] INFO	gs_sample         = False
[12/26/21 19:04:38] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:04:38] INFO	importances       = True
[12/26/21 19:04:38] INFO	interactions      = False
[12/26/21 19:04:38] INFO	isomap            = False
[12/26/21 19:04:38] INFO	iso_components    = 2
[12/26/21 19:04:38] INFO	iso_neighbors     = 5
[12/26/21 19:04:38] INFO	isample_pct       = 10
[12/26/21 19:04:38] INFO	leaders           = []
[12/26/21 19:04:38] INFO	learning_curve    = True
[12/26/21 19:04:38] INFO	logtransform      = False
[12/26/21 19:04:38] INFO	lv_remove         = True
[12/26/21 19:04:38] INFO	lv_threshold      = 0.100000
[12/26/21 19:04:38] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:04:38] INFO	n_estimators      = 51
[12/26/21 19:04:38] INFO	n_jobs            = -1
[12/26/21 19:04:38] INFO	ngrams_max        = 2
[12/26/21 19:04:38] INFO	numpy             = True
[12/26/21 19:04:38] INFO	pca               = False
[12/26/21 19:04:38] INFO	pca_inc           = 1
[12/26/21 19:04:38] INFO	pca_max           = 10
[12/26/21 19:04:38] INFO	pca_min           = 2
[12/26/21 19:04:38] INFO	pca_whiten        = False
[12/26/21 19:04:38] INFO	poly_degree       = 2
[12/26/21 19:04:38] INFO	pvalue_level      = 0.010000
[12/26/21 19:04:38] INFO	rfe               = True
[12/26/21 19:04:38] INFO	rfe_step          = 3
[12/26/21 19:04:38] INFO	roc_curve         = True
[12/26/21 19:04:38] INFO	rounding          = 2
[12/26/21 19:04:38] INFO	sampling          = False
[12/26/21 19:04:38] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:04:38] INFO	sampling_ratio    = 1.000000
[12/26/21 19:04:38] INFO	scaler_option     = True
[12/26/21 19:04:38] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:04:38] INFO	scipy             = False
[12/26/21 19:04:38] INFO	scorer            = roc_auc
[12/26/21 19:04:38] INFO	seed              = 42
[12/26/21 19:04:38] INFO	sentinel          = -1
[12/26/21 19:04:38] INFO	separator         = ,
[12/26/21 19:04:38] INFO	shuffle           = False
[12/26/21 19:04:38] INFO	split             = 0.400000
[12/26/21 19:04:38] INFO	submission_file   = gender_submission
[12/26/21 19:04:38] INFO	submit_probas     = False
[12/26/21 19:04:38] INFO	target [y]        = Survived
[12/26/21 19:04:38] INFO	target_value      = 1
[12/26/21 19:04:38] INFO	transforms        = None
[12/26/21 19:04:38] INFO	tsne              = False
[12/26/21 19:04:38] INFO	tsne_components   = 2
[12/26/21 19:04:38] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:04:38] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:04:38] INFO	vectorize         = False
[12/26/21 19:04:38] INFO	verbosity         = 0
[12/26/21 19:04:38] INFO	Creating Model
[12/26/21 19:04:38] INFO	Calling Pipeline
[12/26/21 19:04:38] INFO	Training Pipeline
[12/26/21 19:04:38] INFO	Loading Data
[12/26/21 19:04:38] INFO	Loading data from ./input/train.csv
[12/26/21 19:04:38] INFO	Found target Survived in data frame
[12/26/21 19:04:38] INFO	Labels (y) found for Partition.train
[12/26/21 19:04:38] INFO	Loading Data
[12/26/21 19:04:38] INFO	Loading data from ./input/test.csv
[12/26/21 19:04:38] INFO	Target Survived not found in Partition.test
[12/26/21 19:04:38] INFO	Saving New Features in Model
[12/26/21 19:04:38] INFO	Original Feature Statistics
[12/26/21 19:04:38] INFO	Number of Training Rows    : 891
[12/26/21 19:04:38] INFO	Number of Training Columns : 11
[12/26/21 19:04:38] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:04:38] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:04:38] INFO	Number of Testing Rows     : 418
[12/26/21 19:04:38] INFO	Number of Testing Columns  : 11
[12/26/21 19:04:38] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:04:38] INFO	Feature Count     : 11
[12/26/21 19:04:38] INFO	Applying transforms
[12/26/21 19:04:38] INFO	No transforms Specified
[12/26/21 19:04:38] INFO	New Feature Count : 11
[12/26/21 19:04:38] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:04:38] INFO	Original Feature Count : 11
[12/26/21 19:04:38] INFO	Reduced Feature Count  : 10
[12/26/21 19:04:38] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:07:51] INFO	********************************************************************************
[12/26/21 19:07:51] INFO	AlphaPy Start
[12/26/21 19:07:51] INFO	********************************************************************************
[12/26/21 19:07:51] INFO	Model Configuration
[12/26/21 19:07:51] INFO	No transforms Found
[12/26/21 19:07:51] INFO	MODEL PARAMETERS:
[12/26/21 19:07:51] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:07:51] INFO	calibration       = False
[12/26/21 19:07:51] INFO	cal_type          = sigmoid
[12/26/21 19:07:51] INFO	calibration_plot  = False
[12/26/21 19:07:51] INFO	clustering        = True
[12/26/21 19:07:51] INFO	cluster_inc       = 3
[12/26/21 19:07:51] INFO	cluster_max       = 30
[12/26/21 19:07:51] INFO	cluster_min       = 3
[12/26/21 19:07:51] INFO	confusion_matrix  = True
[12/26/21 19:07:51] INFO	counts            = True
[12/26/21 19:07:51] INFO	cv_folds          = 3
[12/26/21 19:07:51] INFO	directory         = .
[12/26/21 19:07:51] INFO	extension         = csv
[12/26/21 19:07:51] INFO	drop              = ['PassengerId']
[12/26/21 19:07:51] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:07:51] INFO	esr               = 20
[12/26/21 19:07:51] INFO	factors           = ['Embarked']
[12/26/21 19:07:51] INFO	features [X]      = *
[12/26/21 19:07:51] INFO	feature_selection = False
[12/26/21 19:07:51] INFO	fs_percentage     = 50
[12/26/21 19:07:51] INFO	fs_score_func     = <function f_classif at 0x7f8e29ab9e50>
[12/26/21 19:07:51] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:07:51] INFO	grid_search       = True
[12/26/21 19:07:51] INFO	gs_iters          = 50
[12/26/21 19:07:51] INFO	gs_random         = True
[12/26/21 19:07:51] INFO	gs_sample         = False
[12/26/21 19:07:51] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:07:51] INFO	importances       = True
[12/26/21 19:07:51] INFO	interactions      = False
[12/26/21 19:07:51] INFO	isomap            = False
[12/26/21 19:07:51] INFO	iso_components    = 2
[12/26/21 19:07:51] INFO	iso_neighbors     = 5
[12/26/21 19:07:51] INFO	isample_pct       = 10
[12/26/21 19:07:51] INFO	leaders           = []
[12/26/21 19:07:51] INFO	learning_curve    = True
[12/26/21 19:07:51] INFO	logtransform      = False
[12/26/21 19:07:51] INFO	lv_remove         = True
[12/26/21 19:07:51] INFO	lv_threshold      = 0.100000
[12/26/21 19:07:51] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:07:51] INFO	n_estimators      = 51
[12/26/21 19:07:51] INFO	n_jobs            = -1
[12/26/21 19:07:51] INFO	ngrams_max        = 2
[12/26/21 19:07:51] INFO	numpy             = True
[12/26/21 19:07:51] INFO	pca               = False
[12/26/21 19:07:51] INFO	pca_inc           = 1
[12/26/21 19:07:51] INFO	pca_max           = 10
[12/26/21 19:07:51] INFO	pca_min           = 2
[12/26/21 19:07:51] INFO	pca_whiten        = False
[12/26/21 19:07:51] INFO	poly_degree       = 2
[12/26/21 19:07:51] INFO	pvalue_level      = 0.010000
[12/26/21 19:07:51] INFO	rfe               = True
[12/26/21 19:07:51] INFO	rfe_step          = 3
[12/26/21 19:07:51] INFO	roc_curve         = True
[12/26/21 19:07:51] INFO	rounding          = 2
[12/26/21 19:07:51] INFO	sampling          = False
[12/26/21 19:07:51] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:07:51] INFO	sampling_ratio    = 1.000000
[12/26/21 19:07:51] INFO	scaler_option     = True
[12/26/21 19:07:51] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:07:51] INFO	scipy             = False
[12/26/21 19:07:51] INFO	scorer            = roc_auc
[12/26/21 19:07:51] INFO	seed              = 42
[12/26/21 19:07:51] INFO	sentinel          = -1
[12/26/21 19:07:51] INFO	separator         = ,
[12/26/21 19:07:51] INFO	shuffle           = False
[12/26/21 19:07:51] INFO	split             = 0.400000
[12/26/21 19:07:51] INFO	submission_file   = gender_submission
[12/26/21 19:07:51] INFO	submit_probas     = False
[12/26/21 19:07:51] INFO	target [y]        = Survived
[12/26/21 19:07:51] INFO	target_value      = 1
[12/26/21 19:07:51] INFO	transforms        = None
[12/26/21 19:07:51] INFO	tsne              = False
[12/26/21 19:07:51] INFO	tsne_components   = 2
[12/26/21 19:07:51] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:07:51] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:07:51] INFO	vectorize         = False
[12/26/21 19:07:51] INFO	verbosity         = 0
[12/26/21 19:07:51] INFO	Creating Model
[12/26/21 19:07:51] INFO	Calling Pipeline
[12/26/21 19:07:51] INFO	Training Pipeline
[12/26/21 19:07:51] INFO	Loading Data
[12/26/21 19:07:51] INFO	Loading data from ./input/train.csv
[12/26/21 19:07:51] INFO	Found target Survived in data frame
[12/26/21 19:07:51] INFO	Labels (y) found for Partition.train
[12/26/21 19:07:51] INFO	Loading Data
[12/26/21 19:07:51] INFO	Loading data from ./input/test.csv
[12/26/21 19:07:51] INFO	Target Survived not found in Partition.test
[12/26/21 19:07:51] INFO	Saving New Features in Model
[12/26/21 19:07:51] INFO	Original Feature Statistics
[12/26/21 19:07:51] INFO	Number of Training Rows    : 891
[12/26/21 19:07:51] INFO	Number of Training Columns : 11
[12/26/21 19:07:51] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:07:51] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:07:51] INFO	Number of Testing Rows     : 418
[12/26/21 19:07:51] INFO	Number of Testing Columns  : 11
[12/26/21 19:07:51] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:07:51] INFO	Feature Count     : 11
[12/26/21 19:07:51] INFO	Applying transforms
[12/26/21 19:07:51] INFO	No transforms Specified
[12/26/21 19:07:51] INFO	New Feature Count : 11
[12/26/21 19:07:51] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:07:51] INFO	Original Feature Count : 11
[12/26/21 19:07:51] INFO	Reduced Feature Count  : 10
[12/26/21 19:07:51] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:14:55] INFO	********************************************************************************
[12/26/21 19:14:55] INFO	AlphaPy Start
[12/26/21 19:14:55] INFO	********************************************************************************
[12/26/21 19:14:55] INFO	Model Configuration
[12/26/21 19:14:55] INFO	No transforms Found
[12/26/21 19:14:55] INFO	MODEL PARAMETERS:
[12/26/21 19:14:55] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:14:55] INFO	calibration       = False
[12/26/21 19:14:55] INFO	cal_type          = sigmoid
[12/26/21 19:14:55] INFO	calibration_plot  = False
[12/26/21 19:14:55] INFO	clustering        = True
[12/26/21 19:14:55] INFO	cluster_inc       = 3
[12/26/21 19:14:55] INFO	cluster_max       = 30
[12/26/21 19:14:55] INFO	cluster_min       = 3
[12/26/21 19:14:55] INFO	confusion_matrix  = True
[12/26/21 19:14:55] INFO	counts            = True
[12/26/21 19:14:55] INFO	cv_folds          = 3
[12/26/21 19:14:55] INFO	directory         = .
[12/26/21 19:14:55] INFO	extension         = csv
[12/26/21 19:14:55] INFO	drop              = ['PassengerId']
[12/26/21 19:14:55] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:14:55] INFO	esr               = 20
[12/26/21 19:14:55] INFO	factors           = ['Embarked']
[12/26/21 19:14:55] INFO	features [X]      = *
[12/26/21 19:14:55] INFO	feature_selection = False
[12/26/21 19:14:55] INFO	fs_percentage     = 50
[12/26/21 19:14:55] INFO	fs_score_func     = <function f_classif at 0x7fae81be9e50>
[12/26/21 19:14:55] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:14:55] INFO	grid_search       = True
[12/26/21 19:14:55] INFO	gs_iters          = 50
[12/26/21 19:14:55] INFO	gs_random         = True
[12/26/21 19:14:55] INFO	gs_sample         = False
[12/26/21 19:14:55] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:14:55] INFO	importances       = True
[12/26/21 19:14:55] INFO	interactions      = False
[12/26/21 19:14:55] INFO	isomap            = False
[12/26/21 19:14:55] INFO	iso_components    = 2
[12/26/21 19:14:55] INFO	iso_neighbors     = 5
[12/26/21 19:14:55] INFO	isample_pct       = 10
[12/26/21 19:14:55] INFO	leaders           = []
[12/26/21 19:14:55] INFO	learning_curve    = True
[12/26/21 19:14:55] INFO	logtransform      = False
[12/26/21 19:14:55] INFO	lv_remove         = True
[12/26/21 19:14:55] INFO	lv_threshold      = 0.100000
[12/26/21 19:14:55] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:14:55] INFO	n_estimators      = 51
[12/26/21 19:14:55] INFO	n_jobs            = -1
[12/26/21 19:14:55] INFO	ngrams_max        = 2
[12/26/21 19:14:55] INFO	numpy             = True
[12/26/21 19:14:55] INFO	pca               = False
[12/26/21 19:14:55] INFO	pca_inc           = 1
[12/26/21 19:14:55] INFO	pca_max           = 10
[12/26/21 19:14:55] INFO	pca_min           = 2
[12/26/21 19:14:55] INFO	pca_whiten        = False
[12/26/21 19:14:55] INFO	poly_degree       = 2
[12/26/21 19:14:55] INFO	pvalue_level      = 0.010000
[12/26/21 19:14:55] INFO	rfe               = True
[12/26/21 19:14:55] INFO	rfe_step          = 3
[12/26/21 19:14:55] INFO	roc_curve         = True
[12/26/21 19:14:55] INFO	rounding          = 2
[12/26/21 19:14:55] INFO	sampling          = False
[12/26/21 19:14:55] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:14:55] INFO	sampling_ratio    = 1.000000
[12/26/21 19:14:55] INFO	scaler_option     = True
[12/26/21 19:14:55] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:14:55] INFO	scipy             = False
[12/26/21 19:14:55] INFO	scorer            = roc_auc
[12/26/21 19:14:55] INFO	seed              = 42
[12/26/21 19:14:55] INFO	sentinel          = -1
[12/26/21 19:14:55] INFO	separator         = ,
[12/26/21 19:14:55] INFO	shuffle           = False
[12/26/21 19:14:55] INFO	split             = 0.400000
[12/26/21 19:14:55] INFO	submission_file   = gender_submission
[12/26/21 19:14:55] INFO	submit_probas     = False
[12/26/21 19:14:55] INFO	target [y]        = Survived
[12/26/21 19:14:55] INFO	target_value      = 1
[12/26/21 19:14:55] INFO	transforms        = None
[12/26/21 19:14:55] INFO	tsne              = False
[12/26/21 19:14:55] INFO	tsne_components   = 2
[12/26/21 19:14:55] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:14:55] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:14:55] INFO	vectorize         = False
[12/26/21 19:14:55] INFO	verbosity         = 0
[12/26/21 19:14:55] INFO	Creating Model
[12/26/21 19:14:55] INFO	Calling Pipeline
[12/26/21 19:14:55] INFO	Training Pipeline
[12/26/21 19:14:55] INFO	Loading Data
[12/26/21 19:14:55] INFO	Loading data from ./input/train.csv
[12/26/21 19:14:55] INFO	Found target Survived in data frame
[12/26/21 19:14:55] INFO	Labels (y) found for Partition.train
[12/26/21 19:14:55] INFO	Loading Data
[12/26/21 19:14:55] INFO	Loading data from ./input/test.csv
[12/26/21 19:14:55] INFO	Target Survived not found in Partition.test
[12/26/21 19:14:55] INFO	Saving New Features in Model
[12/26/21 19:14:55] INFO	Original Feature Statistics
[12/26/21 19:14:55] INFO	Number of Training Rows    : 891
[12/26/21 19:14:55] INFO	Number of Training Columns : 11
[12/26/21 19:14:55] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:14:55] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:14:55] INFO	Number of Testing Rows     : 418
[12/26/21 19:14:55] INFO	Number of Testing Columns  : 11
[12/26/21 19:14:55] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:14:55] INFO	Feature Count     : 11
[12/26/21 19:14:55] INFO	Applying transforms
[12/26/21 19:14:55] INFO	No transforms Specified
[12/26/21 19:14:55] INFO	New Feature Count : 11
[12/26/21 19:14:55] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:14:55] INFO	Original Feature Count : 11
[12/26/21 19:14:55] INFO	Reduced Feature Count  : 10
[12/26/21 19:14:55] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:14:55] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:14:55] INFO	Creating Cross-Tabulations
[12/26/21 19:14:55] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:26:45] INFO	********************************************************************************
[12/26/21 19:26:45] INFO	AlphaPy Start
[12/26/21 19:26:45] INFO	********************************************************************************
[12/26/21 19:26:45] INFO	Model Configuration
[12/26/21 19:26:45] INFO	No transforms Found
[12/26/21 19:26:45] INFO	MODEL PARAMETERS:
[12/26/21 19:26:45] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:26:45] INFO	calibration       = False
[12/26/21 19:26:45] INFO	cal_type          = sigmoid
[12/26/21 19:26:45] INFO	calibration_plot  = False
[12/26/21 19:26:45] INFO	clustering        = True
[12/26/21 19:26:45] INFO	cluster_inc       = 3
[12/26/21 19:26:45] INFO	cluster_max       = 30
[12/26/21 19:26:45] INFO	cluster_min       = 3
[12/26/21 19:26:45] INFO	confusion_matrix  = True
[12/26/21 19:26:45] INFO	counts            = True
[12/26/21 19:26:45] INFO	cv_folds          = 3
[12/26/21 19:26:45] INFO	directory         = .
[12/26/21 19:26:45] INFO	extension         = csv
[12/26/21 19:26:45] INFO	drop              = ['PassengerId']
[12/26/21 19:26:45] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:26:45] INFO	esr               = 20
[12/26/21 19:26:45] INFO	factors           = ['Embarked']
[12/26/21 19:26:45] INFO	features [X]      = *
[12/26/21 19:26:45] INFO	feature_selection = False
[12/26/21 19:26:45] INFO	fs_percentage     = 50
[12/26/21 19:26:45] INFO	fs_score_func     = <function f_classif at 0x7f8db1297e50>
[12/26/21 19:26:45] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:26:45] INFO	grid_search       = True
[12/26/21 19:26:45] INFO	gs_iters          = 50
[12/26/21 19:26:45] INFO	gs_random         = True
[12/26/21 19:26:45] INFO	gs_sample         = False
[12/26/21 19:26:45] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:26:45] INFO	importances       = True
[12/26/21 19:26:45] INFO	interactions      = False
[12/26/21 19:26:45] INFO	isomap            = False
[12/26/21 19:26:45] INFO	iso_components    = 2
[12/26/21 19:26:45] INFO	iso_neighbors     = 5
[12/26/21 19:26:45] INFO	isample_pct       = 10
[12/26/21 19:26:45] INFO	leaders           = []
[12/26/21 19:26:45] INFO	learning_curve    = True
[12/26/21 19:26:45] INFO	logtransform      = False
[12/26/21 19:26:45] INFO	lv_remove         = True
[12/26/21 19:26:45] INFO	lv_threshold      = 0.100000
[12/26/21 19:26:45] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:26:45] INFO	n_estimators      = 51
[12/26/21 19:26:45] INFO	n_jobs            = -1
[12/26/21 19:26:45] INFO	ngrams_max        = 2
[12/26/21 19:26:45] INFO	numpy             = True
[12/26/21 19:26:45] INFO	pca               = False
[12/26/21 19:26:45] INFO	pca_inc           = 1
[12/26/21 19:26:45] INFO	pca_max           = 10
[12/26/21 19:26:45] INFO	pca_min           = 2
[12/26/21 19:26:45] INFO	pca_whiten        = False
[12/26/21 19:26:45] INFO	poly_degree       = 2
[12/26/21 19:26:45] INFO	pvalue_level      = 0.010000
[12/26/21 19:26:45] INFO	rfe               = True
[12/26/21 19:26:45] INFO	rfe_step          = 3
[12/26/21 19:26:45] INFO	roc_curve         = True
[12/26/21 19:26:45] INFO	rounding          = 2
[12/26/21 19:26:45] INFO	sampling          = False
[12/26/21 19:26:45] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:26:45] INFO	sampling_ratio    = 1.000000
[12/26/21 19:26:45] INFO	scaler_option     = True
[12/26/21 19:26:45] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:26:45] INFO	scipy             = False
[12/26/21 19:26:45] INFO	scorer            = roc_auc
[12/26/21 19:26:45] INFO	seed              = 42
[12/26/21 19:26:45] INFO	sentinel          = -1
[12/26/21 19:26:45] INFO	separator         = ,
[12/26/21 19:26:45] INFO	shuffle           = False
[12/26/21 19:26:45] INFO	split             = 0.400000
[12/26/21 19:26:45] INFO	submission_file   = gender_submission
[12/26/21 19:26:45] INFO	submit_probas     = False
[12/26/21 19:26:45] INFO	target [y]        = Survived
[12/26/21 19:26:45] INFO	target_value      = 1
[12/26/21 19:26:45] INFO	transforms        = None
[12/26/21 19:26:45] INFO	tsne              = False
[12/26/21 19:26:45] INFO	tsne_components   = 2
[12/26/21 19:26:45] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:26:45] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:26:45] INFO	vectorize         = False
[12/26/21 19:26:45] INFO	verbosity         = 0
[12/26/21 19:26:45] INFO	Creating Model
[12/26/21 19:26:45] INFO	Calling Pipeline
[12/26/21 19:26:45] INFO	Training Pipeline
[12/26/21 19:26:45] INFO	Loading Data
[12/26/21 19:26:45] INFO	Loading data from ./input/train.csv
[12/26/21 19:26:45] INFO	Found target Survived in data frame
[12/26/21 19:26:45] INFO	Labels (y) found for Partition.train
[12/26/21 19:26:45] INFO	Loading Data
[12/26/21 19:26:45] INFO	Loading data from ./input/test.csv
[12/26/21 19:26:45] INFO	Target Survived not found in Partition.test
[12/26/21 19:26:45] INFO	Saving New Features in Model
[12/26/21 19:26:45] INFO	Original Feature Statistics
[12/26/21 19:26:45] INFO	Number of Training Rows    : 891
[12/26/21 19:26:45] INFO	Number of Training Columns : 11
[12/26/21 19:26:45] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:26:45] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:26:45] INFO	Number of Testing Rows     : 418
[12/26/21 19:26:45] INFO	Number of Testing Columns  : 11
[12/26/21 19:26:45] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:26:45] INFO	Feature Count     : 11
[12/26/21 19:26:45] INFO	Applying transforms
[12/26/21 19:26:45] INFO	No transforms Specified
[12/26/21 19:26:45] INFO	New Feature Count : 11
[12/26/21 19:26:45] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:26:45] INFO	Original Feature Count : 11
[12/26/21 19:26:45] INFO	Reduced Feature Count  : 10
[12/26/21 19:26:45] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:26:45] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:26:45] INFO	Creating Cross-Tabulations
[12/26/21 19:27:14] INFO	********************************************************************************
[12/26/21 19:27:14] INFO	AlphaPy Start
[12/26/21 19:27:14] INFO	********************************************************************************
[12/26/21 19:27:14] INFO	Model Configuration
[12/26/21 19:27:14] INFO	No transforms Found
[12/26/21 19:27:14] INFO	MODEL PARAMETERS:
[12/26/21 19:27:14] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:27:14] INFO	calibration       = False
[12/26/21 19:27:14] INFO	cal_type          = sigmoid
[12/26/21 19:27:14] INFO	calibration_plot  = False
[12/26/21 19:27:14] INFO	clustering        = True
[12/26/21 19:27:14] INFO	cluster_inc       = 3
[12/26/21 19:27:14] INFO	cluster_max       = 30
[12/26/21 19:27:14] INFO	cluster_min       = 3
[12/26/21 19:27:14] INFO	confusion_matrix  = True
[12/26/21 19:27:14] INFO	counts            = True
[12/26/21 19:27:14] INFO	cv_folds          = 3
[12/26/21 19:27:14] INFO	directory         = .
[12/26/21 19:27:14] INFO	extension         = csv
[12/26/21 19:27:14] INFO	drop              = ['PassengerId']
[12/26/21 19:27:14] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:27:14] INFO	esr               = 20
[12/26/21 19:27:14] INFO	factors           = ['Embarked']
[12/26/21 19:27:14] INFO	features [X]      = *
[12/26/21 19:27:14] INFO	feature_selection = False
[12/26/21 19:27:14] INFO	fs_percentage     = 50
[12/26/21 19:27:14] INFO	fs_score_func     = <function f_classif at 0x7f8998303ee0>
[12/26/21 19:27:14] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:27:14] INFO	grid_search       = True
[12/26/21 19:27:14] INFO	gs_iters          = 50
[12/26/21 19:27:14] INFO	gs_random         = True
[12/26/21 19:27:14] INFO	gs_sample         = False
[12/26/21 19:27:14] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:27:14] INFO	importances       = True
[12/26/21 19:27:14] INFO	interactions      = False
[12/26/21 19:27:14] INFO	isomap            = False
[12/26/21 19:27:14] INFO	iso_components    = 2
[12/26/21 19:27:14] INFO	iso_neighbors     = 5
[12/26/21 19:27:14] INFO	isample_pct       = 10
[12/26/21 19:27:14] INFO	leaders           = []
[12/26/21 19:27:14] INFO	learning_curve    = True
[12/26/21 19:27:14] INFO	logtransform      = False
[12/26/21 19:27:14] INFO	lv_remove         = True
[12/26/21 19:27:14] INFO	lv_threshold      = 0.100000
[12/26/21 19:27:14] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:27:14] INFO	n_estimators      = 51
[12/26/21 19:27:14] INFO	n_jobs            = -1
[12/26/21 19:27:14] INFO	ngrams_max        = 2
[12/26/21 19:27:14] INFO	numpy             = True
[12/26/21 19:27:14] INFO	pca               = False
[12/26/21 19:27:14] INFO	pca_inc           = 1
[12/26/21 19:27:14] INFO	pca_max           = 10
[12/26/21 19:27:14] INFO	pca_min           = 2
[12/26/21 19:27:14] INFO	pca_whiten        = False
[12/26/21 19:27:14] INFO	poly_degree       = 2
[12/26/21 19:27:14] INFO	pvalue_level      = 0.010000
[12/26/21 19:27:14] INFO	rfe               = True
[12/26/21 19:27:14] INFO	rfe_step          = 3
[12/26/21 19:27:14] INFO	roc_curve         = True
[12/26/21 19:27:14] INFO	rounding          = 2
[12/26/21 19:27:14] INFO	sampling          = False
[12/26/21 19:27:14] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:27:14] INFO	sampling_ratio    = 1.000000
[12/26/21 19:27:14] INFO	scaler_option     = True
[12/26/21 19:27:14] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:27:14] INFO	scipy             = False
[12/26/21 19:27:14] INFO	scorer            = roc_auc
[12/26/21 19:27:14] INFO	seed              = 42
[12/26/21 19:27:14] INFO	sentinel          = -1
[12/26/21 19:27:14] INFO	separator         = ,
[12/26/21 19:27:14] INFO	shuffle           = False
[12/26/21 19:27:14] INFO	split             = 0.400000
[12/26/21 19:27:14] INFO	submission_file   = gender_submission
[12/26/21 19:27:14] INFO	submit_probas     = False
[12/26/21 19:27:14] INFO	target [y]        = Survived
[12/26/21 19:27:14] INFO	target_value      = 1
[12/26/21 19:27:14] INFO	transforms        = None
[12/26/21 19:27:14] INFO	tsne              = False
[12/26/21 19:27:14] INFO	tsne_components   = 2
[12/26/21 19:27:14] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:27:14] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:27:14] INFO	vectorize         = False
[12/26/21 19:27:14] INFO	verbosity         = 0
[12/26/21 19:27:14] INFO	Creating Model
[12/26/21 19:27:14] INFO	Calling Pipeline
[12/26/21 19:27:14] INFO	Training Pipeline
[12/26/21 19:27:14] INFO	Loading Data
[12/26/21 19:27:14] INFO	Loading data from ./input/train.csv
[12/26/21 19:27:14] INFO	Found target Survived in data frame
[12/26/21 19:27:14] INFO	Labels (y) found for Partition.train
[12/26/21 19:27:14] INFO	Loading Data
[12/26/21 19:27:14] INFO	Loading data from ./input/test.csv
[12/26/21 19:27:14] INFO	Target Survived not found in Partition.test
[12/26/21 19:27:14] INFO	Saving New Features in Model
[12/26/21 19:27:14] INFO	Original Feature Statistics
[12/26/21 19:27:14] INFO	Number of Training Rows    : 891
[12/26/21 19:27:14] INFO	Number of Training Columns : 11
[12/26/21 19:27:14] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:27:14] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:27:14] INFO	Number of Testing Rows     : 418
[12/26/21 19:27:14] INFO	Number of Testing Columns  : 11
[12/26/21 19:27:14] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:27:14] INFO	Feature Count     : 11
[12/26/21 19:27:14] INFO	Applying transforms
[12/26/21 19:27:14] INFO	No transforms Specified
[12/26/21 19:27:14] INFO	New Feature Count : 11
[12/26/21 19:27:14] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:27:14] INFO	Original Feature Count : 11
[12/26/21 19:27:14] INFO	Reduced Feature Count  : 10
[12/26/21 19:27:14] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:27:14] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:27:14] INFO	Creating Cross-Tabulations
[12/26/21 19:27:14] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:27:14] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:27:14] INFO	Feature Count     : 10
[12/26/21 19:27:14] INFO	Creating Count Features
[12/26/21 19:27:14] INFO	NA Counts
[12/26/21 19:27:14] INFO	Number Counts
[12/26/21 19:27:14] INFO	New Feature Count : 21
[12/26/21 19:27:14] INFO	Creating Base Features
[12/26/21 19:27:14] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:27:14] INFO	Feature 2: Name => Factorization
[12/26/21 19:27:14] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:27:14] INFO	Feature 3: Sex => Factorization
[12/26/21 19:27:14] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:27:14] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:27:14] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:27:14] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:27:14] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:27:14] INFO	Encoding: Encoders.target
[12/26/21 19:27:14] INFO	Fitting training features for Embarked
[12/26/21 19:27:14] INFO	Transforming testing features for Embarked
[12/26/21 19:27:14] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:27:14] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:27:14] INFO	New Feature Count : 21
[12/26/21 19:27:14] INFO	Scaling Base Features
[12/26/21 19:27:14] INFO	Creating NumPy Features
[12/26/21 19:27:14] INFO	NumPy Feature: sum
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	NumPy Feature: mean
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	NumPy Feature: std
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	NumPy Feature: var
[12/26/21 19:27:14] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:27:14] INFO	NumPy Feature Count : 4
[12/26/21 19:27:14] INFO	New Feature Count : 25
[12/26/21 19:27:14] INFO	Creating Clustering Features
[12/26/21 19:27:14] INFO	Cluster Minimum   : 3
[12/26/21 19:27:14] INFO	Cluster Maximum   : 30
[12/26/21 19:27:14] INFO	Cluster Increment : 3
[12/26/21 19:27:14] INFO	k = 3
[12/26/21 19:27:15] INFO	k = 6
[12/26/21 19:27:15] INFO	k = 9
[12/26/21 19:27:15] INFO	k = 12
[12/26/21 19:27:15] INFO	k = 15
[12/26/21 19:27:15] INFO	k = 18
[12/26/21 19:27:15] INFO	k = 21
[12/26/21 19:27:16] INFO	k = 24
[12/26/21 19:27:16] INFO	k = 27
[12/26/21 19:27:16] INFO	k = 30
[12/26/21 19:27:16] INFO	Clustering Feature Count : 10
[12/26/21 19:27:16] INFO	New Feature Count : 35
[12/26/21 19:27:16] INFO	Saving New Features in Model
[12/26/21 19:27:16] INFO	Creating Interactions
[12/26/21 19:27:16] INFO	Initial Feature Count  : 35
[12/26/21 19:27:16] INFO	Skipping Interactions
[12/26/21 19:27:16] INFO	Saving New Features in Model
[12/26/21 19:27:16] INFO	Removing Low-Variance Features
[12/26/21 19:27:16] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:27:16] INFO	Original Feature Count  : 35
[12/26/21 19:27:16] INFO	Reduced Feature Count   : 35
[12/26/21 19:27:16] INFO	Saving New Features in Model
[12/26/21 19:27:16] INFO	Skipping Shuffling
[12/26/21 19:27:16] INFO	Skipping Sampling
[12/26/21 19:27:16] INFO	Getting All Estimators
[12/26/21 19:27:16] INFO	Algorithm Configuration
[12/26/21 19:27:16] INFO	Selecting Models
[12/26/21 19:27:16] INFO	Algorithm: CATB
[12/26/21 19:27:16] INFO	Fitting Initial Model
[12/26/21 19:27:16] INFO	Cross-Validation
[12/26/21 19:27:18] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:27:18] INFO	Recursive Feature Elimination with CV
[12/26/21 19:27:20] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[12/26/21 19:27:20] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:27:20] INFO	No grid is defined for grid search
[12/26/21 19:27:20] INFO	Final Model Predictions for CATB
[12/26/21 19:27:20] INFO	Skipping Calibration
[12/26/21 19:27:20] INFO	Making Predictions
[12/26/21 19:27:20] INFO	Predictions Complete
[12/26/21 19:27:20] INFO	Algorithm: LGB
[12/26/21 19:27:20] INFO	Fitting Initial Model
[12/26/21 19:27:20] INFO	Cross-Validation
[12/26/21 19:27:21] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:27:21] INFO	Recursive Feature Elimination with CV
[12/26/21 19:27:24] INFO	RFECV took 2.49 seconds for step 3 and 3 folds
[12/26/21 19:27:24] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:27:24] INFO	No grid is defined for grid search
[12/26/21 19:27:24] INFO	Final Model Predictions for LGB
[12/26/21 19:27:24] INFO	Skipping Calibration
[12/26/21 19:27:24] INFO	Making Predictions
[12/26/21 19:27:24] INFO	Predictions Complete
[12/26/21 19:27:24] INFO	Algorithm: XGB
[12/26/21 19:27:24] INFO	Fitting Initial Model
[12/26/21 19:27:24] INFO	Cross-Validation
[12/26/21 19:27:24] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:27:24] INFO	Recursive Feature Elimination with CV
[12/26/21 19:27:27] INFO	RFECV took 2.51 seconds for step 3 and 3 folds
[12/26/21 19:27:27] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:27:27] INFO	Randomized Grid Search
[12/26/21 19:28:20] INFO	Grid Search took 53.75 seconds for 50 candidate parameter settings.
[12/26/21 19:28:20] INFO	Model with rank: 1
[12/26/21 19:28:20] INFO	Mean validation score: 0.872 (std: 0.022)
[12/26/21 19:28:20] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/26/21 19:28:20] INFO	Model with rank: 2
[12/26/21 19:28:20] INFO	Mean validation score: 0.871 (std: 0.023)
[12/26/21 19:28:20] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 19:28:20] INFO	Model with rank: 3
[12/26/21 19:28:20] INFO	Mean validation score: 0.870 (std: 0.024)
[12/26/21 19:28:20] INFO	Parameters: {'est__subsample': 0.9, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.6}
[12/26/21 19:28:20] INFO	Algorithm: XGB, Best Score: 0.8715, Best Parameters: {'est__subsample': 0.5, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 5, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/26/21 19:28:20] INFO	Final Model Predictions for XGB
[12/26/21 19:28:20] INFO	Skipping Calibration
[12/26/21 19:28:20] INFO	Making Predictions
[12/26/21 19:28:20] INFO	Predictions Complete
[12/26/21 19:28:20] INFO	Blending Models
[12/26/21 19:28:20] INFO	Blending Start: 2021-12-26 19:28:20.892693
[12/26/21 19:28:20] INFO	Blending Complete: 0:00:00.007855
[12/26/21 19:28:20] INFO	================================================================================
[12/26/21 19:28:20] INFO	Metrics for: Partition.train
[12/26/21 19:30:16] INFO	********************************************************************************
[12/26/21 19:30:16] INFO	AlphaPy Start
[12/26/21 19:30:16] INFO	********************************************************************************
[12/26/21 19:30:16] INFO	Model Configuration
[12/26/21 19:30:16] INFO	No transforms Found
[12/26/21 19:30:16] INFO	MODEL PARAMETERS:
[12/26/21 19:30:16] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:30:16] INFO	calibration       = False
[12/26/21 19:30:16] INFO	cal_type          = sigmoid
[12/26/21 19:30:16] INFO	calibration_plot  = False
[12/26/21 19:30:16] INFO	clustering        = True
[12/26/21 19:30:16] INFO	cluster_inc       = 3
[12/26/21 19:30:16] INFO	cluster_max       = 30
[12/26/21 19:30:16] INFO	cluster_min       = 3
[12/26/21 19:30:16] INFO	confusion_matrix  = True
[12/26/21 19:30:16] INFO	counts            = True
[12/26/21 19:30:16] INFO	cv_folds          = 3
[12/26/21 19:30:16] INFO	directory         = .
[12/26/21 19:30:16] INFO	extension         = csv
[12/26/21 19:30:16] INFO	drop              = ['PassengerId']
[12/26/21 19:30:16] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:30:16] INFO	esr               = 20
[12/26/21 19:30:16] INFO	factors           = ['Embarked']
[12/26/21 19:30:16] INFO	features [X]      = *
[12/26/21 19:30:16] INFO	feature_selection = False
[12/26/21 19:30:16] INFO	fs_percentage     = 50
[12/26/21 19:30:16] INFO	fs_score_func     = <function f_classif at 0x7fb482c12ee0>
[12/26/21 19:30:16] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:30:16] INFO	grid_search       = True
[12/26/21 19:30:16] INFO	gs_iters          = 50
[12/26/21 19:30:16] INFO	gs_random         = True
[12/26/21 19:30:16] INFO	gs_sample         = False
[12/26/21 19:30:16] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:30:16] INFO	importances       = True
[12/26/21 19:30:16] INFO	interactions      = False
[12/26/21 19:30:16] INFO	isomap            = False
[12/26/21 19:30:16] INFO	iso_components    = 2
[12/26/21 19:30:16] INFO	iso_neighbors     = 5
[12/26/21 19:30:16] INFO	isample_pct       = 10
[12/26/21 19:30:16] INFO	leaders           = []
[12/26/21 19:30:16] INFO	learning_curve    = True
[12/26/21 19:30:16] INFO	logtransform      = False
[12/26/21 19:30:16] INFO	lv_remove         = True
[12/26/21 19:30:16] INFO	lv_threshold      = 0.100000
[12/26/21 19:30:16] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:30:16] INFO	n_estimators      = 51
[12/26/21 19:30:16] INFO	n_jobs            = -1
[12/26/21 19:30:16] INFO	ngrams_max        = 2
[12/26/21 19:30:16] INFO	numpy             = True
[12/26/21 19:30:16] INFO	pca               = False
[12/26/21 19:30:16] INFO	pca_inc           = 1
[12/26/21 19:30:16] INFO	pca_max           = 10
[12/26/21 19:30:16] INFO	pca_min           = 2
[12/26/21 19:30:16] INFO	pca_whiten        = False
[12/26/21 19:30:16] INFO	poly_degree       = 2
[12/26/21 19:30:16] INFO	pvalue_level      = 0.010000
[12/26/21 19:30:16] INFO	rfe               = True
[12/26/21 19:30:16] INFO	rfe_step          = 3
[12/26/21 19:30:16] INFO	roc_curve         = True
[12/26/21 19:30:16] INFO	rounding          = 2
[12/26/21 19:30:16] INFO	sampling          = False
[12/26/21 19:30:16] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:30:16] INFO	sampling_ratio    = 1.000000
[12/26/21 19:30:16] INFO	scaler_option     = True
[12/26/21 19:30:16] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:30:16] INFO	scipy             = False
[12/26/21 19:30:16] INFO	scorer            = roc_auc
[12/26/21 19:30:16] INFO	seed              = 42
[12/26/21 19:30:16] INFO	sentinel          = -1
[12/26/21 19:30:16] INFO	separator         = ,
[12/26/21 19:30:16] INFO	shuffle           = False
[12/26/21 19:30:16] INFO	split             = 0.400000
[12/26/21 19:30:16] INFO	submission_file   = gender_submission
[12/26/21 19:30:16] INFO	submit_probas     = False
[12/26/21 19:30:16] INFO	target [y]        = Survived
[12/26/21 19:30:16] INFO	target_value      = 1
[12/26/21 19:30:16] INFO	transforms        = None
[12/26/21 19:30:16] INFO	tsne              = False
[12/26/21 19:30:16] INFO	tsne_components   = 2
[12/26/21 19:30:16] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:30:16] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:30:16] INFO	vectorize         = False
[12/26/21 19:30:16] INFO	verbosity         = 0
[12/26/21 19:30:16] INFO	Creating Model
[12/26/21 19:30:16] INFO	Calling Pipeline
[12/26/21 19:30:16] INFO	Training Pipeline
[12/26/21 19:30:16] INFO	Loading Data
[12/26/21 19:30:16] INFO	Loading data from ./input/train.csv
[12/26/21 19:30:16] INFO	Found target Survived in data frame
[12/26/21 19:30:16] INFO	Labels (y) found for Partition.train
[12/26/21 19:30:16] INFO	Loading Data
[12/26/21 19:30:16] INFO	Loading data from ./input/test.csv
[12/26/21 19:30:16] INFO	Target Survived not found in Partition.test
[12/26/21 19:30:16] INFO	Saving New Features in Model
[12/26/21 19:30:16] INFO	Original Feature Statistics
[12/26/21 19:30:16] INFO	Number of Training Rows    : 891
[12/26/21 19:30:16] INFO	Number of Training Columns : 11
[12/26/21 19:30:16] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:30:16] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:30:16] INFO	Number of Testing Rows     : 418
[12/26/21 19:30:16] INFO	Number of Testing Columns  : 11
[12/26/21 19:30:16] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:30:16] INFO	Feature Count     : 11
[12/26/21 19:30:16] INFO	Applying transforms
[12/26/21 19:30:16] INFO	No transforms Specified
[12/26/21 19:30:16] INFO	New Feature Count : 11
[12/26/21 19:30:16] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:30:16] INFO	Original Feature Count : 11
[12/26/21 19:30:16] INFO	Reduced Feature Count  : 10
[12/26/21 19:30:16] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:30:16] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:30:16] INFO	Creating Cross-Tabulations
[12/26/21 19:30:16] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:30:16] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:30:16] INFO	Feature Count     : 10
[12/26/21 19:30:16] INFO	Creating Count Features
[12/26/21 19:30:16] INFO	NA Counts
[12/26/21 19:30:16] INFO	Number Counts
[12/26/21 19:30:16] INFO	New Feature Count : 21
[12/26/21 19:30:16] INFO	Creating Base Features
[12/26/21 19:30:16] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:30:16] INFO	Feature 2: Name => Factorization
[12/26/21 19:30:16] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:30:16] INFO	Feature 3: Sex => Factorization
[12/26/21 19:30:16] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:30:16] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:30:16] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:30:16] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:30:16] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:30:16] INFO	Encoding: Encoders.target
[12/26/21 19:30:16] INFO	Fitting training features for Embarked
[12/26/21 19:30:16] INFO	Transforming testing features for Embarked
[12/26/21 19:30:16] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:30:16] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:30:16] INFO	New Feature Count : 21
[12/26/21 19:30:16] INFO	Scaling Base Features
[12/26/21 19:30:16] INFO	Creating NumPy Features
[12/26/21 19:30:16] INFO	NumPy Feature: sum
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	NumPy Feature: mean
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	NumPy Feature: std
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	NumPy Feature: var
[12/26/21 19:30:16] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:30:16] INFO	NumPy Feature Count : 4
[12/26/21 19:30:16] INFO	New Feature Count : 25
[12/26/21 19:30:16] INFO	Creating Clustering Features
[12/26/21 19:30:16] INFO	Cluster Minimum   : 3
[12/26/21 19:30:16] INFO	Cluster Maximum   : 30
[12/26/21 19:30:16] INFO	Cluster Increment : 3
[12/26/21 19:30:16] INFO	k = 3
[12/26/21 19:30:18] INFO	k = 6
[12/26/21 19:30:18] INFO	k = 9
[12/26/21 19:30:18] INFO	k = 12
[12/26/21 19:30:18] INFO	k = 15
[12/26/21 19:30:18] INFO	k = 18
[12/26/21 19:30:18] INFO	k = 21
[12/26/21 19:30:18] INFO	k = 24
[12/26/21 19:30:18] INFO	k = 27
[12/26/21 19:30:18] INFO	k = 30
[12/26/21 19:30:18] INFO	Clustering Feature Count : 10
[12/26/21 19:30:18] INFO	New Feature Count : 35
[12/26/21 19:30:18] INFO	Saving New Features in Model
[12/26/21 19:30:18] INFO	Creating Interactions
[12/26/21 19:30:18] INFO	Initial Feature Count  : 35
[12/26/21 19:30:18] INFO	Skipping Interactions
[12/26/21 19:30:18] INFO	Saving New Features in Model
[12/26/21 19:30:18] INFO	Removing Low-Variance Features
[12/26/21 19:30:18] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:30:18] INFO	Original Feature Count  : 35
[12/26/21 19:30:18] INFO	Reduced Feature Count   : 35
[12/26/21 19:30:18] INFO	Saving New Features in Model
[12/26/21 19:30:18] INFO	Skipping Shuffling
[12/26/21 19:30:18] INFO	Skipping Sampling
[12/26/21 19:30:18] INFO	Getting All Estimators
[12/26/21 19:30:18] INFO	Algorithm Configuration
[12/26/21 19:30:19] INFO	Selecting Models
[12/26/21 19:30:19] INFO	Algorithm: CATB
[12/26/21 19:30:19] INFO	Fitting Initial Model
[12/26/21 19:30:19] INFO	Cross-Validation
[12/26/21 19:30:20] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:30:20] INFO	Recursive Feature Elimination with CV
[12/26/21 19:30:23] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[12/26/21 19:30:23] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:30:23] INFO	No grid is defined for grid search
[12/26/21 19:30:23] INFO	Final Model Predictions for CATB
[12/26/21 19:30:23] INFO	Skipping Calibration
[12/26/21 19:30:23] INFO	Making Predictions
[12/26/21 19:30:23] INFO	Predictions Complete
[12/26/21 19:30:23] INFO	Algorithm: LGB
[12/26/21 19:30:23] INFO	Fitting Initial Model
[12/26/21 19:30:23] INFO	Cross-Validation
[12/26/21 19:30:24] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:30:24] INFO	Recursive Feature Elimination with CV
[12/26/21 19:30:26] INFO	RFECV took 2.44 seconds for step 3 and 3 folds
[12/26/21 19:30:26] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:30:26] INFO	No grid is defined for grid search
[12/26/21 19:30:26] INFO	Final Model Predictions for LGB
[12/26/21 19:30:26] INFO	Skipping Calibration
[12/26/21 19:30:26] INFO	Making Predictions
[12/26/21 19:30:26] INFO	Predictions Complete
[12/26/21 19:30:26] INFO	Algorithm: XGB
[12/26/21 19:30:26] INFO	Fitting Initial Model
[12/26/21 19:30:26] INFO	Cross-Validation
[12/26/21 19:30:26] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:30:26] INFO	Recursive Feature Elimination with CV
[12/26/21 19:30:29] INFO	RFECV took 2.23 seconds for step 3 and 3 folds
[12/26/21 19:30:29] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:30:29] INFO	Randomized Grid Search
[12/26/21 19:31:42] INFO	Grid Search took 73.01 seconds for 50 candidate parameter settings.
[12/26/21 19:31:42] INFO	Model with rank: 1
[12/26/21 19:31:42] INFO	Mean validation score: 0.871 (std: 0.023)
[12/26/21 19:31:42] INFO	Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 19:31:42] INFO	Model with rank: 2
[12/26/21 19:31:42] INFO	Mean validation score: 0.871 (std: 0.022)
[12/26/21 19:31:42] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 20, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.7}
[12/26/21 19:31:42] INFO	Model with rank: 3
[12/26/21 19:31:42] INFO	Mean validation score: 0.870 (std: 0.019)
[12/26/21 19:31:42] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 19:31:42] INFO	Algorithm: XGB, Best Score: 0.8708, Best Parameters: {'est__subsample': 0.8, 'est__n_estimators': 21, 'est__min_child_weight': 1.1, 'est__max_depth': 20, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 19:31:42] INFO	Final Model Predictions for XGB
[12/26/21 19:31:42] INFO	Skipping Calibration
[12/26/21 19:31:42] INFO	Making Predictions
[12/26/21 19:31:42] INFO	Predictions Complete
[12/26/21 19:31:42] INFO	Blending Models
[12/26/21 19:31:42] INFO	Blending Start: 2021-12-26 19:31:42.187245
[12/26/21 19:31:42] INFO	Blending Complete: 0:00:00.004669
[12/26/21 19:31:42] INFO	================================================================================
[12/26/21 19:31:42] INFO	Metrics for: Partition.train
[12/26/21 19:31:42] INFO	--------------------------------------------------------------------------------
[12/26/21 19:31:42] INFO	Algorithm: CATB
[12/26/21 19:31:42] INFO	accuracy: 0.8585858585858586
[12/26/21 19:31:42] INFO	average_precision: 0.9113351686222868
[12/26/21 19:31:42] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 19:31:42] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 19:31:42] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 19:31:42] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 19:31:42] INFO	f1: 0.8025078369905956
[12/26/21 19:31:42] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 19:31:42] INFO	precision: 0.8648648648648649
[12/26/21 19:31:42] INFO	recall: 0.7485380116959064
[12/26/21 19:31:42] INFO	roc_auc: 0.9297979313797549
[12/26/21 19:31:42] INFO	--------------------------------------------------------------------------------
[12/26/21 19:31:42] INFO	Algorithm: LGB
[12/26/21 19:31:42] INFO	accuracy: 0.9730639730639731
[12/26/21 19:31:42] INFO	average_precision: 0.9961113207491221
[12/26/21 19:31:42] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 19:31:42] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 19:31:42] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 19:31:42] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 19:31:42] INFO	f1: 0.9643916913946586
[12/26/21 19:31:42] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 19:31:42] INFO	precision: 0.9789156626506024
[12/26/21 19:31:42] INFO	recall: 0.9502923976608187
[12/26/21 19:31:42] INFO	roc_auc: 0.9974861257576241
[12/26/21 19:31:42] INFO	--------------------------------------------------------------------------------
[12/26/21 19:31:42] INFO	Algorithm: XGB
[12/26/21 19:31:42] INFO	accuracy: 0.9281705948372615
[12/26/21 19:31:42] INFO	average_precision: 0.9588406501183722
[12/26/21 19:31:42] INFO	balanced_accuracy: 0.913598887930208
[12/26/21 19:31:42] INFO	brier_score_loss: 0.10616725840401096
[12/26/21 19:31:42] INFO	cohen_kappa: 0.8448959608323133
[12/26/21 19:31:42] INFO	confusion_matrix: [[536  13]
 [ 51 291]]
[12/26/21 19:31:42] INFO	f1: 0.9009287925696595
[12/26/21 19:31:42] INFO	neg_log_loss: 0.38173942430118385
[12/26/21 19:31:42] INFO	precision: 0.9572368421052632
[12/26/21 19:31:42] INFO	recall: 0.8508771929824561
[12/26/21 19:31:42] INFO	roc_auc: 0.9664967671151162
[12/26/21 19:31:42] INFO	================================================================================
[12/26/21 19:31:42] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 19:31:42] INFO	Best Model Selection Start: 2021-12-26 19:31:42.215951
[12/26/21 19:31:42] INFO	Scoring CATB Model
[12/26/21 19:31:42] INFO	Scoring LGB Model
[12/26/21 19:31:42] INFO	Scoring XGB Model
[12/26/21 19:31:42] INFO	Scoring BLEND Model
[12/26/21 19:31:42] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 19:31:42] INFO	Best Model Selection Complete: 0:00:00.000206
[12/26/21 19:31:42] INFO	================================================================================
[12/26/21 19:31:42] INFO	Generating Plots for partition: train
[12/26/21 19:31:42] INFO	Generating Calibration Plot
[12/26/21 19:31:42] INFO	Calibration for Algorithm: CATB
[12/26/21 19:31:42] INFO	Calibration for Algorithm: LGB
[12/26/21 19:31:42] INFO	Calibration for Algorithm: XGB
[12/26/21 19:31:42] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 19:31:42] INFO	Generating Confusion Matrices
[12/26/21 19:31:42] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 19:31:42] INFO	Confusion Matrix:
[12/26/21 19:31:42] INFO	[[509  40]
 [ 86 256]]
[12/26/21 19:31:42] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 19:31:42] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 19:31:42] INFO	Confusion Matrix:
[12/26/21 19:31:42] INFO	[[542   7]
 [ 17 325]]
[12/26/21 19:31:42] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 19:31:42] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 19:31:42] INFO	Confusion Matrix:
[12/26/21 19:31:42] INFO	[[536  13]
 [ 51 291]]
[12/26/21 19:31:42] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 19:31:42] INFO	Generating ROC Curves
[12/26/21 19:31:42] INFO	ROC Curve for Algorithm: CATB
[12/26/21 19:31:42] INFO	ROC Curve for Algorithm: LGB
[12/26/21 19:31:42] INFO	ROC Curve for Algorithm: XGB
[12/26/21 19:31:42] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 19:31:42] INFO	Generating Learning Curves
[12/26/21 19:31:42] INFO	Algorithm Configuration
[12/26/21 19:31:42] INFO	Learning Curve for Algorithm: CATB
[12/26/21 19:31:43] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 19:31:43] INFO	Learning Curve for Algorithm: LGB
[12/26/21 19:31:45] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 19:31:45] INFO	Learning Curve for Algorithm: XGB
[12/26/21 19:31:45] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 19:31:45] INFO	Generating Feature Importance Plots
[12/26/21 19:31:45] INFO	Feature Importances for Algorithm: CATB
[12/26/21 19:31:45] INFO	Feature Ranking:
[12/26/21 19:31:45] INFO	1. Sex_factor (45.178104)
[12/26/21 19:31:45] INFO	2. Pclass (13.721171)
[12/26/21 19:31:45] INFO	3. Age (6.651788)
[12/26/21 19:31:45] INFO	4. Fare (4.529770)
[12/26/21 19:31:45] INFO	5. var (3.586590)
[12/26/21 19:31:45] INFO	6. std (3.492385)
[12/26/21 19:31:45] INFO	7. Ticket_factor (3.315046)
[12/26/21 19:31:45] INFO	8. cluster_30 (2.831587)
[12/26/21 19:31:45] INFO	9. mean (2.733389)
[12/26/21 19:31:45] INFO	10. Name_factor (2.586310)
[12/26/21 19:31:45] INFO	11. Cabin_factor (2.101764)
[12/26/21 19:31:45] INFO	12. Embarked (2.086410)
[12/26/21 19:31:45] INFO	13. SibSp (2.085405)
[12/26/21 19:31:45] INFO	14. cluster_12 (1.876782)
[12/26/21 19:31:45] INFO	15. cluster_24 (1.263144)
[12/26/21 19:31:45] INFO	16. count_2 (1.004409)
[12/26/21 19:31:45] INFO	17. sum (0.955946)
[12/26/21 19:31:45] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 19:31:45] INFO	Feature Importances for Algorithm: LGB
[12/26/21 19:31:45] INFO	Feature Ranking:
[12/26/21 19:31:45] INFO	1. Fare (256.000000)
[12/26/21 19:31:45] INFO	2. sum (241.000000)
[12/26/21 19:31:45] INFO	3. Age (232.000000)
[12/26/21 19:31:45] INFO	4. std (201.000000)
[12/26/21 19:31:45] INFO	5. Ticket_factor (199.000000)
[12/26/21 19:31:45] INFO	6. Name_factor (175.000000)
[12/26/21 19:31:45] INFO	7. cluster_30 (53.000000)
[12/26/21 19:31:45] INFO	8. cluster_27 (46.000000)
[12/26/21 19:31:45] INFO	9. Sex_factor (43.000000)
[12/26/21 19:31:45] INFO	10. Pclass (43.000000)
[12/26/21 19:31:45] INFO	11. Cabin_factor (41.000000)
[12/26/21 19:31:45] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 19:31:45] INFO	Feature Importances for Algorithm: XGB
[12/26/21 19:31:45] INFO	Feature Ranking:
[12/26/21 19:31:45] INFO	1. Sex_factor (0.424644)
[12/26/21 19:31:45] INFO	2. Pclass (0.127452)
[12/26/21 19:31:45] INFO	3. Cabin_factor (0.081307)
[12/26/21 19:31:45] INFO	4. Age (0.051007)
[12/26/21 19:31:45] INFO	5. SibSp (0.049620)
[12/26/21 19:31:45] INFO	6. count_1 (0.046373)
[12/26/21 19:31:45] INFO	7. Embarked (0.046225)
[12/26/21 19:31:45] INFO	8. std (0.036262)
[12/26/21 19:31:45] INFO	9. cluster_30 (0.036076)
[12/26/21 19:31:45] INFO	10. Fare (0.032410)
[12/26/21 19:31:45] INFO	11. cluster_24 (0.021187)
[12/26/21 19:31:45] INFO	12. Name_factor (0.019312)
[12/26/21 19:31:45] INFO	13. sum (0.017784)
[12/26/21 19:31:45] INFO	14. cluster_15 (0.010340)
[12/26/21 19:31:45] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 19:31:46] INFO	Getting Predictions
[12/26/21 19:34:42] INFO	********************************************************************************
[12/26/21 19:34:42] INFO	AlphaPy Start
[12/26/21 19:34:42] INFO	********************************************************************************
[12/26/21 19:34:42] INFO	Model Configuration
[12/26/21 19:34:42] INFO	No transforms Found
[12/26/21 19:34:42] INFO	MODEL PARAMETERS:
[12/26/21 19:34:42] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:34:42] INFO	calibration       = False
[12/26/21 19:34:42] INFO	cal_type          = sigmoid
[12/26/21 19:34:42] INFO	calibration_plot  = False
[12/26/21 19:34:42] INFO	clustering        = True
[12/26/21 19:34:42] INFO	cluster_inc       = 3
[12/26/21 19:34:42] INFO	cluster_max       = 30
[12/26/21 19:34:42] INFO	cluster_min       = 3
[12/26/21 19:34:42] INFO	confusion_matrix  = True
[12/26/21 19:34:42] INFO	counts            = True
[12/26/21 19:34:42] INFO	cv_folds          = 3
[12/26/21 19:34:42] INFO	directory         = .
[12/26/21 19:34:42] INFO	extension         = csv
[12/26/21 19:34:42] INFO	drop              = ['PassengerId']
[12/26/21 19:34:42] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:34:42] INFO	esr               = 20
[12/26/21 19:34:42] INFO	factors           = ['Embarked']
[12/26/21 19:34:42] INFO	features [X]      = *
[12/26/21 19:34:42] INFO	feature_selection = False
[12/26/21 19:34:42] INFO	fs_percentage     = 50
[12/26/21 19:34:42] INFO	fs_score_func     = <function f_classif at 0x7fd89999aee0>
[12/26/21 19:34:42] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:34:42] INFO	grid_search       = True
[12/26/21 19:34:42] INFO	gs_iters          = 50
[12/26/21 19:34:42] INFO	gs_random         = True
[12/26/21 19:34:42] INFO	gs_sample         = False
[12/26/21 19:34:42] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:34:42] INFO	importances       = True
[12/26/21 19:34:42] INFO	interactions      = False
[12/26/21 19:34:42] INFO	isomap            = False
[12/26/21 19:34:42] INFO	iso_components    = 2
[12/26/21 19:34:42] INFO	iso_neighbors     = 5
[12/26/21 19:34:42] INFO	isample_pct       = 10
[12/26/21 19:34:42] INFO	leaders           = []
[12/26/21 19:34:42] INFO	learning_curve    = True
[12/26/21 19:34:42] INFO	logtransform      = False
[12/26/21 19:34:42] INFO	lv_remove         = True
[12/26/21 19:34:42] INFO	lv_threshold      = 0.100000
[12/26/21 19:34:42] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:34:42] INFO	n_estimators      = 51
[12/26/21 19:34:42] INFO	n_jobs            = -1
[12/26/21 19:34:42] INFO	ngrams_max        = 2
[12/26/21 19:34:42] INFO	numpy             = True
[12/26/21 19:34:42] INFO	pca               = False
[12/26/21 19:34:42] INFO	pca_inc           = 1
[12/26/21 19:34:42] INFO	pca_max           = 10
[12/26/21 19:34:42] INFO	pca_min           = 2
[12/26/21 19:34:42] INFO	pca_whiten        = False
[12/26/21 19:34:42] INFO	poly_degree       = 2
[12/26/21 19:34:42] INFO	pvalue_level      = 0.010000
[12/26/21 19:34:42] INFO	rfe               = True
[12/26/21 19:34:42] INFO	rfe_step          = 3
[12/26/21 19:34:42] INFO	roc_curve         = True
[12/26/21 19:34:42] INFO	rounding          = 2
[12/26/21 19:34:42] INFO	sampling          = False
[12/26/21 19:34:42] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:34:42] INFO	sampling_ratio    = 1.000000
[12/26/21 19:34:42] INFO	scaler_option     = True
[12/26/21 19:34:42] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:34:42] INFO	scipy             = False
[12/26/21 19:34:42] INFO	scorer            = roc_auc
[12/26/21 19:34:42] INFO	seed              = 42
[12/26/21 19:34:42] INFO	sentinel          = -1
[12/26/21 19:34:42] INFO	separator         = ,
[12/26/21 19:34:42] INFO	shuffle           = False
[12/26/21 19:34:42] INFO	split             = 0.400000
[12/26/21 19:34:42] INFO	submission_file   = gender_submission
[12/26/21 19:34:42] INFO	submit_probas     = False
[12/26/21 19:34:42] INFO	target [y]        = Survived
[12/26/21 19:34:42] INFO	target_value      = 1
[12/26/21 19:34:42] INFO	transforms        = None
[12/26/21 19:34:42] INFO	tsne              = False
[12/26/21 19:34:42] INFO	tsne_components   = 2
[12/26/21 19:34:42] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:34:42] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:34:42] INFO	vectorize         = False
[12/26/21 19:34:42] INFO	verbosity         = 0
[12/26/21 19:34:42] INFO	Creating Model
[12/26/21 19:34:42] INFO	Calling Pipeline
[12/26/21 19:34:42] INFO	Training Pipeline
[12/26/21 19:34:42] INFO	Loading Data
[12/26/21 19:34:42] INFO	Loading data from ./input/train.csv
[12/26/21 19:34:42] INFO	Found target Survived in data frame
[12/26/21 19:34:42] INFO	Labels (y) found for Partition.train
[12/26/21 19:34:42] INFO	Loading Data
[12/26/21 19:34:42] INFO	Loading data from ./input/test.csv
[12/26/21 19:34:42] INFO	Target Survived not found in Partition.test
[12/26/21 19:34:42] INFO	Saving New Features in Model
[12/26/21 19:34:42] INFO	Original Feature Statistics
[12/26/21 19:34:42] INFO	Number of Training Rows    : 891
[12/26/21 19:34:42] INFO	Number of Training Columns : 11
[12/26/21 19:34:42] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:34:42] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:34:42] INFO	Number of Testing Rows     : 418
[12/26/21 19:34:42] INFO	Number of Testing Columns  : 11
[12/26/21 19:34:42] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:34:42] INFO	Feature Count     : 11
[12/26/21 19:34:42] INFO	Applying transforms
[12/26/21 19:34:42] INFO	No transforms Specified
[12/26/21 19:34:42] INFO	New Feature Count : 11
[12/26/21 19:34:42] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:34:42] INFO	Original Feature Count : 11
[12/26/21 19:34:42] INFO	Reduced Feature Count  : 10
[12/26/21 19:34:42] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:34:42] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:34:42] INFO	Creating Cross-Tabulations
[12/26/21 19:34:42] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:34:42] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:34:42] INFO	Feature Count     : 10
[12/26/21 19:34:42] INFO	Creating Count Features
[12/26/21 19:34:42] INFO	NA Counts
[12/26/21 19:34:42] INFO	Number Counts
[12/26/21 19:34:42] INFO	New Feature Count : 21
[12/26/21 19:34:42] INFO	Creating Base Features
[12/26/21 19:34:42] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:34:42] INFO	Feature 2: Name => Factorization
[12/26/21 19:34:42] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:34:42] INFO	Feature 3: Sex => Factorization
[12/26/21 19:34:42] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:34:42] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:34:42] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:34:42] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:34:42] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:34:42] INFO	Encoding: Encoders.target
[12/26/21 19:34:42] INFO	Fitting training features for Embarked
[12/26/21 19:34:42] INFO	Transforming testing features for Embarked
[12/26/21 19:34:42] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:34:42] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:34:42] INFO	New Feature Count : 21
[12/26/21 19:34:42] INFO	Scaling Base Features
[12/26/21 19:34:42] INFO	Creating NumPy Features
[12/26/21 19:34:42] INFO	NumPy Feature: sum
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	NumPy Feature: mean
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	NumPy Feature: std
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	NumPy Feature: var
[12/26/21 19:34:42] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:34:42] INFO	NumPy Feature Count : 4
[12/26/21 19:34:42] INFO	New Feature Count : 25
[12/26/21 19:34:42] INFO	Creating Clustering Features
[12/26/21 19:34:42] INFO	Cluster Minimum   : 3
[12/26/21 19:34:42] INFO	Cluster Maximum   : 30
[12/26/21 19:34:42] INFO	Cluster Increment : 3
[12/26/21 19:34:42] INFO	k = 3
[12/26/21 19:34:43] INFO	k = 6
[12/26/21 19:34:43] INFO	k = 9
[12/26/21 19:34:43] INFO	k = 12
[12/26/21 19:34:44] INFO	k = 15
[12/26/21 19:34:44] INFO	k = 18
[12/26/21 19:34:44] INFO	k = 21
[12/26/21 19:34:44] INFO	k = 24
[12/26/21 19:34:44] INFO	k = 27
[12/26/21 19:34:44] INFO	k = 30
[12/26/21 19:34:44] INFO	Clustering Feature Count : 10
[12/26/21 19:34:44] INFO	New Feature Count : 35
[12/26/21 19:34:44] INFO	Saving New Features in Model
[12/26/21 19:34:44] INFO	Creating Interactions
[12/26/21 19:34:44] INFO	Initial Feature Count  : 35
[12/26/21 19:34:44] INFO	Skipping Interactions
[12/26/21 19:34:44] INFO	Saving New Features in Model
[12/26/21 19:34:44] INFO	Removing Low-Variance Features
[12/26/21 19:34:44] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:34:44] INFO	Original Feature Count  : 35
[12/26/21 19:34:44] INFO	Reduced Feature Count   : 35
[12/26/21 19:34:44] INFO	Saving New Features in Model
[12/26/21 19:34:44] INFO	Skipping Shuffling
[12/26/21 19:34:44] INFO	Skipping Sampling
[12/26/21 19:34:44] INFO	Getting All Estimators
[12/26/21 19:34:44] INFO	Algorithm Configuration
[12/26/21 19:34:44] INFO	Selecting Models
[12/26/21 19:34:44] INFO	Algorithm: CATB
[12/26/21 19:34:44] INFO	Fitting Initial Model
[12/26/21 19:34:44] INFO	Cross-Validation
[12/26/21 19:34:46] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:34:46] INFO	Recursive Feature Elimination with CV
[12/26/21 19:34:48] INFO	RFECV took 2.35 seconds for step 3 and 3 folds
[12/26/21 19:34:48] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:34:48] INFO	No grid is defined for grid search
[12/26/21 19:34:48] INFO	Final Model Predictions for CATB
[12/26/21 19:34:48] INFO	Skipping Calibration
[12/26/21 19:34:48] INFO	Making Predictions
[12/26/21 19:34:48] INFO	Predictions Complete
[12/26/21 19:34:48] INFO	Algorithm: LGB
[12/26/21 19:34:48] INFO	Fitting Initial Model
[12/26/21 19:34:48] INFO	Cross-Validation
[12/26/21 19:34:49] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:34:49] INFO	Recursive Feature Elimination with CV
[12/26/21 19:34:52] INFO	RFECV took 2.57 seconds for step 3 and 3 folds
[12/26/21 19:34:52] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:34:52] INFO	No grid is defined for grid search
[12/26/21 19:34:52] INFO	Final Model Predictions for LGB
[12/26/21 19:34:52] INFO	Skipping Calibration
[12/26/21 19:34:52] INFO	Making Predictions
[12/26/21 19:34:52] INFO	Predictions Complete
[12/26/21 19:34:52] INFO	Algorithm: XGB
[12/26/21 19:34:52] INFO	Fitting Initial Model
[12/26/21 19:34:52] INFO	Cross-Validation
[12/26/21 19:34:52] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:34:52] INFO	Recursive Feature Elimination with CV
[12/26/21 19:34:54] INFO	RFECV took 2.27 seconds for step 3 and 3 folds
[12/26/21 19:34:54] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:34:54] INFO	Randomized Grid Search
[12/26/21 19:35:47] INFO	Grid Search took 52.78 seconds for 50 candidate parameter settings.
[12/26/21 19:35:47] INFO	Model with rank: 1
[12/26/21 19:35:47] INFO	Mean validation score: 0.870 (std: 0.020)
[12/26/21 19:35:47] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/26/21 19:35:47] INFO	Model with rank: 2
[12/26/21 19:35:47] INFO	Mean validation score: 0.870 (std: 0.019)
[12/26/21 19:35:47] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 101, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 19:35:47] INFO	Model with rank: 3
[12/26/21 19:35:47] INFO	Mean validation score: 0.870 (std: 0.023)
[12/26/21 19:35:47] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 201, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.6}
[12/26/21 19:35:47] INFO	Algorithm: XGB, Best Score: 0.8704, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.02, 'est__colsample_bytree': 1.0}
[12/26/21 19:35:47] INFO	Final Model Predictions for XGB
[12/26/21 19:35:47] INFO	Skipping Calibration
[12/26/21 19:35:47] INFO	Making Predictions
[12/26/21 19:35:47] INFO	Predictions Complete
[12/26/21 19:35:47] INFO	Blending Models
[12/26/21 19:35:47] INFO	Blending Start: 2021-12-26 19:35:47.724448
[12/26/21 19:35:47] INFO	Blending Complete: 0:00:00.007722
[12/26/21 19:35:47] INFO	================================================================================
[12/26/21 19:35:47] INFO	Metrics for: Partition.train
[12/26/21 19:35:47] INFO	--------------------------------------------------------------------------------
[12/26/21 19:35:47] INFO	Algorithm: CATB
[12/26/21 19:35:47] INFO	accuracy: 0.8585858585858586
[12/26/21 19:35:47] INFO	average_precision: 0.9113351686222868
[12/26/21 19:35:47] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 19:35:47] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 19:35:47] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 19:35:47] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 19:35:47] INFO	f1: 0.8025078369905956
[12/26/21 19:35:47] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 19:35:47] INFO	precision: 0.8648648648648649
[12/26/21 19:35:47] INFO	recall: 0.7485380116959064
[12/26/21 19:35:47] INFO	roc_auc: 0.9297979313797549
[12/26/21 19:35:47] INFO	--------------------------------------------------------------------------------
[12/26/21 19:35:47] INFO	Algorithm: LGB
[12/26/21 19:35:47] INFO	accuracy: 0.9730639730639731
[12/26/21 19:35:47] INFO	average_precision: 0.9961113207491221
[12/26/21 19:35:47] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 19:35:47] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 19:35:47] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 19:35:47] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 19:35:47] INFO	f1: 0.9643916913946586
[12/26/21 19:35:47] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 19:35:47] INFO	precision: 0.9789156626506024
[12/26/21 19:35:47] INFO	recall: 0.9502923976608187
[12/26/21 19:35:47] INFO	roc_auc: 0.9974861257576241
[12/26/21 19:35:47] INFO	--------------------------------------------------------------------------------
[12/26/21 19:35:47] INFO	Algorithm: XGB
[12/26/21 19:35:47] INFO	accuracy: 0.9494949494949495
[12/26/21 19:35:47] INFO	average_precision: 0.9823928700354045
[12/26/21 19:35:47] INFO	balanced_accuracy: 0.940274182724571
[12/26/21 19:35:47] INFO	brier_score_loss: 0.050472331787754794
[12/26/21 19:35:47] INFO	cohen_kappa: 0.8918558077436582
[12/26/21 19:35:47] INFO	confusion_matrix: [[538  11]
 [ 34 308]]
[12/26/21 19:35:47] INFO	f1: 0.9319213313161876
[12/26/21 19:35:47] INFO	neg_log_loss: 0.20211650756648694
[12/26/21 19:35:47] INFO	precision: 0.9655172413793104
[12/26/21 19:35:47] INFO	recall: 0.9005847953216374
[12/26/21 19:35:47] INFO	roc_auc: 0.9879472512489482
[12/26/21 19:35:47] INFO	================================================================================
[12/26/21 19:35:47] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 19:35:47] INFO	Best Model Selection Start: 2021-12-26 19:35:47.763151
[12/26/21 19:35:47] INFO	Scoring CATB Model
[12/26/21 19:35:47] INFO	Scoring LGB Model
[12/26/21 19:35:47] INFO	Scoring XGB Model
[12/26/21 19:35:47] INFO	Scoring BLEND Model
[12/26/21 19:35:47] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 19:35:47] INFO	Best Model Selection Complete: 0:00:00.000227
[12/26/21 19:35:47] INFO	================================================================================
[12/26/21 19:35:47] INFO	Generating Plots for partition: train
[12/26/21 19:35:47] INFO	Generating Calibration Plot
[12/26/21 19:35:47] INFO	Calibration for Algorithm: CATB
[12/26/21 19:35:47] INFO	Calibration for Algorithm: LGB
[12/26/21 19:35:47] INFO	Calibration for Algorithm: XGB
[12/26/21 19:35:47] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 19:35:48] INFO	Generating Confusion Matrices
[12/26/21 19:35:48] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 19:35:48] INFO	Confusion Matrix:
[12/26/21 19:35:48] INFO	[[509  40]
 [ 86 256]]
[12/26/21 19:35:48] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 19:35:48] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 19:35:48] INFO	Confusion Matrix:
[12/26/21 19:35:48] INFO	[[542   7]
 [ 17 325]]
[12/26/21 19:35:48] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 19:35:48] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 19:35:48] INFO	Confusion Matrix:
[12/26/21 19:35:48] INFO	[[538  11]
 [ 34 308]]
[12/26/21 19:35:48] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 19:35:48] INFO	Generating ROC Curves
[12/26/21 19:35:48] INFO	ROC Curve for Algorithm: CATB
[12/26/21 19:35:48] INFO	ROC Curve for Algorithm: LGB
[12/26/21 19:35:48] INFO	ROC Curve for Algorithm: XGB
[12/26/21 19:35:48] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 19:35:48] INFO	Generating Learning Curves
[12/26/21 19:35:48] INFO	Algorithm Configuration
[12/26/21 19:35:48] INFO	Learning Curve for Algorithm: CATB
[12/26/21 19:35:48] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 19:35:48] INFO	Learning Curve for Algorithm: LGB
[12/26/21 19:35:50] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 19:35:50] INFO	Learning Curve for Algorithm: XGB
[12/26/21 19:35:51] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 19:35:51] INFO	Generating Feature Importance Plots
[12/26/21 19:35:51] INFO	Feature Importances for Algorithm: CATB
[12/26/21 19:35:51] INFO	Feature Ranking:
[12/26/21 19:35:51] INFO	1. Sex_factor (45.178104)
[12/26/21 19:35:51] INFO	2. Pclass (13.721171)
[12/26/21 19:35:51] INFO	3. Age (6.651788)
[12/26/21 19:35:51] INFO	4. Fare (4.529770)
[12/26/21 19:35:51] INFO	5. var (3.586590)
[12/26/21 19:35:51] INFO	6. std (3.492385)
[12/26/21 19:35:51] INFO	7. Ticket_factor (3.315046)
[12/26/21 19:35:51] INFO	8. cluster_30 (2.831587)
[12/26/21 19:35:51] INFO	9. mean (2.733389)
[12/26/21 19:35:51] INFO	10. Name_factor (2.586310)
[12/26/21 19:35:51] INFO	11. Cabin_factor (2.101764)
[12/26/21 19:35:51] INFO	12. Embarked (2.086410)
[12/26/21 19:35:51] INFO	13. SibSp (2.085405)
[12/26/21 19:35:51] INFO	14. cluster_12 (1.876782)
[12/26/21 19:35:51] INFO	15. cluster_24 (1.263144)
[12/26/21 19:35:51] INFO	16. count_2 (1.004409)
[12/26/21 19:35:51] INFO	17. sum (0.955946)
[12/26/21 19:35:51] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 19:35:51] INFO	Feature Importances for Algorithm: LGB
[12/26/21 19:35:51] INFO	Feature Ranking:
[12/26/21 19:35:51] INFO	1. Fare (256.000000)
[12/26/21 19:35:51] INFO	2. sum (241.000000)
[12/26/21 19:35:51] INFO	3. Age (232.000000)
[12/26/21 19:35:51] INFO	4. std (201.000000)
[12/26/21 19:35:51] INFO	5. Ticket_factor (199.000000)
[12/26/21 19:35:51] INFO	6. Name_factor (175.000000)
[12/26/21 19:35:51] INFO	7. cluster_30 (53.000000)
[12/26/21 19:35:51] INFO	8. cluster_27 (46.000000)
[12/26/21 19:35:51] INFO	9. Sex_factor (43.000000)
[12/26/21 19:35:51] INFO	10. Pclass (43.000000)
[12/26/21 19:35:51] INFO	11. Cabin_factor (41.000000)
[12/26/21 19:35:51] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 19:35:51] INFO	Feature Importances for Algorithm: XGB
[12/26/21 19:35:51] INFO	Feature Ranking:
[12/26/21 19:35:51] INFO	1. Sex_factor (0.424644)
[12/26/21 19:35:51] INFO	2. Pclass (0.127452)
[12/26/21 19:35:51] INFO	3. Cabin_factor (0.081307)
[12/26/21 19:35:51] INFO	4. Age (0.051007)
[12/26/21 19:35:51] INFO	5. SibSp (0.049620)
[12/26/21 19:35:51] INFO	6. count_1 (0.046373)
[12/26/21 19:35:51] INFO	7. Embarked (0.046225)
[12/26/21 19:35:51] INFO	8. std (0.036262)
[12/26/21 19:35:51] INFO	9. cluster_30 (0.036076)
[12/26/21 19:35:51] INFO	10. Fare (0.032410)
[12/26/21 19:35:51] INFO	11. cluster_24 (0.021187)
[12/26/21 19:35:51] INFO	12. Name_factor (0.019312)
[12/26/21 19:35:51] INFO	13. sum (0.017784)
[12/26/21 19:35:51] INFO	14. cluster_15 (0.010340)
[12/26/21 19:35:51] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 19:35:51] INFO	Getting Predictions
[12/26/21 19:35:51] INFO	Getting Probabilities
[12/26/21 19:35:51] INFO	Saving Ranked Predictions
[12/26/21 19:35:51] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 19:35:51] INFO	Saving Submission to ./output/submission_20211226.csv
[12/26/21 19:35:51] INFO	Saving Model Predictor
[12/26/21 19:35:51] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 19:35:51] INFO	Saving Feature Map
[12/26/21 19:35:51] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 19:35:51] INFO	********************************************************************************
[12/26/21 19:35:51] INFO	AlphaPy End
[12/26/21 19:35:51] INFO	********************************************************************************
[12/26/21 19:40:49] INFO	********************************************************************************
[12/26/21 19:40:49] INFO	AlphaPy Start
[12/26/21 19:40:49] INFO	********************************************************************************
[12/26/21 19:40:49] INFO	Model Configuration
[12/26/21 19:40:49] INFO	No transforms Found
[12/26/21 19:40:49] INFO	MODEL PARAMETERS:
[12/26/21 19:40:49] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:40:49] INFO	calibration       = False
[12/26/21 19:40:49] INFO	cal_type          = sigmoid
[12/26/21 19:40:49] INFO	calibration_plot  = False
[12/26/21 19:40:49] INFO	clustering        = True
[12/26/21 19:40:49] INFO	cluster_inc       = 3
[12/26/21 19:40:49] INFO	cluster_max       = 30
[12/26/21 19:40:49] INFO	cluster_min       = 3
[12/26/21 19:40:49] INFO	confusion_matrix  = True
[12/26/21 19:40:49] INFO	counts            = True
[12/26/21 19:40:49] INFO	cv_folds          = 3
[12/26/21 19:40:49] INFO	directory         = .
[12/26/21 19:40:49] INFO	extension         = csv
[12/26/21 19:40:49] INFO	drop              = ['PassengerId']
[12/26/21 19:40:49] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:40:49] INFO	esr               = 20
[12/26/21 19:40:49] INFO	factors           = ['Embarked']
[12/26/21 19:40:49] INFO	features [X]      = *
[12/26/21 19:40:49] INFO	feature_selection = False
[12/26/21 19:40:49] INFO	fs_percentage     = 50
[12/26/21 19:40:49] INFO	fs_score_func     = <function f_classif at 0x7fd969413ee0>
[12/26/21 19:40:49] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:40:49] INFO	grid_search       = True
[12/26/21 19:40:49] INFO	gs_iters          = 50
[12/26/21 19:40:49] INFO	gs_random         = True
[12/26/21 19:40:49] INFO	gs_sample         = False
[12/26/21 19:40:49] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:40:49] INFO	importances       = True
[12/26/21 19:40:49] INFO	interactions      = False
[12/26/21 19:40:49] INFO	isomap            = False
[12/26/21 19:40:49] INFO	iso_components    = 2
[12/26/21 19:40:49] INFO	iso_neighbors     = 5
[12/26/21 19:40:49] INFO	isample_pct       = 10
[12/26/21 19:40:49] INFO	leaders           = []
[12/26/21 19:40:49] INFO	learning_curve    = True
[12/26/21 19:40:49] INFO	logtransform      = False
[12/26/21 19:40:49] INFO	lv_remove         = True
[12/26/21 19:40:49] INFO	lv_threshold      = 0.100000
[12/26/21 19:40:49] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:40:49] INFO	n_estimators      = 51
[12/26/21 19:40:49] INFO	n_jobs            = -1
[12/26/21 19:40:49] INFO	ngrams_max        = 2
[12/26/21 19:40:49] INFO	numpy             = True
[12/26/21 19:40:49] INFO	pca               = False
[12/26/21 19:40:49] INFO	pca_inc           = 1
[12/26/21 19:40:49] INFO	pca_max           = 10
[12/26/21 19:40:49] INFO	pca_min           = 2
[12/26/21 19:40:49] INFO	pca_whiten        = False
[12/26/21 19:40:49] INFO	poly_degree       = 2
[12/26/21 19:40:49] INFO	pvalue_level      = 0.010000
[12/26/21 19:40:49] INFO	rfe               = True
[12/26/21 19:40:49] INFO	rfe_step          = 3
[12/26/21 19:40:49] INFO	roc_curve         = True
[12/26/21 19:40:49] INFO	rounding          = 2
[12/26/21 19:40:49] INFO	sampling          = False
[12/26/21 19:40:49] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:40:49] INFO	sampling_ratio    = 1.000000
[12/26/21 19:40:49] INFO	scaler_option     = True
[12/26/21 19:40:49] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:40:49] INFO	scipy             = False
[12/26/21 19:40:49] INFO	scorer            = roc_auc
[12/26/21 19:40:49] INFO	seed              = 42
[12/26/21 19:40:49] INFO	sentinel          = -1
[12/26/21 19:40:49] INFO	separator         = ,
[12/26/21 19:40:49] INFO	shuffle           = False
[12/26/21 19:40:49] INFO	split             = 0.400000
[12/26/21 19:40:49] INFO	submission_file   = gender_submission
[12/26/21 19:40:49] INFO	submit_probas     = False
[12/26/21 19:40:49] INFO	target [y]        = Survived
[12/26/21 19:40:49] INFO	target_value      = 1
[12/26/21 19:40:49] INFO	transforms        = None
[12/26/21 19:40:49] INFO	tsne              = False
[12/26/21 19:40:49] INFO	tsne_components   = 2
[12/26/21 19:40:49] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:40:49] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:40:49] INFO	vectorize         = False
[12/26/21 19:40:49] INFO	verbosity         = 0
[12/26/21 19:40:49] INFO	Creating Model
[12/26/21 19:40:49] INFO	Calling Pipeline
[12/26/21 19:40:49] INFO	Training Pipeline
[12/26/21 19:40:49] INFO	Loading Data
[12/26/21 19:40:49] INFO	Loading data from ./input/train.csv
[12/26/21 19:40:49] INFO	Found target Survived in data frame
[12/26/21 19:40:49] INFO	Labels (y) found for Partition.train
[12/26/21 19:40:49] INFO	Loading Data
[12/26/21 19:40:49] INFO	Loading data from ./input/test.csv
[12/26/21 19:40:49] INFO	Target Survived not found in Partition.test
[12/26/21 19:40:49] INFO	Saving New Features in Model
[12/26/21 19:40:49] INFO	Original Feature Statistics
[12/26/21 19:40:49] INFO	Number of Training Rows    : 891
[12/26/21 19:40:49] INFO	Number of Training Columns : 11
[12/26/21 19:40:49] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:40:49] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:40:49] INFO	Number of Testing Rows     : 418
[12/26/21 19:40:49] INFO	Number of Testing Columns  : 11
[12/26/21 19:40:49] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:40:49] INFO	Feature Count     : 11
[12/26/21 19:40:49] INFO	Applying transforms
[12/26/21 19:40:49] INFO	No transforms Specified
[12/26/21 19:40:49] INFO	New Feature Count : 11
[12/26/21 19:40:49] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:40:49] INFO	Original Feature Count : 11
[12/26/21 19:40:49] INFO	Reduced Feature Count  : 10
[12/26/21 19:40:49] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:40:49] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:40:49] INFO	Creating Cross-Tabulations
[12/26/21 19:40:49] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:40:49] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:40:49] INFO	Feature Count     : 10
[12/26/21 19:40:49] INFO	Creating Count Features
[12/26/21 19:40:49] INFO	NA Counts
[12/26/21 19:40:49] INFO	Number Counts
[12/26/21 19:40:49] INFO	New Feature Count : 21
[12/26/21 19:40:49] INFO	Creating Base Features
[12/26/21 19:40:49] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:40:49] INFO	Feature 2: Name => Factorization
[12/26/21 19:40:49] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:40:49] INFO	Feature 3: Sex => Factorization
[12/26/21 19:40:49] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:40:49] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:40:49] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:40:49] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:40:49] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:40:49] INFO	Encoding: Encoders.target
[12/26/21 19:40:49] INFO	Fitting training features for Embarked
[12/26/21 19:40:49] INFO	Transforming testing features for Embarked
[12/26/21 19:40:49] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:40:49] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:40:49] INFO	New Feature Count : 21
[12/26/21 19:40:49] INFO	Scaling Base Features
[12/26/21 19:40:49] INFO	Creating NumPy Features
[12/26/21 19:40:49] INFO	NumPy Feature: sum
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	NumPy Feature: mean
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	NumPy Feature: std
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	NumPy Feature: var
[12/26/21 19:40:49] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:40:49] INFO	NumPy Feature Count : 4
[12/26/21 19:40:49] INFO	New Feature Count : 25
[12/26/21 19:40:49] INFO	Creating Clustering Features
[12/26/21 19:40:49] INFO	Cluster Minimum   : 3
[12/26/21 19:40:49] INFO	Cluster Maximum   : 30
[12/26/21 19:40:49] INFO	Cluster Increment : 3
[12/26/21 19:40:49] INFO	k = 3
[12/26/21 19:40:51] INFO	k = 6
[12/26/21 19:40:51] INFO	k = 9
[12/26/21 19:40:51] INFO	k = 12
[12/26/21 19:40:51] INFO	k = 15
[12/26/21 19:40:51] INFO	k = 18
[12/26/21 19:40:51] INFO	k = 21
[12/26/21 19:40:51] INFO	k = 24
[12/26/21 19:40:51] INFO	k = 27
[12/26/21 19:40:51] INFO	k = 30
[12/26/21 19:40:51] INFO	Clustering Feature Count : 10
[12/26/21 19:40:51] INFO	New Feature Count : 35
[12/26/21 19:40:51] INFO	Saving New Features in Model
[12/26/21 19:40:51] INFO	Creating Interactions
[12/26/21 19:40:51] INFO	Initial Feature Count  : 35
[12/26/21 19:40:51] INFO	Skipping Interactions
[12/26/21 19:40:51] INFO	Saving New Features in Model
[12/26/21 19:40:51] INFO	Removing Low-Variance Features
[12/26/21 19:40:51] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:40:51] INFO	Original Feature Count  : 35
[12/26/21 19:40:51] INFO	Reduced Feature Count   : 35
[12/26/21 19:40:51] INFO	Saving New Features in Model
[12/26/21 19:40:51] INFO	Skipping Shuffling
[12/26/21 19:40:51] INFO	Skipping Sampling
[12/26/21 19:40:51] INFO	Getting All Estimators
[12/26/21 19:40:51] INFO	Algorithm Configuration
[12/26/21 19:40:52] INFO	Selecting Models
[12/26/21 19:40:52] INFO	Algorithm: CATB
[12/26/21 19:40:52] INFO	Fitting Initial Model
[12/26/21 19:40:52] INFO	Cross-Validation
[12/26/21 19:40:53] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:40:53] INFO	Recursive Feature Elimination with CV
[12/26/21 19:40:56] INFO	RFECV took 2.42 seconds for step 3 and 3 folds
[12/26/21 19:40:56] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:40:56] INFO	No grid is defined for grid search
[12/26/21 19:40:56] INFO	Final Model Predictions for CATB
[12/26/21 19:40:56] INFO	Skipping Calibration
[12/26/21 19:40:56] INFO	Making Predictions
[12/26/21 19:40:56] INFO	Predictions Complete
[12/26/21 19:40:56] INFO	Algorithm: LGB
[12/26/21 19:40:56] INFO	Fitting Initial Model
[12/26/21 19:40:56] INFO	Cross-Validation
[12/26/21 19:40:57] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:40:57] INFO	Recursive Feature Elimination with CV
[12/26/21 19:40:59] INFO	RFECV took 2.61 seconds for step 3 and 3 folds
[12/26/21 19:40:59] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:40:59] INFO	No grid is defined for grid search
[12/26/21 19:40:59] INFO	Final Model Predictions for LGB
[12/26/21 19:40:59] INFO	Skipping Calibration
[12/26/21 19:40:59] INFO	Making Predictions
[12/26/21 19:40:59] INFO	Predictions Complete
[12/26/21 19:40:59] INFO	Algorithm: XGB
[12/26/21 19:40:59] INFO	Fitting Initial Model
[12/26/21 19:40:59] INFO	Cross-Validation
[12/26/21 19:41:00] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:41:00] INFO	Recursive Feature Elimination with CV
[12/26/21 19:41:02] INFO	RFECV took 2.46 seconds for step 3 and 3 folds
[12/26/21 19:41:02] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:41:02] INFO	Randomized Grid Search
[12/26/21 19:42:00] INFO	Grid Search took 57.67 seconds for 50 candidate parameter settings.
[12/26/21 19:42:00] INFO	Model with rank: 1
[12/26/21 19:42:00] INFO	Mean validation score: 0.873 (std: 0.025)
[12/26/21 19:42:00] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/26/21 19:42:00] INFO	Model with rank: 2
[12/26/21 19:42:00] INFO	Mean validation score: 0.872 (std: 0.026)
[12/26/21 19:42:00] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 9, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/26/21 19:42:00] INFO	Model with rank: 3
[12/26/21 19:42:00] INFO	Mean validation score: 0.871 (std: 0.027)
[12/26/21 19:42:00] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.1, 'est__max_depth': 15, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.5}
[12/26/21 19:42:00] INFO	Algorithm: XGB, Best Score: 0.8732, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 51, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.6}
[12/26/21 19:42:00] INFO	Final Model Predictions for XGB
[12/26/21 19:42:00] INFO	Skipping Calibration
[12/26/21 19:42:00] INFO	Making Predictions
[12/26/21 19:42:00] INFO	Predictions Complete
[12/26/21 19:42:00] INFO	Blending Models
[12/26/21 19:42:00] INFO	Blending Start: 2021-12-26 19:42:00.231956
[12/26/21 19:42:00] INFO	Blending Complete: 0:00:00.006936
[12/26/21 19:42:00] INFO	================================================================================
[12/26/21 19:42:00] INFO	Metrics for: Partition.train
[12/26/21 19:42:00] INFO	--------------------------------------------------------------------------------
[12/26/21 19:42:00] INFO	Algorithm: CATB
[12/26/21 19:42:00] INFO	accuracy: 0.8585858585858586
[12/26/21 19:42:00] INFO	average_precision: 0.9113351686222868
[12/26/21 19:42:00] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 19:42:00] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 19:42:00] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 19:42:00] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 19:42:00] INFO	f1: 0.8025078369905956
[12/26/21 19:42:00] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 19:42:00] INFO	precision: 0.8648648648648649
[12/26/21 19:42:00] INFO	recall: 0.7485380116959064
[12/26/21 19:42:00] INFO	roc_auc: 0.9297979313797549
[12/26/21 19:42:00] INFO	--------------------------------------------------------------------------------
[12/26/21 19:42:00] INFO	Algorithm: LGB
[12/26/21 19:42:00] INFO	accuracy: 0.9730639730639731
[12/26/21 19:42:00] INFO	average_precision: 0.9961113207491221
[12/26/21 19:42:00] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 19:42:00] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 19:42:00] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 19:42:00] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 19:42:00] INFO	f1: 0.9643916913946586
[12/26/21 19:42:00] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 19:42:00] INFO	precision: 0.9789156626506024
[12/26/21 19:42:00] INFO	recall: 0.9502923976608187
[12/26/21 19:42:00] INFO	roc_auc: 0.9974861257576241
[12/26/21 19:42:00] INFO	--------------------------------------------------------------------------------
[12/26/21 19:42:00] INFO	Algorithm: XGB
[12/26/21 19:42:00] INFO	accuracy: 0.9337822671156004
[12/26/21 19:42:00] INFO	average_precision: 0.9732219136247747
[12/26/21 19:42:00] INFO	balanced_accuracy: 0.9214600709423832
[12/26/21 19:42:00] INFO	brier_score_loss: 0.07052077823288468
[12/26/21 19:42:00] INFO	cohen_kappa: 0.8575747970056814
[12/26/21 19:42:00] INFO	confusion_matrix: [[535  14]
 [ 45 297]]
[12/26/21 19:42:00] INFO	f1: 0.9096477794793262
[12/26/21 19:42:00] INFO	neg_log_loss: 0.27398489487559174
[12/26/21 19:42:00] INFO	precision: 0.954983922829582
[12/26/21 19:42:00] INFO	recall: 0.868421052631579
[12/26/21 19:42:00] INFO	roc_auc: 0.9793617315906645
[12/26/21 19:42:00] INFO	================================================================================
[12/26/21 19:42:00] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 19:42:00] INFO	Best Model Selection Start: 2021-12-26 19:42:00.268943
[12/26/21 19:42:00] INFO	Scoring CATB Model
[12/26/21 19:42:00] INFO	Scoring LGB Model
[12/26/21 19:42:00] INFO	Scoring XGB Model
[12/26/21 19:42:00] INFO	Scoring BLEND Model
[12/26/21 19:42:00] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 19:42:00] INFO	Best Model Selection Complete: 0:00:00.000215
[12/26/21 19:42:00] INFO	================================================================================
[12/26/21 19:42:00] INFO	Generating Plots for partition: train
[12/26/21 19:42:00] INFO	Generating Calibration Plot
[12/26/21 19:42:00] INFO	Calibration for Algorithm: CATB
[12/26/21 19:42:00] INFO	Calibration for Algorithm: LGB
[12/26/21 19:42:00] INFO	Calibration for Algorithm: XGB
[12/26/21 19:42:00] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 19:42:00] INFO	Generating Confusion Matrices
[12/26/21 19:42:00] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 19:42:00] INFO	Confusion Matrix:
[12/26/21 19:42:00] INFO	[[509  40]
 [ 86 256]]
[12/26/21 19:42:00] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 19:42:00] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 19:42:00] INFO	Confusion Matrix:
[12/26/21 19:42:00] INFO	[[542   7]
 [ 17 325]]
[12/26/21 19:42:00] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 19:42:00] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 19:42:00] INFO	Confusion Matrix:
[12/26/21 19:42:00] INFO	[[535  14]
 [ 45 297]]
[12/26/21 19:42:00] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 19:42:00] INFO	Generating ROC Curves
[12/26/21 19:42:00] INFO	ROC Curve for Algorithm: CATB
[12/26/21 19:42:00] INFO	ROC Curve for Algorithm: LGB
[12/26/21 19:42:00] INFO	ROC Curve for Algorithm: XGB
[12/26/21 19:42:00] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 19:42:00] INFO	Generating Learning Curves
[12/26/21 19:42:00] INFO	Algorithm Configuration
[12/26/21 19:42:00] INFO	Learning Curve for Algorithm: CATB
[12/26/21 19:42:01] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 19:42:01] INFO	Learning Curve for Algorithm: LGB
[12/26/21 19:42:02] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 19:42:03] INFO	Learning Curve for Algorithm: XGB
[12/26/21 19:42:03] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 19:42:03] INFO	Generating Feature Importance Plots
[12/26/21 19:42:03] INFO	Feature Importances for Algorithm: CATB
[12/26/21 19:42:03] INFO	Feature Ranking:
[12/26/21 19:42:03] INFO	1. Sex_factor (45.178104)
[12/26/21 19:42:03] INFO	2. Pclass (13.721171)
[12/26/21 19:42:03] INFO	3. Age (6.651788)
[12/26/21 19:42:03] INFO	4. Fare (4.529770)
[12/26/21 19:42:03] INFO	5. var (3.586590)
[12/26/21 19:42:03] INFO	6. std (3.492385)
[12/26/21 19:42:03] INFO	7. Ticket_factor (3.315046)
[12/26/21 19:42:03] INFO	8. cluster_30 (2.831587)
[12/26/21 19:42:03] INFO	9. mean (2.733389)
[12/26/21 19:42:03] INFO	10. Name_factor (2.586310)
[12/26/21 19:42:03] INFO	11. Cabin_factor (2.101764)
[12/26/21 19:42:03] INFO	12. Embarked (2.086410)
[12/26/21 19:42:03] INFO	13. SibSp (2.085405)
[12/26/21 19:42:03] INFO	14. cluster_12 (1.876782)
[12/26/21 19:42:03] INFO	15. cluster_24 (1.263144)
[12/26/21 19:42:03] INFO	16. count_2 (1.004409)
[12/26/21 19:42:03] INFO	17. sum (0.955946)
[12/26/21 19:42:03] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 19:42:03] INFO	Feature Importances for Algorithm: LGB
[12/26/21 19:42:03] INFO	Feature Ranking:
[12/26/21 19:42:03] INFO	1. Fare (256.000000)
[12/26/21 19:42:03] INFO	2. sum (241.000000)
[12/26/21 19:42:03] INFO	3. Age (232.000000)
[12/26/21 19:42:03] INFO	4. std (201.000000)
[12/26/21 19:42:03] INFO	5. Ticket_factor (199.000000)
[12/26/21 19:42:03] INFO	6. Name_factor (175.000000)
[12/26/21 19:42:03] INFO	7. cluster_30 (53.000000)
[12/26/21 19:42:03] INFO	8. cluster_27 (46.000000)
[12/26/21 19:42:03] INFO	9. Sex_factor (43.000000)
[12/26/21 19:42:03] INFO	10. Pclass (43.000000)
[12/26/21 19:42:03] INFO	11. Cabin_factor (41.000000)
[12/26/21 19:42:03] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 19:42:04] INFO	Feature Importances for Algorithm: XGB
[12/26/21 19:42:04] INFO	Feature Ranking:
[12/26/21 19:42:04] INFO	1. Sex_factor (0.424644)
[12/26/21 19:42:04] INFO	2. Pclass (0.127452)
[12/26/21 19:42:04] INFO	3. Cabin_factor (0.081307)
[12/26/21 19:42:04] INFO	4. Age (0.051007)
[12/26/21 19:42:04] INFO	5. SibSp (0.049620)
[12/26/21 19:42:04] INFO	6. count_1 (0.046373)
[12/26/21 19:42:04] INFO	7. Embarked (0.046225)
[12/26/21 19:42:04] INFO	8. std (0.036262)
[12/26/21 19:42:04] INFO	9. cluster_30 (0.036076)
[12/26/21 19:42:04] INFO	10. Fare (0.032410)
[12/26/21 19:42:04] INFO	11. cluster_24 (0.021187)
[12/26/21 19:42:04] INFO	12. Name_factor (0.019312)
[12/26/21 19:42:04] INFO	13. sum (0.017784)
[12/26/21 19:42:04] INFO	14. cluster_15 (0.010340)
[12/26/21 19:42:04] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 19:42:04] INFO	Getting Predictions
[12/26/21 19:42:04] INFO	Getting Probabilities
[12/26/21 19:42:04] INFO	Saving Ranked Predictions
[12/26/21 19:42:04] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 19:42:04] INFO	Saving Submission to ./output/submission_20211226.csv
[12/26/21 19:42:04] INFO	Saving Model Predictor
[12/26/21 19:42:04] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 19:42:04] INFO	Saving Feature Map
[12/26/21 19:42:04] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 19:42:04] INFO	********************************************************************************
[12/26/21 19:42:04] INFO	AlphaPy End
[12/26/21 19:42:04] INFO	********************************************************************************
[12/26/21 19:43:06] INFO	********************************************************************************
[12/26/21 19:43:06] INFO	AlphaPy Start
[12/26/21 19:43:06] INFO	********************************************************************************
[12/26/21 19:43:06] INFO	Model Configuration
[12/26/21 19:43:06] INFO	No transforms Found
[12/26/21 19:43:06] INFO	MODEL PARAMETERS:
[12/26/21 19:43:06] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:43:06] INFO	calibration       = False
[12/26/21 19:43:06] INFO	cal_type          = sigmoid
[12/26/21 19:43:06] INFO	calibration_plot  = False
[12/26/21 19:43:06] INFO	clustering        = True
[12/26/21 19:43:06] INFO	cluster_inc       = 3
[12/26/21 19:43:06] INFO	cluster_max       = 30
[12/26/21 19:43:06] INFO	cluster_min       = 3
[12/26/21 19:43:06] INFO	confusion_matrix  = True
[12/26/21 19:43:06] INFO	counts            = True
[12/26/21 19:43:06] INFO	cv_folds          = 3
[12/26/21 19:43:06] INFO	directory         = .
[12/26/21 19:43:06] INFO	extension         = csv
[12/26/21 19:43:06] INFO	drop              = ['PassengerId']
[12/26/21 19:43:06] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:43:06] INFO	esr               = 20
[12/26/21 19:43:06] INFO	factors           = ['Embarked']
[12/26/21 19:43:06] INFO	features [X]      = *
[12/26/21 19:43:06] INFO	feature_selection = False
[12/26/21 19:43:06] INFO	fs_percentage     = 50
[12/26/21 19:43:06] INFO	fs_score_func     = <function f_classif at 0x7fbd319e3ee0>
[12/26/21 19:43:06] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:43:06] INFO	grid_search       = True
[12/26/21 19:43:06] INFO	gs_iters          = 50
[12/26/21 19:43:06] INFO	gs_random         = True
[12/26/21 19:43:06] INFO	gs_sample         = False
[12/26/21 19:43:06] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:43:06] INFO	importances       = True
[12/26/21 19:43:06] INFO	interactions      = False
[12/26/21 19:43:06] INFO	isomap            = False
[12/26/21 19:43:06] INFO	iso_components    = 2
[12/26/21 19:43:06] INFO	iso_neighbors     = 5
[12/26/21 19:43:06] INFO	isample_pct       = 10
[12/26/21 19:43:06] INFO	leaders           = []
[12/26/21 19:43:06] INFO	learning_curve    = True
[12/26/21 19:43:06] INFO	logtransform      = False
[12/26/21 19:43:06] INFO	lv_remove         = True
[12/26/21 19:43:06] INFO	lv_threshold      = 0.100000
[12/26/21 19:43:06] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:43:06] INFO	n_estimators      = 51
[12/26/21 19:43:06] INFO	n_jobs            = -1
[12/26/21 19:43:06] INFO	ngrams_max        = 2
[12/26/21 19:43:06] INFO	numpy             = True
[12/26/21 19:43:06] INFO	pca               = False
[12/26/21 19:43:06] INFO	pca_inc           = 1
[12/26/21 19:43:06] INFO	pca_max           = 10
[12/26/21 19:43:06] INFO	pca_min           = 2
[12/26/21 19:43:06] INFO	pca_whiten        = False
[12/26/21 19:43:06] INFO	poly_degree       = 2
[12/26/21 19:43:06] INFO	pvalue_level      = 0.010000
[12/26/21 19:43:06] INFO	rfe               = True
[12/26/21 19:43:06] INFO	rfe_step          = 3
[12/26/21 19:43:06] INFO	roc_curve         = True
[12/26/21 19:43:06] INFO	rounding          = 2
[12/26/21 19:43:06] INFO	sampling          = False
[12/26/21 19:43:06] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:43:06] INFO	sampling_ratio    = 1.000000
[12/26/21 19:43:06] INFO	scaler_option     = True
[12/26/21 19:43:06] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:43:06] INFO	scipy             = False
[12/26/21 19:43:06] INFO	scorer            = roc_auc
[12/26/21 19:43:06] INFO	seed              = 42
[12/26/21 19:43:06] INFO	sentinel          = -1
[12/26/21 19:43:06] INFO	separator         = ,
[12/26/21 19:43:06] INFO	shuffle           = False
[12/26/21 19:43:06] INFO	split             = 0.400000
[12/26/21 19:43:06] INFO	submission_file   = gender_submission
[12/26/21 19:43:06] INFO	submit_probas     = False
[12/26/21 19:43:06] INFO	target [y]        = Survived
[12/26/21 19:43:06] INFO	target_value      = 1
[12/26/21 19:43:06] INFO	transforms        = None
[12/26/21 19:43:06] INFO	tsne              = False
[12/26/21 19:43:06] INFO	tsne_components   = 2
[12/26/21 19:43:06] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:43:06] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:43:06] INFO	vectorize         = False
[12/26/21 19:43:06] INFO	verbosity         = 0
[12/26/21 19:43:06] INFO	Creating Model
[12/26/21 19:43:06] INFO	Calling Pipeline
[12/26/21 19:43:06] INFO	Training Pipeline
[12/26/21 19:43:06] INFO	Loading Data
[12/26/21 19:43:06] INFO	Loading data from ./input/train.csv
[12/26/21 19:43:06] INFO	Found target Survived in data frame
[12/26/21 19:43:06] INFO	Labels (y) found for Partition.train
[12/26/21 19:43:06] INFO	Loading Data
[12/26/21 19:43:06] INFO	Loading data from ./input/test.csv
[12/26/21 19:43:06] INFO	Target Survived not found in Partition.test
[12/26/21 19:43:06] INFO	Saving New Features in Model
[12/26/21 19:43:06] INFO	Original Feature Statistics
[12/26/21 19:43:06] INFO	Number of Training Rows    : 891
[12/26/21 19:43:06] INFO	Number of Training Columns : 11
[12/26/21 19:43:06] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:43:06] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:43:06] INFO	Number of Testing Rows     : 418
[12/26/21 19:43:06] INFO	Number of Testing Columns  : 11
[12/26/21 19:43:06] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:43:06] INFO	Feature Count     : 11
[12/26/21 19:43:06] INFO	Applying transforms
[12/26/21 19:43:06] INFO	No transforms Specified
[12/26/21 19:43:06] INFO	New Feature Count : 11
[12/26/21 19:43:06] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:43:06] INFO	Original Feature Count : 11
[12/26/21 19:43:06] INFO	Reduced Feature Count  : 10
[12/26/21 19:43:06] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:43:06] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:43:06] INFO	Creating Cross-Tabulations
[12/26/21 19:43:06] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:43:06] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:43:06] INFO	Feature Count     : 10
[12/26/21 19:43:06] INFO	Creating Count Features
[12/26/21 19:43:06] INFO	NA Counts
[12/26/21 19:43:06] INFO	Number Counts
[12/26/21 19:43:06] INFO	New Feature Count : 21
[12/26/21 19:43:06] INFO	Creating Base Features
[12/26/21 19:43:06] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:43:06] INFO	Feature 2: Name => Factorization
[12/26/21 19:43:06] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:43:06] INFO	Feature 3: Sex => Factorization
[12/26/21 19:43:06] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:43:06] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:43:06] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:43:06] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:43:06] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:43:06] INFO	Encoding: Encoders.target
[12/26/21 19:43:06] INFO	Fitting training features for Embarked
[12/26/21 19:43:06] INFO	Transforming testing features for Embarked
[12/26/21 19:43:06] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:43:06] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:43:06] INFO	New Feature Count : 21
[12/26/21 19:43:06] INFO	Scaling Base Features
[12/26/21 19:43:06] INFO	Creating NumPy Features
[12/26/21 19:43:06] INFO	NumPy Feature: sum
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	NumPy Feature: mean
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	NumPy Feature: std
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	NumPy Feature: var
[12/26/21 19:43:06] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:43:06] INFO	NumPy Feature Count : 4
[12/26/21 19:43:06] INFO	New Feature Count : 25
[12/26/21 19:43:06] INFO	Creating Clustering Features
[12/26/21 19:43:06] INFO	Cluster Minimum   : 3
[12/26/21 19:43:06] INFO	Cluster Maximum   : 30
[12/26/21 19:43:06] INFO	Cluster Increment : 3
[12/26/21 19:43:06] INFO	k = 3
[12/26/21 19:43:08] INFO	k = 6
[12/26/21 19:43:08] INFO	k = 9
[12/26/21 19:43:08] INFO	k = 12
[12/26/21 19:43:08] INFO	k = 15
[12/26/21 19:43:08] INFO	k = 18
[12/26/21 19:43:08] INFO	k = 21
[12/26/21 19:43:08] INFO	k = 24
[12/26/21 19:43:08] INFO	k = 27
[12/26/21 19:43:08] INFO	k = 30
[12/26/21 19:43:08] INFO	Clustering Feature Count : 10
[12/26/21 19:43:08] INFO	New Feature Count : 35
[12/26/21 19:43:08] INFO	Saving New Features in Model
[12/26/21 19:43:08] INFO	Creating Interactions
[12/26/21 19:43:08] INFO	Initial Feature Count  : 35
[12/26/21 19:43:08] INFO	Skipping Interactions
[12/26/21 19:43:08] INFO	Saving New Features in Model
[12/26/21 19:43:08] INFO	Removing Low-Variance Features
[12/26/21 19:43:08] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:43:08] INFO	Original Feature Count  : 35
[12/26/21 19:43:08] INFO	Reduced Feature Count   : 35
[12/26/21 19:43:08] INFO	Saving New Features in Model
[12/26/21 19:43:08] INFO	Skipping Shuffling
[12/26/21 19:43:08] INFO	Skipping Sampling
[12/26/21 19:43:08] INFO	Getting All Estimators
[12/26/21 19:43:08] INFO	Algorithm Configuration
[12/26/21 19:43:09] INFO	Selecting Models
[12/26/21 19:43:09] INFO	Algorithm: CATB
[12/26/21 19:43:09] INFO	Fitting Initial Model
[12/26/21 19:43:09] INFO	Cross-Validation
[12/26/21 19:43:10] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:43:10] INFO	Recursive Feature Elimination with CV
[12/26/21 19:43:13] INFO	RFECV took 2.19 seconds for step 3 and 3 folds
[12/26/21 19:43:13] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:43:13] INFO	No grid is defined for grid search
[12/26/21 19:43:13] INFO	Final Model Predictions for CATB
[12/26/21 19:43:13] INFO	Skipping Calibration
[12/26/21 19:43:13] INFO	Making Predictions
[12/26/21 19:43:13] INFO	Predictions Complete
[12/26/21 19:43:13] INFO	Algorithm: LGB
[12/26/21 19:43:13] INFO	Fitting Initial Model
[12/26/21 19:43:13] INFO	Cross-Validation
[12/26/21 19:43:14] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:43:14] INFO	Recursive Feature Elimination with CV
[12/26/21 19:43:17] INFO	RFECV took 3.06 seconds for step 3 and 3 folds
[12/26/21 19:43:17] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:43:17] INFO	No grid is defined for grid search
[12/26/21 19:43:17] INFO	Final Model Predictions for LGB
[12/26/21 19:43:17] INFO	Skipping Calibration
[12/26/21 19:43:17] INFO	Making Predictions
[12/26/21 19:43:17] INFO	Predictions Complete
[12/26/21 19:43:17] INFO	Algorithm: XGB
[12/26/21 19:43:17] INFO	Fitting Initial Model
[12/26/21 19:43:17] INFO	Cross-Validation
[12/26/21 19:43:17] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:43:17] INFO	Recursive Feature Elimination with CV
[12/26/21 19:43:19] INFO	RFECV took 2.26 seconds for step 3 and 3 folds
[12/26/21 19:43:19] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:43:19] INFO	Randomized Grid Search
[12/26/21 19:44:30] INFO	Grid Search took 70.60 seconds for 50 candidate parameter settings.
[12/26/21 19:44:30] INFO	Model with rank: 1
[12/26/21 19:44:30] INFO	Mean validation score: 0.870 (std: 0.029)
[12/26/21 19:44:30] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/26/21 19:44:30] INFO	Model with rank: 2
[12/26/21 19:44:30] INFO	Mean validation score: 0.870 (std: 0.024)
[12/26/21 19:44:30] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 10, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 19:44:30] INFO	Model with rank: 3
[12/26/21 19:44:30] INFO	Mean validation score: 0.870 (std: 0.027)
[12/26/21 19:44:30] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 19:44:30] INFO	Algorithm: XGB, Best Score: 0.8698, Best Parameters: {'est__subsample': 0.6, 'est__n_estimators': 101, 'est__min_child_weight': 1.0, 'est__max_depth': 15, 'est__learning_rate': 0.02, 'est__colsample_bytree': 0.5}
[12/26/21 19:44:30] INFO	Final Model Predictions for XGB
[12/26/21 19:44:30] INFO	Skipping Calibration
[12/26/21 19:44:30] INFO	Making Predictions
[12/26/21 19:44:30] INFO	Predictions Complete
[12/26/21 19:44:30] INFO	Blending Models
[12/26/21 19:44:30] INFO	Blending Start: 2021-12-26 19:44:30.359710
[12/26/21 19:44:30] INFO	Blending Complete: 0:00:00.005621
[12/26/21 19:44:30] INFO	================================================================================
[12/26/21 19:44:30] INFO	Metrics for: Partition.train
[12/26/21 19:44:30] INFO	--------------------------------------------------------------------------------
[12/26/21 19:44:30] INFO	Algorithm: CATB
[12/26/21 19:44:30] INFO	accuracy: 0.8585858585858586
[12/26/21 19:44:30] INFO	average_precision: 0.9113351686222868
[12/26/21 19:44:30] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 19:44:30] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 19:44:30] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 19:44:30] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 19:44:30] INFO	f1: 0.8025078369905956
[12/26/21 19:44:30] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 19:44:30] INFO	precision: 0.8648648648648649
[12/26/21 19:44:30] INFO	recall: 0.7485380116959064
[12/26/21 19:44:30] INFO	roc_auc: 0.9297979313797549
[12/26/21 19:44:30] INFO	--------------------------------------------------------------------------------
[12/26/21 19:44:30] INFO	Algorithm: LGB
[12/26/21 19:44:30] INFO	accuracy: 0.9730639730639731
[12/26/21 19:44:30] INFO	average_precision: 0.9961113207491221
[12/26/21 19:44:30] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 19:44:30] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 19:44:30] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 19:44:30] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 19:44:30] INFO	f1: 0.9643916913946586
[12/26/21 19:44:30] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 19:44:30] INFO	precision: 0.9789156626506024
[12/26/21 19:44:30] INFO	recall: 0.9502923976608187
[12/26/21 19:44:30] INFO	roc_auc: 0.9974861257576241
[12/26/21 19:44:30] INFO	--------------------------------------------------------------------------------
[12/26/21 19:44:30] INFO	Algorithm: XGB
[12/26/21 19:44:30] INFO	accuracy: 0.9214365881032548
[12/26/21 19:44:30] INFO	average_precision: 0.9659074215660941
[12/26/21 19:44:30] INFO	balanced_accuracy: 0.9081344070558911
[12/26/21 19:44:30] INFO	brier_score_loss: 0.08562712014221595
[12/26/21 19:44:30] INFO	cohen_kappa: 0.8309261247194301
[12/26/21 19:44:30] INFO	confusion_matrix: [[530  19]
 [ 51 291]]
[12/26/21 19:44:30] INFO	f1: 0.892638036809816
[12/26/21 19:44:30] INFO	neg_log_loss: 0.3206369337091676
[12/26/21 19:44:30] INFO	precision: 0.9387096774193548
[12/26/21 19:44:30] INFO	recall: 0.8508771929824561
[12/26/21 19:44:30] INFO	roc_auc: 0.9743872431534208
[12/26/21 19:44:30] INFO	================================================================================
[12/26/21 19:44:30] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 19:44:30] INFO	Best Model Selection Start: 2021-12-26 19:44:30.389846
[12/26/21 19:44:30] INFO	Scoring CATB Model
[12/26/21 19:44:30] INFO	Scoring LGB Model
[12/26/21 19:44:30] INFO	Scoring XGB Model
[12/26/21 19:44:30] INFO	Scoring BLEND Model
[12/26/21 19:44:30] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 19:44:30] INFO	Best Model Selection Complete: 0:00:00.000204
[12/26/21 19:44:30] INFO	================================================================================
[12/26/21 19:44:30] INFO	Generating Plots for partition: train
[12/26/21 19:44:30] INFO	Generating Calibration Plot
[12/26/21 19:44:30] INFO	Calibration for Algorithm: CATB
[12/26/21 19:44:30] INFO	Calibration for Algorithm: LGB
[12/26/21 19:44:30] INFO	Calibration for Algorithm: XGB
[12/26/21 19:44:30] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 19:44:30] INFO	Generating Confusion Matrices
[12/26/21 19:44:30] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 19:44:30] INFO	Confusion Matrix:
[12/26/21 19:44:30] INFO	[[509  40]
 [ 86 256]]
[12/26/21 19:44:30] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 19:44:30] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 19:44:30] INFO	Confusion Matrix:
[12/26/21 19:44:30] INFO	[[542   7]
 [ 17 325]]
[12/26/21 19:44:30] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 19:44:30] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 19:44:30] INFO	Confusion Matrix:
[12/26/21 19:44:30] INFO	[[530  19]
 [ 51 291]]
[12/26/21 19:44:30] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 19:44:30] INFO	Generating ROC Curves
[12/26/21 19:44:30] INFO	ROC Curve for Algorithm: CATB
[12/26/21 19:44:30] INFO	ROC Curve for Algorithm: LGB
[12/26/21 19:44:30] INFO	ROC Curve for Algorithm: XGB
[12/26/21 19:44:30] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 19:44:30] INFO	Generating Learning Curves
[12/26/21 19:44:30] INFO	Algorithm Configuration
[12/26/21 19:44:30] INFO	Learning Curve for Algorithm: CATB
[12/26/21 19:44:31] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 19:44:31] INFO	Learning Curve for Algorithm: LGB
[12/26/21 19:44:33] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 19:44:33] INFO	Learning Curve for Algorithm: XGB
[12/26/21 19:44:34] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 19:44:34] INFO	Generating Feature Importance Plots
[12/26/21 19:44:34] INFO	Feature Importances for Algorithm: CATB
[12/26/21 19:44:34] INFO	Feature Ranking:
[12/26/21 19:44:34] INFO	1. Sex_factor (45.178104)
[12/26/21 19:44:34] INFO	2. Pclass (13.721171)
[12/26/21 19:44:34] INFO	3. Age (6.651788)
[12/26/21 19:44:34] INFO	4. Fare (4.529770)
[12/26/21 19:44:34] INFO	5. var (3.586590)
[12/26/21 19:44:34] INFO	6. std (3.492385)
[12/26/21 19:44:34] INFO	7. Ticket_factor (3.315046)
[12/26/21 19:44:34] INFO	8. cluster_30 (2.831587)
[12/26/21 19:44:34] INFO	9. mean (2.733389)
[12/26/21 19:44:34] INFO	10. Name_factor (2.586310)
[12/26/21 19:44:34] INFO	11. Cabin_factor (2.101764)
[12/26/21 19:44:34] INFO	12. Embarked (2.086410)
[12/26/21 19:44:34] INFO	13. SibSp (2.085405)
[12/26/21 19:44:34] INFO	14. cluster_12 (1.876782)
[12/26/21 19:44:34] INFO	15. cluster_24 (1.263144)
[12/26/21 19:44:34] INFO	16. count_2 (1.004409)
[12/26/21 19:44:34] INFO	17. sum (0.955946)
[12/26/21 19:44:34] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 19:44:34] INFO	Feature Importances for Algorithm: LGB
[12/26/21 19:44:34] INFO	Feature Ranking:
[12/26/21 19:44:34] INFO	1. Fare (256.000000)
[12/26/21 19:44:34] INFO	2. sum (241.000000)
[12/26/21 19:44:34] INFO	3. Age (232.000000)
[12/26/21 19:44:34] INFO	4. std (201.000000)
[12/26/21 19:44:34] INFO	5. Ticket_factor (199.000000)
[12/26/21 19:44:34] INFO	6. Name_factor (175.000000)
[12/26/21 19:44:34] INFO	7. cluster_30 (53.000000)
[12/26/21 19:44:34] INFO	8. cluster_27 (46.000000)
[12/26/21 19:44:34] INFO	9. Sex_factor (43.000000)
[12/26/21 19:44:34] INFO	10. Pclass (43.000000)
[12/26/21 19:44:34] INFO	11. Cabin_factor (41.000000)
[12/26/21 19:44:34] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 19:44:34] INFO	Feature Importances for Algorithm: XGB
[12/26/21 19:44:34] INFO	Feature Ranking:
[12/26/21 19:44:34] INFO	1. Sex_factor (0.424644)
[12/26/21 19:44:34] INFO	2. Pclass (0.127452)
[12/26/21 19:44:34] INFO	3. Cabin_factor (0.081307)
[12/26/21 19:44:34] INFO	4. Age (0.051007)
[12/26/21 19:44:34] INFO	5. SibSp (0.049620)
[12/26/21 19:44:34] INFO	6. count_1 (0.046373)
[12/26/21 19:44:34] INFO	7. Embarked (0.046225)
[12/26/21 19:44:34] INFO	8. std (0.036262)
[12/26/21 19:44:34] INFO	9. cluster_30 (0.036076)
[12/26/21 19:44:34] INFO	10. Fare (0.032410)
[12/26/21 19:44:34] INFO	11. cluster_24 (0.021187)
[12/26/21 19:44:34] INFO	12. Name_factor (0.019312)
[12/26/21 19:44:34] INFO	13. sum (0.017784)
[12/26/21 19:44:34] INFO	14. cluster_15 (0.010340)
[12/26/21 19:44:34] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 19:44:34] INFO	Getting Predictions
[12/26/21 19:44:34] INFO	Getting Probabilities
[12/26/21 19:44:34] INFO	Saving Ranked Predictions
[12/26/21 19:44:34] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 19:44:34] INFO	Saving Submission to ./output/submission_20211226.csv
[12/26/21 19:44:34] INFO	Saving Model Predictor
[12/26/21 19:44:34] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 19:44:34] INFO	Saving Feature Map
[12/26/21 19:44:34] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 19:44:34] INFO	********************************************************************************
[12/26/21 19:44:34] INFO	AlphaPy End
[12/26/21 19:44:34] INFO	********************************************************************************
[12/26/21 19:46:01] INFO	********************************************************************************
[12/26/21 19:46:01] INFO	AlphaPy Start
[12/26/21 19:46:01] INFO	********************************************************************************
[12/26/21 19:46:01] INFO	Model Configuration
[12/26/21 19:46:01] INFO	No transforms Found
[12/26/21 19:46:01] INFO	MODEL PARAMETERS:
[12/26/21 19:46:01] INFO	algorithms        = ['CATB', 'LGB', 'XGB']
[12/26/21 19:46:01] INFO	calibration       = False
[12/26/21 19:46:01] INFO	cal_type          = sigmoid
[12/26/21 19:46:01] INFO	calibration_plot  = False
[12/26/21 19:46:01] INFO	clustering        = True
[12/26/21 19:46:01] INFO	cluster_inc       = 3
[12/26/21 19:46:01] INFO	cluster_max       = 30
[12/26/21 19:46:01] INFO	cluster_min       = 3
[12/26/21 19:46:01] INFO	confusion_matrix  = True
[12/26/21 19:46:01] INFO	counts            = True
[12/26/21 19:46:01] INFO	cv_folds          = 3
[12/26/21 19:46:01] INFO	directory         = .
[12/26/21 19:46:01] INFO	extension         = csv
[12/26/21 19:46:01] INFO	drop              = ['PassengerId']
[12/26/21 19:46:01] INFO	encoder           = <Encoders.target: 14>
[12/26/21 19:46:01] INFO	esr               = 20
[12/26/21 19:46:01] INFO	factors           = ['Embarked']
[12/26/21 19:46:01] INFO	features [X]      = *
[12/26/21 19:46:01] INFO	feature_selection = False
[12/26/21 19:46:01] INFO	fs_percentage     = 50
[12/26/21 19:46:01] INFO	fs_score_func     = <function f_classif at 0x7fb4c9ab2ee0>
[12/26/21 19:46:01] INFO	fs_uni_grid       = [5, 10, 15, 20, 25]
[12/26/21 19:46:01] INFO	grid_search       = True
[12/26/21 19:46:01] INFO	gs_iters          = 50
[12/26/21 19:46:01] INFO	gs_random         = True
[12/26/21 19:46:01] INFO	gs_sample         = False
[12/26/21 19:46:01] INFO	gs_sample_pct     = 0.200000
[12/26/21 19:46:01] INFO	importances       = True
[12/26/21 19:46:01] INFO	interactions      = False
[12/26/21 19:46:01] INFO	isomap            = False
[12/26/21 19:46:01] INFO	iso_components    = 2
[12/26/21 19:46:01] INFO	iso_neighbors     = 5
[12/26/21 19:46:01] INFO	isample_pct       = 10
[12/26/21 19:46:01] INFO	leaders           = []
[12/26/21 19:46:01] INFO	learning_curve    = True
[12/26/21 19:46:01] INFO	logtransform      = False
[12/26/21 19:46:01] INFO	lv_remove         = True
[12/26/21 19:46:01] INFO	lv_threshold      = 0.100000
[12/26/21 19:46:01] INFO	model_type        = <ModelType.classification: 1>
[12/26/21 19:46:01] INFO	n_estimators      = 51
[12/26/21 19:46:01] INFO	n_jobs            = -1
[12/26/21 19:46:01] INFO	ngrams_max        = 2
[12/26/21 19:46:01] INFO	numpy             = True
[12/26/21 19:46:01] INFO	pca               = False
[12/26/21 19:46:01] INFO	pca_inc           = 1
[12/26/21 19:46:01] INFO	pca_max           = 10
[12/26/21 19:46:01] INFO	pca_min           = 2
[12/26/21 19:46:01] INFO	pca_whiten        = False
[12/26/21 19:46:01] INFO	poly_degree       = 2
[12/26/21 19:46:01] INFO	pvalue_level      = 0.010000
[12/26/21 19:46:01] INFO	rfe               = True
[12/26/21 19:46:01] INFO	rfe_step          = 3
[12/26/21 19:46:01] INFO	roc_curve         = True
[12/26/21 19:46:01] INFO	rounding          = 2
[12/26/21 19:46:01] INFO	sampling          = False
[12/26/21 19:46:01] INFO	sampling_method   = <SamplingMethod.over_random: 3>
[12/26/21 19:46:01] INFO	sampling_ratio    = 1.000000
[12/26/21 19:46:01] INFO	scaler_option     = True
[12/26/21 19:46:01] INFO	scaler_type       = <Scalers.standard: 2>
[12/26/21 19:46:01] INFO	scipy             = False
[12/26/21 19:46:01] INFO	scorer            = roc_auc
[12/26/21 19:46:01] INFO	seed              = 42
[12/26/21 19:46:01] INFO	sentinel          = -1
[12/26/21 19:46:01] INFO	separator         = ,
[12/26/21 19:46:01] INFO	shuffle           = False
[12/26/21 19:46:01] INFO	split             = 0.400000
[12/26/21 19:46:01] INFO	submission_file   = gender_submission
[12/26/21 19:46:01] INFO	submit_probas     = False
[12/26/21 19:46:01] INFO	target [y]        = Survived
[12/26/21 19:46:01] INFO	target_value      = 1
[12/26/21 19:46:01] INFO	transforms        = None
[12/26/21 19:46:01] INFO	tsne              = False
[12/26/21 19:46:01] INFO	tsne_components   = 2
[12/26/21 19:46:01] INFO	tsne_learn_rate   = 1000.000000
[12/26/21 19:46:01] INFO	tsne_perplexity   = 30.000000
[12/26/21 19:46:01] INFO	vectorize         = False
[12/26/21 19:46:01] INFO	verbosity         = 0
[12/26/21 19:46:01] INFO	Creating Model
[12/26/21 19:46:01] INFO	Calling Pipeline
[12/26/21 19:46:01] INFO	Training Pipeline
[12/26/21 19:46:01] INFO	Loading Data
[12/26/21 19:46:01] INFO	Loading data from ./input/train.csv
[12/26/21 19:46:01] INFO	Found target Survived in data frame
[12/26/21 19:46:01] INFO	Labels (y) found for Partition.train
[12/26/21 19:46:01] INFO	Loading Data
[12/26/21 19:46:01] INFO	Loading data from ./input/test.csv
[12/26/21 19:46:01] INFO	Target Survived not found in Partition.test
[12/26/21 19:46:01] INFO	Saving New Features in Model
[12/26/21 19:46:01] INFO	Original Feature Statistics
[12/26/21 19:46:01] INFO	Number of Training Rows    : 891
[12/26/21 19:46:01] INFO	Number of Training Columns : 11
[12/26/21 19:46:01] INFO	Unique Training Values for Survived : [0 1]
[12/26/21 19:46:01] INFO	Unique Training Counts for Survived : [549 342]
[12/26/21 19:46:01] INFO	Number of Testing Rows     : 418
[12/26/21 19:46:01] INFO	Number of Testing Columns  : 11
[12/26/21 19:46:01] INFO	Original Features : Index(['PassengerId', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch',
       'Ticket', 'Fare', 'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:46:01] INFO	Feature Count     : 11
[12/26/21 19:46:01] INFO	Applying transforms
[12/26/21 19:46:01] INFO	No transforms Specified
[12/26/21 19:46:01] INFO	New Feature Count : 11
[12/26/21 19:46:01] INFO	Dropping Features: ['PassengerId']
[12/26/21 19:46:01] INFO	Original Feature Count : 11
[12/26/21 19:46:01] INFO	Reduced Feature Count  : 10
[12/26/21 19:46:01] INFO	Writing data frame to ./input/train_20211226.csv
[12/26/21 19:46:01] INFO	Writing data frame to ./input/test_20211226.csv
[12/26/21 19:46:01] INFO	Creating Cross-Tabulations
[12/26/21 19:46:01] INFO	Creating crosstabs for feature Embarked
[12/26/21 19:46:01] INFO	Original Features : Index(['Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare',
       'Cabin', 'Embarked'],
      dtype='object')
[12/26/21 19:46:01] INFO	Feature Count     : 10
[12/26/21 19:46:01] INFO	Creating Count Features
[12/26/21 19:46:01] INFO	NA Counts
[12/26/21 19:46:01] INFO	Number Counts
[12/26/21 19:46:01] INFO	New Feature Count : 21
[12/26/21 19:46:01] INFO	Creating Base Features
[12/26/21 19:46:01] INFO	Feature 1: Pclass is a numerical feature of type int64 with 3 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 2: Name is a text feature [12:82] with 1307 unique values
[12/26/21 19:46:01] INFO	Feature 2: Name => Factorization
[12/26/21 19:46:01] INFO	Feature 3: Sex is a text feature [4:6] with 2 unique values
[12/26/21 19:46:01] INFO	Feature 3: Sex => Factorization
[12/26/21 19:46:01] INFO	Feature 4: Age is a numerical feature of type float64 with 99 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	Feature 5: SibSp is a numerical feature of type int64 with 7 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 6: Parch is a numerical feature of type int64 with 8 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 7: Ticket is a text feature [3:18] with 929 unique values
[12/26/21 19:46:01] INFO	Feature 7: Ticket => Factorization
[12/26/21 19:46:01] INFO	Feature 8: Fare is a numerical feature of type float64 with 282 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	Feature 9: Cabin is a text feature [1:15] with 187 unique values
[12/26/21 19:46:01] INFO	Feature 9: Cabin => Factorization
[12/26/21 19:46:01] INFO	Feature 10: Embarked is a factor of type object with 4 unique values
[12/26/21 19:46:01] INFO	Encoding: Encoders.target
[12/26/21 19:46:01] INFO	Fitting training features for Embarked
[12/26/21 19:46:01] INFO	Transforming testing features for Embarked
[12/26/21 19:46:01] INFO	Feature 11: nan_count is a numerical feature of type int64 with 3 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 12: count_0 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 13: count_1 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 14: count_2 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 15: count_3 is a numerical feature of type int64 with 4 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 16: count_4 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 17: count_5 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 18: count_6 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 19: count_7 is a numerical feature of type int64 with 2 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 20: count_8 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	Feature 21: count_9 is a numerical feature of type int64 with 3 unique values
[12/26/21 19:46:01] INFO	    Imputation for Data Type int64: Most Frequent Strategy
[12/26/21 19:46:01] INFO	New Feature Count : 21
[12/26/21 19:46:01] INFO	Scaling Base Features
[12/26/21 19:46:01] INFO	Creating NumPy Features
[12/26/21 19:46:01] INFO	NumPy Feature: sum
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	NumPy Feature: mean
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	NumPy Feature: std
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	NumPy Feature: var
[12/26/21 19:46:01] INFO	    Imputation for Data Type float64: Median Strategy
[12/26/21 19:46:01] INFO	NumPy Feature Count : 4
[12/26/21 19:46:01] INFO	New Feature Count : 25
[12/26/21 19:46:01] INFO	Creating Clustering Features
[12/26/21 19:46:01] INFO	Cluster Minimum   : 3
[12/26/21 19:46:01] INFO	Cluster Maximum   : 30
[12/26/21 19:46:01] INFO	Cluster Increment : 3
[12/26/21 19:46:01] INFO	k = 3
[12/26/21 19:46:03] INFO	k = 6
[12/26/21 19:46:03] INFO	k = 9
[12/26/21 19:46:03] INFO	k = 12
[12/26/21 19:46:03] INFO	k = 15
[12/26/21 19:46:03] INFO	k = 18
[12/26/21 19:46:03] INFO	k = 21
[12/26/21 19:46:03] INFO	k = 24
[12/26/21 19:46:03] INFO	k = 27
[12/26/21 19:46:03] INFO	k = 30
[12/26/21 19:46:03] INFO	Clustering Feature Count : 10
[12/26/21 19:46:03] INFO	New Feature Count : 35
[12/26/21 19:46:03] INFO	Saving New Features in Model
[12/26/21 19:46:03] INFO	Creating Interactions
[12/26/21 19:46:03] INFO	Initial Feature Count  : 35
[12/26/21 19:46:03] INFO	Skipping Interactions
[12/26/21 19:46:03] INFO	Saving New Features in Model
[12/26/21 19:46:03] INFO	Removing Low-Variance Features
[12/26/21 19:46:03] INFO	Low-Variance Threshold  : 0.10
[12/26/21 19:46:03] INFO	Original Feature Count  : 35
[12/26/21 19:46:03] INFO	Reduced Feature Count   : 35
[12/26/21 19:46:03] INFO	Saving New Features in Model
[12/26/21 19:46:03] INFO	Skipping Shuffling
[12/26/21 19:46:03] INFO	Skipping Sampling
[12/26/21 19:46:03] INFO	Getting All Estimators
[12/26/21 19:46:03] INFO	Algorithm Configuration
[12/26/21 19:46:03] INFO	Selecting Models
[12/26/21 19:46:03] INFO	Algorithm: CATB
[12/26/21 19:46:03] INFO	Fitting Initial Model
[12/26/21 19:46:03] INFO	Cross-Validation
[12/26/21 19:46:05] INFO	Cross-Validation Scores: [0.83592177 0.87170453 0.87414917]
[12/26/21 19:46:05] INFO	Recursive Feature Elimination with CV
[12/26/21 19:46:07] INFO	RFECV took 2.36 seconds for step 3 and 3 folds
[12/26/21 19:46:07] INFO	Algorithm: CATB, Selected Features: 17, Ranking: [1 1 1 1 1 5 1 1 1 1 2 3 4 1 5 6 7 7 7 6 2 1 1 1 1 4 2 5 1 4 3 6 1 3 1]
[12/26/21 19:46:07] INFO	No grid is defined for grid search
[12/26/21 19:46:07] INFO	Final Model Predictions for CATB
[12/26/21 19:46:07] INFO	Skipping Calibration
[12/26/21 19:46:07] INFO	Making Predictions
[12/26/21 19:46:07] INFO	Predictions Complete
[12/26/21 19:46:07] INFO	Algorithm: LGB
[12/26/21 19:46:07] INFO	Fitting Initial Model
[12/26/21 19:46:07] INFO	Cross-Validation
[12/26/21 19:46:08] INFO	Cross-Validation Scores: [0.83024159 0.87527562 0.85135653]
[12/26/21 19:46:08] INFO	Recursive Feature Elimination with CV
[12/26/21 19:46:11] INFO	RFECV took 2.32 seconds for step 3 and 3 folds
[12/26/21 19:46:11] INFO	Algorithm: LGB, Selected Features: 11, Ranking: [1 1 1 1 2 7 1 1 1 3 6 6 5 4 7 8 8 9 8 9 6 1 7 1 3 9 4 5 4 2 2 5 3 1 1]
[12/26/21 19:46:11] INFO	No grid is defined for grid search
[12/26/21 19:46:11] INFO	Final Model Predictions for LGB
[12/26/21 19:46:11] INFO	Skipping Calibration
[12/26/21 19:46:11] INFO	Making Predictions
[12/26/21 19:46:11] INFO	Predictions Complete
[12/26/21 19:46:11] INFO	Algorithm: XGB
[12/26/21 19:46:11] INFO	Fitting Initial Model
[12/26/21 19:46:11] INFO	Cross-Validation
[12/26/21 19:46:11] INFO	Cross-Validation Scores: [0.83719202 0.88335251 0.86516154]
[12/26/21 19:46:11] INFO	Recursive Feature Elimination with CV
[12/26/21 19:46:13] INFO	RFECV took 2.24 seconds for step 3 and 3 folds
[12/26/21 19:46:13] INFO	Algorithm: XGB, Selected Features: 14, Ranking: [1 1 1 1 1 2 2 1 1 1 3 4 1 2 6 7 6 8 7 7 8 1 8 1 4 5 4 3 5 1 3 5 1 6 1]
[12/26/21 19:46:13] INFO	Randomized Grid Search
[12/26/21 19:47:07] INFO	Grid Search took 53.82 seconds for 50 candidate parameter settings.
[12/26/21 19:47:07] INFO	Model with rank: 1
[12/26/21 19:47:07] INFO	Mean validation score: 0.869 (std: 0.024)
[12/26/21 19:47:07] INFO	Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 19:47:07] INFO	Model with rank: 2
[12/26/21 19:47:07] INFO	Mean validation score: 0.869 (std: 0.019)
[12/26/21 19:47:07] INFO	Parameters: {'est__subsample': 0.6, 'est__n_estimators': 21, 'est__min_child_weight': 1.0, 'est__max_depth': 8, 'est__learning_rate': 0.05, 'est__colsample_bytree': 0.9}
[12/26/21 19:47:07] INFO	Model with rank: 3
[12/26/21 19:47:07] INFO	Mean validation score: 0.869 (std: 0.019)
[12/26/21 19:47:07] INFO	Parameters: {'est__subsample': 0.5, 'est__n_estimators': 501, 'est__min_child_weight': 1.1, 'est__max_depth': 12, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.9}
[12/26/21 19:47:07] INFO	Algorithm: XGB, Best Score: 0.8694, Best Parameters: {'est__subsample': 0.7, 'est__n_estimators': 201, 'est__min_child_weight': 1.1, 'est__max_depth': 8, 'est__learning_rate': 0.01, 'est__colsample_bytree': 0.5}
[12/26/21 19:47:07] INFO	Final Model Predictions for XGB
[12/26/21 19:47:07] INFO	Skipping Calibration
[12/26/21 19:47:07] INFO	Making Predictions
[12/26/21 19:47:07] INFO	Predictions Complete
[12/26/21 19:47:07] INFO	Blending Models
[12/26/21 19:47:07] INFO	Blending Start: 2021-12-26 19:47:07.545251
[12/26/21 19:47:07] INFO	Blending Complete: 0:00:00.005661
[12/26/21 19:47:07] INFO	================================================================================
[12/26/21 19:47:07] INFO	Metrics for: Partition.train
[12/26/21 19:47:07] INFO	--------------------------------------------------------------------------------
[12/26/21 19:47:07] INFO	Algorithm: CATB
[12/26/21 19:47:07] INFO	accuracy: 0.8585858585858586
[12/26/21 19:47:07] INFO	average_precision: 0.9113351686222868
[12/26/21 19:47:07] INFO	balanced_accuracy: 0.8378391333525069
[12/26/21 19:47:07] INFO	brier_score_loss: 0.10043404518351136
[12/26/21 19:47:07] INFO	cohen_kappa: 0.6932572665125658
[12/26/21 19:47:07] INFO	confusion_matrix: [[509  40]
 [ 86 256]]
[12/26/21 19:47:07] INFO	f1: 0.8025078369905956
[12/26/21 19:47:07] INFO	neg_log_loss: 0.3371948718196211
[12/26/21 19:47:07] INFO	precision: 0.8648648648648649
[12/26/21 19:47:07] INFO	recall: 0.7485380116959064
[12/26/21 19:47:07] INFO	roc_auc: 0.9297979313797549
[12/26/21 19:47:07] INFO	--------------------------------------------------------------------------------
[12/26/21 19:47:07] INFO	Algorithm: LGB
[12/26/21 19:47:07] INFO	accuracy: 0.9730639730639731
[12/26/21 19:47:07] INFO	average_precision: 0.9961113207491221
[12/26/21 19:47:07] INFO	balanced_accuracy: 0.9687709711437062
[12/26/21 19:47:07] INFO	brier_score_loss: 0.032809498448974184
[12/26/21 19:47:07] INFO	cohen_kappa: 0.9427387092109702
[12/26/21 19:47:07] INFO	confusion_matrix: [[542   7]
 [ 17 325]]
[12/26/21 19:47:07] INFO	f1: 0.9643916913946586
[12/26/21 19:47:07] INFO	neg_log_loss: 0.1458307566281259
[12/26/21 19:47:07] INFO	precision: 0.9789156626506024
[12/26/21 19:47:07] INFO	recall: 0.9502923976608187
[12/26/21 19:47:07] INFO	roc_auc: 0.9974861257576241
[12/26/21 19:47:07] INFO	--------------------------------------------------------------------------------
[12/26/21 19:47:07] INFO	Algorithm: XGB
[12/26/21 19:47:07] INFO	accuracy: 0.9191919191919192
[12/26/21 19:47:07] INFO	average_precision: 0.9634798085774395
[12/26/21 19:47:07] INFO	balanced_accuracy: 0.9035567059725818
[12/26/21 19:47:07] INFO	brier_score_loss: 0.08653320682334775
[12/26/21 19:47:07] INFO	cohen_kappa: 0.8253112439956867
[12/26/21 19:47:07] INFO	confusion_matrix: [[533  16]
 [ 56 286]]
[12/26/21 19:47:07] INFO	f1: 0.888198757763975
[12/26/21 19:47:07] INFO	neg_log_loss: 0.32327724179602096
[12/26/21 19:47:07] INFO	precision: 0.9470198675496688
[12/26/21 19:47:07] INFO	recall: 0.8362573099415205
[12/26/21 19:47:07] INFO	roc_auc: 0.9720384750583198
[12/26/21 19:47:07] INFO	================================================================================
[12/26/21 19:47:07] INFO	Selecting Best Model for partition: Partition.train
[12/26/21 19:47:07] INFO	Best Model Selection Start: 2021-12-26 19:47:07.575439
[12/26/21 19:47:07] INFO	Scoring CATB Model
[12/26/21 19:47:07] INFO	Scoring LGB Model
[12/26/21 19:47:07] INFO	Scoring XGB Model
[12/26/21 19:47:07] INFO	Scoring BLEND Model
[12/26/21 19:47:07] INFO	Best Model is BLEND with a roc_auc score of 0.9979
[12/26/21 19:47:07] INFO	Best Model Selection Complete: 0:00:00.000198
[12/26/21 19:47:07] INFO	================================================================================
[12/26/21 19:47:07] INFO	Generating Plots for partition: train
[12/26/21 19:47:07] INFO	Generating Calibration Plot
[12/26/21 19:47:07] INFO	Calibration for Algorithm: CATB
[12/26/21 19:47:07] INFO	Calibration for Algorithm: LGB
[12/26/21 19:47:07] INFO	Calibration for Algorithm: XGB
[12/26/21 19:47:07] INFO	Writing plot to ./plots/calibration_train.png
[12/26/21 19:47:07] INFO	Generating Confusion Matrices
[12/26/21 19:47:07] INFO	Confusion Matrix for Algorithm: CATB
[12/26/21 19:47:07] INFO	Confusion Matrix:
[12/26/21 19:47:07] INFO	[[509  40]
 [ 86 256]]
[12/26/21 19:47:07] INFO	Writing plot to ./plots/confusion_train_CATB.png
[12/26/21 19:47:07] INFO	Confusion Matrix for Algorithm: LGB
[12/26/21 19:47:07] INFO	Confusion Matrix:
[12/26/21 19:47:07] INFO	[[542   7]
 [ 17 325]]
[12/26/21 19:47:07] INFO	Writing plot to ./plots/confusion_train_LGB.png
[12/26/21 19:47:07] INFO	Confusion Matrix for Algorithm: XGB
[12/26/21 19:47:07] INFO	Confusion Matrix:
[12/26/21 19:47:07] INFO	[[533  16]
 [ 56 286]]
[12/26/21 19:47:07] INFO	Writing plot to ./plots/confusion_train_XGB.png
[12/26/21 19:47:08] INFO	Generating ROC Curves
[12/26/21 19:47:08] INFO	ROC Curve for Algorithm: CATB
[12/26/21 19:47:08] INFO	ROC Curve for Algorithm: LGB
[12/26/21 19:47:08] INFO	ROC Curve for Algorithm: XGB
[12/26/21 19:47:08] INFO	Writing plot to ./plots/roc_curve_train.png
[12/26/21 19:47:08] INFO	Generating Learning Curves
[12/26/21 19:47:08] INFO	Algorithm Configuration
[12/26/21 19:47:08] INFO	Learning Curve for Algorithm: CATB
[12/26/21 19:47:08] INFO	Writing plot to ./plots/learning_curve_train_CATB.png
[12/26/21 19:47:08] INFO	Learning Curve for Algorithm: LGB
[12/26/21 19:47:10] INFO	Writing plot to ./plots/learning_curve_train_LGB.png
[12/26/21 19:47:10] INFO	Learning Curve for Algorithm: XGB
[12/26/21 19:47:11] INFO	Writing plot to ./plots/learning_curve_train_XGB.png
[12/26/21 19:47:11] INFO	Generating Feature Importance Plots
[12/26/21 19:47:11] INFO	Feature Importances for Algorithm: CATB
[12/26/21 19:47:11] INFO	Feature Ranking:
[12/26/21 19:47:11] INFO	1. Sex_factor (45.178104)
[12/26/21 19:47:11] INFO	2. Pclass (13.721171)
[12/26/21 19:47:11] INFO	3. Age (6.651788)
[12/26/21 19:47:11] INFO	4. Fare (4.529770)
[12/26/21 19:47:11] INFO	5. var (3.586590)
[12/26/21 19:47:11] INFO	6. std (3.492385)
[12/26/21 19:47:11] INFO	7. Ticket_factor (3.315046)
[12/26/21 19:47:11] INFO	8. cluster_30 (2.831587)
[12/26/21 19:47:11] INFO	9. mean (2.733389)
[12/26/21 19:47:11] INFO	10. Name_factor (2.586310)
[12/26/21 19:47:11] INFO	11. Cabin_factor (2.101764)
[12/26/21 19:47:11] INFO	12. Embarked (2.086410)
[12/26/21 19:47:11] INFO	13. SibSp (2.085405)
[12/26/21 19:47:11] INFO	14. cluster_12 (1.876782)
[12/26/21 19:47:11] INFO	15. cluster_24 (1.263144)
[12/26/21 19:47:11] INFO	16. count_2 (1.004409)
[12/26/21 19:47:11] INFO	17. sum (0.955946)
[12/26/21 19:47:11] INFO	Writing plot to ./plots/feature_importance_train_CATB.png
[12/26/21 19:47:11] INFO	Feature Importances for Algorithm: LGB
[12/26/21 19:47:11] INFO	Feature Ranking:
[12/26/21 19:47:11] INFO	1. Fare (256.000000)
[12/26/21 19:47:11] INFO	2. sum (241.000000)
[12/26/21 19:47:11] INFO	3. Age (232.000000)
[12/26/21 19:47:11] INFO	4. std (201.000000)
[12/26/21 19:47:11] INFO	5. Ticket_factor (199.000000)
[12/26/21 19:47:11] INFO	6. Name_factor (175.000000)
[12/26/21 19:47:11] INFO	7. cluster_30 (53.000000)
[12/26/21 19:47:11] INFO	8. cluster_27 (46.000000)
[12/26/21 19:47:11] INFO	9. Sex_factor (43.000000)
[12/26/21 19:47:11] INFO	10. Pclass (43.000000)
[12/26/21 19:47:11] INFO	11. Cabin_factor (41.000000)
[12/26/21 19:47:11] INFO	Writing plot to ./plots/feature_importance_train_LGB.png
[12/26/21 19:47:11] INFO	Feature Importances for Algorithm: XGB
[12/26/21 19:47:11] INFO	Feature Ranking:
[12/26/21 19:47:11] INFO	1. Sex_factor (0.424644)
[12/26/21 19:47:11] INFO	2. Pclass (0.127452)
[12/26/21 19:47:11] INFO	3. Cabin_factor (0.081307)
[12/26/21 19:47:11] INFO	4. Age (0.051007)
[12/26/21 19:47:11] INFO	5. SibSp (0.049620)
[12/26/21 19:47:11] INFO	6. count_1 (0.046373)
[12/26/21 19:47:11] INFO	7. Embarked (0.046225)
[12/26/21 19:47:11] INFO	8. std (0.036262)
[12/26/21 19:47:11] INFO	9. cluster_30 (0.036076)
[12/26/21 19:47:11] INFO	10. Fare (0.032410)
[12/26/21 19:47:11] INFO	11. cluster_24 (0.021187)
[12/26/21 19:47:11] INFO	12. Name_factor (0.019312)
[12/26/21 19:47:11] INFO	13. sum (0.017784)
[12/26/21 19:47:11] INFO	14. cluster_15 (0.010340)
[12/26/21 19:47:11] INFO	Writing plot to ./plots/feature_importance_train_XGB.png
[12/26/21 19:47:11] INFO	Getting Predictions
[12/26/21 19:47:11] INFO	Getting Probabilities
[12/26/21 19:47:11] INFO	Saving Ranked Predictions
[12/26/21 19:47:11] INFO	Writing data frame to ./output/ranked_train_20211226.csv
[12/26/21 19:47:11] INFO	Saving Submission to ./output/submission_20211226.csv
[12/26/21 19:47:11] INFO	Saving Model Predictor
[12/26/21 19:47:11] INFO	Writing model predictor to ./model/model_20211226.pkl
[12/26/21 19:47:11] INFO	Saving Feature Map
[12/26/21 19:47:11] INFO	Writing feature map to ./model/feature_map_20211226.pkl
[12/26/21 19:47:11] INFO	********************************************************************************
[12/26/21 19:47:11] INFO	AlphaPy End
[12/26/21 19:47:11] INFO	********************************************************************************
[01/29/22 16:14:44] INFO	********************************************************************************
[01/29/22 16:14:44] INFO	AlphaPy Start
[01/29/22 16:14:44] INFO	********************************************************************************
[01/29/22 16:14:44] INFO	Model Configuration
[02/18/22 21:45:35] INFO	********************************************************************************
[02/18/22 21:45:35] INFO	AlphaPy Start
[02/18/22 21:45:35] INFO	********************************************************************************
[02/18/22 21:45:35] INFO	Model Configuration
[04/04/22 22:28:00] INFO	********************************************************************************
[04/04/22 22:28:00] INFO	AlphaPy Start
[04/04/22 22:28:00] INFO	********************************************************************************
[04/04/22 22:28:00] INFO	Model Configuration
